(self.webpackChunkTiendaComics=self.webpackChunkTiendaComics||[]).push([[179],{2011:(it,be,L)=>{"use strict";L.d(be,{hO:()=>Ge,xv:()=>ye,Dh:()=>de,GT:()=>ge,cc:()=>Ne,on:()=>$,pX:()=>ie});var _=L(5e3),J=L(127),k=L(2680);it=L.hmd(it);const le=["ngOnDestroy"],ie=(re,he,we,me={})=>new Proxy(re,{get:(Ue,Ce)=>we.runOutsideAngular(()=>{var rt;if(re[Ce])return(null===(rt=null==me?void 0:me.spy)||void 0===rt?void 0:rt.get)&&me.spy.get(Ce,re[Ce]),re[Ce];if(le.indexOf(Ce)>-1)return()=>{};const Ke=he.toPromise().then(pt=>{const Q=pt&&pt[Ce];return"function"==typeof Q?Q.bind(pt):Q&&Q.then?Q.then(ae=>we.run(()=>ae)):we.run(()=>Q)});return new Proxy(()=>{},{get:(pt,Q)=>Ke[Q],apply:(pt,Q,ae)=>Ke.then(_e=>{var Ee;const Re=_e&&_e(...ae);return(null===(Ee=null==me?void 0:me.spy)||void 0===Ee?void 0:Ee.apply)&&me.spy.apply(Ce,ae,Re),Re})})})}),ge=(re,he)=>{he.forEach(we=>{Object.getOwnPropertyNames(we.prototype||we).forEach(me=>{Object.defineProperty(re.prototype,me,Object.getOwnPropertyDescriptor(we.prototype||we,me))})})};class oe{constructor(he){return he}}const de=new _.OlP("angularfire2.app.options"),ye=new _.OlP("angularfire2.app.name");function $(re,he,we){const Ue="object"==typeof we&&we||{};Ue.name=Ue.name||"string"==typeof we&&we||"[DEFAULT]";const rt=J.Z.apps.filter(Ke=>Ke&&Ke.name===Ue.name)[0]||he.runOutsideAngular(()=>J.Z.initializeApp(re,Ue));try{JSON.stringify(re)!==JSON.stringify(rt.options)&&H("error",`${rt.name} Firebase App already initialized with different options${it.hot?", you may need to reload as Firebase is not HMR aware.":"."}`)}catch(Ke){}return new oe(rt)}const H=(re,...he)=>{(0,_.X6Q)()&&"undefined"!=typeof console&&console[re](...he)},X={provide:oe,useFactory:$,deps:[de,_.R0b,[new _.FiY,ye]]};let Ge=(()=>{class re{constructor(we){J.Z.registerVersion("angularfire",k.q4.full,"core"),J.Z.registerVersion("angularfire",k.q4.full,"app-compat"),J.Z.registerVersion("angular",_.q4F.full,we.toString())}static initializeApp(we,me){return{ngModule:re,providers:[{provide:de,useValue:we},{provide:ye,useValue:me}]}}}return re.\u0275fac=function(we){return new(we||re)(_.LFG(_.Lbi))},re.\u0275mod=_.oAB({type:re}),re.\u0275inj=_.cJS({providers:[X]}),re})();function Ne(re,he,we,me,Ue){const[,Ce,rt]=globalThis.\u0275AngularfireInstanceCache.find(Ke=>Ke[0]===re)||[];if(Ce)return function Fe(re,he){try{return re.toString()===he.toString()}catch(we){return re===he}}(Ue,rt)||(K("error",`${he} was already initialized on the ${we} Firebase App with different settings.${Be?" You may need to reload as Firebase is not HMR aware.":""}`),K("warn",{is:Ue,was:rt})),Ce;{const Ke=me();return globalThis.\u0275AngularfireInstanceCache.push([re,Ke,Ue]),Ke}}const Be=!!it.hot,K=(re,...he)=>{(0,_.X6Q)()&&"undefined"!=typeof console&&console[re](...he)};globalThis.\u0275AngularfireInstanceCache||(globalThis.\u0275AngularfireInstanceCache=[])},2680:(it,be,L)=>{"use strict";L.d(be,{q4:()=>Pu,iC:()=>fo,HU:()=>na,vb:()=>Wl,JM:()=>ku});var _=L(5e3),J=L(5867),k=L(5861),le=L(9681),ie=L(2090),ge=L(4859),oe=L(1877),de=L(2940);const ye="@firebase/installations",$="0.5.5",X=`w:${$}`,Ge="FIS_v2",he=new ie.LL("installations","Installations",{"missing-app-config-values":'Missing App configuration value: "{$valueName}"',"not-registered":"Firebase Installation is not registered.","installation-not-found":"Firebase Installation not found.","request-failed":'{$requestName} request failed with error "{$serverCode} {$serverStatus}: {$serverMessage}"',"app-offline":"Could not process request. Application offline.","delete-pending-registration":"Can't delete installation while there is a pending registration request."});function we(D){return D instanceof ie.ZR&&D.code.includes("request-failed")}function me({projectId:D}){return`https://firebaseinstallations.googleapis.com/v1/projects/${D}/installations`}function Ue(D){return{token:D.token,requestStatus:2,expiresIn:_e(D.expiresIn),creationTime:Date.now()}}function Ce(D,T){return rt.apply(this,arguments)}function rt(){return(rt=(0,k.Z)(function*(D,T){const V=(yield T.json()).error;return he.create("request-failed",{requestName:D,serverCode:V.code,serverMessage:V.message,serverStatus:V.status})})).apply(this,arguments)}function Ke({apiKey:D}){return new Headers({"Content-Type":"application/json",Accept:"application/json","x-goog-api-key":D})}function pt(D,{refreshToken:T}){const R=Ke(D);return R.append("Authorization",function Ee(D){return`${Ge} ${D}`}(T)),R}function Q(D){return ae.apply(this,arguments)}function ae(){return(ae=(0,k.Z)(function*(D){const T=yield D();return T.status>=500&&T.status<600?D():T})).apply(this,arguments)}function _e(D){return Number(D.replace("s","000"))}function Re(D,T){return ce.apply(this,arguments)}function ce(){return(ce=(0,k.Z)(function*(D,{fid:T}){const R=me(D),ne={method:"POST",headers:Ke(D),body:JSON.stringify({fid:T,authVersion:Ge,appId:D.appId,sdkVersion:X})},De=yield Q(()=>fetch(R,ne));if(De.ok){const $e=yield De.json();return{fid:$e.fid||T,registrationStatus:2,refreshToken:$e.refreshToken,authToken:Ue($e.authToken)}}throw yield Ce("Create Installation",De)})).apply(this,arguments)}function Ct(D){return new Promise(T=>{setTimeout(T,D)})}const Ln=/^[cdef][\w-]{21}$/;function nt(){try{const D=new Uint8Array(17);(self.crypto||self.msCrypto).getRandomValues(D),D[0]=112+D[0]%16;const R=function wr(D){return function Ot(D){return btoa(String.fromCharCode(...D)).replace(/\+/g,"-").replace(/\//g,"_")}(D).substr(0,22)}(D);return Ln.test(R)?R:""}catch(D){return""}}function Jt(D){return`${D.appName}!${D.appId}`}const mr=new Map;function $t(D,T){const R=Jt(D);Dn(R,T),function vi(D,T){const R=function gn(){return!kt&&"BroadcastChannel"in self&&(kt=new BroadcastChannel("[Firebase] FID Change"),kt.onmessage=D=>{Dn(D.data.key,D.data.fid)}),kt}();R&&R.postMessage({key:D,fid:T}),function Xs(){0===mr.size&&kt&&(kt.close(),kt=null)}()}(R,T)}function Dn(D,T){const R=mr.get(D);if(R)for(const V of R)V(T)}let kt=null;const Ae="firebase-installations-store";let ur=null;function et(){return ur||(ur=(0,de.openDb)("firebase-installations-database",1,D=>{0===D.oldVersion&&D.createObjectStore(Ae)})),ur}function Xr(D,T){return Ut.apply(this,arguments)}function Ut(){return(Ut=(0,k.Z)(function*(D,T){const R=Jt(D),z=(yield et()).transaction(Ae,"readwrite"),ne=z.objectStore(Ae),De=yield ne.get(R);return yield ne.put(T,R),yield z.complete,(!De||De.fid!==T.fid)&&$t(D,T.fid),T})).apply(this,arguments)}function Vn(D){return Rs.apply(this,arguments)}function Rs(){return(Rs=(0,k.Z)(function*(D){const T=Jt(D),V=(yield et()).transaction(Ae,"readwrite");yield V.objectStore(Ae).delete(T),yield V.complete})).apply(this,arguments)}function lt(D,T){return tt.apply(this,arguments)}function tt(){return(tt=(0,k.Z)(function*(D,T){const R=Jt(D),z=(yield et()).transaction(Ae,"readwrite"),ne=z.objectStore(Ae),De=yield ne.get(R),$e=T(De);return void 0===$e?yield ne.delete(R):yield ne.put($e,R),yield z.complete,$e&&(!De||De.fid!==$e.fid)&&$t(D,$e.fid),$e})).apply(this,arguments)}function Dt(D){return sn.apply(this,arguments)}function sn(){return(sn=(0,k.Z)(function*(D){let T;const R=yield lt(D,V=>{const z=Ir(V),ne=bt(D,z);return T=ne.registrationPromise,ne.installationEntry});return""===R.fid?{installationEntry:yield T}:{installationEntry:R,registrationPromise:T}})).apply(this,arguments)}function Ir(D){return mn(D||{fid:nt(),registrationStatus:0})}function bt(D,T){if(0===T.registrationStatus){if(!navigator.onLine)return{installationEntry:T,registrationPromise:Promise.reject(he.create("app-offline"))};const R={fid:T.fid,registrationStatus:1,registrationTime:Date.now()},V=function Xe(D,T){return ot.apply(this,arguments)}(D,R);return{installationEntry:R,registrationPromise:V}}return 1===T.registrationStatus?{installationEntry:T,registrationPromise:_l(D)}:{installationEntry:T}}function ot(){return(ot=(0,k.Z)(function*(D,T){try{return Xr(D,yield Re(D,T))}catch(R){throw we(R)&&409===R.customData.serverCode?yield Vn(D):yield Xr(D,{fid:T.fid,registrationStatus:0}),R}})).apply(this,arguments)}function _l(D){return eo.apply(this,arguments)}function eo(){return(eo=(0,k.Z)(function*(D){let T=yield ct(D);for(;1===T.registrationStatus;)yield Ct(100),T=yield ct(D);if(0===T.registrationStatus){const{installationEntry:R,registrationPromise:V}=yield Dt(D);return V||R}return T})).apply(this,arguments)}function ct(D){return lt(D,T=>{if(!T)throw he.create("installation-not-found");return mn(T)})}function mn(D){return function Cr(D){return 1===D.registrationStatus&&D.registrationTime+1e4<Date.now()}(D)?{fid:D.fid,registrationStatus:0}:D}function as(D,T){return B.apply(this,arguments)}function B(){return(B=(0,k.Z)(function*({appConfig:D,platformLoggerProvider:T},R){const V=G(D,R),z=pt(D,R),ne=T.getImmediate({optional:!0});ne&&z.append("x-firebase-client",ne.getPlatformInfoString());const $e={method:"POST",headers:z,body:JSON.stringify({installation:{sdkVersion:X}})},ke=yield Q(()=>fetch(V,$e));if(ke.ok)return Ue(yield ke.json());throw yield Ce("Generate Auth Token",ke)})).apply(this,arguments)}function G(D,{fid:T}){return`${me(D)}/${T}/authTokens:generate`}function q(D){return ve.apply(this,arguments)}function ve(){return(ve=(0,k.Z)(function*(D,T=!1){let R;const V=yield lt(D.appConfig,ne=>{if(!bn(ne))throw he.create("not-registered");const De=ne.authToken;if(!T&&Dr(De))return ne;if(1===De.requestStatus)return R=ee(D,T),ne;{if(!navigator.onLine)throw he.create("app-offline");const $e=lr(ne);return R=on(D,$e),$e}});return R?yield R:V.authToken})).apply(this,arguments)}function ee(D,T){return je.apply(this,arguments)}function je(){return(je=(0,k.Z)(function*(D,T){let R=yield gt(D.appConfig);for(;1===R.authToken.requestStatus;)yield Ct(100),R=yield gt(D.appConfig);const V=R.authToken;return 0===V.requestStatus?q(D,T):V})).apply(this,arguments)}function gt(D){return lt(D,T=>{if(!bn(T))throw he.create("not-registered");return function Ps(D){return 1===D.requestStatus&&D.requestTime+1e4<Date.now()}(T.authToken)?Object.assign(Object.assign({},T),{authToken:{requestStatus:0}}):T})}function on(D,T){return Bn.apply(this,arguments)}function Bn(){return(Bn=(0,k.Z)(function*(D,T){try{const R=yield as(D,T),V=Object.assign(Object.assign({},T),{authToken:R});return yield Xr(D.appConfig,V),R}catch(R){if(!we(R)||401!==R.customData.serverCode&&404!==R.customData.serverCode){const V=Object.assign(Object.assign({},T),{authToken:{requestStatus:0}});yield Xr(D.appConfig,V)}else yield Vn(D.appConfig);throw R}})).apply(this,arguments)}function bn(D){return void 0!==D&&2===D.registrationStatus}function Dr(D){return 2===D.requestStatus&&!function xt(D){const T=Date.now();return T<D.creationTime||D.creationTime+D.expiresIn<T+36e5}(D)}function lr(D){const T={requestStatus:1,requestTime:Date.now()};return Object.assign(Object.assign({},D),{authToken:T})}function ko(){return(ko=(0,k.Z)(function*(D){const T=D,{installationEntry:R,registrationPromise:V}=yield Dt(T.appConfig);return V?V.catch(console.error):q(T).catch(console.error),R.fid})).apply(this,arguments)}function to(){return(to=(0,k.Z)(function*(D,T=!1){const R=D;return yield Qn(R.appConfig),(yield q(R,T)).token})).apply(this,arguments)}function Qn(D){return Un.apply(this,arguments)}function Un(){return(Un=(0,k.Z)(function*(D){const{registrationPromise:T}=yield Dt(D);T&&(yield T)})).apply(this,arguments)}function wa(D){return he.create("missing-app-config-values",{valueName:D})}const jr="installations",Tt=D=>{const T=D.getProvider("app").getImmediate(),R=function jn(D){if(!D||!D.options)throw wa("App Configuration");if(!D.name)throw wa("App Name");const T=["projectId","apiKey","appId"];for(const R of T)if(!D.options[R])throw wa(R);return{appName:D.name,projectId:D.options.projectId,apiKey:D.options.apiKey,appId:D.options.appId}}(T);return{app:T,appConfig:R,platformLoggerProvider:(0,le._getProvider)(T,"platform-logger"),_delete:()=>Promise.resolve()}},jt=D=>{const T=D.getProvider("app").getImmediate(),R=(0,le._getProvider)(T,jr).getImmediate();return{getId:()=>function yl(D){return ko.apply(this,arguments)}(R),getToken:z=>function mu(D){return to.apply(this,arguments)}(R,z)}};(function Tn(){(0,le._registerComponent)(new ge.wA(jr,Tt,"PUBLIC")),(0,le._registerComponent)(new ge.wA("installations-internal",jt,"PRIVATE"))})(),(0,le.registerVersion)(ye,$),(0,le.registerVersion)(ye,$,"esm2017");const _r="@firebase/remote-config",An=new ie.LL("remoteconfig","Remote Config",{"registration-window":"Undefined window object. This SDK only supports usage in a browser environment.","registration-project-id":"Undefined project identifier. Check Firebase app initialization.","registration-api-key":"Undefined API key. Check Firebase app initialization.","registration-app-id":"Undefined app identifier. Check Firebase app initialization.","storage-open":"Error thrown when opening storage. Original error: {$originalErrorMessage}.","storage-get":"Error thrown when reading from storage. Original error: {$originalErrorMessage}.","storage-set":"Error thrown when writing to storage. Original error: {$originalErrorMessage}.","storage-delete":"Error thrown when deleting from storage. Original error: {$originalErrorMessage}.","fetch-client-network":"Fetch client failed to connect to a network. Check Internet connection. Original error: {$originalErrorMessage}.","fetch-timeout":'The config fetch request timed out.  Configure timeout using "fetchTimeoutMillis" SDK setting.',"fetch-throttle":'The config fetch request timed out while in an exponential backoff state. Configure timeout using "fetchTimeoutMillis" SDK setting. Unix timestamp in milliseconds when fetch request throttling ends: {$throttleEndTimeMillis}.',"fetch-client-parse":"Fetch client could not parse response. Original error: {$originalErrorMessage}.","fetch-status":"Fetch server returned an HTTP error status. HTTP status: {$httpStatus}.","indexed-db-unavailable":"Indexed DB is not supported by current browser"});class Qp{constructor(T,R,V,z){this.client=T,this.storage=R,this.storageCache=V,this.logger=z}isCachedDataFresh(T,R){if(!R)return this.logger.debug("Config fetch cache check. Cache unpopulated."),!1;const V=Date.now()-R,z=V<=T;return this.logger.debug(`Config fetch cache check. Cache age millis: ${V}. Cache max age millis (minimumFetchIntervalMillis setting): ${T}. Is cache hit: ${z}.`),z}fetch(T){var R=this;return(0,k.Z)(function*(){const[V,z]=yield Promise.all([R.storage.getLastSuccessfulFetchTimestampMillis(),R.storage.getLastSuccessfulFetchResponse()]);if(z&&R.isCachedDataFresh(T.cacheMaxAgeMillis,V))return z;T.eTag=z&&z.eTag;const ne=yield R.client.fetch(T),De=[R.storageCache.setLastSuccessfulFetchTimestampMillis(Date.now())];return 200===ne.status&&De.push(R.storage.setLastSuccessfulFetchResponse(ne)),yield Promise.all(De),ne})()}}function Ph(D=navigator){return D.languages&&D.languages[0]||D.language}class Di{constructor(T,R,V,z,ne,De){this.firebaseInstallations=T,this.sdkVersion=R,this.namespace=V,this.projectId=z,this.apiKey=ne,this.appId=De}fetch(T){var R=this;return(0,k.Z)(function*(){const[V,z]=yield Promise.all([R.firebaseInstallations.getId(),R.firebaseInstallations.getToken()]),De=`${window.FIREBASE_REMOTE_CONFIG_URL_BASE||"https://firebaseremoteconfig.googleapis.com"}/v1/projects/${R.projectId}/namespaces/${R.namespace}:fetch?key=${R.apiKey}`,$e={"Content-Type":"application/json","Content-Encoding":"gzip","If-None-Match":T.eTag||"*"},ke={sdk_version:R.sdkVersion,app_instance_id:V,app_instance_id_token:z,app_id:R.appId,language_code:Ph()},at={method:"POST",headers:$e,body:JSON.stringify(ke)},Ft=fetch(De,at),ln=new Promise((Qi,Ji)=>{T.signal.addEventListener(()=>{const Hs=new Error("The operation was aborted.");Hs.name="AbortError",Ji(Hs)})});let dr;try{yield Promise.race([Ft,ln]),dr=yield Ft}catch(Qi){let Ji="fetch-client-network";throw"AbortError"===Qi.name&&(Ji="fetch-timeout"),An.create(Ji,{originalErrorMessage:Qi.message})}let In=dr.status;const js=dr.headers.get("ETag")||void 0;let po,Yi;if(200===dr.status){let Qi;try{Qi=yield dr.json()}catch(Ji){throw An.create("fetch-client-parse",{originalErrorMessage:Ji.message})}po=Qi.entries,Yi=Qi.state}if("INSTANCE_STATE_UNSPECIFIED"===Yi?In=500:"NO_CHANGE"===Yi?In=304:("NO_TEMPLATE"===Yi||"EMPTY_CONFIG"===Yi)&&(po={}),304!==In&&200!==In)throw An.create("fetch-status",{httpStatus:In});return{status:In,eTag:js,config:po}})()}}class Uc{constructor(T,R){this.client=T,this.storage=R}fetch(T){var R=this;return(0,k.Z)(function*(){const V=(yield R.storage.getThrottleMetadata())||{backoffCount:0,throttleEndTimeMillis:Date.now()};return R.attemptFetch(T,V)})()}attemptFetch(T,{throttleEndTimeMillis:R,backoffCount:V}){var z=this;return(0,k.Z)(function*(){yield function Ca(D,T){return new Promise((R,V)=>{const z=Math.max(T-Date.now(),0),ne=setTimeout(R,z);D.addEventListener(()=>{clearTimeout(ne),V(An.create("fetch-throttle",{throttleEndTimeMillis:T}))})})}(T.signal,R);try{const ne=yield z.client.fetch(T);return yield z.storage.deleteThrottleMetadata(),ne}catch(ne){if(!function Oh(D){if(!(D instanceof ie.ZR&&D.customData))return!1;const T=Number(D.customData.httpStatus);return 429===T||500===T||503===T||504===T}(ne))throw ne;const De={throttleEndTimeMillis:Date.now()+(0,ie.$s)(V),backoffCount:V+1};return yield z.storage.setThrottleMetadata(De),z.attemptFetch(T,De)}})()}}class Jp{constructor(T,R,V,z,ne){this.app=T,this._client=R,this._storageCache=V,this._storage=z,this._logger=ne,this._isInitializationComplete=!1,this.settings={fetchTimeoutMillis:6e4,minimumFetchIntervalMillis:432e5},this.defaultConfig={}}get fetchTimeMillis(){return this._storageCache.getLastSuccessfulFetchTimestampMillis()||-1}get lastFetchStatus(){return this._storageCache.getLastFetchStatus()||"no-fetch-yet"}}function Da(D,T){const R=D.target.error||void 0;return An.create(T,{originalErrorMessage:R&&R.message})}const Bo="app_namespace_store";class Xp{constructor(T,R,V,z=function Gc(){return new Promise((D,T)=>{try{const R=indexedDB.open("firebase_remote_config",1);R.onerror=V=>{T(Da(V,"storage-open"))},R.onsuccess=V=>{D(V.target.result)},R.onupgradeneeded=V=>{0===V.oldVersion&&V.target.result.createObjectStore(Bo,{keyPath:"compositeKey"})}}catch(R){T(An.create("storage-open",{originalErrorMessage:R}))}})}()){this.appId=T,this.appName=R,this.namespace=V,this.openDbPromise=z}getLastFetchStatus(){return this.get("last_fetch_status")}setLastFetchStatus(T){return this.set("last_fetch_status",T)}getLastSuccessfulFetchTimestampMillis(){return this.get("last_successful_fetch_timestamp_millis")}setLastSuccessfulFetchTimestampMillis(T){return this.set("last_successful_fetch_timestamp_millis",T)}getLastSuccessfulFetchResponse(){return this.get("last_successful_fetch_response")}setLastSuccessfulFetchResponse(T){return this.set("last_successful_fetch_response",T)}getActiveConfig(){return this.get("active_config")}setActiveConfig(T){return this.set("active_config",T)}getActiveConfigEtag(){return this.get("active_config_etag")}setActiveConfigEtag(T){return this.set("active_config_etag",T)}getThrottleMetadata(){return this.get("throttle_metadata")}setThrottleMetadata(T){return this.set("throttle_metadata",T)}deleteThrottleMetadata(){return this.delete("throttle_metadata")}get(T){var R=this;return(0,k.Z)(function*(){const V=yield R.openDbPromise;return new Promise((z,ne)=>{const $e=V.transaction([Bo],"readonly").objectStore(Bo),ke=R.createCompositeKey(T);try{const at=$e.get(ke);at.onerror=Ft=>{ne(Da(Ft,"storage-get"))},at.onsuccess=Ft=>{const ln=Ft.target.result;z(ln?ln.value:void 0)}}catch(at){ne(An.create("storage-get",{originalErrorMessage:at&&at.message}))}})})()}set(T,R){var V=this;return(0,k.Z)(function*(){const z=yield V.openDbPromise;return new Promise((ne,De)=>{const ke=z.transaction([Bo],"readwrite").objectStore(Bo),at=V.createCompositeKey(T);try{const Ft=ke.put({compositeKey:at,value:R});Ft.onerror=ln=>{De(Da(ln,"storage-set"))},Ft.onsuccess=()=>{ne()}}catch(Ft){De(An.create("storage-set",{originalErrorMessage:Ft&&Ft.message}))}})})()}delete(T){var R=this;return(0,k.Z)(function*(){const V=yield R.openDbPromise;return new Promise((z,ne)=>{const $e=V.transaction([Bo],"readwrite").objectStore(Bo),ke=R.createCompositeKey(T);try{const at=$e.delete(ke);at.onerror=Ft=>{ne(Da(Ft,"storage-delete"))},at.onsuccess=()=>{z()}}catch(at){ne(An.create("storage-delete",{originalErrorMessage:at&&at.message}))}})})()}createCompositeKey(T){return[this.appId,this.appName,this.namespace,T].join()}}class $c{constructor(T){this.storage=T}getLastFetchStatus(){return this.lastFetchStatus}getLastSuccessfulFetchTimestampMillis(){return this.lastSuccessfulFetchTimestampMillis}getActiveConfig(){return this.activeConfig}loadFromStorage(){var T=this;return(0,k.Z)(function*(){const R=T.storage.getLastFetchStatus(),V=T.storage.getLastSuccessfulFetchTimestampMillis(),z=T.storage.getActiveConfig(),ne=yield R;ne&&(T.lastFetchStatus=ne);const De=yield V;De&&(T.lastSuccessfulFetchTimestampMillis=De);const $e=yield z;$e&&(T.activeConfig=$e)})()}setLastFetchStatus(T){return this.lastFetchStatus=T,this.storage.setLastFetchStatus(T)}setLastSuccessfulFetchTimestampMillis(T){return this.lastSuccessfulFetchTimestampMillis=T,this.storage.setLastSuccessfulFetchTimestampMillis(T)}setActiveConfig(T){return this.activeConfig=T,this.storage.setActiveConfig(T)}}function Wc(){return Il.apply(this,arguments)}function Il(){return(Il=(0,k.Z)(function*(){if(!(0,ie.hl)())return!1;try{return yield(0,ie.eu)()}catch(D){return!1}})).apply(this,arguments)}!function eg(){(0,le._registerComponent)(new ge.wA("remote-config",function D(T,{instanceIdentifier:R}){const V=T.getProvider("app").getImmediate(),z=T.getProvider("installations-internal").getImmediate();if("undefined"==typeof window)throw An.create("registration-window");if(!(0,ie.hl)())throw An.create("indexed-db-unavailable");const{projectId:ne,apiKey:De,appId:$e}=V.options;if(!ne)throw An.create("registration-project-id");if(!De)throw An.create("registration-api-key");if(!$e)throw An.create("registration-app-id");const ke=new Xp($e,V.name,R=R||"firebase"),at=new $c(ke),Ft=new oe.Yd(_r);Ft.logLevel=oe.in.ERROR;const ln=new Di(z,le.SDK_VERSION,R,ne,De,$e),dr=new Uc(ln,ke),In=new Qp(dr,ke,at,Ft),js=new Jp(V,In,at,ke,Ft);return function Xt(D){const T=(0,ie.m9)(D);T._initializePromise||(T._initializePromise=T._storageCache.loadFromStorage().then(()=>{T._isInitializationComplete=!0}))}(js),js},"PUBLIC").setMultipleInstances(!0)),(0,le.registerVersion)(_r,"0.3.4"),(0,le.registerVersion)(_r,"0.3.4","esm2017")}();const qc="/firebase-messaging-sw.js",so="/firebase-cloud-messaging-push-scope",_u="BDOU99-h67HcA6JeFXHbSNMu7e2yNNu3RzoMj8TM4W88jITfq7ZmPvIM1Iv-4_l2LxQcYwhqby2xGpWwzjfAnG4",oo="google.c.a.c_id",Aa="google.c.a.c_l",ks="google.c.a.ts",Sa="google.c.a.e";var yr=(()=>{return(D=yr||(yr={})).PUSH_RECEIVED="push-received",D.NOTIFICATION_CLICKED="notification-clicked",yr;var D})();function bi(D){const T=new Uint8Array(D);return btoa(String.fromCharCode(...T)).replace(/=/g,"").replace(/\+/g,"-").replace(/\//g,"_")}function Cl(D){const R=(D+"=".repeat((4-D.length%4)%4)).replace(/\-/g,"+").replace(/_/g,"/"),V=atob(R),z=new Uint8Array(V.length);for(let ne=0;ne<V.length;++ne)z[ne]=V.charCodeAt(ne);return z}const Gr="fcm_token_details_db",Kc="fcm_token_object_Store";function yu(D){return Zc.apply(this,arguments)}function Zc(){return Zc=(0,k.Z)(function*(D){if("databases"in indexedDB&&!(yield indexedDB.databases()).map(ne=>ne.name).includes(Gr))return null;let T=null;return(yield(0,de.openDb)(Gr,5,function(){var V=(0,k.Z)(function*(z){var ne;if(z.oldVersion<2||!z.objectStoreNames.contains(Kc))return;const De=z.transaction.objectStore(Kc),$e=yield De.index("fcmSenderId").get(D);if(yield De.clear(),$e)if(2===z.oldVersion){const ke=$e;if(!ke.auth||!ke.p256dh||!ke.endpoint)return;T={token:ke.fcmToken,createTime:null!==(ne=ke.createTime)&&void 0!==ne?ne:Date.now(),subscriptionOptions:{auth:ke.auth,p256dh:ke.p256dh,endpoint:ke.endpoint,swScope:ke.swScope,vapidKey:"string"==typeof ke.vapidKey?ke.vapidKey:bi(ke.vapidKey)}}}else if(3===z.oldVersion){const ke=$e;T={token:ke.fcmToken,createTime:ke.createTime,subscriptionOptions:{auth:bi(ke.auth),p256dh:bi(ke.p256dh),endpoint:ke.endpoint,swScope:ke.swScope,vapidKey:bi(ke.vapidKey)}}}else if(4===z.oldVersion){const ke=$e;T={token:ke.fcmToken,createTime:ke.createTime,subscriptionOptions:{auth:bi(ke.auth),p256dh:bi(ke.p256dh),endpoint:ke.endpoint,swScope:ke.swScope,vapidKey:bi(ke.vapidKey)}}}});return function(z){return V.apply(this,arguments)}}())).close(),yield(0,de.deleteDb)(Gr),yield(0,de.deleteDb)("fcm_vapid_details_db"),yield(0,de.deleteDb)("undefined"),Yc(T)?T:null}),Zc.apply(this,arguments)}function Yc(D){if(!D||!D.subscriptionOptions)return!1;const{subscriptionOptions:T}=D;return"number"==typeof D.createTime&&D.createTime>0&&"string"==typeof D.token&&D.token.length>0&&"string"==typeof T.auth&&T.auth.length>0&&"string"==typeof T.p256dh&&T.p256dh.length>0&&"string"==typeof T.endpoint&&T.endpoint.length>0&&"string"==typeof T.swScope&&T.swScope.length>0&&"string"==typeof T.vapidKey&&T.vapidKey.length>0}const Fs="firebase-messaging-store";let Qc=null;function en(){return Qc||(Qc=(0,de.openDb)("firebase-messaging-database",1,D=>{0===D.oldVersion&&D.createObjectStore(Fs)})),Qc}function Lh(D){return Uo.apply(this,arguments)}function Uo(){return(Uo=(0,k.Z)(function*(D){const T=Gi(D),V=yield(yield en()).transaction(Fs).objectStore(Fs).get(T);if(V)return V;{const z=yield yu(D.appConfig.senderId);if(z)return yield $n(D,z),z}})).apply(this,arguments)}function $n(D,T){return Mn.apply(this,arguments)}function Mn(){return(Mn=(0,k.Z)(function*(D,T){const R=Gi(D),z=(yield en()).transaction(Fs,"readwrite");return yield z.objectStore(Fs).put(T,R),yield z.complete,T})).apply(this,arguments)}function ls(D){return jo.apply(this,arguments)}function jo(){return(jo=(0,k.Z)(function*(D){const T=Gi(D),V=(yield en()).transaction(Fs,"readwrite");yield V.objectStore(Fs).delete(T),yield V.complete})).apply(this,arguments)}function Gi({appConfig:D}){return D.appId}const Wn=new ie.LL("messaging","Messaging",{"missing-app-config-values":'Missing App configuration value: "{$valueName}"',"only-available-in-window":"This method is available in a Window context.","only-available-in-sw":"This method is available in a service worker context.","permission-default":"The notification permission was not granted and dismissed instead.","permission-blocked":"The notification permission was not granted and blocked instead.","unsupported-browser":"This browser doesn't support the API's required to use the Firebase SDK.","indexed-db-unsupported":"This browser doesn't support indexedDb.open() (ex. Safari iFrame, Firefox Private Browsing, etc)","failed-service-worker-registration":"We are unable to register the default service worker. {$browserErrorMessage}","token-subscribe-failed":"A problem occurred while subscribing the user to FCM: {$errorInfo}","token-subscribe-no-token":"FCM returned no token when subscribing the user to push.","token-unsubscribe-failed":"A problem occurred while unsubscribing the user from FCM: {$errorInfo}","token-update-failed":"A problem occurred while updating the user from FCM: {$errorInfo}","token-update-no-token":"FCM returned no token when updating the user to push.","use-sw-after-get-token":"The useServiceWorker() method may only be called once and must be called before calling getToken() to ensure your service worker is used.","invalid-sw-registration":"The input to useServiceWorker() must be a ServiceWorkerRegistration.","invalid-bg-handler":"The input to setBackgroundMessageHandler() must be a function.","invalid-vapid-key":"The public VAPID key must be a string.","use-vapid-key-after-get-token":"The usePublicVapidKey() method may only be called once and must be called before calling getToken() to ensure your VAPID key is used."});function $i(D,T){return Dl.apply(this,arguments)}function Dl(){return(Dl=(0,k.Z)(function*(D,T){const R=yield Ma(D),V=Go(T),z={method:"POST",headers:R,body:JSON.stringify(V)};let ne;try{ne=yield(yield fetch(Xn(D.appConfig),z)).json()}catch(De){throw Wn.create("token-subscribe-failed",{errorInfo:De})}if(ne.error)throw Wn.create("token-subscribe-failed",{errorInfo:ne.error.message});if(!ne.token)throw Wn.create("token-subscribe-no-token");return ne.token})).apply(this,arguments)}function Ar(D,T){return Ls.apply(this,arguments)}function Ls(){return(Ls=(0,k.Z)(function*(D,T){const R=yield Ma(D),V=Go(T.subscriptionOptions),z={method:"PATCH",headers:R,body:JSON.stringify(V)};let ne;try{ne=yield(yield fetch(`${Xn(D.appConfig)}/${T.token}`,z)).json()}catch(De){throw Wn.create("token-update-failed",{errorInfo:De})}if(ne.error)throw Wn.create("token-update-failed",{errorInfo:ne.error.message});if(!ne.token)throw Wn.create("token-update-no-token");return ne.token})).apply(this,arguments)}function Ho(D,T){return dt.apply(this,arguments)}function dt(){return(dt=(0,k.Z)(function*(D,T){const V={method:"DELETE",headers:yield Ma(D)};try{const ne=yield(yield fetch(`${Xn(D.appConfig)}/${T}`,V)).json();if(ne.error)throw Wn.create("token-unsubscribe-failed",{errorInfo:ne.error.message})}catch(z){throw Wn.create("token-unsubscribe-failed",{errorInfo:z})}})).apply(this,arguments)}function Xn({projectId:D}){return`https://fcmregistrations.googleapis.com/v1/projects/${D}/registrations`}function Ma(D){return Na.apply(this,arguments)}function Na(){return(Na=(0,k.Z)(function*({appConfig:D,installations:T}){const R=yield T.getToken();return new Headers({"Content-Type":"application/json",Accept:"application/json","x-goog-api-key":D.apiKey,"x-goog-firebase-installations-auth":`FIS ${R}`})})).apply(this,arguments)}function Go({p256dh:D,auth:T,endpoint:R,vapidKey:V}){const z={web:{endpoint:R,auth:T,p256dh:D}};return V!==_u&&(z.web.applicationPubKey=V),z}const $o=6048e5;function bl(D){return vu.apply(this,arguments)}function vu(){return(vu=(0,k.Z)(function*(D){const T=yield $r(D.swRegistration,D.vapidKey),R={vapidKey:D.vapidKey,swScope:D.swRegistration.scope,endpoint:T.endpoint,auth:bi(T.getKey("auth")),p256dh:bi(T.getKey("p256dh"))},V=yield Lh(D.firebaseDependencies);if(V){if(wu(V.subscriptionOptions,R))return Date.now()>=V.createTime+$o?Eu(D,{token:V.token,createTime:Date.now(),subscriptionOptions:R}):V.token;try{yield Ho(D.firebaseDependencies,V.token)}catch(z){console.warn(z)}return ao(D.firebaseDependencies,R)}return ao(D.firebaseDependencies,R)})).apply(this,arguments)}function Te(D){return At.apply(this,arguments)}function At(){return(At=(0,k.Z)(function*(D){const T=yield Lh(D.firebaseDependencies);T&&(yield Ho(D.firebaseDependencies,T.token),yield ls(D.firebaseDependencies));const R=yield D.swRegistration.pushManager.getSubscription();return!R||R.unsubscribe()})).apply(this,arguments)}function Eu(D,T){return tn.apply(this,arguments)}function tn(){return(tn=(0,k.Z)(function*(D,T){try{const R=yield Ar(D.firebaseDependencies,T),V=Object.assign(Object.assign({},T),{token:R,createTime:Date.now()});return yield $n(D.firebaseDependencies,V),R}catch(R){throw yield Te(D),R}})).apply(this,arguments)}function ao(D,T){return Vs.apply(this,arguments)}function Vs(){return(Vs=(0,k.Z)(function*(D,T){const V={token:yield $i(D,T),createTime:Date.now(),subscriptionOptions:T};return yield $n(D,V),V.token})).apply(this,arguments)}function $r(D,T){return cs.apply(this,arguments)}function cs(){return(cs=(0,k.Z)(function*(D,T){return(yield D.pushManager.getSubscription())||D.pushManager.subscribe({userVisibleOnly:!0,applicationServerKey:Cl(T)})})).apply(this,arguments)}function wu(D,T){return T.vapidKey===D.vapidKey&&T.endpoint===D.endpoint&&T.auth===D.auth&&T.p256dh===D.p256dh}function Iu(D){const T={from:D.from,collapseKey:D.collapse_key,messageId:D.fcmMessageId};return function Cu(D,T){if(!T.notification)return;D.notification={};const R=T.notification.title;R&&(D.notification.title=R);const V=T.notification.body;V&&(D.notification.body=V);const z=T.notification.image;z&&(D.notification.image=z)}(T,D),function Wo(D,T){!T.data||(D.data=T.data)}(T,D),function Ra(D,T){if(!T.fcmOptions)return;D.fcmOptions={};const R=T.fcmOptions.link;R&&(D.fcmOptions.link=R);const V=T.fcmOptions.analytics_label;V&&(D.fcmOptions.analyticsLabel=V)}(T,D),T}function qn(D){return"object"==typeof D&&!!D&&oo in D}function Ti(D,T){const R=[];for(let V=0;V<D.length;V++)R.push(D.charAt(V)),V<T.length&&R.push(T.charAt(V));return R.join("")}function ds(D){return Wn.create("missing-app-config-values",{valueName:D})}Ti("hts/frbslgigp.ogepscmv/ieo/eaylg","tp:/ieaeogn-agolai.o/1frlglgc/o"),Ti("AzSCbw63g1R0nCw85jG8","Iaya3yLKwmgvh7cF0q4");class Ai{constructor(T,R,V){this.deliveryMetricsExportedToBigQueryEnabled=!1,this.onBackgroundMessageHandler=null,this.onMessageHandler=null,this.logEvents=[],this.isLogServiceStarted=!1;const z=function Du(D){if(!D||!D.options)throw ds("App Configuration Object");if(!D.name)throw ds("App Name");const T=["projectId","apiKey","appId","messagingSenderId"],{options:R}=D;for(const V of T)if(!R[V])throw ds(V);return{appName:D.name,projectId:R.projectId,apiKey:R.apiKey,appId:R.appId,senderId:R.messagingSenderId}}(T);this.firebaseDependencies={app:T,appConfig:z,installations:R,analyticsProvider:V}}_delete(){return Promise.resolve()}}function Jc(D){return qo.apply(this,arguments)}function qo(){return(qo=(0,k.Z)(function*(D){try{D.swRegistration=yield navigator.serviceWorker.register(qc,{scope:so}),D.swRegistration.update().catch(()=>{})}catch(T){throw Wn.create("failed-service-worker-registration",{browserErrorMessage:T.message})}})).apply(this,arguments)}function bu(D,T){return Pa.apply(this,arguments)}function Pa(){return(Pa=(0,k.Z)(function*(D,T){if(!T&&!D.swRegistration&&(yield Jc(D)),T||!D.swRegistration){if(!(T instanceof ServiceWorkerRegistration))throw Wn.create("invalid-sw-registration");D.swRegistration=T}})).apply(this,arguments)}function zo(D,T){return Oa.apply(this,arguments)}function Oa(){return(Oa=(0,k.Z)(function*(D,T){T?D.vapidKey=T:D.vapidKey||(D.vapidKey=_u)})).apply(this,arguments)}function Fa(){return(Fa=(0,k.Z)(function*(D,T){if(!navigator)throw Wn.create("only-available-in-window");if("default"===Notification.permission&&(yield Notification.requestPermission()),"granted"!==Notification.permission)throw Wn.create("permission-blocked");return yield zo(D,null==T?void 0:T.vapidKey),yield bu(D,null==T?void 0:T.serviceWorkerRegistration),bl(D)})).apply(this,arguments)}function Tl(D,T,R){return Al.apply(this,arguments)}function Al(){return(Al=(0,k.Z)(function*(D,T,R){const V=Ko(T);(yield D.firebaseDependencies.analyticsProvider.get()).logEvent(V,{message_id:R[oo],message_name:R[Aa],message_time:R[ks],message_device_time:Math.floor(Date.now()/1e3)})})).apply(this,arguments)}function Ko(D){switch(D){case yr.NOTIFICATION_CLICKED:return"notification_open";case yr.PUSH_RECEIVED:return"notification_foreground";default:throw new Error}}function La(){return(La=(0,k.Z)(function*(D,T){const R=T.data;if(!R.isFirebaseMessaging)return;D.onMessageHandler&&R.messageType===yr.PUSH_RECEIVED&&("function"==typeof D.onMessageHandler?D.onMessageHandler(Iu(R)):D.onMessageHandler.next(Iu(R)));const V=R.data;qn(V)&&"1"===V[Sa]&&(yield Tl(D,R.messageType,V))})).apply(this,arguments)}const Sl="@firebase/messaging",Tu=D=>{const T=new Ai(D.getProvider("app").getImmediate(),D.getProvider("installations-internal").getImmediate(),D.getProvider("analytics-internal"));return navigator.serviceWorker.addEventListener("message",R=>function Xc(D,T){return La.apply(this,arguments)}(T,R)),T},ed=D=>{const T=D.getProvider("messaging").getImmediate();return{getToken:V=>function ka(D,T){return Fa.apply(this,arguments)}(T,V)}};function er(){return Nn.apply(this,arguments)}function Nn(){return(Nn=(0,k.Z)(function*(){try{yield(0,ie.eu)()}catch(D){return!1}return"undefined"!=typeof window&&(0,ie.hl)()&&(0,ie.zI)()&&"serviceWorker"in navigator&&"PushManager"in window&&"Notification"in window&&"fetch"in window&&ServiceWorkerRegistration.prototype.hasOwnProperty("showNotification")&&PushSubscription.prototype.hasOwnProperty("getKey")})).apply(this,arguments)}!function tg(){(0,le._registerComponent)(new ge.wA("messaging",Tu,"PUBLIC")),(0,le._registerComponent)(new ge.wA("messaging-internal",ed,"PRIVATE")),(0,le.registerVersion)(Sl,"0.9.8"),(0,le.registerVersion)(Sl,"0.9.8","esm2017")}();const Bs="analytics",Au="firebase_id",nd="https://firebase.googleapis.com/v1alpha/projects/-/apps/{app-id}/webConfig",hs="https://www.googletagmanager.com/gtag/js",yn=new oe.Yd("@firebase/analytics");function Hh(D){return Promise.all(D.map(T=>T.catch(R=>R)))}function ng(D,T){const R=document.createElement("script");R.src=`${hs}?l=${D}&id=${T}`,R.async=!0,document.head.appendChild(R)}function xu(D,T,R,V,z,ne){return rd.apply(this,arguments)}function rd(){return(rd=(0,k.Z)(function*(D,T,R,V,z,ne){const De=V[z];try{if(De)yield T[De];else{const ke=(yield Hh(R)).find(at=>at.measurementId===z);ke&&(yield T[ke.appId])}}catch($e){yn.error($e)}D("config",z,ne)})).apply(this,arguments)}function ja(D,T,R,V,z){return id.apply(this,arguments)}function id(){return(id=(0,k.Z)(function*(D,T,R,V,z){try{let ne=[];if(z&&z.send_to){let De=z.send_to;Array.isArray(De)||(De=[De]);const $e=yield Hh(R);for(const ke of De){const at=$e.find(ln=>ln.measurementId===ke),Ft=at&&T[at.appId];if(!Ft){ne=[];break}ne.push(Ft)}}0===ne.length&&(ne=Object.values(T)),yield Promise.all(ne),D("event",V,z||{})}catch(ne){yn.error(ne)}})).apply(this,arguments)}function Wi(){const D=window.document.getElementsByTagName("script");for(const T of Object.values(D))if(T.src&&T.src.includes(hs))return T;return null}const cr=new ie.LL("analytics","Analytics",{"already-exists":"A Firebase Analytics instance with the appId {$id}  already exists. Only one Firebase Analytics instance can be created for each appId.","already-initialized":"initializeAnalytics() cannot be called again with different options than those it was initially called with. It can be called again with the same options to return the existing instance, or getAnalytics() can be used to get a reference to the already-intialized instance.","already-initialized-settings":"Firebase Analytics has already been initialized.settings() must be called before initializing any Analytics instanceor it will have no effect.","interop-component-reg-failed":"Firebase Analytics Interop Component failed to instantiate: {$reason}","invalid-analytics-context":"Firebase Analytics is not supported in this environment. Wrap initialization of analytics in analytics.isSupported() to prevent initialization in unsupported environments. Details: {$errorInfo}","indexeddb-unavailable":"IndexedDB unavailable or restricted in this environment. Wrap initialization of analytics in analytics.isSupported() to prevent initialization in unsupported environments. Details: {$errorInfo}","fetch-throttle":"The config fetch request timed out while in an exponential backoff state. Unix timestamp in milliseconds when fetch request throttling ends: {$throttleEndTimeMillis}.","config-fetch-failed":"Dynamic config fetch failed: [{$httpStatus}] {$responseMessage}","no-api-key":'The "apiKey" field is empty in the local Firebase config. Firebase Analytics requires this field tocontain a valid API key.',"no-app-id":'The "appId" field is empty in the local Firebase config. Firebase Analytics requires this field tocontain a valid app ID.'}),Wh=new class Ha{constructor(T={},R=1e3){this.throttleMetadata=T,this.intervalMillis=R}getThrottleMetadata(T){return this.throttleMetadata[T]}setThrottleMetadata(T,R){this.throttleMetadata[T]=R}deleteThrottleMetadata(T){delete this.throttleMetadata[T]}};function Ga(D){return new Headers({Accept:"application/json","x-goog-api-key":D})}function Mu(D){return fs.apply(this,arguments)}function fs(){return(fs=(0,k.Z)(function*(D){var T;const{appId:R,apiKey:V}=D,z={method:"GET",headers:Ga(V)},ne=nd.replace("{app-id}",R),De=yield fetch(ne,z);if(200!==De.status&&304!==De.status){let $e="";try{const ke=yield De.json();(null===(T=ke.error)||void 0===T?void 0:T.message)&&($e=ke.error.message)}catch(ke){}throw cr.create("config-fetch-failed",{httpStatus:De.status,responseMessage:$e})}return De.json()})).apply(this,arguments)}function Wr(D){return Ht.apply(this,arguments)}function Ht(){return(Ht=(0,k.Z)(function*(D,T=Wh,R){const{appId:V,apiKey:z,measurementId:ne}=D.options;if(!V)throw cr.create("no-app-id");if(!z){if(ne)return{measurementId:ne,appId:V};throw cr.create("no-api-key")}const De=T.getThrottleMetadata(V)||{backoffCount:0,throttleEndTimeMillis:Date.now()},$e=new Pl;return setTimeout((0,k.Z)(function*(){$e.abort()}),void 0!==R?R:6e4),$a({appId:V,apiKey:z,measurementId:ne},De,$e,T)})).apply(this,arguments)}function $a(D,T,R){return Rl.apply(this,arguments)}function Rl(){return(Rl=(0,k.Z)(function*(D,{throttleEndTimeMillis:T,backoffCount:R},V,z=Wh){const{appId:ne,measurementId:De}=D;try{yield qh(V,T)}catch($e){if(De)return yn.warn(`Timed out fetching this Firebase app's measurement ID from the server. Falling back to the measurement ID ${De} provided in the "measurementId" field in the local Firebase config. [${$e.message}]`),{appId:ne,measurementId:De};throw $e}try{const $e=yield Mu(D);return z.deleteThrottleMetadata(ne),$e}catch($e){if(!Wa($e)){if(z.deleteThrottleMetadata(ne),De)return yn.warn(`Failed to fetch this Firebase app's measurement ID from the server. Falling back to the measurement ID ${De} provided in the "measurementId" field in the local Firebase config. [${$e.message}]`),{appId:ne,measurementId:De};throw $e}const ke=503===Number($e.customData.httpStatus)?(0,ie.$s)(R,z.intervalMillis,30):(0,ie.$s)(R,z.intervalMillis),at={throttleEndTimeMillis:Date.now()+ke,backoffCount:R+1};return z.setThrottleMetadata(ne,at),yn.debug(`Calling attemptFetch again in ${ke} millis`),$a(D,at,V,z)}})).apply(this,arguments)}function qh(D,T){return new Promise((R,V)=>{const z=Math.max(T-Date.now(),0),ne=setTimeout(R,z);D.addEventListener(()=>{clearTimeout(ne),V(cr.create("fetch-throttle",{throttleEndTimeMillis:T}))})})}function Wa(D){if(!(D instanceof ie.ZR&&D.customData))return!1;const T=Number(D.customData.httpStatus);return 429===T||500===T||503===T||504===T}class Pl{constructor(){this.listeners=[]}addEventListener(T){this.listeners.push(T)}abort(){this.listeners.forEach(T=>T())}}function Zo(){return Sr.apply(this,arguments)}function Sr(){return(Sr=(0,k.Z)(function*(){if(!(0,ie.hl)())return yn.warn(cr.create("indexeddb-unavailable",{errorInfo:"IndexedDB is not available in this environment."}).message),!1;try{yield(0,ie.eu)()}catch(D){return yn.warn(cr.create("indexeddb-unavailable",{errorInfo:D}).message),!1}return!0})).apply(this,arguments)}function Yo(){return(Yo=(0,k.Z)(function*(D,T,R,V,z,ne,De){var $e;const ke=Wr(D);ke.then(In=>{R[In.measurementId]=In.appId,D.options.measurementId&&In.measurementId!==D.options.measurementId&&yn.warn(`The measurement ID in the local Firebase config (${D.options.measurementId}) does not match the measurement ID fetched from the server (${In.measurementId}). To ensure analytics events are always sent to the correct Analytics property, update the measurement ID field in the local config or remove it from the local config.`)}).catch(In=>yn.error(In)),T.push(ke);const at=Zo().then(In=>{if(In)return V.getId()}),[Ft,ln]=yield Promise.all([ke,at]);Wi()||ng(ne,Ft.measurementId),z("js",new Date);const dr=null!==($e=null==De?void 0:De.config)&&void 0!==$e?$e:{};return dr.origin="firebase",dr.update=!0,null!=ln&&(dr[Au]=ln),z("config",Ft.measurementId,dr),Ft.measurementId})).apply(this,arguments)}class Nu{constructor(T){this.app=T}_delete(){return delete qi[this.app.options.appId],Promise.resolve()}}let qi={},Ol=[];const kl={};let qa,Vt,Qo="dataLayer",zi=!1;function lo(D,T,R){!function za(){const D=[];if((0,ie.ru)()&&D.push("This is a browser extension environment."),(0,ie.zI)()||D.push("Cookies are not available."),D.length>0){const T=D.map((V,z)=>`(${z+1}) ${V}`).join(" "),R=cr.create("invalid-analytics-context",{errorInfo:T});yn.warn(R.message)}}();const V=D.options.appId;if(!V)throw cr.create("no-app-id");if(!D.options.apiKey){if(!D.options.measurementId)throw cr.create("no-api-key");yn.warn(`The "apiKey" field is empty in the local Firebase config. This is needed to fetch the latest measurement ID for this Firebase app. Falling back to the measurement ID ${D.options.measurementId} provided in the "measurementId" field in the local Firebase config.`)}if(null!=qi[V])throw cr.create("already-exists",{id:V});if(!zi){!function Ua(D){let T=[];Array.isArray(window[D])?T=window[D]:window[D]=T}(Qo);const{wrappedGtag:ne,gtagCore:De}=function Nl(D,T,R,V,z){let ne=function(...De){window[V].push(arguments)};return window[z]&&"function"==typeof window[z]&&(ne=window[z]),window[z]=function rg(D,T,R,V){function ne(){return(ne=(0,k.Z)(function*(De,$e,ke){try{"event"===De?yield ja(D,T,R,$e,ke):"config"===De?yield xu(D,T,R,V,$e,ke):D("set",$e)}catch(at){yn.error(at)}})).apply(this,arguments)}return function z(De,$e,ke){return ne.apply(this,arguments)}}(ne,D,T,R),{gtagCore:ne,wrappedGtag:window[z]}}(qi,Ol,kl,Qo,"gtag");Vt=ne,qa=De,zi=!0}return qi[V]=function qr(D,T,R,V,z,ne,De){return Yo.apply(this,arguments)}(D,Ol,kl,T,qa,Qo,R),new Nu(D)}function Jo(){return(Jo=(0,k.Z)(function*(D,T,R,V,z){if(z&&z.global)D("event",R,V);else{const ne=yield T;D("event",R,Object.assign(Object.assign({},V),{send_to:ne}))}})).apply(this,arguments)}function Ll(){return Vl.apply(this,arguments)}function Vl(){return(Vl=(0,k.Z)(function*(){if((0,ie.ru)()||!(0,ie.zI)()||!(0,ie.hl)())return!1;try{return yield(0,ie.eu)()}catch(D){return!1}})).apply(this,arguments)}const Us="@firebase/analytics";!function wn(){(0,le._registerComponent)(new ge.wA(Bs,(T,{options:R})=>lo(T.getProvider("app").getImmediate(),T.getProvider("installations-internal").getImmediate(),R),"PUBLIC")),(0,le._registerComponent)(new ge.wA("analytics-internal",function D(T){try{const R=T.getProvider(Bs).getImmediate();return{logEvent:(V,z,ne)=>function Bl(D,T,R,V){D=(0,ie.m9)(D),function En(D,T,R,V,z){return Jo.apply(this,arguments)}(Vt,qi[D.app.options.appId],T,R,V).catch(z=>yn.error(z))}(R,V,z,ne)}}catch(R){throw cr.create("interop-component-reg-failed",{reason:R})}},"PRIVATE")),(0,le.registerVersion)(Us,"0.7.5"),(0,le.registerVersion)(Us,"0.7.5","esm2017")}();var Ka=L(4408),Zh=L(7565);const Rn=new class cd extends Zh.v{}(class Si extends Ka.o{constructor(T,R){super(T,R),this.scheduler=T,this.work=R}schedule(T,R=0){return R>0?super.schedule(T,R):(this.delay=R,this.state=T,this.scheduler.flush(this),this)}execute(T,R){return R>0||this.closed?super.execute(T,R):this._execute(T,R)}requestAsyncId(T,R,V=0){return null!=V&&V>0||null==V&&this.delay>0?super.requestAsyncId(T,R,V):T.flush(this)}});var Ul=L(4986),Ru=L(576),Za=L(4482),jl=L(5403),Yh=L(4671),Hl=L(9468),ig=L(5363);const Pu=new _.GfV("7.2.1"),tr="__angularfire_symbol__analyticsIsSupportedValue",Ou="__angularfire_symbol__analyticsIsSupported",ho="__angularfire_symbol__remoteConfigIsSupportedValue",Qh="__angularfire_symbol__remoteConfigIsSupported",Gl="__angularfire_symbol__messagingIsSupportedValue",dd="__angularfire_symbol__messagingIsSupported";function ku(D,T,R){if(T){if(1===T.length)return T[0];const ne=T.filter(De=>De.app===R);if(1===ne.length)return ne[0]}return R.container.getProvider(D).getImmediate({optional:!0})}globalThis[Ou]||(globalThis[Ou]=Ll().then(D=>globalThis[tr]=D).catch(()=>globalThis[tr]=!1)),globalThis[dd]||(globalThis[dd]=er().then(D=>globalThis[Gl]=D).catch(()=>globalThis[Gl]=!1)),globalThis[Qh]||(globalThis[Qh]=Wc().then(D=>globalThis[ho]=D).catch(()=>globalThis[ho]=!1));const Wl=(D,T)=>{const R=T?[T]:(0,J.C6)(),V=[];return R.forEach(z=>{z.container.getProvider(D).instances.forEach(De=>{V.includes(De)||V.push(De)})}),V};function xr(){}class Ya{constructor(T,R=Rn){this.zone=T,this.delegate=R}now(){return this.delegate.now()}schedule(T,R,V){const z=this.zone;return this.delegate.schedule(function(De){z.runGuarded(()=>{T.apply(this,[De])})},R,V)}}class Zi{constructor(T){this.zone=T,this.task=null}call(T,R){const V=this.unscheduleTask.bind(this);return this.task=this.zone.run(()=>Zone.current.scheduleMacroTask("firebaseZoneBlock",xr,{},xr,xr)),R.pipe(function ta(D,T,R){const V=(0,Ru.m)(D)||T||R?{next:D,error:T,complete:R}:D;return V?(0,Za.e)((z,ne)=>{var De;null===(De=V.subscribe)||void 0===De||De.call(V);let $e=!0;z.subscribe(new jl.Q(ne,ke=>{var at;null===(at=V.next)||void 0===at||at.call(V,ke),ne.next(ke)},()=>{var ke;$e=!1,null===(ke=V.complete)||void 0===ke||ke.call(V),ne.complete()},ke=>{var at;$e=!1,null===(at=V.error)||void 0===at||at.call(V,ke),ne.error(ke)},()=>{var ke,at;$e&&(null===(ke=V.unsubscribe)||void 0===ke||ke.call(V)),null===(at=V.finalize)||void 0===at||at.call(V)}))}):Yh.y}({next:V,complete:V,error:V})).subscribe(T).add(V)}unscheduleTask(){setTimeout(()=>{null!=this.task&&"scheduled"===this.task.state&&(this.task.invoke(),this.task=null)},10)}}let na=(()=>{class D{constructor(R){this.ngZone=R,this.outsideAngular=R.runOutsideAngular(()=>new Ya(Zone.current)),this.insideAngular=R.run(()=>new Ya(Zone.current,Ul.z)),globalThis.\u0275AngularFireScheduler||(globalThis.\u0275AngularFireScheduler=this)}}return D.\u0275fac=function(R){return new(R||D)(_.LFG(_.R0b))},D.\u0275prov=_.Yz7({token:D,factory:D.\u0275fac,providedIn:"root"}),D})();function ti(){const D=globalThis.\u0275AngularFireScheduler;if(!D)throw new Error("Either AngularFireModule has not been provided in your AppModule (this can be done manually or implictly using\nprovideFirebaseApp) or you're calling an AngularFire method outside of an NgModule (which is not supported).");return D}function fo(D){return ti(),function xi(D){return function(R){return(R=R.lift(new Zi(D.ngZone))).pipe((0,Hl.R)(D.outsideAngular),(0,ig.Q)(D.insideAngular))}}(ti())(D)}},2090:(it,be,L)=>{"use strict";L.d(be,{BH:()=>Ge,LL:()=>ce,ZR:()=>Re,gQ:()=>Ae,zI:()=>ae,hu:()=>J,g5:()=>k,US:()=>ge,tV:()=>ye,h$:()=>oe,$s:()=>ct,r3:()=>yi,Sg:()=>Ne,ne:()=>ur,p$:()=>$,vZ:()=>kt,ZB:()=>H,gK:()=>lt,pd:()=>os,m9:()=>as,z$:()=>Fe,GJ:()=>$t,jU:()=>re,ru:()=>he,d:()=>me,xb:()=>Dn,w1:()=>Ue,hl:()=>pt,uI:()=>Be,UG:()=>K,Yr:()=>rt,b$:()=>we,G6:()=>Ke,Mn:()=>Ce,w9:()=>mr,cI:()=>Ln,UI:()=>vi,xO:()=>Xs,zd:()=>Ur,DV:()=>Vi,ug:()=>bt,dS:()=>Ir,Pz:()=>st,Dv:()=>Rs,Wj:()=>Dt,lb:()=>sn,eu:()=>Q});const J=function(B,G){if(!B)throw k(G)},k=function(B){return new Error("Firebase Database (${JSCORE_VERSION}) INTERNAL ASSERT FAILED: "+B)},le=function(B){const G=[];let q=0;for(let ve=0;ve<B.length;ve++){let ee=B.charCodeAt(ve);ee<128?G[q++]=ee:ee<2048?(G[q++]=ee>>6|192,G[q++]=63&ee|128):55296==(64512&ee)&&ve+1<B.length&&56320==(64512&B.charCodeAt(ve+1))?(ee=65536+((1023&ee)<<10)+(1023&B.charCodeAt(++ve)),G[q++]=ee>>18|240,G[q++]=ee>>12&63|128,G[q++]=ee>>6&63|128,G[q++]=63&ee|128):(G[q++]=ee>>12|224,G[q++]=ee>>6&63|128,G[q++]=63&ee|128)}return G},ge={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:"function"==typeof atob,encodeByteArray(B,G){if(!Array.isArray(B))throw Error("encodeByteArray takes an array as a parameter");this.init_();const q=G?this.byteToCharMapWebSafe_:this.byteToCharMap_,ve=[];for(let ee=0;ee<B.length;ee+=3){const je=B[ee],gt=ee+1<B.length,on=gt?B[ee+1]:0,Bn=ee+2<B.length,bn=Bn?B[ee+2]:0;let lr=(15&on)<<2|bn>>6,Ps=63&bn;Bn||(Ps=64,gt||(lr=64)),ve.push(q[je>>2],q[(3&je)<<4|on>>4],q[lr],q[Ps])}return ve.join("")},encodeString(B,G){return this.HAS_NATIVE_SUPPORT&&!G?btoa(B):this.encodeByteArray(le(B),G)},decodeString(B,G){return this.HAS_NATIVE_SUPPORT&&!G?atob(B):function(B){const G=[];let q=0,ve=0;for(;q<B.length;){const ee=B[q++];if(ee<128)G[ve++]=String.fromCharCode(ee);else if(ee>191&&ee<224){const je=B[q++];G[ve++]=String.fromCharCode((31&ee)<<6|63&je)}else if(ee>239&&ee<365){const Bn=((7&ee)<<18|(63&B[q++])<<12|(63&B[q++])<<6|63&B[q++])-65536;G[ve++]=String.fromCharCode(55296+(Bn>>10)),G[ve++]=String.fromCharCode(56320+(1023&Bn))}else{const je=B[q++],gt=B[q++];G[ve++]=String.fromCharCode((15&ee)<<12|(63&je)<<6|63&gt)}}return G.join("")}(this.decodeStringToByteArray(B,G))},decodeStringToByteArray(B,G){this.init_();const q=G?this.charToByteMapWebSafe_:this.charToByteMap_,ve=[];for(let ee=0;ee<B.length;){const je=q[B.charAt(ee++)],on=ee<B.length?q[B.charAt(ee)]:0;++ee;const bn=ee<B.length?q[B.charAt(ee)]:64;++ee;const xt=ee<B.length?q[B.charAt(ee)]:64;if(++ee,null==je||null==on||null==bn||null==xt)throw Error();ve.push(je<<2|on>>4),64!==bn&&(ve.push(on<<4&240|bn>>2),64!==xt&&ve.push(bn<<6&192|xt))}return ve},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let B=0;B<this.ENCODED_VALS.length;B++)this.byteToCharMap_[B]=this.ENCODED_VALS.charAt(B),this.charToByteMap_[this.byteToCharMap_[B]]=B,this.byteToCharMapWebSafe_[B]=this.ENCODED_VALS_WEBSAFE.charAt(B),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[B]]=B,B>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(B)]=B,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(B)]=B)}}},oe=function(B){const G=le(B);return ge.encodeByteArray(G,!0)},de=function(B){return oe(B).replace(/\./g,"")},ye=function(B){try{return ge.decodeString(B,!0)}catch(G){console.error("base64Decode failed: ",G)}return null};function $(B){return H(void 0,B)}function H(B,G){if(!(G instanceof Object))return G;switch(G.constructor){case Date:return new Date(G.getTime());case Object:void 0===B&&(B={});break;case Array:B=[];break;default:return G}for(const q in G)!G.hasOwnProperty(q)||!X(q)||(B[q]=H(B[q],G[q]));return B}function X(B){return"__proto__"!==B}class Ge{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise((G,q)=>{this.resolve=G,this.reject=q})}wrapCallback(G){return(q,ve)=>{q?this.reject(q):this.resolve(ve),"function"==typeof G&&(this.promise.catch(()=>{}),1===G.length?G(q):G(q,ve))}}}function Ne(B,G){if(B.uid)throw new Error('The "uid" field is no longer supported by mockUserToken. Please use "sub" instead for Firebase Auth User ID.');const ve=G||"demo-project",ee=B.iat||0,je=B.sub||B.user_id;if(!je)throw new Error("mockUserToken must contain 'sub' or 'user_id' field!");const gt=Object.assign({iss:`https://securetoken.google.com/${ve}`,aud:ve,iat:ee,exp:ee+3600,auth_time:ee,sub:je,user_id:je,firebase:{sign_in_provider:"custom",identities:{}}},B);return[de(JSON.stringify({alg:"none",type:"JWT"})),de(JSON.stringify(gt)),""].join(".")}function Fe(){return"undefined"!=typeof navigator&&"string"==typeof navigator.userAgent?navigator.userAgent:""}function Be(){return"undefined"!=typeof window&&!!(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(Fe())}function K(){try{return"[object process]"===Object.prototype.toString.call(global.process)}catch(B){return!1}}function re(){return"object"==typeof self&&self.self===self}function he(){const B="object"==typeof chrome?chrome.runtime:"object"==typeof browser?browser.runtime:void 0;return"object"==typeof B&&void 0!==B.id}function we(){return"object"==typeof navigator&&"ReactNative"===navigator.product}function me(){return Fe().indexOf("Electron/")>=0}function Ue(){const B=Fe();return B.indexOf("MSIE ")>=0||B.indexOf("Trident/")>=0}function Ce(){return Fe().indexOf("MSAppHost/")>=0}function rt(){return!1}function Ke(){return!K()&&navigator.userAgent.includes("Safari")&&!navigator.userAgent.includes("Chrome")}function pt(){return"object"==typeof indexedDB}function Q(){return new Promise((B,G)=>{try{let q=!0;const ve="validate-browser-context-for-indexeddb-analytics-module",ee=self.indexedDB.open(ve);ee.onsuccess=()=>{ee.result.close(),q||self.indexedDB.deleteDatabase(ve),B(!0)},ee.onupgradeneeded=()=>{q=!1},ee.onerror=()=>{var je;G((null===(je=ee.error)||void 0===je?void 0:je.message)||"")}}catch(q){G(q)}})}function ae(){return!("undefined"==typeof navigator||!navigator.cookieEnabled)}class Re extends Error{constructor(G,q,ve){super(q),this.code=G,this.customData=ve,this.name="FirebaseError",Object.setPrototypeOf(this,Re.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,ce.prototype.create)}}class ce{constructor(G,q,ve){this.service=G,this.serviceName=q,this.errors=ve}create(G,...q){const ve=q[0]||{},ee=`${this.service}/${G}`,je=this.errors[G],gt=je?function Ct(B,G){return B.replace(Ot,(q,ve)=>{const ee=G[ve];return null!=ee?String(ee):`<${ve}?>`})}(je,ve):"Error";return new Re(ee,`${this.serviceName}: ${gt} (${ee}).`,ve)}}const Ot=/\{\$([^}]+)}/g;function Ln(B){return JSON.parse(B)}function st(B){return JSON.stringify(B)}const nt=function(B){let G={},q={},ve={},ee="";try{const je=B.split(".");G=Ln(ye(je[0])||""),q=Ln(ye(je[1])||""),ee=je[2],ve=q.d||{},delete q.d}catch(je){}return{header:G,claims:q,data:ve,signature:ee}},mr=function(B){const q=nt(B).claims;return!!q&&"object"==typeof q&&q.hasOwnProperty("iat")},$t=function(B){const G=nt(B).claims;return"object"==typeof G&&!0===G.admin};function yi(B,G){return Object.prototype.hasOwnProperty.call(B,G)}function Vi(B,G){if(Object.prototype.hasOwnProperty.call(B,G))return B[G]}function Dn(B){for(const G in B)if(Object.prototype.hasOwnProperty.call(B,G))return!1;return!0}function vi(B,G,q){const ve={};for(const ee in B)Object.prototype.hasOwnProperty.call(B,ee)&&(ve[ee]=G.call(q,B[ee],ee,B));return ve}function kt(B,G){if(B===G)return!0;const q=Object.keys(B),ve=Object.keys(G);for(const ee of q){if(!ve.includes(ee))return!1;const je=B[ee],gt=G[ee];if(gn(je)&&gn(gt)){if(!kt(je,gt))return!1}else if(je!==gt)return!1}for(const ee of ve)if(!q.includes(ee))return!1;return!0}function gn(B){return null!==B&&"object"==typeof B}function Xs(B){const G=[];for(const[q,ve]of Object.entries(B))Array.isArray(ve)?ve.forEach(ee=>{G.push(encodeURIComponent(q)+"="+encodeURIComponent(ee))}):G.push(encodeURIComponent(q)+"="+encodeURIComponent(ve));return G.length?"&"+G.join("&"):""}function Ur(B){const G={};return B.replace(/^\?/,"").split("&").forEach(ve=>{if(ve){const[ee,je]=ve.split("=");G[decodeURIComponent(ee)]=decodeURIComponent(je)}}),G}function os(B){const G=B.indexOf("?");if(!G)return"";const q=B.indexOf("#",G);return B.substring(G,q>0?q:void 0)}class Ae{constructor(){this.chain_=[],this.buf_=[],this.W_=[],this.pad_=[],this.inbuf_=0,this.total_=0,this.blockSize=64,this.pad_[0]=128;for(let G=1;G<this.blockSize;++G)this.pad_[G]=0;this.reset()}reset(){this.chain_[0]=1732584193,this.chain_[1]=4023233417,this.chain_[2]=2562383102,this.chain_[3]=271733878,this.chain_[4]=3285377520,this.inbuf_=0,this.total_=0}compress_(G,q){q||(q=0);const ve=this.W_;if("string"==typeof G)for(let xt=0;xt<16;xt++)ve[xt]=G.charCodeAt(q)<<24|G.charCodeAt(q+1)<<16|G.charCodeAt(q+2)<<8|G.charCodeAt(q+3),q+=4;else for(let xt=0;xt<16;xt++)ve[xt]=G[q]<<24|G[q+1]<<16|G[q+2]<<8|G[q+3],q+=4;for(let xt=16;xt<80;xt++){const lr=ve[xt-3]^ve[xt-8]^ve[xt-14]^ve[xt-16];ve[xt]=4294967295&(lr<<1|lr>>>31)}let bn,Dr,ee=this.chain_[0],je=this.chain_[1],gt=this.chain_[2],on=this.chain_[3],Bn=this.chain_[4];for(let xt=0;xt<80;xt++){xt<40?xt<20?(bn=on^je&(gt^on),Dr=1518500249):(bn=je^gt^on,Dr=1859775393):xt<60?(bn=je&gt|on&(je|gt),Dr=2400959708):(bn=je^gt^on,Dr=3395469782);const lr=(ee<<5|ee>>>27)+bn+Bn+Dr+ve[xt]&4294967295;Bn=on,on=gt,gt=4294967295&(je<<30|je>>>2),je=ee,ee=lr}this.chain_[0]=this.chain_[0]+ee&4294967295,this.chain_[1]=this.chain_[1]+je&4294967295,this.chain_[2]=this.chain_[2]+gt&4294967295,this.chain_[3]=this.chain_[3]+on&4294967295,this.chain_[4]=this.chain_[4]+Bn&4294967295}update(G,q){if(null==G)return;void 0===q&&(q=G.length);const ve=q-this.blockSize;let ee=0;const je=this.buf_;let gt=this.inbuf_;for(;ee<q;){if(0===gt)for(;ee<=ve;)this.compress_(G,ee),ee+=this.blockSize;if("string"==typeof G){for(;ee<q;)if(je[gt]=G.charCodeAt(ee),++gt,++ee,gt===this.blockSize){this.compress_(je),gt=0;break}}else for(;ee<q;)if(je[gt]=G[ee],++gt,++ee,gt===this.blockSize){this.compress_(je),gt=0;break}}this.inbuf_=gt,this.total_+=q}digest(){const G=[];let q=8*this.total_;this.update(this.pad_,this.inbuf_<56?56-this.inbuf_:this.blockSize-(this.inbuf_-56));for(let ee=this.blockSize-1;ee>=56;ee--)this.buf_[ee]=255&q,q/=256;this.compress_(this.buf_);let ve=0;for(let ee=0;ee<5;ee++)for(let je=24;je>=0;je-=8)G[ve]=this.chain_[ee]>>je&255,++ve;return G}}function ur(B,G){const q=new et(B,G);return q.subscribe.bind(q)}class et{constructor(G,q){this.observers=[],this.unsubscribes=[],this.observerCount=0,this.task=Promise.resolve(),this.finalized=!1,this.onNoObservers=q,this.task.then(()=>{G(this)}).catch(ve=>{this.error(ve)})}next(G){this.forEachObserver(q=>{q.next(G)})}error(G){this.forEachObserver(q=>{q.error(G)}),this.close(G)}complete(){this.forEachObserver(G=>{G.complete()}),this.close()}subscribe(G,q,ve){let ee;if(void 0===G&&void 0===q&&void 0===ve)throw new Error("Missing Observer.");ee=function Ut(B,G){if("object"!=typeof B||null===B)return!1;for(const q of G)if(q in B&&"function"==typeof B[q])return!0;return!1}(G,["next","error","complete"])?G:{next:G,error:q,complete:ve},void 0===ee.next&&(ee.next=Vn),void 0===ee.error&&(ee.error=Vn),void 0===ee.complete&&(ee.complete=Vn);const je=this.unsubscribeOne.bind(this,this.observers.length);return this.finalized&&this.task.then(()=>{try{this.finalError?ee.error(this.finalError):ee.complete()}catch(gt){}}),this.observers.push(ee),je}unsubscribeOne(G){void 0===this.observers||void 0===this.observers[G]||(delete this.observers[G],this.observerCount-=1,0===this.observerCount&&void 0!==this.onNoObservers&&this.onNoObservers(this))}forEachObserver(G){if(!this.finalized)for(let q=0;q<this.observers.length;q++)this.sendOne(q,G)}sendOne(G,q){this.task.then(()=>{if(void 0!==this.observers&&void 0!==this.observers[G])try{q(this.observers[G])}catch(ve){"undefined"!=typeof console&&console.error&&console.error(ve)}})}close(G){this.finalized||(this.finalized=!0,void 0!==G&&(this.finalError=G),this.task.then(()=>{this.observers=void 0,this.onNoObservers=void 0}))}}function Vn(){}const Rs=function(B,G,q,ve){let ee;if(ve<G?ee="at least "+G:ve>q&&(ee=0===q?"none":"no more than "+q),ee)throw new Error(B+" failed: Was called with "+ve+(1===ve?" argument.":" arguments.")+" Expects "+ee+".")};function lt(B,G){return`${B} failed: ${G} argument `}function Dt(B,G,q,ve){if((!ve||q)&&"function"!=typeof q)throw new Error(lt(B,G)+"must be a valid function.")}function sn(B,G,q,ve){if((!ve||q)&&("object"!=typeof q||null===q))throw new Error(lt(B,G)+"must be a valid context object.")}const Ir=function(B){const G=[];let q=0;for(let ve=0;ve<B.length;ve++){let ee=B.charCodeAt(ve);if(ee>=55296&&ee<=56319){const je=ee-55296;ve++,J(ve<B.length,"Surrogate pair missing trail surrogate."),ee=65536+(je<<10)+(B.charCodeAt(ve)-56320)}ee<128?G[q++]=ee:ee<2048?(G[q++]=ee>>6|192,G[q++]=63&ee|128):ee<65536?(G[q++]=ee>>12|224,G[q++]=ee>>6&63|128,G[q++]=63&ee|128):(G[q++]=ee>>18|240,G[q++]=ee>>12&63|128,G[q++]=ee>>6&63|128,G[q++]=63&ee|128)}return G},bt=function(B){let G=0;for(let q=0;q<B.length;q++){const ve=B.charCodeAt(q);ve<128?G++:ve<2048?G+=2:ve>=55296&&ve<=56319?(G+=4,q++):G+=3}return G};function ct(B,G=1e3,q=2){const ve=G*Math.pow(q,B),ee=Math.round(.5*ve*(Math.random()-.5)*2);return Math.min(144e5,ve+ee)}function as(B){return B&&B._delegate?B._delegate:B}},4799:(it,be,L)=>{"use strict";var _=L(5e3);let J=null;function k(){return J}const oe=new _.OlP("DocumentToken");var ae=(()=>((ae=ae||{})[ae.Zero=0]="Zero",ae[ae.One=1]="One",ae[ae.Two=2]="Two",ae[ae.Few=3]="Few",ae[ae.Many=4]="Many",ae[ae.Other=5]="Other",ae))();const os=_.kL8;class Lt{}let An=(()=>{class n extends Lt{constructor(t){super(),this.locale=t}getPluralCategory(t,r){switch(os(r||this.locale)(t)){case ae.Zero:return"zero";case ae.One:return"one";case ae.Two:return"two";case ae.Few:return"few";case ae.Many:return"many";default:return"other"}}}return n.\u0275fac=function(t){return new(t||n)(_.LFG(_.soG))},n.\u0275prov=_.Yz7({token:n,factory:n.\u0275fac}),n})();class Ui{constructor(e,t,r,o){this.$implicit=e,this.ngForOf=t,this.index=r,this.count=o}get first(){return 0===this.index}get last(){return this.index===this.count-1}get even(){return this.index%2==0}get odd(){return!this.even}}let Gn=(()=>{class n{constructor(t,r,o){this._viewContainer=t,this._template=r,this._differs=o,this._ngForOf=null,this._ngForOfDirty=!0,this._differ=null}set ngForOf(t){this._ngForOf=t,this._ngForOfDirty=!0}set ngForTrackBy(t){this._trackByFn=t}get ngForTrackBy(){return this._trackByFn}set ngForTemplate(t){t&&(this._template=t)}ngDoCheck(){if(this._ngForOfDirty){this._ngForOfDirty=!1;const t=this._ngForOf;!this._differ&&t&&(this._differ=this._differs.find(t).create(this.ngForTrackBy))}if(this._differ){const t=this._differ.diff(this._ngForOf);t&&this._applyChanges(t)}}_applyChanges(t){const r=this._viewContainer;t.forEachOperation((o,u,c)=>{if(null==o.previousIndex)r.createEmbeddedView(this._template,new Ui(o.item,this._ngForOf,-1,-1),null===c?void 0:c);else if(null==c)r.remove(null===u?void 0:u);else if(null!==u){const g=r.get(u);r.move(g,c),Lo(g,o)}});for(let o=0,u=r.length;o<u;o++){const g=r.get(o).context;g.index=o,g.count=u,g.ngForOf=this._ngForOf}t.forEachIdentityChange(o=>{Lo(r.get(o.currentIndex),o)})}static ngTemplateContextGuard(t,r){return!0}}return n.\u0275fac=function(t){return new(t||n)(_.Y36(_.s_b),_.Y36(_.Rgc),_.Y36(_.ZZ4))},n.\u0275dir=_.lG2({type:n,selectors:[["","ngFor","","ngForOf",""]],inputs:{ngForOf:"ngForOf",ngForTrackBy:"ngForTrackBy",ngForTemplate:"ngForTemplate"}}),n})();function Lo(n,e){n.context.$implicit=e.item}let Sa=(()=>{class n{}return n.\u0275fac=function(t){return new(t||n)},n.\u0275mod=_.oAB({type:n}),n.\u0275inj=_.cJS({providers:[{provide:Lt,useClass:An}]}),n})();function xa(n){return"server"===n}class Uo extends class Lh extends class ge{}{constructor(){super(...arguments),this.supportsDOMEvents=!0}}{static makeCurrent(){!function ie(n){J||(J=n)}(new Uo)}onAndCancel(e,t,r){return e.addEventListener(t,r,!1),()=>{e.removeEventListener(t,r,!1)}}dispatchEvent(e,t){e.dispatchEvent(t)}remove(e){e.parentNode&&e.parentNode.removeChild(e)}createElement(e,t){return(t=t||this.getDefaultDocument()).createElement(e)}createHtmlDocument(){return document.implementation.createHTMLDocument("fakeTitle")}getDefaultDocument(){return document}isElementNode(e){return e.nodeType===Node.ELEMENT_NODE}isShadowRoot(e){return e instanceof DocumentFragment}getGlobalEventTarget(e,t){return"window"===t?window:"document"===t?e:"body"===t?e.body:null}getBaseHref(e){const t=function Mn(){return $n=$n||document.querySelector("base"),$n?$n.getAttribute("href"):null}();return null==t?null:function jo(n){ls=ls||document.createElement("a"),ls.setAttribute("href",n);const e=ls.pathname;return"/"===e.charAt(0)?e:`/${e}`}(t)}resetBaseElement(){$n=null}getUserAgent(){return window.navigator.userAgent}getCookie(e){return function Fo(n,e){e=encodeURIComponent(e);for(const t of n.split(";")){const r=t.indexOf("="),[o,u]=-1==r?[t,""]:[t.slice(0,r),t.slice(r+1)];if(o.trim()===e)return decodeURIComponent(u)}return null}(document.cookie,e)}}let ls,$n=null;const Gi=new _.OlP("TRANSITION_ID"),Wn=[{provide:_.ip1,useFactory:function Tr(n,e,t){return()=>{t.get(_.CZH).donePromise.then(()=>{const r=k(),o=e.querySelectorAll(`style[ng-transition="${n}"]`);for(let u=0;u<o.length;u++)r.remove(o[u])})}},deps:[Gi,oe,_.zs3],multi:!0}];class $i{static init(){(0,_.VLi)(new $i)}addToWindow(e){_.dqk.getAngularTestability=(r,o=!0)=>{const u=e.findTestabilityInTree(r,o);if(null==u)throw new Error("Could not find testability for element.");return u},_.dqk.getAllAngularTestabilities=()=>e.getAllTestabilities(),_.dqk.getAllAngularRootElements=()=>e.getAllRootElements(),_.dqk.frameworkStabilizers||(_.dqk.frameworkStabilizers=[]),_.dqk.frameworkStabilizers.push(r=>{const o=_.dqk.getAllAngularTestabilities();let u=o.length,c=!1;const g=function(E){c=c||E,u--,0==u&&r(c)};o.forEach(function(E){E.whenStable(g)})})}findTestabilityInTree(e,t,r){if(null==t)return null;const o=e.getTestability(t);return null!=o?o:r?k().isShadowRoot(t)?this.findTestabilityInTree(e,t.host,!0):this.findTestabilityInTree(e,t.parentElement,!0):null}}let Dl=(()=>{class n{build(){return new XMLHttpRequest}}return n.\u0275fac=function(t){return new(t||n)},n.\u0275prov=_.Yz7({token:n,factory:n.\u0275fac}),n})();const Ar=new _.OlP("EventManagerPlugins");let Ls=(()=>{class n{constructor(t,r){this._zone=r,this._eventNameToPlugin=new Map,t.forEach(o=>o.manager=this),this._plugins=t.slice().reverse()}addEventListener(t,r,o){return this._findPluginFor(r).addEventListener(t,r,o)}addGlobalEventListener(t,r,o){return this._findPluginFor(r).addGlobalEventListener(t,r,o)}getZone(){return this._zone}_findPluginFor(t){const r=this._eventNameToPlugin.get(t);if(r)return r;const o=this._plugins;for(let u=0;u<o.length;u++){const c=o[u];if(c.supports(t))return this._eventNameToPlugin.set(t,c),c}throw new Error(`No event manager plugin found for event ${t}`)}}return n.\u0275fac=function(t){return new(t||n)(_.LFG(Ar),_.LFG(_.R0b))},n.\u0275prov=_.Yz7({token:n,factory:n.\u0275fac}),n})();class Ho{constructor(e){this._doc=e}addGlobalEventListener(e,t,r){const o=k().getGlobalEventTarget(this._doc,e);if(!o)throw new Error(`Unsupported event target ${o} for event ${t}`);return this.addEventListener(o,t,r)}}let dt=(()=>{class n{constructor(){this._stylesSet=new Set}addStyles(t){const r=new Set;t.forEach(o=>{this._stylesSet.has(o)||(this._stylesSet.add(o),r.add(o))}),this.onStylesAdded(r)}onStylesAdded(t){}getAllStyles(){return Array.from(this._stylesSet)}}return n.\u0275fac=function(t){return new(t||n)},n.\u0275prov=_.Yz7({token:n,factory:n.\u0275fac}),n})(),Xn=(()=>{class n extends dt{constructor(t){super(),this._doc=t,this._hostNodes=new Map,this._hostNodes.set(t.head,[])}_addStylesToHost(t,r,o){t.forEach(u=>{const c=this._doc.createElement("style");c.textContent=u,o.push(r.appendChild(c))})}addHost(t){const r=[];this._addStylesToHost(this._stylesSet,t,r),this._hostNodes.set(t,r)}removeHost(t){const r=this._hostNodes.get(t);r&&r.forEach(Ma),this._hostNodes.delete(t)}onStylesAdded(t){this._hostNodes.forEach((r,o)=>{this._addStylesToHost(t,o,r)})}ngOnDestroy(){this._hostNodes.forEach(t=>t.forEach(Ma))}}return n.\u0275fac=function(t){return new(t||n)(_.LFG(oe))},n.\u0275prov=_.Yz7({token:n,factory:n.\u0275fac}),n})();function Ma(n){k().remove(n)}const Na={svg:"http://www.w3.org/2000/svg",xhtml:"http://www.w3.org/1999/xhtml",xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/"},Go=/%COMP%/g;function tn(n,e,t){for(let r=0;r<e.length;r++){let o=e[r];Array.isArray(o)?tn(n,o,t):(o=o.replace(Go,n),t.push(o))}return t}function ao(n){return e=>{if("__ngUnwrap__"===e)return n;!1===n(e)&&(e.preventDefault(),e.returnValue=!1)}}let $r=(()=>{class n{constructor(t,r,o){this.eventManager=t,this.sharedStylesHost=r,this.appId=o,this.rendererByCompId=new Map,this.defaultRenderer=new cs(t)}createRenderer(t,r){if(!t||!r)return this.defaultRenderer;switch(r.encapsulation){case _.ifc.Emulated:{let o=this.rendererByCompId.get(r.id);return o||(o=new Cu(this.eventManager,this.sharedStylesHost,r,this.appId),this.rendererByCompId.set(r.id,o)),o.applyToHost(t),o}case 1:case _.ifc.ShadowDom:return new Wo(this.eventManager,this.sharedStylesHost,t,r);default:if(!this.rendererByCompId.has(r.id)){const o=tn(r.id,r.styles,[]);this.sharedStylesHost.addStyles(o),this.rendererByCompId.set(r.id,this.defaultRenderer)}return this.defaultRenderer}}begin(){}end(){}}return n.\u0275fac=function(t){return new(t||n)(_.LFG(Ls),_.LFG(Xn),_.LFG(_.AFp))},n.\u0275prov=_.Yz7({token:n,factory:n.\u0275fac}),n})();class cs{constructor(e){this.eventManager=e,this.data=Object.create(null),this.destroyNode=null}destroy(){}createElement(e,t){return t?document.createElementNS(Na[t]||t,e):document.createElement(e)}createComment(e){return document.createComment(e)}createText(e){return document.createTextNode(e)}appendChild(e,t){e.appendChild(t)}insertBefore(e,t,r){e&&e.insertBefore(t,r)}removeChild(e,t){e&&e.removeChild(t)}selectRootElement(e,t){let r="string"==typeof e?document.querySelector(e):e;if(!r)throw new Error(`The selector "${e}" did not match any elements`);return t||(r.textContent=""),r}parentNode(e){return e.parentNode}nextSibling(e){return e.nextSibling}setAttribute(e,t,r,o){if(o){t=o+":"+t;const u=Na[o];u?e.setAttributeNS(u,t,r):e.setAttribute(t,r)}else e.setAttribute(t,r)}removeAttribute(e,t,r){if(r){const o=Na[r];o?e.removeAttributeNS(o,t):e.removeAttribute(`${r}:${t}`)}else e.removeAttribute(t)}addClass(e,t){e.classList.add(t)}removeClass(e,t){e.classList.remove(t)}setStyle(e,t,r,o){o&(_.JOm.DashCase|_.JOm.Important)?e.style.setProperty(t,r,o&_.JOm.Important?"important":""):e.style[t]=r}removeStyle(e,t,r){r&_.JOm.DashCase?e.style.removeProperty(t):e.style[t]=""}setProperty(e,t,r){e[t]=r}setValue(e,t){e.nodeValue=t}listen(e,t,r){return"string"==typeof e?this.eventManager.addGlobalEventListener(e,t,ao(r)):this.eventManager.addEventListener(e,t,ao(r))}}class Cu extends cs{constructor(e,t,r,o){super(e),this.component=r;const u=tn(o+"-"+r.id,r.styles,[]);t.addStyles(u),this.contentAttr=function At(n){return"_ngcontent-%COMP%".replace(Go,n)}(o+"-"+r.id),this.hostAttr=function Eu(n){return"_nghost-%COMP%".replace(Go,n)}(o+"-"+r.id)}applyToHost(e){super.setAttribute(e,this.hostAttr,"")}createElement(e,t){const r=super.createElement(e,t);return super.setAttribute(r,this.contentAttr,""),r}}class Wo extends cs{constructor(e,t,r,o){super(e),this.sharedStylesHost=t,this.hostEl=r,this.shadowRoot=r.attachShadow({mode:"open"}),this.sharedStylesHost.addHost(this.shadowRoot);const u=tn(o.id,o.styles,[]);for(let c=0;c<u.length;c++){const g=document.createElement("style");g.textContent=u[c],this.shadowRoot.appendChild(g)}}nodeOrShadowRoot(e){return e===this.hostEl?this.shadowRoot:e}destroy(){this.sharedStylesHost.removeHost(this.shadowRoot)}appendChild(e,t){return super.appendChild(this.nodeOrShadowRoot(e),t)}insertBefore(e,t,r){return super.insertBefore(this.nodeOrShadowRoot(e),t,r)}removeChild(e,t){return super.removeChild(this.nodeOrShadowRoot(e),t)}parentNode(e){return this.nodeOrShadowRoot(super.parentNode(this.nodeOrShadowRoot(e)))}}let Ra=(()=>{class n extends Ho{constructor(t){super(t)}supports(t){return!0}addEventListener(t,r,o){return t.addEventListener(r,o,!1),()=>this.removeEventListener(t,r,o)}removeEventListener(t,r,o){return t.removeEventListener(r,o)}}return n.\u0275fac=function(t){return new(t||n)(_.LFG(oe))},n.\u0275prov=_.Yz7({token:n,factory:n.\u0275fac}),n})();const qn=["alt","control","meta","shift"],Du={"\b":"Backspace","\t":"Tab","\x7f":"Delete","\x1b":"Escape",Del:"Delete",Esc:"Escape",Left:"ArrowLeft",Right:"ArrowRight",Up:"ArrowUp",Down:"ArrowDown",Menu:"ContextMenu",Scroll:"ScrollLock",Win:"OS"},ds={A:"1",B:"2",C:"3",D:"4",E:"5",F:"6",G:"7",H:"8",I:"9",J:"*",K:"+",M:"-",N:".",O:"/","`":"0","\x90":"NumLock"},Ai={alt:n=>n.altKey,control:n=>n.ctrlKey,meta:n=>n.metaKey,shift:n=>n.shiftKey};let Jc=(()=>{class n extends Ho{constructor(t){super(t)}supports(t){return null!=n.parseEventName(t)}addEventListener(t,r,o){const u=n.parseEventName(r),c=n.eventCallback(u.fullKey,o,this.manager.getZone());return this.manager.getZone().runOutsideAngular(()=>k().onAndCancel(t,u.domEventName,c))}static parseEventName(t){const r=t.toLowerCase().split("."),o=r.shift();if(0===r.length||"keydown"!==o&&"keyup"!==o)return null;const u=n._normalizeKey(r.pop());let c="";if(qn.forEach(E=>{const I=r.indexOf(E);I>-1&&(r.splice(I,1),c+=E+".")}),c+=u,0!=r.length||0===u.length)return null;const g={};return g.domEventName=o,g.fullKey=c,g}static getEventFullKey(t){let r="",o=function qo(n){let e=n.key;if(null==e){if(e=n.keyIdentifier,null==e)return"Unidentified";e.startsWith("U+")&&(e=String.fromCharCode(parseInt(e.substring(2),16)),3===n.location&&ds.hasOwnProperty(e)&&(e=ds[e]))}return Du[e]||e}(t);return o=o.toLowerCase()," "===o?o="space":"."===o&&(o="dot"),qn.forEach(u=>{u!=o&&Ai[u](t)&&(r+=u+".")}),r+=o,r}static eventCallback(t,r,o){return u=>{n.getEventFullKey(u)===t&&o.runGuarded(()=>r(u))}}static _normalizeKey(t){return"esc"===t?"escape":t}}return n.\u0275fac=function(t){return new(t||n)(_.LFG(oe))},n.\u0275prov=_.Yz7({token:n,factory:n.\u0275fac}),n})();const ka=(0,_.eFA)(_._c5,"browser",[{provide:_.Lbi,useValue:"browser"},{provide:_.g9A,useValue:function bu(){Uo.makeCurrent(),$i.init()},multi:!0},{provide:oe,useFactory:function zo(){return(0,_.RDi)(document),document},deps:[]}]),Fa=[{provide:_.zSh,useValue:"root"},{provide:_.qLn,useFactory:function Pa(){return new _.qLn},deps:[]},{provide:Ar,useClass:Ra,multi:!0,deps:[oe,_.R0b,_.Lbi]},{provide:Ar,useClass:Jc,multi:!0,deps:[oe]},{provide:$r,useClass:$r,deps:[Ls,Xn,_.AFp]},{provide:_.FYo,useExisting:$r},{provide:dt,useExisting:Xn},{provide:Xn,useClass:Xn,deps:[oe]},{provide:_.dDg,useClass:_.dDg,deps:[_.R0b]},{provide:Ls,useClass:Ls,deps:[Ar,_.R0b]},{provide:class en{},useClass:Dl,deps:[]}];let Tl=(()=>{class n{constructor(t){if(t)throw new Error("BrowserModule has already been loaded. If you need access to common directives such as NgIf and NgFor from a lazy loaded module, import CommonModule instead.")}static withServerTransition(t){return{ngModule:n,providers:[{provide:_.AFp,useValue:t.appId},{provide:Gi,useExisting:_.AFp},Wn]}}}return n.\u0275fac=function(t){return new(t||n)(_.LFG(n,12))},n.\u0275mod=_.oAB({type:n}),n.\u0275inj=_.cJS({providers:Fa,imports:[Sa,_.hGG]}),n})();"undefined"!=typeof window&&window;var Wi=L(8996),uo=L(8306);const{isArray:cr}=Array,{getPrototypeOf:Gh,prototype:$h,keys:Ha}=Object;var Mu=L(8421),fs=L(7669),Wr=L(5403),Ht=L(4004);const{isArray:$a}=Array;function Wa(n,e){return n.reduce((t,r,o)=>(t[r]=e[o],t),{})}let Zo=(()=>{class n{constructor(t,r){this._renderer=t,this._elementRef=r,this.onChange=o=>{},this.onTouched=()=>{}}setProperty(t,r){this._renderer.setProperty(this._elementRef.nativeElement,t,r)}registerOnTouched(t){this.onTouched=t}registerOnChange(t){this.onChange=t}setDisabledState(t){this.setProperty("disabled",t)}}return n.\u0275fac=function(t){return new(t||n)(_.Y36(_.Qsj),_.Y36(_.SBq))},n.\u0275dir=_.lG2({type:n}),n})(),Sr=(()=>{class n extends Zo{}return n.\u0275fac=function(){let e;return function(r){return(e||(e=_.n5z(n)))(r||n)}}(),n.\u0275dir=_.lG2({type:n,features:[_.qOj]}),n})();const qr=new _.OlP("NgValueAccessor"),qi={provide:qr,useExisting:(0,_.Gpc)(()=>Qo),multi:!0},kl=new _.OlP("CompositionEventMode");let Qo=(()=>{class n extends Zo{constructor(t,r,o){super(t,r),this._compositionMode=o,this._composing=!1,null==this._compositionMode&&(this._compositionMode=!function Ol(){const n=k()?k().getUserAgent():"";return/android (\d+)/.test(n.toLowerCase())}())}writeValue(t){this.setProperty("value",null==t?"":t)}_handleInput(t){(!this._compositionMode||this._compositionMode&&!this._composing)&&this.onChange(t)}_compositionStart(){this._composing=!0}_compositionEnd(t){this._composing=!1,this._compositionMode&&this.onChange(t)}}return n.\u0275fac=function(t){return new(t||n)(_.Y36(_.Qsj),_.Y36(_.SBq),_.Y36(kl,8))},n.\u0275dir=_.lG2({type:n,selectors:[["input","formControlName","",3,"type","checkbox"],["textarea","formControlName",""],["input","formControl","",3,"type","checkbox"],["textarea","formControl",""],["input","ngModel","",3,"type","checkbox"],["textarea","ngModel",""],["","ngDefaultControl",""]],hostBindings:function(t,r){1&t&&_.NdJ("input",function(u){return r._handleInput(u.target.value)})("blur",function(){return r.onTouched()})("compositionstart",function(){return r._compositionStart()})("compositionend",function(u){return r._compositionEnd(u.target.value)})},features:[_._Bn([qi]),_.qOj]}),n})();const Vt=new _.OlP("NgValidators"),zi=new _.OlP("NgAsyncValidators");function co(n){return null!=n}function ea(n){const e=(0,_.QGY)(n)?(0,Wi.D)(n):n;return(0,_.CqO)(e),e}function sd(n){let e={};return n.forEach(t=>{e=null!=t?Object.assign(Object.assign({},e),t):e}),0===Object.keys(e).length?null:e}function Yt(n,e){return e.map(t=>t(n))}function Vl(n){return n.map(e=>function Ll(n){return!n.validate}(e)?e:t=>e.validate(t))}function ad(n){return null!=n?function od(n){if(!n)return null;const e=n.filter(co);return 0==e.length?null:function(t){return sd(Yt(t,e))}}(Vl(n)):null}function ud(n){if(!n)return null;const e=n.filter(co);return 0==e.length?null:function(t){return function Pl(...n){const e=(0,fs.jO)(n),{args:t,keys:r}=function Wh(n){if(1===n.length){const e=n[0];if(cr(e))return{args:e,keys:null};if(function Ga(n){return n&&"object"==typeof n&&Gh(n)===$h}(e)){const t=Ha(e);return{args:t.map(r=>e[r]),keys:t}}}return{args:n,keys:null}}(n),o=new uo.y(u=>{const{length:c}=t;if(!c)return void u.complete();const g=new Array(c);let E=c,I=c;for(let S=0;S<c;S++){let M=!1;(0,Mu.Xf)(t[S]).subscribe(new Wr.Q(u,F=>{M||(M=!0,I--),g[S]=F},()=>E--,void 0,()=>{(!E||!M)&&(I||u.next(r?Wa(r,g):g),u.complete())}))}});return e?o.pipe(function qh(n){return(0,Ht.U)(e=>function Rl(n,e){return $a(e)?n(...e):n(e)}(n,e))}(e)):o}(Yt(t,e).map(ea)).pipe((0,Ht.U)(sd))}}function Kh(n){return null!=n?ud(Vl(n)):null}function Bl(n,e){return null===n?[e]:Array.isArray(n)?[...n,e]:[n,e]}function wn(n){return n?Array.isArray(n)?n:[n]:[]}function Ka(n,e){return Array.isArray(n)?n.includes(e):n===e}function Si(n,e){const t=wn(e);return wn(n).forEach(o=>{Ka(t,o)||t.push(o)}),t}function Zh(n,e){return wn(e).filter(t=>!Ka(n,t))}class cd{constructor(){this._rawValidators=[],this._rawAsyncValidators=[],this._onDestroyCallbacks=[]}get value(){return this.control?this.control.value:null}get valid(){return this.control?this.control.valid:null}get invalid(){return this.control?this.control.invalid:null}get pending(){return this.control?this.control.pending:null}get disabled(){return this.control?this.control.disabled:null}get enabled(){return this.control?this.control.enabled:null}get errors(){return this.control?this.control.errors:null}get pristine(){return this.control?this.control.pristine:null}get dirty(){return this.control?this.control.dirty:null}get touched(){return this.control?this.control.touched:null}get status(){return this.control?this.control.status:null}get untouched(){return this.control?this.control.untouched:null}get statusChanges(){return this.control?this.control.statusChanges:null}get valueChanges(){return this.control?this.control.valueChanges:null}get path(){return null}_setValidators(e){this._rawValidators=e||[],this._composedValidatorFn=ad(this._rawValidators)}_setAsyncValidators(e){this._rawAsyncValidators=e||[],this._composedAsyncValidatorFn=Kh(this._rawAsyncValidators)}get validator(){return this._composedValidatorFn||null}get asyncValidator(){return this._composedAsyncValidatorFn||null}_registerOnDestroy(e){this._onDestroyCallbacks.push(e)}_invokeOnDestroyCallbacks(){this._onDestroyCallbacks.forEach(e=>e()),this._onDestroyCallbacks=[]}reset(e){this.control&&this.control.reset(e)}hasError(e,t){return!!this.control&&this.control.hasError(e,t)}getError(e,t){return this.control?this.control.getError(e,t):null}}class Rn extends cd{constructor(){super(...arguments),this._parent=null,this.name=null,this.valueAccessor=null}}class an extends cd{get formDirective(){return null}get path(){return null}}let jl=(()=>{class n extends class Ul{constructor(e){this._cd=e}is(e){var t,r,o;return"submitted"===e?!!(null===(t=this._cd)||void 0===t?void 0:t.submitted):!!(null===(o=null===(r=this._cd)||void 0===r?void 0:r.control)||void 0===o?void 0:o[e])}}{constructor(t){super(t)}}return n.\u0275fac=function(t){return new(t||n)(_.Y36(Rn,2))},n.\u0275dir=_.lG2({type:n,selectors:[["","formControlName",""],["","ngModel",""],["","formControl",""]],hostVars:14,hostBindings:function(t,r){2&t&&_.ekj("ng-untouched",r.is("untouched"))("ng-touched",r.is("touched"))("ng-pristine",r.is("pristine"))("ng-dirty",r.is("dirty"))("ng-valid",r.is("valid"))("ng-invalid",r.is("invalid"))("ng-pending",r.is("pending"))},features:[_.qOj]}),n})();function Ya(n,e){(function ra(n,e){const t=function Us(n){return n._rawValidators}(n);null!==e.validator?n.setValidators(Bl(t,e.validator)):"function"==typeof t&&n.setValidators([t]);const r=function ld(n){return n._rawAsyncValidators}(n);null!==e.asyncValidator?n.setAsyncValidators(Bl(r,e.asyncValidator)):"function"==typeof r&&n.setAsyncValidators([r]);const o=()=>n.updateValueAndValidity();na(e._rawValidators,o),na(e._rawAsyncValidators,o)})(n,e),e.valueAccessor.writeValue(n.value),function ag(n,e){e.valueAccessor.registerOnChange(t=>{n._pendingValue=t,n._pendingChange=!0,n._pendingDirty=!0,"change"===n.updateOn&&fo(n,e)})}(n,e),function xi(n,e){const t=(r,o)=>{e.valueAccessor.writeValue(r),o&&e.viewToModelUpdate(r)};n.registerOnChange(t),e._registerOnDestroy(()=>{n._unregisterOnChange(t)})}(n,e),function ql(n,e){e.valueAccessor.registerOnTouched(()=>{n._pendingTouched=!0,"blur"===n.updateOn&&n._pendingChange&&fo(n,e),"submit"!==n.updateOn&&n.markAsTouched()})}(n,e),function ti(n,e){if(e.valueAccessor.setDisabledState){const t=r=>{e.valueAccessor.setDisabledState(r)};n.registerOnDisabledChange(t),e._registerOnDestroy(()=>{n._unregisterOnDisabledChange(t)})}}(n,e)}function na(n,e){n.forEach(t=>{t.registerOnValidatorChange&&t.registerOnValidatorChange(e)})}function fo(n,e){n._pendingDirty&&n.markAsDirty(),n.setValue(n._pendingValue,{emitModelToViewChange:!1}),e.viewToModelUpdate(n._pendingValue),n._pendingChange=!1}function De(n,e){const t=n.indexOf(e);t>-1&&n.splice(t,1)}const at="VALID",Ft="INVALID",ln="PENDING",dr="DISABLED";function js(n){return(Ji(n)?n.validators:n)||null}function po(n){return Array.isArray(n)?ad(n):n||null}function Yi(n,e){return(Ji(e)?e.asyncValidators:n)||null}function Qi(n){return Array.isArray(n)?Kh(n):n||null}function Ji(n){return null!=n&&!Array.isArray(n)&&"object"==typeof n}const ia=n=>n instanceof zl;function ty(n){return(n=>n instanceof dg)(n)?n.value:n.getRawValue()}function Xh(n,e){const t=ia(n),r=n.controls;if(!(t?Object.keys(r):r).length)throw new _.vHH(1e3,"");if(!r[e])throw new _.vHH(1001,"")}function hd(n,e){ia(n),n._forEachChild((r,o)=>{if(void 0===e[o])throw new _.vHH(1002,"")})}class cg{constructor(e,t){this._pendingDirty=!1,this._hasOwnPendingAsyncValidator=!1,this._pendingTouched=!1,this._onCollectionChange=()=>{},this._parent=null,this.pristine=!0,this.touched=!1,this._onDisabledChange=[],this._rawValidators=e,this._rawAsyncValidators=t,this._composedValidatorFn=po(this._rawValidators),this._composedAsyncValidatorFn=Qi(this._rawAsyncValidators)}get validator(){return this._composedValidatorFn}set validator(e){this._rawValidators=this._composedValidatorFn=e}get asyncValidator(){return this._composedAsyncValidatorFn}set asyncValidator(e){this._rawAsyncValidators=this._composedAsyncValidatorFn=e}get parent(){return this._parent}get valid(){return this.status===at}get invalid(){return this.status===Ft}get pending(){return this.status==ln}get disabled(){return this.status===dr}get enabled(){return this.status!==dr}get dirty(){return!this.pristine}get untouched(){return!this.touched}get updateOn(){return this._updateOn?this._updateOn:this.parent?this.parent.updateOn:"change"}setValidators(e){this._rawValidators=e,this._composedValidatorFn=po(e)}setAsyncValidators(e){this._rawAsyncValidators=e,this._composedAsyncValidatorFn=Qi(e)}addValidators(e){this.setValidators(Si(e,this._rawValidators))}addAsyncValidators(e){this.setAsyncValidators(Si(e,this._rawAsyncValidators))}removeValidators(e){this.setValidators(Zh(e,this._rawValidators))}removeAsyncValidators(e){this.setAsyncValidators(Zh(e,this._rawAsyncValidators))}hasValidator(e){return Ka(this._rawValidators,e)}hasAsyncValidator(e){return Ka(this._rawAsyncValidators,e)}clearValidators(){this.validator=null}clearAsyncValidators(){this.asyncValidator=null}markAsTouched(e={}){this.touched=!0,this._parent&&!e.onlySelf&&this._parent.markAsTouched(e)}markAllAsTouched(){this.markAsTouched({onlySelf:!0}),this._forEachChild(e=>e.markAllAsTouched())}markAsUntouched(e={}){this.touched=!1,this._pendingTouched=!1,this._forEachChild(t=>{t.markAsUntouched({onlySelf:!0})}),this._parent&&!e.onlySelf&&this._parent._updateTouched(e)}markAsDirty(e={}){this.pristine=!1,this._parent&&!e.onlySelf&&this._parent.markAsDirty(e)}markAsPristine(e={}){this.pristine=!0,this._pendingDirty=!1,this._forEachChild(t=>{t.markAsPristine({onlySelf:!0})}),this._parent&&!e.onlySelf&&this._parent._updatePristine(e)}markAsPending(e={}){this.status=ln,!1!==e.emitEvent&&this.statusChanges.emit(this.status),this._parent&&!e.onlySelf&&this._parent.markAsPending(e)}disable(e={}){const t=this._parentMarkedDirty(e.onlySelf);this.status=dr,this.errors=null,this._forEachChild(r=>{r.disable(Object.assign(Object.assign({},e),{onlySelf:!0}))}),this._updateValue(),!1!==e.emitEvent&&(this.valueChanges.emit(this.value),this.statusChanges.emit(this.status)),this._updateAncestors(Object.assign(Object.assign({},e),{skipPristineCheck:t})),this._onDisabledChange.forEach(r=>r(!0))}enable(e={}){const t=this._parentMarkedDirty(e.onlySelf);this.status=at,this._forEachChild(r=>{r.enable(Object.assign(Object.assign({},e),{onlySelf:!0}))}),this.updateValueAndValidity({onlySelf:!0,emitEvent:e.emitEvent}),this._updateAncestors(Object.assign(Object.assign({},e),{skipPristineCheck:t})),this._onDisabledChange.forEach(r=>r(!1))}_updateAncestors(e){this._parent&&!e.onlySelf&&(this._parent.updateValueAndValidity(e),e.skipPristineCheck||this._parent._updatePristine(),this._parent._updateTouched())}setParent(e){this._parent=e}updateValueAndValidity(e={}){this._setInitialStatus(),this._updateValue(),this.enabled&&(this._cancelExistingSubscription(),this.errors=this._runValidator(),this.status=this._calculateStatus(),(this.status===at||this.status===ln)&&this._runAsyncValidator(e.emitEvent)),!1!==e.emitEvent&&(this.valueChanges.emit(this.value),this.statusChanges.emit(this.status)),this._parent&&!e.onlySelf&&this._parent.updateValueAndValidity(e)}_updateTreeValidity(e={emitEvent:!0}){this._forEachChild(t=>t._updateTreeValidity(e)),this.updateValueAndValidity({onlySelf:!0,emitEvent:e.emitEvent})}_setInitialStatus(){this.status=this._allControlsDisabled()?dr:at}_runValidator(){return this.validator?this.validator(this):null}_runAsyncValidator(e){if(this.asyncValidator){this.status=ln,this._hasOwnPendingAsyncValidator=!0;const t=ea(this.asyncValidator(this));this._asyncValidationSubscription=t.subscribe(r=>{this._hasOwnPendingAsyncValidator=!1,this.setErrors(r,{emitEvent:e})})}}_cancelExistingSubscription(){this._asyncValidationSubscription&&(this._asyncValidationSubscription.unsubscribe(),this._hasOwnPendingAsyncValidator=!1)}setErrors(e,t={}){this.errors=e,this._updateControlsErrors(!1!==t.emitEvent)}get(e){return function In(n,e,t){if(null==e||(Array.isArray(e)||(e=e.split(t)),Array.isArray(e)&&0===e.length))return null;let r=n;return e.forEach(o=>{r=ia(r)?r.controls.hasOwnProperty(o)?r.controls[o]:null:(n=>n instanceof ny)(r)&&r.at(o)||null}),r}(this,e,".")}getError(e,t){const r=t?this.get(t):this;return r&&r.errors?r.errors[e]:null}hasError(e,t){return!!this.getError(e,t)}get root(){let e=this;for(;e._parent;)e=e._parent;return e}_updateControlsErrors(e){this.status=this._calculateStatus(),e&&this.statusChanges.emit(this.status),this._parent&&this._parent._updateControlsErrors(e)}_initObservables(){this.valueChanges=new _.vpe,this.statusChanges=new _.vpe}_calculateStatus(){return this._allControlsDisabled()?dr:this.errors?Ft:this._hasOwnPendingAsyncValidator||this._anyControlsHaveStatus(ln)?ln:this._anyControlsHaveStatus(Ft)?Ft:at}_anyControlsHaveStatus(e){return this._anyControls(t=>t.status===e)}_anyControlsDirty(){return this._anyControls(e=>e.dirty)}_anyControlsTouched(){return this._anyControls(e=>e.touched)}_updatePristine(e={}){this.pristine=!this._anyControlsDirty(),this._parent&&!e.onlySelf&&this._parent._updatePristine(e)}_updateTouched(e={}){this.touched=this._anyControlsTouched(),this._parent&&!e.onlySelf&&this._parent._updateTouched(e)}_isBoxedValue(e){return"object"==typeof e&&null!==e&&2===Object.keys(e).length&&"value"in e&&"disabled"in e}_registerOnCollectionChange(e){this._onCollectionChange=e}_setUpdateStrategy(e){Ji(e)&&null!=e.updateOn&&(this._updateOn=e.updateOn)}_parentMarkedDirty(e){return!e&&!(!this._parent||!this._parent.dirty)&&!this._parent._anyControlsDirty()}}class dg extends cg{constructor(e=null,t,r){super(js(t),Yi(r,t)),this._onChange=[],this._pendingChange=!1,this._applyFormState(e),this._setUpdateStrategy(t),this._initObservables(),this.updateValueAndValidity({onlySelf:!0,emitEvent:!!this.asyncValidator})}setValue(e,t={}){this.value=this._pendingValue=e,this._onChange.length&&!1!==t.emitModelToViewChange&&this._onChange.forEach(r=>r(this.value,!1!==t.emitViewToModelChange)),this.updateValueAndValidity(t)}patchValue(e,t={}){this.setValue(e,t)}reset(e=null,t={}){this._applyFormState(e),this.markAsPristine(t),this.markAsUntouched(t),this.setValue(this.value,t),this._pendingChange=!1}_updateValue(){}_anyControls(e){return!1}_allControlsDisabled(){return this.disabled}registerOnChange(e){this._onChange.push(e)}_unregisterOnChange(e){De(this._onChange,e)}registerOnDisabledChange(e){this._onDisabledChange.push(e)}_unregisterOnDisabledChange(e){De(this._onDisabledChange,e)}_forEachChild(e){}_syncPendingControls(){return!("submit"!==this.updateOn||(this._pendingDirty&&this.markAsDirty(),this._pendingTouched&&this.markAsTouched(),!this._pendingChange)||(this.setValue(this._pendingValue,{onlySelf:!0,emitModelToViewChange:!1}),0))}_applyFormState(e){this._isBoxedValue(e)?(this.value=this._pendingValue=e.value,e.disabled?this.disable({onlySelf:!0,emitEvent:!1}):this.enable({onlySelf:!0,emitEvent:!1})):this.value=this._pendingValue=e}}class zl extends cg{constructor(e,t,r){super(js(t),Yi(r,t)),this.controls=e,this._initObservables(),this._setUpdateStrategy(t),this._setUpControls(),this.updateValueAndValidity({onlySelf:!0,emitEvent:!!this.asyncValidator})}registerControl(e,t){return this.controls[e]?this.controls[e]:(this.controls[e]=t,t.setParent(this),t._registerOnCollectionChange(this._onCollectionChange),t)}addControl(e,t,r={}){this.registerControl(e,t),this.updateValueAndValidity({emitEvent:r.emitEvent}),this._onCollectionChange()}removeControl(e,t={}){this.controls[e]&&this.controls[e]._registerOnCollectionChange(()=>{}),delete this.controls[e],this.updateValueAndValidity({emitEvent:t.emitEvent}),this._onCollectionChange()}setControl(e,t,r={}){this.controls[e]&&this.controls[e]._registerOnCollectionChange(()=>{}),delete this.controls[e],t&&this.registerControl(e,t),this.updateValueAndValidity({emitEvent:r.emitEvent}),this._onCollectionChange()}contains(e){return this.controls.hasOwnProperty(e)&&this.controls[e].enabled}setValue(e,t={}){hd(this,e),Object.keys(e).forEach(r=>{Xh(this,r),this.controls[r].setValue(e[r],{onlySelf:!0,emitEvent:t.emitEvent})}),this.updateValueAndValidity(t)}patchValue(e,t={}){null!=e&&(Object.keys(e).forEach(r=>{this.controls[r]&&this.controls[r].patchValue(e[r],{onlySelf:!0,emitEvent:t.emitEvent})}),this.updateValueAndValidity(t))}reset(e={},t={}){this._forEachChild((r,o)=>{r.reset(e[o],{onlySelf:!0,emitEvent:t.emitEvent})}),this._updatePristine(t),this._updateTouched(t),this.updateValueAndValidity(t)}getRawValue(){return this._reduceChildren({},(e,t,r)=>(e[r]=ty(t),e))}_syncPendingControls(){let e=this._reduceChildren(!1,(t,r)=>!!r._syncPendingControls()||t);return e&&this.updateValueAndValidity({onlySelf:!0}),e}_forEachChild(e){Object.keys(this.controls).forEach(t=>{const r=this.controls[t];r&&e(r,t)})}_setUpControls(){this._forEachChild(e=>{e.setParent(this),e._registerOnCollectionChange(this._onCollectionChange)})}_updateValue(){this.value=this._reduceValue()}_anyControls(e){for(const t of Object.keys(this.controls)){const r=this.controls[t];if(this.contains(t)&&e(r))return!0}return!1}_reduceValue(){return this._reduceChildren({},(e,t,r)=>((t.enabled||this.disabled)&&(e[r]=t.value),e))}_reduceChildren(e,t){let r=e;return this._forEachChild((o,u)=>{r=t(r,o,u)}),r}_allControlsDisabled(){for(const e of Object.keys(this.controls))if(this.controls[e].enabled)return!1;return Object.keys(this.controls).length>0||this.disabled}}class ny extends cg{constructor(e,t,r){super(js(t),Yi(r,t)),this.controls=e,this._initObservables(),this._setUpdateStrategy(t),this._setUpControls(),this.updateValueAndValidity({onlySelf:!0,emitEvent:!!this.asyncValidator})}at(e){return this.controls[e]}push(e,t={}){this.controls.push(e),this._registerControl(e),this.updateValueAndValidity({emitEvent:t.emitEvent}),this._onCollectionChange()}insert(e,t,r={}){this.controls.splice(e,0,t),this._registerControl(t),this.updateValueAndValidity({emitEvent:r.emitEvent})}removeAt(e,t={}){this.controls[e]&&this.controls[e]._registerOnCollectionChange(()=>{}),this.controls.splice(e,1),this.updateValueAndValidity({emitEvent:t.emitEvent})}setControl(e,t,r={}){this.controls[e]&&this.controls[e]._registerOnCollectionChange(()=>{}),this.controls.splice(e,1),t&&(this.controls.splice(e,0,t),this._registerControl(t)),this.updateValueAndValidity({emitEvent:r.emitEvent}),this._onCollectionChange()}get length(){return this.controls.length}setValue(e,t={}){hd(this,e),e.forEach((r,o)=>{Xh(this,o),this.at(o).setValue(r,{onlySelf:!0,emitEvent:t.emitEvent})}),this.updateValueAndValidity(t)}patchValue(e,t={}){null!=e&&(e.forEach((r,o)=>{this.at(o)&&this.at(o).patchValue(r,{onlySelf:!0,emitEvent:t.emitEvent})}),this.updateValueAndValidity(t))}reset(e=[],t={}){this._forEachChild((r,o)=>{r.reset(e[o],{onlySelf:!0,emitEvent:t.emitEvent})}),this._updatePristine(t),this._updateTouched(t),this.updateValueAndValidity(t)}getRawValue(){return this.controls.map(e=>ty(e))}clear(e={}){this.controls.length<1||(this._forEachChild(t=>t._registerOnCollectionChange(()=>{})),this.controls.splice(0),this.updateValueAndValidity({emitEvent:e.emitEvent}))}_syncPendingControls(){let e=this.controls.reduce((t,r)=>!!r._syncPendingControls()||t,!1);return e&&this.updateValueAndValidity({onlySelf:!0}),e}_forEachChild(e){this.controls.forEach((t,r)=>{e(t,r)})}_updateValue(){this.value=this.controls.filter(e=>e.enabled||this.disabled).map(e=>e.value)}_anyControls(e){return this.controls.some(t=>t.enabled&&e(t))}_setUpControls(){this._forEachChild(e=>this._registerControl(e))}_allControlsDisabled(){for(const e of this.controls)if(e.enabled)return!1;return this.controls.length>0||this.disabled}_registerControl(e){e.setParent(this),e._registerOnCollectionChange(this._onCollectionChange)}}const tf={provide:Rn,useExisting:(0,_.Gpc)(()=>nf)},yd=(()=>Promise.resolve(null))();let nf=(()=>{class n extends Rn{constructor(t,r,o,u){super(),this.control=new dg,this._registered=!1,this.update=new _.vpe,this._parent=t,this._setValidators(r),this._setAsyncValidators(o),this.valueAccessor=function ne(n,e){if(!e)return null;let t,r,o;return Array.isArray(e),e.forEach(u=>{u.constructor===Qo?t=u:function V(n){return Object.getPrototypeOf(n.constructor)===Sr}(u)?r=u:o=u}),o||r||t||null}(0,u)}ngOnChanges(t){this._checkForErrors(),this._registered||this._setUpControl(),"isDisabled"in t&&this._updateDisabled(t),function R(n,e){if(!n.hasOwnProperty("model"))return!1;const t=n.model;return!!t.isFirstChange()||!Object.is(e,t.currentValue)}(t,this.viewModel)&&(this._updateValue(this.model),this.viewModel=this.model)}ngOnDestroy(){this.formDirective&&this.formDirective.removeControl(this)}get path(){return this._parent?function xr(n,e){return[...e.path,n]}(this.name,this._parent):[this.name]}get formDirective(){return this._parent?this._parent.formDirective:null}viewToModelUpdate(t){this.viewModel=t,this.update.emit(t)}_setUpControl(){this._setUpdateStrategy(),this._isStandalone()?this._setUpStandalone():this.formDirective.addControl(this),this._registered=!0}_setUpdateStrategy(){this.options&&null!=this.options.updateOn&&(this.control._updateOn=this.options.updateOn)}_isStandalone(){return!this._parent||!(!this.options||!this.options.standalone)}_setUpStandalone(){Ya(this.control,this),this.control.updateValueAndValidity({emitEvent:!1})}_checkForErrors(){this._isStandalone()||this._checkParentType(),this._checkName()}_checkParentType(){}_checkName(){this.options&&this.options.name&&(this.name=this.options.name),this._isStandalone()}_updateValue(t){yd.then(()=>{this.control.setValue(t,{emitViewToModelChange:!1})})}_updateDisabled(t){const r=t.isDisabled.currentValue,o=""===r||r&&"false"!==r;yd.then(()=>{o&&!this.control.disabled?this.control.disable():!o&&this.control.disabled&&this.control.enable()})}}return n.\u0275fac=function(t){return new(t||n)(_.Y36(an,9),_.Y36(Vt,10),_.Y36(zi,10),_.Y36(qr,10))},n.\u0275dir=_.lG2({type:n,selectors:[["","ngModel","",3,"formControlName","",3,"formControl",""]],inputs:{name:"name",isDisabled:["disabled","isDisabled"],model:["ngModel","model"],options:["ngModelOptions","options"]},outputs:{update:"ngModelChange"},exportAs:["ngModel"],features:[_._Bn([tf]),_.qOj,_.TTD]}),n})();const rf={provide:qr,useExisting:(0,_.Gpc)(()=>sf),multi:!0};let sf=(()=>{class n extends Sr{writeValue(t){this.setProperty("value",null==t?"":t)}registerOnChange(t){this.onChange=r=>{t(""==r?null:parseFloat(r))}}}return n.\u0275fac=function(){let e;return function(r){return(e||(e=_.n5z(n)))(r||n)}}(),n.\u0275dir=_.lG2({type:n,selectors:[["input","type","number","formControlName",""],["input","type","number","formControl",""],["input","type","number","ngModel",""]],hostBindings:function(t,r){1&t&&_.NdJ("input",function(u){return r.onChange(u.target.value)})("blur",function(){return r.onTouched()})},features:[_._Bn([rf]),_.qOj]}),n})(),oa=(()=>{class n{}return n.\u0275fac=function(t){return new(t||n)},n.\u0275mod=_.oAB({type:n}),n.\u0275inj=_.cJS({}),n})(),Cg=(()=>{class n{}return n.\u0275fac=function(t){return new(t||n)},n.\u0275mod=_.oAB({type:n}),n.\u0275inj=_.cJS({imports:[[oa]]}),n})(),ec=(()=>{class n{}return n.\u0275fac=function(t){return new(t||n)},n.\u0275mod=_.oAB({type:n}),n.\u0275inj=_.cJS({imports:[Cg]}),n})();const hr_firebaseConfig={apiKey:"AIzaSyAFEfDLRrNk6bMGx0zekYF9ajdXSDL7F4g",authDomain:"tiendacomicslnk.firebaseapp.com",projectId:"tiendacomicslnk",storageBucket:"tiendacomicslnk.appspot.com",messagingSenderId:"969515085719",appId:"1:969515085719:web:3ff90c1d8dc49649b5ded2"};var Pn=L(2011),bd=L(4986);function eu(...n){const e=(0,fs.yG)(n);return(0,Wi.D)(n,e)}var tc=L(6451),nc=L(3099),Gs=L(4482);function $s(n,e){return(0,Gs.e)((t,r)=>{let o=null,u=0,c=!1;const g=()=>c&&!o&&r.complete();t.subscribe(new Wr.Q(r,E=>{null==o||o.unsubscribe();let I=0;const S=u++;(0,Mu.Xf)(n(E,S)).subscribe(o=new Wr.Q(r,M=>r.next(e?e(E,M,S,I++):M),()=>{o=null,g()}))},()=>{c=!0,g()}))})}function Td(n,e,t,r,o){return(u,c)=>{let g=t,E=e,I=0;u.subscribe(new Wr.Q(c,S=>{const M=I++;E=g?n(E,S,M):(g=!0,S),r&&c.next(E)},o&&(()=>{g&&c.next(E),c.complete()})))}}function Fu(n,e){return(0,Gs.e)(Td(n,e,arguments.length>=2,!0))}var ff=L(4671);function bg(n,e=ff.y){return n=null!=n?n:Ad,(0,Gs.e)((t,r)=>{let o,u=!0;t.subscribe(new Wr.Q(r,c=>{const g=e(c);(u||!n(o,g))&&(u=!1,o=g,r.next(c))}))})}function Ad(n,e){return n===e}var vy=L(5032),vn=L(2680),Lu=(L(2438),L(3942)),Ws=L(4859),pe=L(5861),ys=L(9681),P=L(2090),vs=L(1877);const Sd="@firebase/database";let rc="";function mf(n){rc=n}class wy{constructor(e){this.domStorage_=e,this.prefix_="firebase:"}set(e,t){null==t?this.domStorage_.removeItem(this.prefixedName_(e)):this.domStorage_.setItem(this.prefixedName_(e),(0,P.Pz)(t))}get(e){const t=this.domStorage_.getItem(this.prefixedName_(e));return null==t?null:(0,P.cI)(t)}remove(e){this.domStorage_.removeItem(this.prefixedName_(e))}prefixedName_(e){return this.prefix_+e}toString(){return this.domStorage_.toString()}}class Md{constructor(){this.cache_={},this.isInMemoryStorage=!0}set(e,t){null==t?delete this.cache_[e]:this.cache_[e]=t}get(e){return(0,P.r3)(this.cache_,e)?this.cache_[e]:null}remove(e){delete this.cache_[e]}}const Tg=function(n){try{if("undefined"!=typeof window&&void 0!==window[n]){const e=window[n];return e.setItem("firebase:sentinel","cache"),e.removeItem("firebase:sentinel"),new wy(e)}}catch(e){}return new Md},nr=Tg("localStorage"),tu=Tg("sessionStorage"),Xi=new vs.Yd("@firebase/database"),Es=function(){let n=1;return function(){return n++}}(),_f=function(n){const e=(0,P.dS)(n),t=new P.gQ;t.update(e);const r=t.digest();return P.US.encodeByteArray(r)},Vu=function(...n){let e="";for(let t=0;t<n.length;t++){const r=n[t];Array.isArray(r)||r&&"object"==typeof r&&"number"==typeof r.length?e+=Vu.apply(null,r):e+="object"==typeof r?(0,P.Pz)(r):r,e+=" "}return e};let aa=null,Ag=!0;const ws=function(n,e){(0,P.hu)(!e||!0===n||!1===n,"Can't turn on custom loggers persistently."),!0===n?(Xi.logLevel=vs.in.VERBOSE,aa=Xi.log.bind(Xi),e&&tu.set("logging_enabled",!0)):"function"==typeof n?aa=n:(aa=null,tu.remove("logging_enabled"))},un=function(...n){if(!0===Ag&&(Ag=!1,null===aa&&!0===tu.get("logging_enabled")&&ws(!0)),aa){const e=Vu.apply(null,n);aa(e)}},ua=function(n){return function(...e){un(n,...e)}},yf=function(...n){const e="FIREBASE INTERNAL ERROR: "+Vu(...n);Xi.error(e)},Is=function(...n){const e=`FIREBASE FATAL ERROR: ${Vu(...n)}`;throw Xi.error(e),new Error(e)},rr=function(...n){const e="FIREBASE WARNING: "+Vu(...n);Xi.warn(e)},fr=function(n){return"number"==typeof n&&(n!=n||n===Number.POSITIVE_INFINITY||n===Number.NEGATIVE_INFINITY)},Mi="[MIN_NAME]",Cs="[MAX_NAME]",ii=function(n,e){if(n===e)return 0;if(n===Mi||e===Cs)return-1;if(e===Mi||n===Cs)return 1;{const t=v(n),r=v(e);return null!==t?null!==r?t-r==0?n.length-e.length:t-r:-1:null!==r?1:n<e?-1:1}},qs=function(n,e){return n===e?0:n<e?-1:1},la=function(n,e){if(e&&n in e)return e[n];throw new Error("Missing required key ("+n+") in object: "+(0,P.Pz)(e))},sc=function(n){if("object"!=typeof n||null===n)return(0,P.Pz)(n);const e=[];for(const r in n)e.push(r);e.sort();let t="{";for(let r=0;r<e.length;r++)0!==r&&(t+=","),t+=(0,P.Pz)(e[r]),t+=":",t+=sc(n[e[r]]);return t+="}",t},Sg=function(n,e){const t=n.length;if(t<=e)return[n];const r=[];for(let o=0;o<t;o+=e)r.push(n.substring(o,o+e>t?t:o+e));return r};function Sn(n,e){for(const t in n)n.hasOwnProperty(t)&&e(t,n[t])}const xg=function(n){(0,P.hu)(!fr(n),"Invalid JSON number");const r=1023;let o,u,c,g,E;0===n?(u=0,c=0,o=1/n==-1/0?1:0):(o=n<0,(n=Math.abs(n))>=Math.pow(2,1-r)?(g=Math.min(Math.floor(Math.log(n)/Math.LN2),r),u=g+r,c=Math.round(n*Math.pow(2,52-g)-Math.pow(2,52))):(u=0,c=Math.round(n/Math.pow(2,-1074))));const I=[];for(E=52;E;E-=1)I.push(c%2?1:0),c=Math.floor(c/2);for(E=11;E;E-=1)I.push(u%2?1:0),u=Math.floor(u/2);I.push(o?1:0),I.reverse();const S=I.join("");let M="";for(E=0;E<64;E+=8){let F=parseInt(S.substr(E,8),2).toString(16);1===F.length&&(F="0"+F),M+=F}return M.toLowerCase()},m=new RegExp("^-?(0*)\\d{1,10}$"),h=-2147483648,f=2147483647,v=function(n){if(m.test(n)){const e=Number(n);if(e>=h&&e<=f)return e}return null},b=function(n){try{n()}catch(e){setTimeout(()=>{throw rr("Exception was thrown by user callback.",e.stack||""),e},Math.floor(0))}},U=function(n,e){const t=setTimeout(n,e);return"object"==typeof t&&t.unref&&t.unref(),t};class te{constructor(e,t){this.appName_=e,this.appCheckProvider=t,this.appCheck=null==t?void 0:t.getImmediate({optional:!0}),this.appCheck||null==t||t.get().then(r=>this.appCheck=r)}getToken(e){return this.appCheck?this.appCheck.getToken(e):new Promise((t,r)=>{setTimeout(()=>{this.appCheck?this.getToken(e).then(t,r):t(null)},0)})}addTokenChangeListener(e){var t;null===(t=this.appCheckProvider)||void 0===t||t.get().then(r=>r.addTokenListener(e))}notifyForInvalidToken(){rr(`Provided AppCheck credentials for the app named "${this.appName_}" are invalid. This usually indicates your app was not initialized correctly.`)}}class Pe{constructor(e,t,r){this.appName_=e,this.firebaseOptions_=t,this.authProvider_=r,this.auth_=null,this.auth_=r.getImmediate({optional:!0}),this.auth_||r.onInit(o=>this.auth_=o)}getToken(e){return this.auth_?this.auth_.getToken(e).catch(t=>t&&"auth/token-not-initialized"===t.code?(un("Got auth/token-not-initialized error.  Treating as null token."),null):Promise.reject(t)):new Promise((t,r)=>{setTimeout(()=>{this.auth_?this.getToken(e).then(t,r):t(null)},0)})}addTokenChangeListener(e){this.auth_?this.auth_.addAuthTokenListener(e):this.authProvider_.get().then(t=>t.addAuthTokenListener(e))}removeTokenChangeListener(e){this.authProvider_.get().then(t=>t.removeAuthTokenListener(e))}notifyForInvalidToken(){let e='Provided authentication credentials for the app named "'+this.appName_+'" are invalid. This usually indicates your app was not initialized correctly. ';e+="credential"in this.firebaseOptions_?'Make sure the "credential" property provided to initializeApp() is authorized to access the specified "databaseURL" and is from the correct project.':"serviceAccount"in this.firebaseOptions_?'Make sure the "serviceAccount" property provided to initializeApp() is authorized to access the specified "databaseURL" and is from the correct project.':'Make sure the "apiKey" and "databaseURL" properties provided to initializeApp() match the values provided for your app at https://console.firebase.google.com/.',rr(e)}}let Se=(()=>{class n{constructor(t){this.accessToken=t}getToken(t){return Promise.resolve({accessToken:this.accessToken})}addTokenChangeListener(t){t(this.accessToken)}removeTokenChangeListener(t){}notifyForInvalidToken(){}}return n.OWNER="owner",n})();const oc=/(console\.firebase|firebase-console-\w+\.corp|firebase\.corp)\.google\.com/,Bu="websocket",Nd="long_polling";class nu{constructor(e,t,r,o,u=!1,c="",g=!1){this.secure=t,this.namespace=r,this.webSocketOnly=o,this.nodeAdmin=u,this.persistenceKey=c,this.includeNamespaceInQueryParams=g,this._host=e.toLowerCase(),this._domain=this._host.substr(this._host.indexOf(".")+1),this.internalHost=nr.get("host:"+e)||this._host}isCacheableHost(){return"s-"===this.internalHost.substr(0,2)}isCustomHost(){return"firebaseio.com"!==this._domain&&"firebaseio-demo.com"!==this._domain}get host(){return this._host}set host(e){e!==this.internalHost&&(this.internalHost=e,this.isCacheableHost()&&nr.set("host:"+this._host,this.internalHost))}toString(){let e=this.toURLString();return this.persistenceKey&&(e+="<"+this.persistenceKey+">"),e}toURLString(){return`${this.secure?"https://":"http://"}${this.host}/${this.includeNamespaceInQueryParams?`?ns=${this.namespace}`:""}`}}function Rd(n,e,t){let r;if((0,P.hu)("string"==typeof e,"typeof type must == string"),(0,P.hu)("object"==typeof t,"typeof params must == object"),e===Bu)r=(n.secure?"wss://":"ws://")+n.internalHost+"/.ws?";else{if(e!==Nd)throw new Error("Unknown connection type: "+e);r=(n.secure?"https://":"http://")+n.internalHost+"/.lp?"}(function Uu(n){return n.host!==n.internalHost||n.isCustomHost()||n.includeNamespaceInQueryParams})(n)&&(t.ns=n.namespace);const o=[];return Sn(t,(u,c)=>{o.push(u+"="+c)}),r+o.join("&")}class wf{constructor(){this.counters_={}}incrementCounter(e,t=1){(0,P.r3)(this.counters_,e)||(this.counters_[e]=0),this.counters_[e]+=t}get(){return(0,P.p$)(this.counters_)}}const ju={},lc={};function cc(n){const e=n.toString();return ju[e]||(ju[e]=new wf),ju[e]}class O0{constructor(e){this.onMessage_=e,this.pendingResponses=[],this.currentResponseNum=0,this.closeAfterResponse=-1,this.onClose=null}closeAfter(e,t){this.closeAfterResponse=e,this.onClose=t,this.closeAfterResponse<this.currentResponseNum&&(this.onClose(),this.onClose=null)}handleResponse(e,t){for(this.pendingResponses[e]=t;this.pendingResponses[this.currentResponseNum];){const r=this.pendingResponses[this.currentResponseNum];delete this.pendingResponses[this.currentResponseNum];for(let o=0;o<r.length;++o)r[o]&&b(()=>{this.onMessage_(r[o])});if(this.currentResponseNum===this.closeAfterResponse){this.onClose&&(this.onClose(),this.onClose=null);break}this.currentResponseNum++}}}class Pd{constructor(e,t,r,o,u,c,g){this.connId=e,this.repoInfo=t,this.applicationId=r,this.appCheckToken=o,this.authToken=u,this.transportSessionId=c,this.lastSessionId=g,this.bytesSent=0,this.bytesReceived=0,this.everConnected_=!1,this.log_=ua(e),this.stats_=cc(t),this.urlFn=E=>(this.appCheckToken&&(E.ac=this.appCheckToken),Rd(t,Nd,E))}open(e,t){this.curSegmentNum=0,this.onDisconnect_=t,this.myPacketOrderer=new O0(e),this.isClosed_=!1,this.connectTimeoutTimer_=setTimeout(()=>{this.log_("Timed out trying to connect."),this.onClosed_(),this.connectTimeoutTimer_=null},Math.floor(3e4)),function(n){if((0,P.Yr)()||"complete"===document.readyState)n();else{let e=!1;const t=function(){document.body?e||(e=!0,n()):setTimeout(t,Math.floor(10))};document.addEventListener?(document.addEventListener("DOMContentLoaded",t,!1),window.addEventListener("load",t,!1)):document.attachEvent&&(document.attachEvent("onreadystatechange",()=>{"complete"===document.readyState&&t()}),window.attachEvent("onload",t))}}(()=>{if(this.isClosed_)return;this.scriptTagHolder=new Mg((...u)=>{const[c,g,E,I,S]=u;if(this.incrementIncomingBytes_(u),this.scriptTagHolder)if(this.connectTimeoutTimer_&&(clearTimeout(this.connectTimeoutTimer_),this.connectTimeoutTimer_=null),this.everConnected_=!0,"start"===c)this.id=g,this.password=E;else{if("close"!==c)throw new Error("Unrecognized command received: "+c);g?(this.scriptTagHolder.sendNewPolls=!1,this.myPacketOrderer.closeAfter(g,()=>{this.onClosed_()})):this.onClosed_()}},(...u)=>{const[c,g]=u;this.incrementIncomingBytes_(u),this.myPacketOrderer.handleResponse(c,g)},()=>{this.onClosed_()},this.urlFn);const r={start:"t"};r.ser=Math.floor(1e8*Math.random()),this.scriptTagHolder.uniqueCallbackIdentifier&&(r.cb=this.scriptTagHolder.uniqueCallbackIdentifier),r.v="5",this.transportSessionId&&(r.s=this.transportSessionId),this.lastSessionId&&(r.ls=this.lastSessionId),this.applicationId&&(r.p=this.applicationId),this.appCheckToken&&(r.ac=this.appCheckToken),"undefined"!=typeof location&&location.hostname&&oc.test(location.hostname)&&(r.r="f");const o=this.urlFn(r);this.log_("Connecting via long-poll to "+o),this.scriptTagHolder.addTag(o,()=>{})})}start(){this.scriptTagHolder.startLongPoll(this.id,this.password),this.addDisconnectPingFrame(this.id,this.password)}static forceAllow(){Pd.forceAllow_=!0}static forceDisallow(){Pd.forceDisallow_=!0}static isAvailable(){return!((0,P.Yr)()||!Pd.forceAllow_&&(Pd.forceDisallow_||"undefined"==typeof document||null==document.createElement||"object"==typeof window&&window.chrome&&window.chrome.extension&&!/^chrome/.test(window.location.href)||"object"==typeof Windows&&"object"==typeof Windows.UI))}markConnectionHealthy(){}shutdown_(){this.isClosed_=!0,this.scriptTagHolder&&(this.scriptTagHolder.close(),this.scriptTagHolder=null),this.myDisconnFrame&&(document.body.removeChild(this.myDisconnFrame),this.myDisconnFrame=null),this.connectTimeoutTimer_&&(clearTimeout(this.connectTimeoutTimer_),this.connectTimeoutTimer_=null)}onClosed_(){this.isClosed_||(this.log_("Longpoll is closing itself"),this.shutdown_(),this.onDisconnect_&&(this.onDisconnect_(this.everConnected_),this.onDisconnect_=null))}close(){this.isClosed_||(this.log_("Longpoll is being closed."),this.shutdown_())}send(e){const t=(0,P.Pz)(e);this.bytesSent+=t.length,this.stats_.incrementCounter("bytes_sent",t.length);const r=(0,P.h$)(t),o=Sg(r,1840);for(let u=0;u<o.length;u++)this.scriptTagHolder.enqueueSegment(this.curSegmentNum,o.length,o[u]),this.curSegmentNum++}addDisconnectPingFrame(e,t){if((0,P.Yr)())return;this.myDisconnFrame=document.createElement("iframe");const r={dframe:"t"};r.id=e,r.pw=t,this.myDisconnFrame.src=this.urlFn(r),this.myDisconnFrame.style.display="none",document.body.appendChild(this.myDisconnFrame)}incrementIncomingBytes_(e){const t=(0,P.Pz)(e).length;this.bytesReceived+=t,this.stats_.incrementCounter("bytes_received",t)}}class Mg{constructor(e,t,r,o){if(this.onDisconnect=r,this.urlFn=o,this.outstandingRequests=new Set,this.pendingSegs=[],this.currentSerial=Math.floor(1e8*Math.random()),this.sendNewPolls=!0,(0,P.Yr)())this.commandCB=e,this.onMessageCB=t;else{this.uniqueCallbackIdentifier=Es(),window["pLPCommand"+this.uniqueCallbackIdentifier]=e,window["pRTLPCB"+this.uniqueCallbackIdentifier]=t,this.myIFrame=Mg.createIFrame_();let u="";this.myIFrame.src&&"javascript:"===this.myIFrame.src.substr(0,"javascript:".length)&&(u='<script>document.domain="'+document.domain+'";<\/script>');const c="<html><body>"+u+"</body></html>";try{this.myIFrame.doc.open(),this.myIFrame.doc.write(c),this.myIFrame.doc.close()}catch(g){un("frame writing exception"),g.stack&&un(g.stack),un(g)}}}static createIFrame_(){const e=document.createElement("iframe");if(e.style.display="none",!document.body)throw"Document body has not initialized. Wait to initialize Firebase until after the document is ready.";document.body.appendChild(e);try{e.contentWindow.document||un("No IE domain setting required")}catch(t){const r=document.domain;e.src="javascript:void((function(){document.open();document.domain='"+r+"';document.close();})())"}return e.contentDocument?e.doc=e.contentDocument:e.contentWindow?e.doc=e.contentWindow.document:e.document&&(e.doc=e.document),e}close(){this.alive=!1,this.myIFrame&&(this.myIFrame.doc.body.innerHTML="",setTimeout(()=>{null!==this.myIFrame&&(document.body.removeChild(this.myIFrame),this.myIFrame=null)},Math.floor(0)));const e=this.onDisconnect;e&&(this.onDisconnect=null,e())}startLongPoll(e,t){for(this.myID=e,this.myPW=t,this.alive=!0;this.newRequest_(););}newRequest_(){if(this.alive&&this.sendNewPolls&&this.outstandingRequests.size<(this.pendingSegs.length>0?2:1)){this.currentSerial++;const e={};e.id=this.myID,e.pw=this.myPW,e.ser=this.currentSerial;let t=this.urlFn(e),r="",o=0;for(;this.pendingSegs.length>0&&this.pendingSegs[0].d.length+30+r.length<=1870;){const c=this.pendingSegs.shift();r=r+"&seg"+o+"="+c.seg+"&ts"+o+"="+c.ts+"&d"+o+"="+c.d,o++}return t+=r,this.addLongPollTag_(t,this.currentSerial),!0}return!1}enqueueSegment(e,t,r){this.pendingSegs.push({seg:e,ts:t,d:r}),this.alive&&this.newRequest_()}addLongPollTag_(e,t){this.outstandingRequests.add(t);const r=()=>{this.outstandingRequests.delete(t),this.newRequest_()},o=setTimeout(r,Math.floor(25e3));this.addTag(e,()=>{clearTimeout(o),r()})}addTag(e,t){(0,P.Yr)()?this.doNodeLongPoll(e,t):setTimeout(()=>{try{if(!this.sendNewPolls)return;const r=this.myIFrame.doc.createElement("script");r.type="text/javascript",r.async=!0,r.src=e,r.onload=r.onreadystatechange=function(){const o=r.readyState;(!o||"loaded"===o||"complete"===o)&&(r.onload=r.onreadystatechange=null,r.parentNode&&r.parentNode.removeChild(r),t())},r.onerror=()=>{un("Long-poll script failed to load: "+e),this.sendNewPolls=!1,this.close()},this.myIFrame.doc.body.appendChild(r)}catch(r){}},Math.floor(1))}}let If=null;"undefined"!=typeof MozWebSocket?If=MozWebSocket:"undefined"!=typeof WebSocket&&(If=WebSocket);let _t=(()=>{class n{constructor(t,r,o,u,c,g,E){this.connId=t,this.applicationId=o,this.appCheckToken=u,this.authToken=c,this.keepaliveTimer=null,this.frames=null,this.totalFrames=0,this.bytesSent=0,this.bytesReceived=0,this.log_=ua(this.connId),this.stats_=cc(r),this.connURL=n.connectionURL_(r,g,E,u),this.nodeAdmin=r.nodeAdmin}static connectionURL_(t,r,o,u){const c={v:"5"};return!(0,P.Yr)()&&"undefined"!=typeof location&&location.hostname&&oc.test(location.hostname)&&(c.r="f"),r&&(c.s=r),o&&(c.ls=o),u&&(c.ac=u),Rd(t,Bu,c)}open(t,r){this.onDisconnect=r,this.onMessage=t,this.log_("Websocket connecting to "+this.connURL),this.everConnected_=!1,nr.set("previous_websocket_failure",!0);try{if((0,P.Yr)()){const u={headers:{"User-Agent":`Firebase/5/${rc}/${process.platform}/${this.nodeAdmin?"AdminNode":"Node"}`,"X-Firebase-GMPID":this.applicationId||""}};this.authToken&&(u.headers.Authorization=`Bearer ${this.authToken}`),this.appCheckToken&&(u.headers["X-Firebase-AppCheck"]=this.appCheckToken);const c=process.env,g=0===this.connURL.indexOf("wss://")?c.HTTPS_PROXY||c.https_proxy:c.HTTP_PROXY||c.http_proxy;g&&(u.proxy={origin:g}),this.mySock=new If(this.connURL,[],u)}else this.mySock=new If(this.connURL,[],{headers:{"X-Firebase-GMPID":this.applicationId||"","X-Firebase-AppCheck":this.appCheckToken||""}})}catch(o){this.log_("Error instantiating WebSocket.");const u=o.message||o.data;return u&&this.log_(u),void this.onClosed_()}this.mySock.onopen=()=>{this.log_("Websocket connected."),this.everConnected_=!0},this.mySock.onclose=()=>{this.log_("Websocket connection was disconnected."),this.mySock=null,this.onClosed_()},this.mySock.onmessage=o=>{this.handleIncomingFrame(o)},this.mySock.onerror=o=>{this.log_("WebSocket error.  Closing connection.");const u=o.message||o.data;u&&this.log_(u),this.onClosed_()}}start(){}static forceDisallow(){n.forceDisallow_=!0}static isAvailable(){let t=!1;if("undefined"!=typeof navigator&&navigator.userAgent){const o=navigator.userAgent.match(/Android ([0-9]{0,}\.[0-9]{0,})/);o&&o.length>1&&parseFloat(o[1])<4.4&&(t=!0)}return!t&&null!==If&&!n.forceDisallow_}static previouslyFailed(){return nr.isInMemoryStorage||!0===nr.get("previous_websocket_failure")}markConnectionHealthy(){nr.remove("previous_websocket_failure")}appendFrame_(t){if(this.frames.push(t),this.frames.length===this.totalFrames){const r=this.frames.join("");this.frames=null;const o=(0,P.cI)(r);this.onMessage(o)}}handleNewFrameCount_(t){this.totalFrames=t,this.frames=[]}extractFrameCount_(t){if((0,P.hu)(null===this.frames,"We already have a frame buffer"),t.length<=6){const r=Number(t);if(!isNaN(r))return this.handleNewFrameCount_(r),null}return this.handleNewFrameCount_(1),t}handleIncomingFrame(t){if(null===this.mySock)return;const r=t.data;if(this.bytesReceived+=r.length,this.stats_.incrementCounter("bytes_received",r.length),this.resetKeepAlive(),null!==this.frames)this.appendFrame_(r);else{const o=this.extractFrameCount_(r);null!==o&&this.appendFrame_(o)}}send(t){this.resetKeepAlive();const r=(0,P.Pz)(t);this.bytesSent+=r.length,this.stats_.incrementCounter("bytes_sent",r.length);const o=Sg(r,16384);o.length>1&&this.sendString_(String(o.length));for(let u=0;u<o.length;u++)this.sendString_(o[u])}shutdown_(){this.isClosed_=!0,this.keepaliveTimer&&(clearInterval(this.keepaliveTimer),this.keepaliveTimer=null),this.mySock&&(this.mySock.close(),this.mySock=null)}onClosed_(){this.isClosed_||(this.log_("WebSocket is closing itself"),this.shutdown_(),this.onDisconnect&&(this.onDisconnect(this.everConnected_),this.onDisconnect=null))}close(){this.isClosed_||(this.log_("WebSocket is being closed"),this.shutdown_())}resetKeepAlive(){clearInterval(this.keepaliveTimer),this.keepaliveTimer=setInterval(()=>{this.mySock&&this.sendString_("0"),this.resetKeepAlive()},Math.floor(45e3))}sendString_(t){try{this.mySock.send(t)}catch(r){this.log_("Exception thrown from WebSocket.send():",r.message||r.data,"Closing connection."),setTimeout(this.onClosed_.bind(this),0)}}}return n.responsesRequiredToBeHealthy=2,n.healthyTimeout=3e4,n})();class Ng{constructor(e){this.initTransports_(e)}static get ALL_TRANSPORTS(){return[Pd,_t]}initTransports_(e){const t=_t&&_t.isAvailable();let r=t&&!_t.previouslyFailed();if(e.webSocketOnly&&(t||rr("wss:// URL used, but browser isn't known to support websockets.  Trying anyway."),r=!0),r)this.transports_=[_t];else{const o=this.transports_=[];for(const u of Ng.ALL_TRANSPORTS)u&&u.isAvailable()&&o.push(u)}}initialTransport(){if(this.transports_.length>0)return this.transports_[0];throw new Error("No transports available")}upgradeTransport(){return this.transports_.length>1?this.transports_[1]:null}}class Cf{constructor(e,t,r,o,u,c,g,E,I,S){this.id=e,this.repoInfo_=t,this.applicationId_=r,this.appCheckToken_=o,this.authToken_=u,this.onMessage_=c,this.onReady_=g,this.onDisconnect_=E,this.onKill_=I,this.lastSessionId=S,this.connectionCount=0,this.pendingDataMessages=[],this.state_=0,this.log_=ua("c:"+this.id+":"),this.transportManager_=new Ng(t),this.log_("Connection created"),this.start_()}start_(){const e=this.transportManager_.initialTransport();this.conn_=new e(this.nextTransportId_(),this.repoInfo_,this.applicationId_,this.appCheckToken_,this.authToken_,null,this.lastSessionId),this.primaryResponsesRequired_=e.responsesRequiredToBeHealthy||0;const t=this.connReceiver_(this.conn_),r=this.disconnReceiver_(this.conn_);this.tx_=this.conn_,this.rx_=this.conn_,this.secondaryConn_=null,this.isHealthy_=!1,setTimeout(()=>{this.conn_&&this.conn_.open(t,r)},Math.floor(0));const o=e.healthyTimeout||0;o>0&&(this.healthyTimeout_=U(()=>{this.healthyTimeout_=null,this.isHealthy_||(this.conn_&&this.conn_.bytesReceived>102400?(this.log_("Connection exceeded healthy timeout but has received "+this.conn_.bytesReceived+" bytes.  Marking connection healthy."),this.isHealthy_=!0,this.conn_.markConnectionHealthy()):this.conn_&&this.conn_.bytesSent>10240?this.log_("Connection exceeded healthy timeout but has sent "+this.conn_.bytesSent+" bytes.  Leaving connection alive."):(this.log_("Closing unhealthy connection after timeout."),this.close()))},Math.floor(o)))}nextTransportId_(){return"c:"+this.id+":"+this.connectionCount++}disconnReceiver_(e){return t=>{e===this.conn_?this.onConnectionLost_(t):e===this.secondaryConn_?(this.log_("Secondary connection lost."),this.onSecondaryConnectionLost_()):this.log_("closing an old connection")}}connReceiver_(e){return t=>{2!==this.state_&&(e===this.rx_?this.onPrimaryMessageReceived_(t):e===this.secondaryConn_?this.onSecondaryMessageReceived_(t):this.log_("message on old connection"))}}sendRequest(e){this.sendData_({t:"d",d:e})}tryCleanupConnection(){this.tx_===this.secondaryConn_&&this.rx_===this.secondaryConn_&&(this.log_("cleaning up and promoting a connection: "+this.secondaryConn_.connId),this.conn_=this.secondaryConn_,this.secondaryConn_=null)}onSecondaryControl_(e){if("t"in e){const t=e.t;"a"===t?this.upgradeIfSecondaryHealthy_():"r"===t?(this.log_("Got a reset on secondary, closing it"),this.secondaryConn_.close(),(this.tx_===this.secondaryConn_||this.rx_===this.secondaryConn_)&&this.close()):"o"===t&&(this.log_("got pong on secondary."),this.secondaryResponsesRequired_--,this.upgradeIfSecondaryHealthy_())}}onSecondaryMessageReceived_(e){const t=la("t",e),r=la("d",e);if("c"===t)this.onSecondaryControl_(r);else{if("d"!==t)throw new Error("Unknown protocol layer: "+t);this.pendingDataMessages.push(r)}}upgradeIfSecondaryHealthy_(){this.secondaryResponsesRequired_<=0?(this.log_("Secondary connection is healthy."),this.isHealthy_=!0,this.secondaryConn_.markConnectionHealthy(),this.proceedWithUpgrade_()):(this.log_("sending ping on secondary."),this.secondaryConn_.send({t:"c",d:{t:"p",d:{}}}))}proceedWithUpgrade_(){this.secondaryConn_.start(),this.log_("sending client ack on secondary"),this.secondaryConn_.send({t:"c",d:{t:"a",d:{}}}),this.log_("Ending transmission on primary"),this.conn_.send({t:"c",d:{t:"n",d:{}}}),this.tx_=this.secondaryConn_,this.tryCleanupConnection()}onPrimaryMessageReceived_(e){const t=la("t",e),r=la("d",e);"c"===t?this.onControl_(r):"d"===t&&this.onDataMessage_(r)}onDataMessage_(e){this.onPrimaryResponse_(),this.onMessage_(e)}onPrimaryResponse_(){this.isHealthy_||(this.primaryResponsesRequired_--,this.primaryResponsesRequired_<=0&&(this.log_("Primary connection is healthy."),this.isHealthy_=!0,this.conn_.markConnectionHealthy()))}onControl_(e){const t=la("t",e);if("d"in e){const r=e.d;if("h"===t)this.onHandshake_(r);else if("n"===t){this.log_("recvd end transmission on primary"),this.rx_=this.secondaryConn_;for(let o=0;o<this.pendingDataMessages.length;++o)this.onDataMessage_(this.pendingDataMessages[o]);this.pendingDataMessages=[],this.tryCleanupConnection()}else"s"===t?this.onConnectionShutdown_(r):"r"===t?this.onReset_(r):"e"===t?yf("Server Error: "+r):"o"===t?(this.log_("got pong on primary."),this.onPrimaryResponse_(),this.sendPingOnPrimaryIfNecessary_()):yf("Unknown control packet command: "+t)}}onHandshake_(e){const t=e.ts,r=e.v,o=e.h;this.sessionId=e.s,this.repoInfo_.host=o,0===this.state_&&(this.conn_.start(),this.onConnectionEstablished_(this.conn_,t),"5"!==r&&rr("Protocol version mismatch detected"),this.tryStartUpgrade_())}tryStartUpgrade_(){const e=this.transportManager_.upgradeTransport();e&&this.startUpgrade_(e)}startUpgrade_(e){this.secondaryConn_=new e(this.nextTransportId_(),this.repoInfo_,this.applicationId_,this.appCheckToken_,this.authToken_,this.sessionId),this.secondaryResponsesRequired_=e.responsesRequiredToBeHealthy||0;const t=this.connReceiver_(this.secondaryConn_),r=this.disconnReceiver_(this.secondaryConn_);this.secondaryConn_.open(t,r),U(()=>{this.secondaryConn_&&(this.log_("Timed out trying to upgrade."),this.secondaryConn_.close())},Math.floor(6e4))}onReset_(e){this.log_("Reset packet received.  New host: "+e),this.repoInfo_.host=e,1===this.state_?this.close():(this.closeConnections_(),this.start_())}onConnectionEstablished_(e,t){this.log_("Realtime connection established."),this.conn_=e,this.state_=1,this.onReady_&&(this.onReady_(t,this.sessionId),this.onReady_=null),0===this.primaryResponsesRequired_?(this.log_("Primary connection is healthy."),this.isHealthy_=!0):U(()=>{this.sendPingOnPrimaryIfNecessary_()},Math.floor(5e3))}sendPingOnPrimaryIfNecessary_(){!this.isHealthy_&&1===this.state_&&(this.log_("sending ping on primary."),this.sendData_({t:"c",d:{t:"p",d:{}}}))}onSecondaryConnectionLost_(){const e=this.secondaryConn_;this.secondaryConn_=null,(this.tx_===e||this.rx_===e)&&this.close()}onConnectionLost_(e){this.conn_=null,e||0!==this.state_?1===this.state_&&this.log_("Realtime connection lost."):(this.log_("Realtime connection failed."),this.repoInfo_.isCacheableHost()&&(nr.remove("host:"+this.repoInfo_.host),this.repoInfo_.internalHost=this.repoInfo_.host)),this.close()}onConnectionShutdown_(e){this.log_("Connection shutdown command received. Shutting down..."),this.onKill_&&(this.onKill_(e),this.onKill_=null),this.onDisconnect_=null,this.close()}sendData_(e){if(1!==this.state_)throw"Connection is not connected";this.tx_.send(e)}close(){2!==this.state_&&(this.log_("Closing realtime connection."),this.state_=2,this.closeConnections_(),this.onDisconnect_&&(this.onDisconnect_(),this.onDisconnect_=null))}closeConnections_(){this.log_("Shutting down all connections"),this.conn_&&(this.conn_.close(),this.conn_=null),this.secondaryConn_&&(this.secondaryConn_.close(),this.secondaryConn_=null),this.healthyTimeout_&&(clearTimeout(this.healthyTimeout_),this.healthyTimeout_=null)}}class Df{put(e,t,r,o){}merge(e,t,r,o){}refreshAuthToken(e){}refreshAppCheckToken(e){}onDisconnectPut(e,t,r){}onDisconnectMerge(e,t,r){}onDisconnectCancel(e,t){}reportStats(e){}}class kg{constructor(e){this.allowedEvents_=e,this.listeners_={},(0,P.hu)(Array.isArray(e)&&e.length>0,"Requires a non-empty array")}trigger(e,...t){if(Array.isArray(this.listeners_[e])){const r=[...this.listeners_[e]];for(let o=0;o<r.length;o++)r[o].callback.apply(r[o].context,t)}}on(e,t,r){this.validateEventType_(e),this.listeners_[e]=this.listeners_[e]||[],this.listeners_[e].push({callback:t,context:r});const o=this.getInitialEvent(e);o&&t.apply(r,o)}off(e,t,r){this.validateEventType_(e);const o=this.listeners_[e]||[];for(let u=0;u<o.length;u++)if(o[u].callback===t&&(!r||r===o[u].context))return void o.splice(u,1)}validateEventType_(e){(0,P.hu)(this.allowedEvents_.find(t=>t===e),"Unknown event: "+e)}}class Od extends kg{constructor(){super(["online"]),this.online_=!0,"undefined"!=typeof window&&void 0!==window.addEventListener&&!(0,P.uI)()&&(window.addEventListener("online",()=>{this.online_||(this.online_=!0,this.trigger("online",!0))},!1),window.addEventListener("offline",()=>{this.online_&&(this.online_=!1,this.trigger("online",!1))},!1))}static getInstance(){return new Od}getInitialEvent(e){return(0,P.hu)("online"===e,"Unknown event type: "+e),[this.online_]}currentlyOnline(){return this.online_}}class nn{constructor(e,t){if(void 0===t){this.pieces_=e.split("/");let r=0;for(let o=0;o<this.pieces_.length;o++)this.pieces_[o].length>0&&(this.pieces_[r]=this.pieces_[o],r++);this.pieces_.length=r,this.pieceNum_=0}else this.pieces_=e,this.pieceNum_=t}toString(){let e="";for(let t=this.pieceNum_;t<this.pieces_.length;t++)""!==this.pieces_[t]&&(e+="/"+this.pieces_[t]);return e||"/"}}function Kt(){return new nn("")}function Mt(n){return n.pieceNum_>=n.pieces_.length?null:n.pieces_[n.pieceNum_]}function Hu(n){return n.pieces_.length-n.pieceNum_}function dn(n){let e=n.pieceNum_;return e<n.pieces_.length&&e++,new nn(n.pieces_,e)}function H0(n){return n.pieceNum_<n.pieces_.length?n.pieces_[n.pieces_.length-1]:null}function Lg(n,e=0){return n.pieces_.slice(n.pieceNum_+e)}function Py(n){if(n.pieceNum_>=n.pieces_.length)return null;const e=[];for(let t=n.pieceNum_;t<n.pieces_.length-1;t++)e.push(n.pieces_[t]);return new nn(e,0)}function Cn(n,e){const t=[];for(let r=n.pieceNum_;r<n.pieces_.length;r++)t.push(n.pieces_[r]);if(e instanceof nn)for(let r=e.pieceNum_;r<e.pieces_.length;r++)t.push(e.pieces_[r]);else{const r=e.split("/");for(let o=0;o<r.length;o++)r[o].length>0&&t.push(r[o])}return new nn(t,0)}function Nt(n){return n.pieceNum_>=n.pieces_.length}function zr(n,e){const t=Mt(n),r=Mt(e);if(null===t)return e;if(t===r)return zr(dn(n),dn(e));throw new Error("INTERNAL ERROR: innerPath ("+e+") is not within outerPath ("+n+")")}function aM(n,e){const t=Lg(n,0),r=Lg(e,0);for(let o=0;o<t.length&&o<r.length;o++){const u=ii(t[o],r[o]);if(0!==u)return u}return t.length===r.length?0:t.length<r.length?-1:1}function G0(n,e){if(Hu(n)!==Hu(e))return!1;for(let t=n.pieceNum_,r=e.pieceNum_;t<=n.pieces_.length;t++,r++)if(n.pieces_[t]!==e.pieces_[r])return!1;return!0}function yo(n,e){let t=n.pieceNum_,r=e.pieceNum_;if(Hu(n)>Hu(e))return!1;for(;t<n.pieces_.length;){if(n.pieces_[t]!==e.pieces_[r])return!1;++t,++r}return!0}class uM{constructor(e,t){this.errorPrefix_=t,this.parts_=Lg(e,0),this.byteLength_=Math.max(1,this.parts_.length);for(let r=0;r<this.parts_.length;r++)this.byteLength_+=(0,P.ug)(this.parts_[r]);rb(this)}}function rb(n){if(n.byteLength_>768)throw new Error(n.errorPrefix_+"has a key path longer than 768 bytes ("+n.byteLength_+").");if(n.parts_.length>32)throw new Error(n.errorPrefix_+"path specified exceeds the maximum depth that can be written (32) or object contains a cycle "+kd(n))}function kd(n){return 0===n.parts_.length?"":"in property '"+n.parts_.join(".")+"'"}class $0 extends kg{constructor(){let e,t;super(["visible"]),"undefined"!=typeof document&&void 0!==document.addEventListener&&(void 0!==document.hidden?(t="visibilitychange",e="hidden"):void 0!==document.mozHidden?(t="mozvisibilitychange",e="mozHidden"):void 0!==document.msHidden?(t="msvisibilitychange",e="msHidden"):void 0!==document.webkitHidden&&(t="webkitvisibilitychange",e="webkitHidden")),this.visible_=!0,t&&document.addEventListener(t,()=>{const r=!document[e];r!==this.visible_&&(this.visible_=r,this.trigger("visible",r))},!1)}static getInstance(){return new $0}getInitialEvent(e){return(0,P.hu)("visible"===e,"Unknown event type: "+e),[this.visible_]}}const Vg=1e3;let Ug,dc=(()=>{class n extends Df{constructor(t,r,o,u,c,g,E,I){if(super(),this.repoInfo_=t,this.applicationId_=r,this.onDataUpdate_=o,this.onConnectStatus_=u,this.onServerInfoUpdate_=c,this.authTokenProvider_=g,this.appCheckTokenProvider_=E,this.authOverride_=I,this.id=n.nextPersistentConnectionId_++,this.log_=ua("p:"+this.id+":"),this.interruptReasons_={},this.listens=new Map,this.outstandingPuts_=[],this.outstandingGets_=[],this.outstandingPutCount_=0,this.outstandingGetCount_=0,this.onDisconnectRequestQueue_=[],this.connected_=!1,this.reconnectDelay_=Vg,this.maxReconnectDelay_=3e5,this.securityDebugCallback_=null,this.lastSessionId=null,this.establishConnectionTimer_=null,this.visible_=!1,this.requestCBHash_={},this.requestNumber_=0,this.realtime_=null,this.authToken_=null,this.appCheckToken_=null,this.forceTokenRefresh_=!1,this.invalidAuthTokenCount_=0,this.invalidAppCheckTokenCount_=0,this.firstConnection_=!0,this.lastConnectionAttemptTime_=null,this.lastConnectionEstablishedTime_=null,I&&!(0,P.Yr)())throw new Error("Auth override specified in options, but not supported on non Node.js platforms");$0.getInstance().on("visible",this.onVisible_,this),-1===t.host.indexOf("fblocal")&&Od.getInstance().on("online",this.onOnline_,this)}sendRequest(t,r,o){const u=++this.requestNumber_,c={r:u,a:t,b:r};this.log_((0,P.Pz)(c)),(0,P.hu)(this.connected_,"sendRequest call when we're not connected not allowed."),this.realtime_.sendRequest(c),o&&(this.requestCBHash_[u]=o)}get(t){this.initConnection_();const r=new P.BH,o={p:t._path.toString(),q:t._queryObject},u={action:"g",request:o,onComplete:g=>{const E=g.d;"ok"===g.s?(this.onDataUpdate_(o.p,E,!1,null),r.resolve(E)):r.reject(E)}};this.outstandingGets_.push(u),this.outstandingGetCount_++;const c=this.outstandingGets_.length-1;return this.connected_||setTimeout(()=>{const g=this.outstandingGets_[c];void 0===g||u!==g||(delete this.outstandingGets_[c],this.outstandingGetCount_--,0===this.outstandingGetCount_&&(this.outstandingGets_=[]),this.log_("get "+c+" timed out on connection"),r.reject(new Error("Client is offline.")))},3e3),this.connected_&&this.sendGet_(c),r.promise}listen(t,r,o,u){this.initConnection_();const c=t._queryIdentifier,g=t._path.toString();this.log_("Listen called for "+g+" "+c),this.listens.has(g)||this.listens.set(g,new Map),(0,P.hu)(t._queryParams.isDefault()||!t._queryParams.loadsAllData(),"listen() called for non-default but complete query"),(0,P.hu)(!this.listens.get(g).has(c),"listen() called twice for same path/queryId.");const E={onComplete:u,hashFn:r,query:t,tag:o};this.listens.get(g).set(c,E),this.connected_&&this.sendListen_(E)}sendGet_(t){const r=this.outstandingGets_[t];this.sendRequest("g",r.request,o=>{delete this.outstandingGets_[t],this.outstandingGetCount_--,0===this.outstandingGetCount_&&(this.outstandingGets_=[]),r.onComplete&&r.onComplete(o)})}sendListen_(t){const r=t.query,o=r._path.toString(),u=r._queryIdentifier;this.log_("Listen on "+o+" for "+u);const c={p:o};t.tag&&(c.q=r._queryObject,c.t=t.tag),c.h=t.hashFn(),this.sendRequest("q",c,E=>{const I=E.d,S=E.s;n.warnOnListenWarnings_(I,r),(this.listens.get(o)&&this.listens.get(o).get(u))===t&&(this.log_("listen response",E),"ok"!==S&&this.removeListen_(o,u),t.onComplete&&t.onComplete(S,I))})}static warnOnListenWarnings_(t,r){if(t&&"object"==typeof t&&(0,P.r3)(t,"w")){const o=(0,P.DV)(t,"w");if(Array.isArray(o)&&~o.indexOf("no_index")){const u='".indexOn": "'+r._queryParams.getIndex().toString()+'"',c=r._path.toString();rr(`Using an unspecified index. Your data will be downloaded and filtered on the client. Consider adding ${u} at ${c} to your security rules for better performance.`)}}}refreshAuthToken(t){this.authToken_=t,this.log_("Auth token refreshed"),this.authToken_?this.tryAuth():this.connected_&&this.sendRequest("unauth",{},()=>{}),this.reduceReconnectDelayIfAdminCredential_(t)}reduceReconnectDelayIfAdminCredential_(t){(t&&40===t.length||(0,P.GJ)(t))&&(this.log_("Admin auth credential detected.  Reducing max reconnect time."),this.maxReconnectDelay_=3e4)}refreshAppCheckToken(t){this.appCheckToken_=t,this.log_("App check token refreshed"),this.appCheckToken_?this.tryAppCheck():this.connected_&&this.sendRequest("unappeck",{},()=>{})}tryAuth(){if(this.connected_&&this.authToken_){const t=this.authToken_,r=(0,P.w9)(t)?"auth":"gauth",o={cred:t};null===this.authOverride_?o.noauth=!0:"object"==typeof this.authOverride_&&(o.authvar=this.authOverride_),this.sendRequest(r,o,u=>{const c=u.s,g=u.d||"error";this.authToken_===t&&("ok"===c?this.invalidAuthTokenCount_=0:this.onAuthRevoked_(c,g))})}}tryAppCheck(){this.connected_&&this.appCheckToken_&&this.sendRequest("appcheck",{token:this.appCheckToken_},t=>{const r=t.s,o=t.d||"error";"ok"===r?this.invalidAppCheckTokenCount_=0:this.onAppCheckRevoked_(r,o)})}unlisten(t,r){const o=t._path.toString(),u=t._queryIdentifier;this.log_("Unlisten called for "+o+" "+u),(0,P.hu)(t._queryParams.isDefault()||!t._queryParams.loadsAllData(),"unlisten() called for non-default but complete query"),this.removeListen_(o,u)&&this.connected_&&this.sendUnlisten_(o,u,t._queryObject,r)}sendUnlisten_(t,r,o,u){this.log_("Unlisten on "+t+" for "+r);const c={p:t};u&&(c.q=o,c.t=u),this.sendRequest("n",c)}onDisconnectPut(t,r,o){this.initConnection_(),this.connected_?this.sendOnDisconnect_("o",t,r,o):this.onDisconnectRequestQueue_.push({pathString:t,action:"o",data:r,onComplete:o})}onDisconnectMerge(t,r,o){this.initConnection_(),this.connected_?this.sendOnDisconnect_("om",t,r,o):this.onDisconnectRequestQueue_.push({pathString:t,action:"om",data:r,onComplete:o})}onDisconnectCancel(t,r){this.initConnection_(),this.connected_?this.sendOnDisconnect_("oc",t,null,r):this.onDisconnectRequestQueue_.push({pathString:t,action:"oc",data:null,onComplete:r})}sendOnDisconnect_(t,r,o,u){const c={p:r,d:o};this.log_("onDisconnect "+t,c),this.sendRequest(t,c,g=>{u&&setTimeout(()=>{u(g.s,g.d)},Math.floor(0))})}put(t,r,o,u){this.putInternal("p",t,r,o,u)}merge(t,r,o,u){this.putInternal("m",t,r,o,u)}putInternal(t,r,o,u,c){this.initConnection_();const g={p:r,d:o};void 0!==c&&(g.h=c),this.outstandingPuts_.push({action:t,request:g,onComplete:u}),this.outstandingPutCount_++,this.connected_?this.sendPut_(this.outstandingPuts_.length-1):this.log_("Buffering put: "+r)}sendPut_(t){const r=this.outstandingPuts_[t].action,o=this.outstandingPuts_[t].request,u=this.outstandingPuts_[t].onComplete;this.outstandingPuts_[t].queued=this.connected_,this.sendRequest(r,o,c=>{this.log_(r+" response",c),delete this.outstandingPuts_[t],this.outstandingPutCount_--,0===this.outstandingPutCount_&&(this.outstandingPuts_=[]),u&&u(c.s,c.d)})}reportStats(t){if(this.connected_){const r={c:t};this.log_("reportStats",r),this.sendRequest("s",r,o=>{"ok"!==o.s&&this.log_("reportStats","Error sending stats: "+o.d)})}}onDataMessage_(t){if("r"in t){this.log_("from server: "+(0,P.Pz)(t));const r=t.r,o=this.requestCBHash_[r];o&&(delete this.requestCBHash_[r],o(t.b))}else{if("error"in t)throw"A server-side error has occurred: "+t.error;"a"in t&&this.onDataPush_(t.a,t.b)}}onDataPush_(t,r){this.log_("handleServerMessage",t,r),"d"===t?this.onDataUpdate_(r.p,r.d,!1,r.t):"m"===t?this.onDataUpdate_(r.p,r.d,!0,r.t):"c"===t?this.onListenRevoked_(r.p,r.q):"ac"===t?this.onAuthRevoked_(r.s,r.d):"apc"===t?this.onAppCheckRevoked_(r.s,r.d):"sd"===t?this.onSecurityDebugPacket_(r):yf("Unrecognized action received from server: "+(0,P.Pz)(t)+"\nAre you using the latest client?")}onReady_(t,r){this.log_("connection ready"),this.connected_=!0,this.lastConnectionEstablishedTime_=(new Date).getTime(),this.handleTimestamp_(t),this.lastSessionId=r,this.firstConnection_&&this.sendConnectStats_(),this.restoreState_(),this.firstConnection_=!1,this.onConnectStatus_(!0)}scheduleConnect_(t){(0,P.hu)(!this.realtime_,"Scheduling a connect when we're already connected/ing?"),this.establishConnectionTimer_&&clearTimeout(this.establishConnectionTimer_),this.establishConnectionTimer_=setTimeout(()=>{this.establishConnectionTimer_=null,this.establishConnection_()},Math.floor(t))}initConnection_(){!this.realtime_&&this.firstConnection_&&this.scheduleConnect_(0)}onVisible_(t){t&&!this.visible_&&this.reconnectDelay_===this.maxReconnectDelay_&&(this.log_("Window became visible.  Reducing delay."),this.reconnectDelay_=Vg,this.realtime_||this.scheduleConnect_(0)),this.visible_=t}onOnline_(t){t?(this.log_("Browser went online."),this.reconnectDelay_=Vg,this.realtime_||this.scheduleConnect_(0)):(this.log_("Browser went offline.  Killing connection."),this.realtime_&&this.realtime_.close())}onRealtimeDisconnect_(){if(this.log_("data client disconnected"),this.connected_=!1,this.realtime_=null,this.cancelSentTransactions_(),this.requestCBHash_={},this.shouldReconnect_()){this.visible_?this.lastConnectionEstablishedTime_&&((new Date).getTime()-this.lastConnectionEstablishedTime_>3e4&&(this.reconnectDelay_=Vg),this.lastConnectionEstablishedTime_=null):(this.log_("Window isn't visible.  Delaying reconnect."),this.reconnectDelay_=this.maxReconnectDelay_,this.lastConnectionAttemptTime_=(new Date).getTime());const t=(new Date).getTime()-this.lastConnectionAttemptTime_;let r=Math.max(0,this.reconnectDelay_-t);r=Math.random()*r,this.log_("Trying to reconnect in "+r+"ms"),this.scheduleConnect_(r),this.reconnectDelay_=Math.min(this.maxReconnectDelay_,1.3*this.reconnectDelay_)}this.onConnectStatus_(!1)}establishConnection_(){var t=this;return(0,pe.Z)(function*(){if(t.shouldReconnect_()){t.log_("Making a connection attempt"),t.lastConnectionAttemptTime_=(new Date).getTime(),t.lastConnectionEstablishedTime_=null;const r=t.onDataMessage_.bind(t),o=t.onReady_.bind(t),u=t.onRealtimeDisconnect_.bind(t),c=t.id+":"+n.nextConnectionId_++,g=t.lastSessionId;let E=!1,I=null;const S=function(){I?I.close():(E=!0,u())};t.realtime_={close:S,sendRequest:function(W){(0,P.hu)(I,"sendRequest call when we're not connected not allowed."),I.sendRequest(W)}};const F=t.forceTokenRefresh_;t.forceTokenRefresh_=!1;try{const[W,Y]=yield Promise.all([t.authTokenProvider_.getToken(F),t.appCheckTokenProvider_.getToken(F)]);E?un("getToken() completed but was canceled"):(un("getToken() completed. Creating connection."),t.authToken_=W&&W.accessToken,t.appCheckToken_=Y&&Y.token,I=new Cf(c,t.repoInfo_,t.applicationId_,t.appCheckToken_,t.authToken_,r,o,u,xe=>{rr(xe+" ("+t.repoInfo_.toString()+")"),t.interrupt("server_kill")},g))}catch(W){t.log_("Failed to get token: "+W),E||(t.repoInfo_.nodeAdmin&&rr(W),S())}}})()}interrupt(t){un("Interrupting connection for reason: "+t),this.interruptReasons_[t]=!0,this.realtime_?this.realtime_.close():(this.establishConnectionTimer_&&(clearTimeout(this.establishConnectionTimer_),this.establishConnectionTimer_=null),this.connected_&&this.onRealtimeDisconnect_())}resume(t){un("Resuming connection for reason: "+t),delete this.interruptReasons_[t],(0,P.xb)(this.interruptReasons_)&&(this.reconnectDelay_=Vg,this.realtime_||this.scheduleConnect_(0))}handleTimestamp_(t){const r=t-(new Date).getTime();this.onServerInfoUpdate_({serverTimeOffset:r})}cancelSentTransactions_(){for(let t=0;t<this.outstandingPuts_.length;t++){const r=this.outstandingPuts_[t];r&&"h"in r.request&&r.queued&&(r.onComplete&&r.onComplete("disconnect"),delete this.outstandingPuts_[t],this.outstandingPutCount_--)}0===this.outstandingPutCount_&&(this.outstandingPuts_=[])}onListenRevoked_(t,r){let o;o=r?r.map(c=>sc(c)).join("$"):"default";const u=this.removeListen_(t,o);u&&u.onComplete&&u.onComplete("permission_denied")}removeListen_(t,r){const o=new nn(t).toString();let u;if(this.listens.has(o)){const c=this.listens.get(o);u=c.get(r),c.delete(r),0===c.size&&this.listens.delete(o)}else u=void 0;return u}onAuthRevoked_(t,r){un("Auth token revoked: "+t+"/"+r),this.authToken_=null,this.forceTokenRefresh_=!0,this.realtime_.close(),("invalid_token"===t||"permission_denied"===t)&&(this.invalidAuthTokenCount_++,this.invalidAuthTokenCount_>=3&&(this.reconnectDelay_=3e4,this.authTokenProvider_.notifyForInvalidToken()))}onAppCheckRevoked_(t,r){un("App check token revoked: "+t+"/"+r),this.appCheckToken_=null,this.forceTokenRefresh_=!0,("invalid_token"===t||"permission_denied"===t)&&(this.invalidAppCheckTokenCount_++,this.invalidAppCheckTokenCount_>=3&&this.appCheckTokenProvider_.notifyForInvalidToken())}onSecurityDebugPacket_(t){this.securityDebugCallback_?this.securityDebugCallback_(t):"msg"in t&&console.log("FIREBASE: "+t.msg.replace("\n","\nFIREBASE: "))}restoreState_(){this.tryAuth(),this.tryAppCheck();for(const t of this.listens.values())for(const r of t.values())this.sendListen_(r);for(let t=0;t<this.outstandingPuts_.length;t++)this.outstandingPuts_[t]&&this.sendPut_(t);for(;this.onDisconnectRequestQueue_.length;){const t=this.onDisconnectRequestQueue_.shift();this.sendOnDisconnect_(t.action,t.pathString,t.data,t.onComplete)}for(let t=0;t<this.outstandingGets_.length;t++)this.outstandingGets_[t]&&this.sendGet_(t)}sendConnectStats_(){const t={};let r="js";(0,P.Yr)()&&(r=this.repoInfo_.nodeAdmin?"admin_node":"node"),t["sdk."+r+"."+rc.replace(/\./g,"-")]=1,(0,P.uI)()?t["framework.cordova"]=1:(0,P.b$)()&&(t["framework.reactnative"]=1),this.reportStats(t)}shouldReconnect_(){const t=Od.getInstance().currentlyOnline();return(0,P.xb)(this.interruptReasons_)&&t}}return n.nextPersistentConnectionId_=0,n.nextConnectionId_=0,n})();class wt{constructor(e,t){this.name=e,this.node=t}static Wrap(e,t){return new wt(e,t)}}class bf{getCompare(){return this.compare.bind(this)}indexedValueChanged(e,t){const r=new wt(Mi,e),o=new wt(Mi,t);return 0!==this.compare(r,o)}minPost(){return wt.MIN}}class jg extends bf{static get __EMPTY_NODE(){return Ug}static set __EMPTY_NODE(e){Ug=e}compare(e,t){return ii(e.name,t.name)}isDefinedOn(e){throw(0,P.g5)("KeyIndex.isDefinedOn not expected to be called.")}indexedValueChanged(e,t){return!1}minPost(){return wt.MIN}maxPost(){return new wt(Cs,Ug)}makePost(e,t){return(0,P.hu)("string"==typeof e,"KeyIndex indexValue must always be a string."),new wt(e,Ug)}toString(){return".key"}}const da=new jg;class Tf{constructor(e,t,r,o,u=null){this.isReverse_=o,this.resultGenerator_=u,this.nodeStack_=[];let c=1;for(;!e.isEmpty();)if(e=e,c=t?r(e.key,t):1,o&&(c*=-1),c<0)e=this.isReverse_?e.left:e.right;else{if(0===c){this.nodeStack_.push(e);break}this.nodeStack_.push(e),e=this.isReverse_?e.right:e.left}}getNext(){if(0===this.nodeStack_.length)return null;let t,e=this.nodeStack_.pop();if(t=this.resultGenerator_?this.resultGenerator_(e.key,e.value):{key:e.key,value:e.value},this.isReverse_)for(e=e.left;!e.isEmpty();)this.nodeStack_.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack_.push(e),e=e.left;return t}hasNext(){return this.nodeStack_.length>0}peek(){if(0===this.nodeStack_.length)return null;const e=this.nodeStack_[this.nodeStack_.length-1];return this.resultGenerator_?this.resultGenerator_(e.key,e.value):{key:e.key,value:e.value}}}let $u,vo=(()=>{class n{constructor(t,r,o,u,c){this.key=t,this.value=r,this.color=null!=o?o:n.RED,this.left=null!=u?u:Mr.EMPTY_NODE,this.right=null!=c?c:Mr.EMPTY_NODE}copy(t,r,o,u,c){return new n(null!=t?t:this.key,null!=r?r:this.value,null!=o?o:this.color,null!=u?u:this.left,null!=c?c:this.right)}count(){return this.left.count()+1+this.right.count()}isEmpty(){return!1}inorderTraversal(t){return this.left.inorderTraversal(t)||!!t(this.key,this.value)||this.right.inorderTraversal(t)}reverseTraversal(t){return this.right.reverseTraversal(t)||t(this.key,this.value)||this.left.reverseTraversal(t)}min_(){return this.left.isEmpty()?this:this.left.min_()}minKey(){return this.min_().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(t,r,o){let u=this;const c=o(t,u.key);return u=c<0?u.copy(null,null,null,u.left.insert(t,r,o),null):0===c?u.copy(null,r,null,null,null):u.copy(null,null,null,null,u.right.insert(t,r,o)),u.fixUp_()}removeMin_(){if(this.left.isEmpty())return Mr.EMPTY_NODE;let t=this;return!t.left.isRed_()&&!t.left.left.isRed_()&&(t=t.moveRedLeft_()),t=t.copy(null,null,null,t.left.removeMin_(),null),t.fixUp_()}remove(t,r){let o,u;if(o=this,r(t,o.key)<0)!o.left.isEmpty()&&!o.left.isRed_()&&!o.left.left.isRed_()&&(o=o.moveRedLeft_()),o=o.copy(null,null,null,o.left.remove(t,r),null);else{if(o.left.isRed_()&&(o=o.rotateRight_()),!o.right.isEmpty()&&!o.right.isRed_()&&!o.right.left.isRed_()&&(o=o.moveRedRight_()),0===r(t,o.key)){if(o.right.isEmpty())return Mr.EMPTY_NODE;u=o.right.min_(),o=o.copy(u.key,u.value,null,null,o.right.removeMin_())}o=o.copy(null,null,null,null,o.right.remove(t,r))}return o.fixUp_()}isRed_(){return this.color}fixUp_(){let t=this;return t.right.isRed_()&&!t.left.isRed_()&&(t=t.rotateLeft_()),t.left.isRed_()&&t.left.left.isRed_()&&(t=t.rotateRight_()),t.left.isRed_()&&t.right.isRed_()&&(t=t.colorFlip_()),t}moveRedLeft_(){let t=this.colorFlip_();return t.right.left.isRed_()&&(t=t.copy(null,null,null,null,t.right.rotateRight_()),t=t.rotateLeft_(),t=t.colorFlip_()),t}moveRedRight_(){let t=this.colorFlip_();return t.left.left.isRed_()&&(t=t.rotateRight_(),t=t.colorFlip_()),t}rotateLeft_(){const t=this.copy(null,null,n.RED,null,this.right.left);return this.right.copy(null,null,this.color,t,null)}rotateRight_(){const t=this.copy(null,null,n.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,t)}colorFlip_(){const t=this.left.copy(null,null,!this.left.color,null,null),r=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,t,r)}checkMaxDepth_(){const t=this.check_();return Math.pow(2,t)<=this.count()+1}check_(){if(this.isRed_()&&this.left.isRed_())throw new Error("Red node has red child("+this.key+","+this.value+")");if(this.right.isRed_())throw new Error("Right child of ("+this.key+","+this.value+") is red");const t=this.left.check_();if(t!==this.right.check_())throw new Error("Black depths differ");return t+(this.isRed_()?0:1)}}return n.RED=!0,n.BLACK=!1,n})();class Mr{constructor(e,t=Mr.EMPTY_NODE){this.comparator_=e,this.root_=t}insert(e,t){return new Mr(this.comparator_,this.root_.insert(e,t,this.comparator_).copy(null,null,vo.BLACK,null,null))}remove(e){return new Mr(this.comparator_,this.root_.remove(e,this.comparator_).copy(null,null,vo.BLACK,null,null))}get(e){let t,r=this.root_;for(;!r.isEmpty();){if(t=this.comparator_(e,r.key),0===t)return r.value;t<0?r=r.left:t>0&&(r=r.right)}return null}getPredecessorKey(e){let t,r=this.root_,o=null;for(;!r.isEmpty();){if(t=this.comparator_(e,r.key),0===t){if(r.left.isEmpty())return o?o.key:null;for(r=r.left;!r.right.isEmpty();)r=r.right;return r.key}t<0?r=r.left:t>0&&(o=r,r=r.right)}throw new Error("Attempted to find predecessor key for a nonexistent key.  What gives?")}isEmpty(){return this.root_.isEmpty()}count(){return this.root_.count()}minKey(){return this.root_.minKey()}maxKey(){return this.root_.maxKey()}inorderTraversal(e){return this.root_.inorderTraversal(e)}reverseTraversal(e){return this.root_.reverseTraversal(e)}getIterator(e){return new Tf(this.root_,null,this.comparator_,!1,e)}getIteratorFrom(e,t){return new Tf(this.root_,e,this.comparator_,!1,t)}getReverseIteratorFrom(e,t){return new Tf(this.root_,e,this.comparator_,!0,t)}getReverseIterator(e){return new Tf(this.root_,null,this.comparator_,!0,e)}}function Fd(n,e){return ii(n.name,e.name)}function Af(n,e){return ii(n,e)}Mr.EMPTY_NODE=new class ib{copy(e,t,r,o,u){return this}insert(e,t,r){return new vo(e,t,null)}remove(e,t){return this}count(){return 0}isEmpty(){return!0}inorderTraversal(e){return!1}reverseTraversal(e){return!1}minKey(){return null}maxKey(){return null}check_(){return 0}isRed_(){return!1}};const hc=function(n){return"number"==typeof n?"number:"+xg(n):"string:"+n},K0=function(n){if(n.isLeafNode()){const e=n.val();(0,P.hu)("string"==typeof e||"number"==typeof e||"object"==typeof e&&(0,P.r3)(e,".sv"),"Priority must be a string or number.")}else(0,P.hu)(n===$u||n.isEmpty(),"priority of unexpected type.");(0,P.hu)(n===$u||n.getPriority().isEmpty(),"Priority nodes can't have a priority of their own.")};let Fy,Hg,Gg,fc=(()=>{class n{constructor(t,r=n.__childrenNodeConstructor.EMPTY_NODE){this.value_=t,this.priorityNode_=r,this.lazyHash_=null,(0,P.hu)(null!=this.value_,"LeafNode shouldn't be created with null/undefined value."),K0(this.priorityNode_)}static set __childrenNodeConstructor(t){Fy=t}static get __childrenNodeConstructor(){return Fy}isLeafNode(){return!0}getPriority(){return this.priorityNode_}updatePriority(t){return new n(this.value_,t)}getImmediateChild(t){return".priority"===t?this.priorityNode_:n.__childrenNodeConstructor.EMPTY_NODE}getChild(t){return Nt(t)?this:".priority"===Mt(t)?this.priorityNode_:n.__childrenNodeConstructor.EMPTY_NODE}hasChild(){return!1}getPredecessorChildName(t,r){return null}updateImmediateChild(t,r){return".priority"===t?this.updatePriority(r):r.isEmpty()&&".priority"!==t?this:n.__childrenNodeConstructor.EMPTY_NODE.updateImmediateChild(t,r).updatePriority(this.priorityNode_)}updateChild(t,r){const o=Mt(t);return null===o?r:r.isEmpty()&&".priority"!==o?this:((0,P.hu)(".priority"!==o||1===Hu(t),".priority must be the last token in a path"),this.updateImmediateChild(o,n.__childrenNodeConstructor.EMPTY_NODE.updateChild(dn(t),r)))}isEmpty(){return!1}numChildren(){return 0}forEachChild(t,r){return!1}val(t){return t&&!this.getPriority().isEmpty()?{".value":this.getValue(),".priority":this.getPriority().val()}:this.getValue()}hash(){if(null===this.lazyHash_){let t="";this.priorityNode_.isEmpty()||(t+="priority:"+hc(this.priorityNode_.val())+":");const r=typeof this.value_;t+=r+":",t+="number"===r?xg(this.value_):this.value_,this.lazyHash_=_f(t)}return this.lazyHash_}getValue(){return this.value_}compareTo(t){return t===n.__childrenNodeConstructor.EMPTY_NODE?1:t instanceof n.__childrenNodeConstructor?-1:((0,P.hu)(t.isLeafNode(),"Unknown node type"),this.compareToLeafNode_(t))}compareToLeafNode_(t){const r=typeof t.value_,o=typeof this.value_,u=n.VALUE_TYPE_ORDER.indexOf(r),c=n.VALUE_TYPE_ORDER.indexOf(o);return(0,P.hu)(u>=0,"Unknown leaf type: "+r),(0,P.hu)(c>=0,"Unknown leaf type: "+o),u===c?"object"===o?0:this.value_<t.value_?-1:this.value_===t.value_?0:1:c-u}withIndex(){return this}isIndexed(){return!0}equals(t){if(t===this)return!0;if(t.isLeafNode()){const r=t;return this.value_===r.value_&&this.priorityNode_.equals(r.priorityNode_)}return!1}}return n.VALUE_TYPE_ORDER=["object","boolean","number","string"],n})();const fn=new class sb extends bf{compare(e,t){const r=e.node.getPriority(),o=t.node.getPriority(),u=r.compareTo(o);return 0===u?ii(e.name,t.name):u}isDefinedOn(e){return!e.getPriority().isEmpty()}indexedValueChanged(e,t){return!e.getPriority().equals(t.getPriority())}minPost(){return wt.MIN}maxPost(){return new wt(Cs,new fc("[PRIORITY-POST]",Gg))}makePost(e,t){const r=Hg(e);return new wt(t,new fc("[PRIORITY-POST]",r))}toString(){return".priority"}},dM=Math.log(2);class Y0{constructor(e){this.count=parseInt(Math.log(e+1)/dM,10),this.current_=this.count-1;const o=(u=>parseInt(Array(this.count+1).join("1"),2))();this.bits_=e+1&o}nextBitIsOne(){const e=!(this.bits_&1<<this.current_);return this.current_--,e}}const xf=function(n,e,t,r){n.sort(e);const o=function(E,I){const S=I-E;let M,F;if(0===S)return null;if(1===S)return M=n[E],F=t?t(M):M,new vo(F,M.node,vo.BLACK,null,null);{const W=parseInt(S/2,10)+E,Y=o(E,W),xe=o(W+1,I);return M=n[W],F=t?t(M):M,new vo(F,M.node,vo.BLACK,Y,xe)}},g=function(E){let I=null,S=null,M=n.length;const F=function(Y,xe){const qe=M-Y,Pt=M;M-=Y;const Bt=o(qe+1,Pt),or=n[qe],zt=t?t(or):or;W(new vo(zt,or.node,xe,null,Bt))},W=function(Y){I?(I.left=Y,I=Y):(S=Y,I=Y)};for(let Y=0;Y<E.count;++Y){const xe=E.nextBitIsOne(),qe=Math.pow(2,E.count-(Y+1));xe?F(qe,vo.BLACK):(F(qe,vo.BLACK),F(qe,vo.RED))}return S}(new Y0(n.length));return new Mr(r||e,g)};let Ly;const pc={};class ru{constructor(e,t){this.indexes_=e,this.indexSet_=t}static get Default(){return(0,P.hu)(pc&&fn,"ChildrenNode.ts has not been loaded"),Ly=Ly||new ru({".priority":pc},{".priority":fn}),Ly}get(e){const t=(0,P.DV)(this.indexes_,e);if(!t)throw new Error("No index defined for "+e);return t instanceof Mr?t:null}hasIndex(e){return(0,P.r3)(this.indexSet_,e.toString())}addIndex(e,t){(0,P.hu)(e!==da,"KeyIndex always exists and isn't meant to be added to the IndexMap.");const r=[];let o=!1;const u=t.getIterator(wt.Wrap);let g,c=u.getNext();for(;c;)o=o||e.isDefinedOn(c.node),r.push(c),c=u.getNext();g=o?xf(r,e.getCompare()):pc;const E=e.toString(),I=Object.assign({},this.indexSet_);I[E]=e;const S=Object.assign({},this.indexes_);return S[E]=g,new ru(S,I)}addToIndexes(e,t){const r=(0,P.UI)(this.indexes_,(o,u)=>{const c=(0,P.DV)(this.indexSet_,u);if((0,P.hu)(c,"Missing index implementation for "+u),o===pc){if(c.isDefinedOn(e.node)){const g=[],E=t.getIterator(wt.Wrap);let I=E.getNext();for(;I;)I.name!==e.name&&g.push(I),I=E.getNext();return g.push(e),xf(g,c.getCompare())}return pc}{const g=t.get(e.name);let E=o;return g&&(E=E.remove(new wt(e.name,g))),E.insert(e,e.node)}});return new ru(r,this.indexSet_)}removeFromIndexes(e,t){const r=(0,P.UI)(this.indexes_,o=>{if(o===pc)return o;{const u=t.get(e.name);return u?o.remove(new wt(e.name,u)):o}});return new ru(r,this.indexSet_)}}let Mf,ht=(()=>{class n{constructor(t,r,o){this.children_=t,this.priorityNode_=r,this.indexMap_=o,this.lazyHash_=null,this.priorityNode_&&K0(this.priorityNode_),this.children_.isEmpty()&&(0,P.hu)(!this.priorityNode_||this.priorityNode_.isEmpty(),"An empty node cannot have a priority")}static get EMPTY_NODE(){return Mf||(Mf=new n(new Mr(Af),null,ru.Default))}isLeafNode(){return!1}getPriority(){return this.priorityNode_||Mf}updatePriority(t){return this.children_.isEmpty()?this:new n(this.children_,t,this.indexMap_)}getImmediateChild(t){if(".priority"===t)return this.getPriority();{const r=this.children_.get(t);return null===r?Mf:r}}getChild(t){const r=Mt(t);return null===r?this:this.getImmediateChild(r).getChild(dn(t))}hasChild(t){return null!==this.children_.get(t)}updateImmediateChild(t,r){if((0,P.hu)(r,"We should always be passing snapshot nodes"),".priority"===t)return this.updatePriority(r);{const o=new wt(t,r);let u,c;r.isEmpty()?(u=this.children_.remove(t),c=this.indexMap_.removeFromIndexes(o,this.children_)):(u=this.children_.insert(t,r),c=this.indexMap_.addToIndexes(o,this.children_));const g=u.isEmpty()?Mf:this.priorityNode_;return new n(u,g,c)}}updateChild(t,r){const o=Mt(t);if(null===o)return r;{(0,P.hu)(".priority"!==Mt(t)||1===Hu(t),".priority must be the last token in a path");const u=this.getImmediateChild(o).updateChild(dn(t),r);return this.updateImmediateChild(o,u)}}isEmpty(){return this.children_.isEmpty()}numChildren(){return this.children_.count()}val(t){if(this.isEmpty())return null;const r={};let o=0,u=0,c=!0;if(this.forEachChild(fn,(g,E)=>{r[g]=E.val(t),o++,c&&n.INTEGER_REGEXP_.test(g)?u=Math.max(u,Number(g)):c=!1}),!t&&c&&u<2*o){const g=[];for(const E in r)g[E]=r[E];return g}return t&&!this.getPriority().isEmpty()&&(r[".priority"]=this.getPriority().val()),r}hash(){if(null===this.lazyHash_){let t="";this.getPriority().isEmpty()||(t+="priority:"+hc(this.getPriority().val())+":"),this.forEachChild(fn,(r,o)=>{const u=o.hash();""!==u&&(t+=":"+r+":"+u)}),this.lazyHash_=""===t?"":_f(t)}return this.lazyHash_}getPredecessorChildName(t,r,o){const u=this.resolveIndex_(o);if(u){const c=u.getPredecessorKey(new wt(t,r));return c?c.name:null}return this.children_.getPredecessorKey(t)}getFirstChildName(t){const r=this.resolveIndex_(t);if(r){const o=r.minKey();return o&&o.name}return this.children_.minKey()}getFirstChild(t){const r=this.getFirstChildName(t);return r?new wt(r,this.children_.get(r)):null}getLastChildName(t){const r=this.resolveIndex_(t);if(r){const o=r.maxKey();return o&&o.name}return this.children_.maxKey()}getLastChild(t){const r=this.getLastChildName(t);return r?new wt(r,this.children_.get(r)):null}forEachChild(t,r){const o=this.resolveIndex_(t);return o?o.inorderTraversal(u=>r(u.name,u.node)):this.children_.inorderTraversal(r)}getIterator(t){return this.getIteratorFrom(t.minPost(),t)}getIteratorFrom(t,r){const o=this.resolveIndex_(r);if(o)return o.getIteratorFrom(t,u=>u);{const u=this.children_.getIteratorFrom(t.name,wt.Wrap);let c=u.peek();for(;null!=c&&r.compare(c,t)<0;)u.getNext(),c=u.peek();return u}}getReverseIterator(t){return this.getReverseIteratorFrom(t.maxPost(),t)}getReverseIteratorFrom(t,r){const o=this.resolveIndex_(r);if(o)return o.getReverseIteratorFrom(t,u=>u);{const u=this.children_.getReverseIteratorFrom(t.name,wt.Wrap);let c=u.peek();for(;null!=c&&r.compare(c,t)>0;)u.getNext(),c=u.peek();return u}}compareTo(t){return this.isEmpty()?t.isEmpty()?0:-1:t.isLeafNode()||t.isEmpty()?1:t===Nf?-1:0}withIndex(t){if(t===da||this.indexMap_.hasIndex(t))return this;{const r=this.indexMap_.addIndex(t,this.children_);return new n(this.children_,this.priorityNode_,r)}}isIndexed(t){return t===da||this.indexMap_.hasIndex(t)}equals(t){if(t===this)return!0;if(t.isLeafNode())return!1;{const r=t;if(this.getPriority().equals(r.getPriority())){if(this.children_.count()===r.children_.count()){const o=this.getIterator(fn),u=r.getIterator(fn);let c=o.getNext(),g=u.getNext();for(;c&&g;){if(c.name!==g.name||!c.node.equals(g.node))return!1;c=o.getNext(),g=u.getNext()}return null===c&&null===g}return!1}return!1}}resolveIndex_(t){return t===da?null:this.indexMap_.get(t.toString())}}return n.INTEGER_REGEXP_=/^(0|[1-9]\d*)$/,n})();const Nf=new class ob extends ht{constructor(){super(new Mr(Af),ht.EMPTY_NODE,ru.Default)}compareTo(e){return e===this?0:1}equals(e){return e===this}getPriority(){return this}getImmediateChild(e){return ht.EMPTY_NODE}isEmpty(){return!1}};function zn(n,e=null){if(null===n)return ht.EMPTY_NODE;if("object"==typeof n&&".priority"in n&&(e=n[".priority"]),(0,P.hu)(null===e||"string"==typeof e||"number"==typeof e||"object"==typeof e&&".sv"in e,"Invalid priority type found: "+typeof e),"object"==typeof n&&".value"in n&&null!==n[".value"]&&(n=n[".value"]),"object"!=typeof n||".sv"in n)return new fc(n,zn(e));if(n instanceof Array){let t=ht.EMPTY_NODE;return Sn(n,(r,o)=>{if((0,P.r3)(n,r)&&"."!==r.substring(0,1)){const u=zn(o);(u.isLeafNode()||!u.isEmpty())&&(t=t.updateImmediateChild(r,u))}}),t.updatePriority(zn(e))}{const t=[];let r=!1;if(Sn(n,(c,g)=>{if("."!==c.substring(0,1)){const E=zn(g);E.isEmpty()||(r=r||!E.getPriority().isEmpty(),t.push(new wt(c,E)))}}),0===t.length)return ht.EMPTY_NODE;const u=xf(t,Fd,c=>c.name,Af);if(r){const c=xf(t,fn.getCompare());return new ht(u,zn(e),new ru({".priority":c},{".priority":fn}))}return new ht(u,zn(e),ru.Default)}}Object.defineProperties(wt,{MIN:{value:new wt(Mi,ht.EMPTY_NODE)},MAX:{value:new wt(Cs,Nf)}}),jg.__EMPTY_NODE=ht.EMPTY_NODE,fc.__childrenNodeConstructor=ht,function Sf(n){$u=n}(Nf),function $g(n){Gg=n}(Nf),function Z0(n){Hg=n}(zn);class Wg extends bf{constructor(e){super(),this.indexPath_=e,(0,P.hu)(!Nt(e)&&".priority"!==Mt(e),"Can't create PathIndex with empty path or .priority key")}extractChild(e){return e.getChild(this.indexPath_)}isDefinedOn(e){return!e.getChild(this.indexPath_).isEmpty()}compare(e,t){const r=this.extractChild(e.node),o=this.extractChild(t.node),u=r.compareTo(o);return 0===u?ii(e.name,t.name):u}makePost(e,t){const r=zn(e),o=ht.EMPTY_NODE.updateChild(this.indexPath_,r);return new wt(t,o)}maxPost(){const e=ht.EMPTY_NODE.updateChild(this.indexPath_,Nf);return new wt(Cs,e)}toString(){return Lg(this.indexPath_,0).join("/")}}const Vy=new class fM extends bf{compare(e,t){const r=e.node.compareTo(t.node);return 0===r?ii(e.name,t.name):r}isDefinedOn(e){return!0}indexedValueChanged(e,t){return!e.equals(t)}minPost(){return wt.MIN}maxPost(){return wt.MAX}makePost(e,t){const r=zn(e);return new wt(t,r)}toString(){return".value"}},Wu="-0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ_abcdefghijklmnopqrstuvwxyz",ab=function(){let n=0;const e=[];return function(t){const r=t===n;let o;n=t;const u=new Array(8);for(o=7;o>=0;o--)u[o]=Wu.charAt(t%64),t=Math.floor(t/64);(0,P.hu)(0===t,"Cannot push at time == 0");let c=u.join("");if(r){for(o=11;o>=0&&63===e[o];o--)e[o]=0;e[o]++}else for(o=0;o<12;o++)e[o]=Math.floor(64*Math.random());for(o=0;o<12;o++)c+=Wu.charAt(e[o]);return(0,P.hu)(20===c.length,"nextPushId: Length should be 20."),c}}(),By=function(n){if(n===""+f)return"-";const e=v(n);if(null!=e)return""+(e+1);const t=new Array(n.length);for(let c=0;c<t.length;c++)t[c]=n.charAt(c);if(t.length<786)return t.push("-"),t.join("");let r=t.length-1;for(;r>=0&&"z"===t[r];)r--;if(-1===r)return Cs;const u=Wu.charAt(Wu.indexOf(t[r])+1);return t[r]=u,t.slice(0,r+1).join("")},X0=function(n){if(n===""+h)return Mi;const e=v(n);if(null!=e)return""+(e-1);const t=new Array(n.length);for(let r=0;r<t.length;r++)t[r]=n.charAt(r);return"-"===t[t.length-1]?1===t.length?""+f:(delete t[t.length-1],t.join("")):(t[t.length-1]=Wu.charAt(Wu.indexOf(t[t.length-1])-1),t.join("")+"z".repeat(786-t.length))};function Uy(n){return{type:"value",snapshotNode:n}}function Ld(n,e){return{type:"child_added",snapshotNode:e,childName:n}}function Rf(n,e){return{type:"child_removed",snapshotNode:e,childName:n}}function Vd(n,e,t){return{type:"child_changed",snapshotNode:e,childName:n,oldSnap:t}}class jy{constructor(e){this.index_=e}updateChild(e,t,r,o,u,c){(0,P.hu)(e.isIndexed(this.index_),"A node must be indexed if only a child is updated");const g=e.getImmediateChild(t);return g.getChild(o).equals(r.getChild(o))&&g.isEmpty()===r.isEmpty()||(null!=c&&(r.isEmpty()?e.hasChild(t)?c.trackChildChange(Rf(t,g)):(0,P.hu)(e.isLeafNode(),"A child remove without an old child only makes sense on a leaf node"):g.isEmpty()?c.trackChildChange(Ld(t,r)):c.trackChildChange(Vd(t,r,g))),e.isLeafNode()&&r.isEmpty())?e:e.updateImmediateChild(t,r).withIndex(this.index_)}updateFullNode(e,t,r){return null!=r&&(e.isLeafNode()||e.forEachChild(fn,(o,u)=>{t.hasChild(o)||r.trackChildChange(Rf(o,u))}),t.isLeafNode()||t.forEachChild(fn,(o,u)=>{if(e.hasChild(o)){const c=e.getImmediateChild(o);c.equals(u)||r.trackChildChange(Vd(o,u,c))}else r.trackChildChange(Ld(o,u))})),t.withIndex(this.index_)}updatePriority(e,t){return e.isEmpty()?ht.EMPTY_NODE:e.updatePriority(t)}filtersNodes(){return!1}getIndexedFilter(){return this}getIndex(){return this.index_}}class ts{constructor(e){this.indexedFilter_=new jy(e.getIndex()),this.index_=e.getIndex(),this.startPost_=ts.getStartPost_(e),this.endPost_=ts.getEndPost_(e)}getStartPost(){return this.startPost_}getEndPost(){return this.endPost_}matches(e){return this.index_.compare(this.getStartPost(),e)<=0&&this.index_.compare(e,this.getEndPost())<=0}updateChild(e,t,r,o,u,c){return this.matches(new wt(t,r))||(r=ht.EMPTY_NODE),this.indexedFilter_.updateChild(e,t,r,o,u,c)}updateFullNode(e,t,r){t.isLeafNode()&&(t=ht.EMPTY_NODE);let o=t.withIndex(this.index_);o=o.updatePriority(ht.EMPTY_NODE);const u=this;return t.forEachChild(fn,(c,g)=>{u.matches(new wt(c,g))||(o=o.updateImmediateChild(c,ht.EMPTY_NODE))}),this.indexedFilter_.updateFullNode(e,o,r)}updatePriority(e,t){return e}filtersNodes(){return!0}getIndexedFilter(){return this.indexedFilter_}getIndex(){return this.index_}static getStartPost_(e){if(e.hasStart()){const t=e.getIndexStartName();return e.getIndex().makePost(e.getIndexStartValue(),t)}return e.getIndex().minPost()}static getEndPost_(e){if(e.hasEnd()){const t=e.getIndexEndName();return e.getIndex().makePost(e.getIndexEndValue(),t)}return e.getIndex().maxPost()}}class Hy{constructor(e){this.rangedFilter_=new ts(e),this.index_=e.getIndex(),this.limit_=e.getLimit(),this.reverse_=!e.isViewFromLeft()}updateChild(e,t,r,o,u,c){return this.rangedFilter_.matches(new wt(t,r))||(r=ht.EMPTY_NODE),e.getImmediateChild(t).equals(r)?e:e.numChildren()<this.limit_?this.rangedFilter_.getIndexedFilter().updateChild(e,t,r,o,u,c):this.fullLimitUpdateChild_(e,t,r,u,c)}updateFullNode(e,t,r){let o;if(t.isLeafNode()||t.isEmpty())o=ht.EMPTY_NODE.withIndex(this.index_);else if(2*this.limit_<t.numChildren()&&t.isIndexed(this.index_)){let u;o=ht.EMPTY_NODE.withIndex(this.index_),u=this.reverse_?t.getReverseIteratorFrom(this.rangedFilter_.getEndPost(),this.index_):t.getIteratorFrom(this.rangedFilter_.getStartPost(),this.index_);let c=0;for(;u.hasNext()&&c<this.limit_;){const g=u.getNext();let E;if(E=this.reverse_?this.index_.compare(this.rangedFilter_.getStartPost(),g)<=0:this.index_.compare(g,this.rangedFilter_.getEndPost())<=0,!E)break;o=o.updateImmediateChild(g.name,g.node),c++}}else{let u,c,g,E;if(o=t.withIndex(this.index_),o=o.updatePriority(ht.EMPTY_NODE),this.reverse_){E=o.getReverseIterator(this.index_),u=this.rangedFilter_.getEndPost(),c=this.rangedFilter_.getStartPost();const M=this.index_.getCompare();g=(F,W)=>M(W,F)}else E=o.getIterator(this.index_),u=this.rangedFilter_.getStartPost(),c=this.rangedFilter_.getEndPost(),g=this.index_.getCompare();let I=0,S=!1;for(;E.hasNext();){const M=E.getNext();!S&&g(u,M)<=0&&(S=!0),S&&I<this.limit_&&g(M,c)<=0?I++:o=o.updateImmediateChild(M.name,ht.EMPTY_NODE)}}return this.rangedFilter_.getIndexedFilter().updateFullNode(e,o,r)}updatePriority(e,t){return e}filtersNodes(){return!0}getIndexedFilter(){return this.rangedFilter_.getIndexedFilter()}getIndex(){return this.index_}fullLimitUpdateChild_(e,t,r,o,u){let c;if(this.reverse_){const M=this.index_.getCompare();c=(F,W)=>M(W,F)}else c=this.index_.getCompare();const g=e;(0,P.hu)(g.numChildren()===this.limit_,"");const E=new wt(t,r),I=this.reverse_?g.getFirstChild(this.index_):g.getLastChild(this.index_),S=this.rangedFilter_.matches(E);if(g.hasChild(t)){const M=g.getImmediateChild(t);let F=o.getChildAfterChild(this.index_,I,this.reverse_);for(;null!=F&&(F.name===t||g.hasChild(F.name));)F=o.getChildAfterChild(this.index_,F,this.reverse_);const W=null==F?1:c(F,E);if(S&&!r.isEmpty()&&W>=0)return null!=u&&u.trackChildChange(Vd(t,r,M)),g.updateImmediateChild(t,r);{null!=u&&u.trackChildChange(Rf(t,M));const xe=g.updateImmediateChild(t,ht.EMPTY_NODE);return null!=F&&this.rangedFilter_.matches(F)?(null!=u&&u.trackChildChange(Ld(F.name,F.node)),xe.updateImmediateChild(F.name,F.node)):xe}}return r.isEmpty()?e:S&&c(I,E)>=0?(null!=u&&(u.trackChildChange(Rf(I.name,I.node)),u.trackChildChange(Ld(t,r))),g.updateImmediateChild(t,r).updateImmediateChild(I.name,ht.EMPTY_NODE)):e}}class zg{constructor(){this.limitSet_=!1,this.startSet_=!1,this.startNameSet_=!1,this.startAfterSet_=!1,this.endSet_=!1,this.endNameSet_=!1,this.endBeforeSet_=!1,this.limit_=0,this.viewFrom_="",this.indexStartValue_=null,this.indexStartName_="",this.indexEndValue_=null,this.indexEndName_="",this.index_=fn}hasStart(){return this.startSet_}hasStartAfter(){return this.startAfterSet_}hasEndBefore(){return this.endBeforeSet_}isViewFromLeft(){return""===this.viewFrom_?this.startSet_:"l"===this.viewFrom_}getIndexStartValue(){return(0,P.hu)(this.startSet_,"Only valid if start has been set"),this.indexStartValue_}getIndexStartName(){return(0,P.hu)(this.startSet_,"Only valid if start has been set"),this.startNameSet_?this.indexStartName_:Mi}hasEnd(){return this.endSet_}getIndexEndValue(){return(0,P.hu)(this.endSet_,"Only valid if end has been set"),this.indexEndValue_}getIndexEndName(){return(0,P.hu)(this.endSet_,"Only valid if end has been set"),this.endNameSet_?this.indexEndName_:Cs}hasLimit(){return this.limitSet_}hasAnchoredLimit(){return this.limitSet_&&""!==this.viewFrom_}getLimit(){return(0,P.hu)(this.limitSet_,"Only valid if limit has been set"),this.limit_}getIndex(){return this.index_}loadsAllData(){return!(this.startSet_||this.endSet_||this.limitSet_)}isDefault(){return this.loadsAllData()&&this.index_===fn}copy(){const e=new zg;return e.limitSet_=this.limitSet_,e.limit_=this.limit_,e.startSet_=this.startSet_,e.indexStartValue_=this.indexStartValue_,e.startNameSet_=this.startNameSet_,e.indexStartName_=this.indexStartName_,e.endSet_=this.endSet_,e.indexEndValue_=this.indexEndValue_,e.endNameSet_=this.endNameSet_,e.indexEndName_=this.indexEndName_,e.index_=this.index_,e.viewFrom_=this.viewFrom_,e}}function Gy(n,e,t){const r=n.copy();return r.startSet_=!0,void 0===e&&(e=null),r.indexStartValue_=e,null!=t?(r.startNameSet_=!0,r.indexStartName_=t):(r.startNameSet_=!1,r.indexStartName_=""),r}function $y(n,e,t){const r=n.copy();return r.endSet_=!0,void 0===e&&(e=null),r.indexEndValue_=e,void 0!==t?(r.endNameSet_=!0,r.indexEndName_=t):(r.endNameSet_=!1,r.indexEndName_=""),r}function Kg(n,e){const t=n.copy();return t.index_=e,t}function nw(n){const e={};if(n.isDefault())return e;let t;return n.index_===fn?t="$priority":n.index_===Vy?t="$value":n.index_===da?t="$key":((0,P.hu)(n.index_ instanceof Wg,"Unrecognized index type!"),t=n.index_.toString()),e.orderBy=(0,P.Pz)(t),n.startSet_&&(e.startAt=(0,P.Pz)(n.indexStartValue_),n.startNameSet_&&(e.startAt+=","+(0,P.Pz)(n.indexStartName_))),n.endSet_&&(e.endAt=(0,P.Pz)(n.indexEndValue_),n.endNameSet_&&(e.endAt+=","+(0,P.Pz)(n.indexEndName_))),n.limitSet_&&(n.isViewFromLeft()?e.limitToFirst=n.limit_:e.limitToLast=n.limit_),e}function Pf(n){const e={};if(n.startSet_&&(e.sp=n.indexStartValue_,n.startNameSet_&&(e.sn=n.indexStartName_)),n.endSet_&&(e.ep=n.indexEndValue_,n.endNameSet_&&(e.en=n.indexEndName_)),n.limitSet_){e.l=n.limit_;let t=n.viewFrom_;""===t&&(t=n.isViewFromLeft()?"l":"r"),e.vf=t}return n.index_!==fn&&(e.i=n.index_.toString()),e}class Bd extends Df{constructor(e,t,r,o){super(),this.repoInfo_=e,this.onDataUpdate_=t,this.authTokenProvider_=r,this.appCheckTokenProvider_=o,this.log_=ua("p:rest:"),this.listens_={}}reportStats(e){throw new Error("Method not implemented.")}static getListenId_(e,t){return void 0!==t?"tag$"+t:((0,P.hu)(e._queryParams.isDefault(),"should have a tag if it's not a default query."),e._path.toString())}listen(e,t,r,o){const u=e._path.toString();this.log_("Listen called for "+u+" "+e._queryIdentifier);const c=Bd.getListenId_(e,r),g={};this.listens_[c]=g;const E=nw(e._queryParams);this.restRequest_(u+".json",E,(I,S)=>{let M=S;if(404===I&&(M=null,I=null),null===I&&this.onDataUpdate_(u,M,!1,r),(0,P.DV)(this.listens_,c)===g){let F;F=I?401===I?"permission_denied":"rest_error:"+I:"ok",o(F,null)}})}unlisten(e,t){const r=Bd.getListenId_(e,t);delete this.listens_[r]}get(e){const t=nw(e._queryParams),r=e._path.toString(),o=new P.BH;return this.restRequest_(r+".json",t,(u,c)=>{let g=c;404===u&&(g=null,u=null),null===u?(this.onDataUpdate_(r,g,!1,null),o.resolve(g)):o.reject(new Error(g))}),o.promise}refreshAuthToken(e){}restRequest_(e,t={},r){return t.format="export",Promise.all([this.authTokenProvider_.getToken(!1),this.appCheckTokenProvider_.getToken(!1)]).then(([o,u])=>{o&&o.accessToken&&(t.auth=o.accessToken),u&&u.token&&(t.ac=u.token);const c=(this.repoInfo_.secure?"https://":"http://")+this.repoInfo_.host+e+"?ns="+this.repoInfo_.namespace+(0,P.xO)(t);this.log_("Sending REST request for "+c);const g=new XMLHttpRequest;g.onreadystatechange=()=>{if(r&&4===g.readyState){this.log_("REST Response for "+c+" received. status:",g.status,"response:",g.responseText);let E=null;if(g.status>=200&&g.status<300){try{E=(0,P.cI)(g.responseText)}catch(I){rr("Failed to parse JSON response for "+c+": "+g.responseText)}r(null,E)}else 401!==g.status&&404!==g.status&&rr("Got unsuccessful REST response for "+c+" Status: "+g.status),r(g.status);r=null}},g.open("GET",c,!0),g.send()})}}class cb{constructor(){this.rootNode_=ht.EMPTY_NODE}getNode(e){return this.rootNode_.getChild(e)}updateSnapshot(e,t){this.rootNode_=this.rootNode_.updateChild(e,t)}}function Ud(){return{value:null,children:new Map}}function qu(n,e,t){if(Nt(e))n.value=t,n.children.clear();else if(null!==n.value)n.value=n.value.updateChild(e,t);else{const r=Mt(e);n.children.has(r)||n.children.set(r,Ud()),qu(n.children.get(r),e=dn(e),t)}}function Zg(n,e){if(Nt(e))return n.value=null,n.children.clear(),!0;if(null!==n.value){if(n.value.isLeafNode())return!1;{const t=n.value;return n.value=null,t.forEachChild(fn,(r,o)=>{qu(n,new nn(r),o)}),Zg(n,e)}}if(n.children.size>0){const t=Mt(e);return e=dn(e),n.children.has(t)&&Zg(n.children.get(t),e)&&n.children.delete(t),0===n.children.size}return!0}function qy(n,e,t){null!==n.value?t(e,n.value):function db(n,e){n.children.forEach((t,r)=>{e(r,t)})}(n,(r,o)=>{qy(o,new nn(e.toString()+"/"+r),t)})}class zy{constructor(e){this.collection_=e,this.last_=null}get(){const e=this.collection_.get(),t=Object.assign({},e);return this.last_&&Sn(this.last_,(r,o)=>{t[r]=t[r]-o}),this.last_=e,t}}class iw{constructor(e,t){this.server_=t,this.statsToReport_={},this.statsListener_=new zy(e);const r=1e4+2e4*Math.random();U(this.reportStats_.bind(this),Math.floor(r))}reportStats_(){const e=this.statsListener_.get(),t={};let r=!1;Sn(e,(o,u)=>{u>0&&(0,P.r3)(this.statsToReport_,o)&&(t[o]=u,r=!0)}),r&&this.server_.reportStats(t),U(this.reportStats_.bind(this),Math.floor(2*Math.random()*3e5))}}var Ds=(()=>{return(n=Ds||(Ds={}))[n.OVERWRITE=0]="OVERWRITE",n[n.MERGE=1]="MERGE",n[n.ACK_USER_WRITE=2]="ACK_USER_WRITE",n[n.LISTEN_COMPLETE=3]="LISTEN_COMPLETE",Ds;var n})();function Eo(n){return{fromUser:!1,fromServer:!0,queryId:n,tagged:!0}}class gc{constructor(e,t,r){this.path=e,this.affectedTree=t,this.revert=r,this.type=Ds.ACK_USER_WRITE,this.source={fromUser:!0,fromServer:!1,queryId:null,tagged:!1}}operationForChild(e){if(Nt(this.path)){if(null!=this.affectedTree.value)return(0,P.hu)(this.affectedTree.children.isEmpty(),"affectedTree should not have overlapping affected paths."),this;{const t=this.affectedTree.subtree(new nn(e));return new gc(Kt(),t,this.revert)}}return(0,P.hu)(Mt(this.path)===e,"operationForChild called for unrelated child."),new gc(dn(this.path),this.affectedTree,this.revert)}}class Of{constructor(e,t){this.source=e,this.path=t,this.type=Ds.LISTEN_COMPLETE}operationForChild(e){return Nt(this.path)?new Of(this.source,Kt()):new Of(this.source,dn(this.path))}}class mc{constructor(e,t,r){this.source=e,this.path=t,this.snap=r,this.type=Ds.OVERWRITE}operationForChild(e){return Nt(this.path)?new mc(this.source,Kt(),this.snap.getImmediateChild(e)):new mc(this.source,dn(this.path),this.snap)}}class kf{constructor(e,t,r){this.source=e,this.path=t,this.children=r,this.type=Ds.MERGE}operationForChild(e){if(Nt(this.path)){const t=this.children.subtree(new nn(e));return t.isEmpty()?null:t.value?new mc(this.source,Kt(),t.value):new kf(this.source,Kt(),t)}return(0,P.hu)(Mt(this.path)===e,"Can't get a merge for a child not on the path of the operation"),new kf(this.source,dn(this.path),this.children)}toString(){return"Operation("+this.path+": "+this.source.toString()+" merge: "+this.children.toString()+")"}}class ha{constructor(e,t,r){this.node_=e,this.fullyInitialized_=t,this.filtered_=r}isFullyInitialized(){return this.fullyInitialized_}isFiltered(){return this.filtered_}isCompleteForPath(e){if(Nt(e))return this.isFullyInitialized()&&!this.filtered_;const t=Mt(e);return this.isCompleteForChild(t)}isCompleteForChild(e){return this.isFullyInitialized()&&!this.filtered_||this.node_.hasChild(e)}getNode(){return this.node_}}class sw{constructor(e){this.query_=e,this.index_=this.query_._queryParams.getIndex()}}function iu(n,e,t,r,o,u){const c=r.filter(g=>g.type===t);c.sort((g,E)=>function Zy(n,e,t){if(null==e.childName||null==t.childName)throw(0,P.g5)("Should only compare child_ events.");const r=new wt(e.childName,e.snapshotNode),o=new wt(t.childName,t.snapshotNode);return n.index_.compare(r,o)}(n,g,E)),c.forEach(g=>{const E=function pb(n,e,t){return"value"===e.type||"child_removed"===e.type||(e.prevName=t.getPredecessorChildName(e.childName,e.snapshotNode,n.index_)),e}(n,g,u);o.forEach(I=>{I.respondsTo(g.type)&&e.push(I.createEvent(E,n.query_))})})}function Ff(n,e){return{eventCache:n,serverCache:e}}function jd(n,e,t,r){return Ff(new ha(e,t,r),n.serverCache)}function Yy(n,e,t,r){return Ff(n.eventCache,new ha(e,t,r))}function Jg(n){return n.eventCache.isFullyInitialized()?n.eventCache.getNode():null}function su(n){return n.serverCache.isFullyInitialized()?n.serverCache.getNode():null}let Qy;class pn{constructor(e,t=(()=>(Qy||(Qy=new Mr(qs)),Qy))()){this.value=e,this.children=t}static fromObject(e){let t=new pn(null);return Sn(e,(r,o)=>{t=t.set(new nn(r),o)}),t}isEmpty(){return null===this.value&&this.children.isEmpty()}findRootMostMatchingPathAndValue(e,t){if(null!=this.value&&t(this.value))return{path:Kt(),value:this.value};if(Nt(e))return null;{const r=Mt(e),o=this.children.get(r);if(null!==o){const u=o.findRootMostMatchingPathAndValue(dn(e),t);return null!=u?{path:Cn(new nn(r),u.path),value:u.value}:null}return null}}findRootMostValueAndPath(e){return this.findRootMostMatchingPathAndValue(e,()=>!0)}subtree(e){if(Nt(e))return this;{const t=Mt(e),r=this.children.get(t);return null!==r?r.subtree(dn(e)):new pn(null)}}set(e,t){if(Nt(e))return new pn(t,this.children);{const r=Mt(e),u=(this.children.get(r)||new pn(null)).set(dn(e),t),c=this.children.insert(r,u);return new pn(this.value,c)}}remove(e){if(Nt(e))return this.children.isEmpty()?new pn(null):new pn(null,this.children);{const t=Mt(e),r=this.children.get(t);if(r){const o=r.remove(dn(e));let u;return u=o.isEmpty()?this.children.remove(t):this.children.insert(t,o),null===this.value&&u.isEmpty()?new pn(null):new pn(this.value,u)}return this}}get(e){if(Nt(e))return this.value;{const t=Mt(e),r=this.children.get(t);return r?r.get(dn(e)):null}}setTree(e,t){if(Nt(e))return t;{const r=Mt(e),u=(this.children.get(r)||new pn(null)).setTree(dn(e),t);let c;return c=u.isEmpty()?this.children.remove(r):this.children.insert(r,u),new pn(this.value,c)}}fold(e){return this.fold_(Kt(),e)}fold_(e,t){const r={};return this.children.inorderTraversal((o,u)=>{r[o]=u.fold_(Cn(e,o),t)}),t(e,this.value,r)}findOnPath(e,t){return this.findOnPath_(e,Kt(),t)}findOnPath_(e,t,r){const o=!!this.value&&r(t,this.value);if(o)return o;if(Nt(e))return null;{const u=Mt(e),c=this.children.get(u);return c?c.findOnPath_(dn(e),Cn(t,u),r):null}}foreachOnPath(e,t){return this.foreachOnPath_(e,Kt(),t)}foreachOnPath_(e,t,r){if(Nt(e))return this;{this.value&&r(t,this.value);const o=Mt(e),u=this.children.get(o);return u?u.foreachOnPath_(dn(e),Cn(t,o),r):new pn(null)}}foreach(e){this.foreach_(Kt(),e)}foreach_(e,t){this.children.inorderTraversal((r,o)=>{o.foreach_(Cn(e,r),t)}),this.value&&t(e,this.value)}foreachChild(e){this.children.inorderTraversal((t,r)=>{r.value&&e(t,r.value)})}}class si{constructor(e){this.writeTree_=e}static empty(){return new si(new pn(null))}}function Hd(n,e,t){if(Nt(e))return new si(new pn(t));{const r=n.writeTree_.findRootMostValueAndPath(e);if(null!=r){const o=r.path;let u=r.value;const c=zr(o,e);return u=u.updateChild(c,t),new si(n.writeTree_.set(o,u))}{const o=new pn(t),u=n.writeTree_.setTree(e,o);return new si(u)}}}function Jy(n,e,t){let r=n;return Sn(t,(o,u)=>{r=Hd(r,Cn(e,o),u)}),r}function ow(n,e){if(Nt(e))return si.empty();{const t=n.writeTree_.setTree(e,new pn(null));return new si(t)}}function zu(n,e){return null!=_c(n,e)}function _c(n,e){const t=n.writeTree_.findRootMostValueAndPath(e);return null!=t?n.writeTree_.get(t.path).getChild(zr(t.path,e)):null}function aw(n){const e=[],t=n.writeTree_.value;return null!=t?t.isLeafNode()||t.forEachChild(fn,(r,o)=>{e.push(new wt(r,o))}):n.writeTree_.children.inorderTraversal((r,o)=>{null!=o.value&&e.push(new wt(r,o.value))}),e}function Ku(n,e){if(Nt(e))return n;{const t=_c(n,e);return new si(null!=t?new pn(t):n.writeTree_.subtree(e))}}function Xy(n){return n.writeTree_.isEmpty()}function Kr(n,e){return Xg(Kt(),n.writeTree_,e)}function Xg(n,e,t){if(null!=e.value)return t.updateChild(n,e.value);{let r=null;return e.children.inorderTraversal((o,u)=>{".priority"===o?((0,P.hu)(null!==u.value,"Priority writes must always be leaf nodes"),r=u.value):t=Xg(Cn(n,o),u,t)}),!t.getChild(n).isEmpty()&&null!==r&&(t=t.updateChild(Cn(n,".priority"),r)),t}}function Lf(n,e){return iv(e,n)}function _b(n,e){if(n.snap)return yo(n.path,e);for(const t in n.children)if(n.children.hasOwnProperty(t)&&yo(Cn(n.path,t),e))return!0;return!1}function vb(n){return n.visible}function ev(n,e,t){let r=si.empty();for(let o=0;o<n.length;++o){const u=n[o];if(e(u)){const c=u.path;let g;if(u.snap)yo(t,c)?(g=zr(t,c),r=Hd(r,g,u.snap)):yo(c,t)&&(g=zr(c,t),r=Hd(r,Kt(),u.snap.getChild(g)));else{if(!u.children)throw(0,P.g5)("WriteRecord should have .snap or .children");if(yo(t,c))g=zr(t,c),r=Jy(r,g,u.children);else if(yo(c,t))if(g=zr(c,t),Nt(g))r=Jy(r,Kt(),u.children);else{const E=(0,P.DV)(u.children,Mt(g));if(E){const I=E.getChild(dn(g));r=Hd(r,Kt(),I)}}}}}return r}function Eb(n,e,t,r,o){if(r||o){const u=Ku(n.visibleWrites,e);return!o&&Xy(u)?t:o||null!=t||zu(u,Kt())?Kr(ev(n.allWrites,function(I){return(I.visible||o)&&(!r||!~r.indexOf(I.writeId))&&(yo(I.path,e)||yo(e,I.path))},e),t||ht.EMPTY_NODE):null}{const u=_c(n.visibleWrites,e);if(null!=u)return u;{const c=Ku(n.visibleWrites,e);return Xy(c)?t:null!=t||zu(c,Kt())?Kr(c,t||ht.EMPTY_NODE):null}}}function em(n,e,t,r){return Eb(n.writeTree,n.treePath,e,t,r)}function tm(n,e){return function dw(n,e,t){let r=ht.EMPTY_NODE;const o=_c(n.visibleWrites,e);if(o)return o.isLeafNode()||o.forEachChild(fn,(u,c)=>{r=r.updateImmediateChild(u,c)}),r;if(t){const u=Ku(n.visibleWrites,e);return t.forEachChild(fn,(c,g)=>{const E=Kr(Ku(u,new nn(c)),g);r=r.updateImmediateChild(c,E)}),aw(u).forEach(c=>{r=r.updateImmediateChild(c.name,c.node)}),r}return aw(Ku(n.visibleWrites,e)).forEach(c=>{r=r.updateImmediateChild(c.name,c.node)}),r}(n.writeTree,n.treePath,e)}function nv(n,e,t,r){return function wb(n,e,t,r,o){(0,P.hu)(r||o,"Either existingEventSnap or existingServerSnap must exist");const u=Cn(e,t);if(zu(n.visibleWrites,u))return null;{const c=Ku(n.visibleWrites,u);return Xy(c)?o.getChild(t):Kr(c,o.getChild(t))}}(n.writeTree,n.treePath,e,t,r)}function rv(n,e){return function gM(n,e){return _c(n.visibleWrites,e)}(n.writeTree,Cn(n.treePath,e))}function hw(n,e,t){return function Ib(n,e,t,r){const o=Cn(e,t),u=_c(n.visibleWrites,o);return null!=u?u:r.isCompleteForChild(t)?Kr(Ku(n.visibleWrites,o),r.getNode().getImmediateChild(t)):null}(n.writeTree,n.treePath,e,t)}function Cb(n,e){return iv(Cn(n.treePath,e),n.writeTree)}function iv(n,e){return{treePath:n,writeTree:e}}class fw{constructor(){this.changeMap=new Map}trackChildChange(e){const t=e.type,r=e.childName;(0,P.hu)("child_added"===t||"child_changed"===t||"child_removed"===t,"Only child changes supported for tracking"),(0,P.hu)(".priority"!==r,"Only non-priority child changes can be tracked.");const o=this.changeMap.get(r);if(o){const u=o.type;if("child_added"===t&&"child_removed"===u)this.changeMap.set(r,Vd(r,e.snapshotNode,o.snapshotNode));else if("child_removed"===t&&"child_added"===u)this.changeMap.delete(r);else if("child_removed"===t&&"child_changed"===u)this.changeMap.set(r,Rf(r,o.oldSnap));else if("child_changed"===t&&"child_added"===u)this.changeMap.set(r,Ld(r,e.snapshotNode));else{if("child_changed"!==t||"child_changed"!==u)throw(0,P.g5)("Illegal combination of changes: "+e+" occurred after "+o);this.changeMap.set(r,Vd(r,e.snapshotNode,o.oldSnap))}}else this.changeMap.set(r,e)}getChanges(){return Array.from(this.changeMap.values())}}const gw=new class pw{getCompleteChild(e){return null}getChildAfterChild(e,t,r){return null}};class mw{constructor(e,t,r=null){this.writes_=e,this.viewCache_=t,this.optCompleteServerCache_=r}getCompleteChild(e){const t=this.viewCache_.eventCache;if(t.isCompleteForChild(e))return t.getNode().getImmediateChild(e);{const r=null!=this.optCompleteServerCache_?new ha(this.optCompleteServerCache_,!0,!1):this.viewCache_.serverCache;return hw(this.writes_,e,r)}}getChildAfterChild(e,t,r){const o=null!=this.optCompleteServerCache_?this.optCompleteServerCache_:su(this.viewCache_),u=function wo(n,e,t,r,o,u){return function mM(n,e,t,r,o,u,c){let g;const E=Ku(n.visibleWrites,e),I=_c(E,Kt());if(null!=I)g=I;else{if(null==t)return[];g=Kr(E,t)}if(g=g.withIndex(c),g.isEmpty()||g.isLeafNode())return[];{const S=[],M=c.getCompare(),F=u?g.getReverseIteratorFrom(r,c):g.getIteratorFrom(r,c);let W=F.getNext();for(;W&&S.length<o;)0!==M(W,r)&&S.push(W),W=F.getNext();return S}}(n.writeTree,n.treePath,e,t,r,o,u)}(this.writes_,o,t,1,r,e);return 0===u.length?null:u[0]}}function yw(n,e,t,r,o,u){const c=e.eventCache;if(null!=rv(r,t))return e;{let g,E;if(Nt(t))if((0,P.hu)(e.serverCache.isFullyInitialized(),"If change path is empty, we must have complete server data"),e.serverCache.isFiltered()){const I=su(e),M=tm(r,I instanceof ht?I:ht.EMPTY_NODE);g=n.filter.updateFullNode(e.eventCache.getNode(),M,u)}else{const I=em(r,su(e));g=n.filter.updateFullNode(e.eventCache.getNode(),I,u)}else{const I=Mt(t);if(".priority"===I){(0,P.hu)(1===Hu(t),"Can't have a priority with additional path components");const S=c.getNode();E=e.serverCache.getNode();const M=nv(r,t,S,E);g=null!=M?n.filter.updatePriority(S,M):c.getNode()}else{const S=dn(t);let M;if(c.isCompleteForChild(I)){E=e.serverCache.getNode();const F=nv(r,t,c.getNode(),E);M=null!=F?c.getNode().getImmediateChild(I).updateChild(S,F):c.getNode().getImmediateChild(I)}else M=hw(r,I,e.serverCache);g=null!=M?n.filter.updateChild(c.getNode(),I,M,S,o,u):c.getNode()}}return jd(e,g,c.isFullyInitialized()||Nt(t),n.filter.filtersNodes())}}function nm(n,e,t,r,o,u,c,g){const E=e.serverCache;let I;const S=c?n.filter:n.filter.getIndexedFilter();if(Nt(t))I=S.updateFullNode(E.getNode(),r,null);else if(S.filtersNodes()&&!E.isFiltered()){const W=E.getNode().updateChild(t,r);I=S.updateFullNode(E.getNode(),W,null)}else{const W=Mt(t);if(!E.isCompleteForPath(t)&&Hu(t)>1)return e;const Y=dn(t),qe=E.getNode().getImmediateChild(W).updateChild(Y,r);I=".priority"===W?S.updatePriority(E.getNode(),qe):S.updateChild(E.getNode(),W,qe,Y,gw,null)}const M=Yy(e,I,E.isFullyInitialized()||Nt(t),S.filtersNodes());return yw(n,M,t,o,new mw(o,M,u),g)}function av(n,e,t,r,o,u,c){const g=e.eventCache;let E,I;const S=new mw(o,e,u);if(Nt(t))I=n.filter.updateFullNode(e.eventCache.getNode(),r,c),E=jd(e,I,!0,n.filter.filtersNodes());else{const M=Mt(t);if(".priority"===M)I=n.filter.updatePriority(e.eventCache.getNode(),r),E=jd(e,I,g.isFullyInitialized(),g.isFiltered());else{const F=dn(t),W=g.getNode().getImmediateChild(M);let Y;if(Nt(F))Y=r;else{const xe=S.getCompleteChild(M);Y=null!=xe?".priority"===H0(F)&&xe.getChild(Py(F)).isEmpty()?xe:xe.updateChild(F,r):ht.EMPTY_NODE}E=W.equals(Y)?e:jd(e,n.filter.updateChild(g.getNode(),M,Y,F,S,c),g.isFullyInitialized(),n.filter.filtersNodes())}}return E}function vw(n,e){return n.eventCache.isCompleteForChild(e)}function Ew(n,e,t){return t.foreach((r,o)=>{e=e.updateChild(r,o)}),e}function Gd(n,e,t,r,o,u,c,g){if(e.serverCache.getNode().isEmpty()&&!e.serverCache.isFullyInitialized())return e;let I,E=e;I=Nt(t)?r:new pn(null).setTree(t,r);const S=e.serverCache.getNode();return I.children.inorderTraversal((M,F)=>{if(S.hasChild(M)){const Y=Ew(0,e.serverCache.getNode().getImmediateChild(M),F);E=nm(n,E,new nn(M),Y,o,u,c,g)}}),I.children.inorderTraversal((M,F)=>{const W=!e.serverCache.isCompleteForChild(M)&&void 0===F.value;if(!S.hasChild(M)&&!W){const xe=Ew(0,e.serverCache.getNode().getImmediateChild(M),F);E=nm(n,E,new nn(M),xe,o,u,c,g)}}),E}class Ab{constructor(e,t){this.query_=e,this.eventRegistrations_=[];const r=this.query_._queryParams,o=new jy(r.getIndex()),u=function ub(n){return n.loadsAllData()?new jy(n.getIndex()):n.hasLimit()?new Hy(n):new ts(n)}(r);this.processor_=function _w(n){return{filter:n}}(u);const c=t.serverCache,g=t.eventCache,E=o.updateFullNode(ht.EMPTY_NODE,c.getNode(),null),I=u.updateFullNode(ht.EMPTY_NODE,g.getNode(),null),S=new ha(E,c.isFullyInitialized(),o.filtersNodes()),M=new ha(I,g.isFullyInitialized(),u.filtersNodes());this.viewCache_=Ff(M,S),this.eventGenerator_=new sw(this.query_)}get query(){return this.query_}}function fa(n,e){const t=su(n.viewCache_);return t&&(n.query._queryParams.loadsAllData()||!Nt(e)&&!t.getImmediateChild(Mt(e)).isEmpty())?t.getChild(e):null}function Wd(n){return 0===n.eventRegistrations_.length}function Zu(n,e,t){const r=[];if(t){(0,P.hu)(null==e,"A cancel should cancel all event registrations.");const o=n.query._path;n.eventRegistrations_.forEach(u=>{const c=u.createCancelEvent(t,o);c&&r.push(c)})}if(e){let o=[];for(let u=0;u<n.eventRegistrations_.length;++u){const c=n.eventRegistrations_[u];if(c.matches(e)){if(e.hasAnyCallback()){o=o.concat(n.eventRegistrations_.slice(u+1));break}}else o.push(c)}n.eventRegistrations_=o}else n.eventRegistrations_=[];return r}function Bf(n,e,t,r){e.type===Ds.MERGE&&null!==e.source.queryId&&((0,P.hu)(su(n.viewCache_),"We should always have a full cache before handling merges"),(0,P.hu)(Jg(n.viewCache_),"Missing event cache, even though we have a server cache"));const o=n.viewCache_,u=function Db(n,e,t,r,o){const u=new fw;let c,g;if(t.type===Ds.OVERWRITE){const I=t;I.source.fromUser?c=av(n,e,I.path,I.snap,r,o,u):((0,P.hu)(I.source.fromServer,"Unknown source."),g=I.source.tagged||e.serverCache.isFiltered()&&!Nt(I.path),c=nm(n,e,I.path,I.snap,r,o,g,u))}else if(t.type===Ds.MERGE){const I=t;I.source.fromUser?c=function bb(n,e,t,r,o,u,c){let g=e;return r.foreach((E,I)=>{const S=Cn(t,E);vw(e,Mt(S))&&(g=av(n,g,S,I,o,u,c))}),r.foreach((E,I)=>{const S=Cn(t,E);vw(e,Mt(S))||(g=av(n,g,S,I,o,u,c))}),g}(n,e,I.path,I.children,r,o,u):((0,P.hu)(I.source.fromServer,"Unknown source."),g=I.source.tagged||e.serverCache.isFiltered(),c=Gd(n,e,I.path,I.children,r,o,g,u))}else if(t.type===Ds.ACK_USER_WRITE){const I=t;c=I.revert?function Vf(n,e,t,r,o,u){let c;if(null!=rv(r,t))return e;{const g=new mw(r,e,o),E=e.eventCache.getNode();let I;if(Nt(t)||".priority"===Mt(t)){let S;if(e.serverCache.isFullyInitialized())S=em(r,su(e));else{const M=e.serverCache.getNode();(0,P.hu)(M instanceof ht,"serverChildren would be complete if leaf node"),S=tm(r,M)}S=S,I=n.filter.updateFullNode(E,S,u)}else{const S=Mt(t);let M=hw(r,S,e.serverCache);null==M&&e.serverCache.isCompleteForChild(S)&&(M=E.getImmediateChild(S)),I=null!=M?n.filter.updateChild(E,S,M,dn(t),g,u):e.eventCache.getNode().hasChild(S)?n.filter.updateChild(E,S,ht.EMPTY_NODE,dn(t),g,u):E,I.isEmpty()&&e.serverCache.isFullyInitialized()&&(c=em(r,su(e)),c.isLeafNode()&&(I=n.filter.updateFullNode(I,c,u)))}return c=e.serverCache.isFullyInitialized()||null!=rv(r,Kt()),jd(e,I,c,n.filter.filtersNodes())}}(n,e,I.path,r,o,u):function $d(n,e,t,r,o,u,c){if(null!=rv(o,t))return e;const g=e.serverCache.isFiltered(),E=e.serverCache;if(null!=r.value){if(Nt(t)&&E.isFullyInitialized()||E.isCompleteForPath(t))return nm(n,e,t,E.getNode().getChild(t),o,u,g,c);if(Nt(t)){let I=new pn(null);return E.getNode().forEachChild(da,(S,M)=>{I=I.set(new nn(S),M)}),Gd(n,e,t,I,o,u,g,c)}return e}{let I=new pn(null);return r.foreach((S,M)=>{const F=Cn(t,S);E.isCompleteForPath(F)&&(I=I.set(S,E.getNode().getChild(F)))}),Gd(n,e,t,I,o,u,g,c)}}(n,e,I.path,I.affectedTree,r,o,u)}else{if(t.type!==Ds.LISTEN_COMPLETE)throw(0,P.g5)("Unknown operation type: "+t.type);c=function Tb(n,e,t,r,o){const u=e.serverCache;return yw(n,Yy(e,u.getNode(),u.isFullyInitialized()||Nt(t),u.isFiltered()),t,r,gw,o)}(n,e,t.path,r,u)}const E=u.getChanges();return function ov(n,e,t){const r=e.eventCache;if(r.isFullyInitialized()){const o=r.getNode().isLeafNode()||r.getNode().isEmpty(),u=Jg(n);(t.length>0||!n.eventCache.isFullyInitialized()||o&&!r.getNode().equals(u)||!r.getNode().getPriority().equals(u.getPriority()))&&t.push(Uy(Jg(e)))}}(e,c,E),{viewCache:c,changes:E}}(n.processor_,o,e,t,r);return function sv(n,e){(0,P.hu)(e.eventCache.getNode().isIndexed(n.filter.getIndex()),"Event snap not indexed"),(0,P.hu)(e.serverCache.getNode().isIndexed(n.filter.getIndex()),"Server snap not indexed")}(n.processor_,u.viewCache),(0,P.hu)(u.viewCache.serverCache.isFullyInitialized()||!o.serverCache.isFullyInitialized(),"Once a server snap is complete, it should never go back"),n.viewCache_=u.viewCache,rm(n,u.changes,u.viewCache.eventCache.getNode(),null)}function rm(n,e,t,r){return function Ky(n,e,t,r){const o=[],u=[];return e.forEach(c=>{"child_changed"===c.type&&n.index_.indexedValueChanged(c.oldSnap,c.snapshotNode)&&u.push(function ew(n,e){return{type:"child_moved",snapshotNode:e,childName:n}}(c.childName,c.snapshotNode))}),iu(n,o,"child_removed",e,r,t),iu(n,o,"child_added",e,r,t),iu(n,o,"child_moved",u,r,t),iu(n,o,"child_changed",e,r,t),iu(n,o,"value",e,r,t),o}(n.eventGenerator_,e,t,r?[r]:n.eventRegistrations_)}let ou,jf;class yc{constructor(){this.views=new Map}}function Yu(n,e,t,r){const o=e.source.queryId;if(null!==o){const u=n.views.get(o);return(0,P.hu)(null!=u,"SyncTree gave us an op for an invalid query."),Bf(u,e,t,r)}{let u=[];for(const c of n.views.values())u=u.concat(Bf(c,e,t,r));return u}}function vc(n,e,t,r,o){const c=n.views.get(e._queryIdentifier);if(!c){let g=em(t,o?r:null),E=!1;g?E=!0:r instanceof ht?(g=tm(t,r),E=!1):(g=ht.EMPTY_NODE,E=!1);const I=Ff(new ha(g,E,!1),new ha(r,o,!1));return new Ab(e,I)}return c}function lv(n){const e=[];for(const t of n.views.values())t.query._queryParams.loadsAllData()||e.push(t);return e}function au(n,e){let t=null;for(const r of n.views.values())t=t||fa(r,e);return t}function cv(n,e){return e._queryParams.loadsAllData()?Uf(n):n.views.get(e._queryIdentifier)}function dv(n,e){return null!=cv(n,e)}function uu(n){return null!=Uf(n)}function Uf(n){for(const e of n.views.values())if(e.query._queryParams.loadsAllData())return e;return null}let xb=1;class hv{constructor(e){this.listenProvider_=e,this.syncPointTree_=new pn(null),this.pendingWriteTree_=function tv(){return{visibleWrites:si.empty(),allWrites:[],lastWriteId:-1}}(),this.tagToQueryMap=new Map,this.queryToTagMap=new Map}}function fv(n,e,t,r,o){return function uw(n,e,t,r,o){(0,P.hu)(r>n.lastWriteId,"Stacking an older write on top of newer ones"),void 0===o&&(o=!0),n.allWrites.push({path:e,snap:t,writeId:r,visible:o}),o&&(n.visibleWrites=Hd(n.visibleWrites,e,t)),n.lastWriteId=r}(n.pendingWriteTree_,e,t,r,o),o?Qu(n,new mc({fromUser:!0,fromServer:!1,queryId:null,tagged:!1},e,t)):[]}function lu(n,e,t=!1){const r=function cw(n,e){for(let t=0;t<n.allWrites.length;t++){const r=n.allWrites[t];if(r.writeId===e)return r}return null}(n.pendingWriteTree_,e);if(function mb(n,e){const t=n.allWrites.findIndex(g=>g.writeId===e);(0,P.hu)(t>=0,"removeWrite called with nonexistent writeId.");const r=n.allWrites[t];n.allWrites.splice(t,1);let o=r.visible,u=!1,c=n.allWrites.length-1;for(;o&&c>=0;){const g=n.allWrites[c];g.visible&&(c>=t&&_b(g,r.path)?o=!1:yo(r.path,g.path)&&(u=!0)),c--}return!!o&&(u?(function yb(n){n.visibleWrites=ev(n.allWrites,vb,Kt()),n.lastWriteId=n.allWrites.length>0?n.allWrites[n.allWrites.length-1].writeId:-1}(n),!0):(r.snap?n.visibleWrites=ow(n.visibleWrites,r.path):Sn(r.children,E=>{n.visibleWrites=ow(n.visibleWrites,Cn(r.path,E))}),!0))}(n.pendingWriteTree_,e)){let u=new pn(null);return null!=r.snap?u=u.set(Kt(),!0):Sn(r.children,c=>{u=u.set(new nn(c),!0)}),Qu(n,new gc(r.path,u,t))}return[]}function Hf(n,e,t){return Qu(n,new mc({fromUser:!1,fromServer:!0,queryId:null,tagged:!1},e,t))}function im(n,e,t,r){const o=e._path,u=n.syncPointTree_.get(o);let c=[];if(u&&("default"===e._queryIdentifier||dv(u,e))){const g=function Yd(n,e,t,r){const o=e._queryIdentifier,u=[];let c=[];const g=uu(n);if("default"===o)for(const[E,I]of n.views.entries())c=c.concat(Zu(I,t,r)),Wd(I)&&(n.views.delete(E),I.query._queryParams.loadsAllData()||u.push(I.query));else{const E=n.views.get(o);E&&(c=c.concat(Zu(E,t,r)),Wd(E)&&(n.views.delete(o),E.query._queryParams.loadsAllData()||u.push(E.query)))}return g&&!uu(n)&&u.push(new(function zd(){return(0,P.hu)(ou,"Reference.ts has not been loaded"),ou}())(e._repo,e._path)),{removed:u,events:c}}(u,e,t,r);(function Kd(n){return 0===n.views.size})(u)&&(n.syncPointTree_=n.syncPointTree_.remove(o));const E=g.removed;c=g.events;const I=-1!==E.findIndex(M=>M._queryParams.loadsAllData()),S=n.syncPointTree_.findOnPath(o,(M,F)=>uu(F));if(I&&!S){const M=n.syncPointTree_.subtree(o);if(!M.isEmpty()){const F=function Qd(n){return n.fold((e,t,r)=>{if(t&&uu(t))return[Uf(t)];{let o=[];return t&&(o=lv(t)),Sn(r,(u,c)=>{o=o.concat(c)}),o}})}(M);for(let W=0;W<F.length;++W){const Y=F[W],xe=Y.query,qe=Lb(n,Y);n.listenProvider_.startListening(Gf(xe),gv(n,xe),qe.hashFn,qe.onComplete)}}}if(!S&&E.length>0&&!r)if(I){const M=null;n.listenProvider_.stopListening(Gf(e),M)}else E.forEach(M=>{const F=n.queryToTagMap.get(om(M));n.listenProvider_.stopListening(Gf(M),F)});!function Tw(n,e){for(let t=0;t<e.length;++t){const r=e[t];if(!r._queryParams.loadsAllData()){const o=om(r),u=n.queryToTagMap.get(o);n.queryToTagMap.delete(o),n.tagToQueryMap.delete(u)}}}(n,E)}return c}function kb(n,e,t){const r=e._path;let o=null,u=!1;n.syncPointTree_.foreachOnPath(r,(M,F)=>{const W=zr(M,r);o=o||au(F,W),u=u||uu(F)});let g,c=n.syncPointTree_.get(r);c?(u=u||uu(c),o=o||au(c,Kt())):(c=new yc,n.syncPointTree_=n.syncPointTree_.set(r,c)),null!=o?g=!0:(g=!1,o=ht.EMPTY_NODE,n.syncPointTree_.subtree(r).foreachChild((F,W)=>{const Y=au(W,Kt());Y&&(o=o.updateImmediateChild(F,Y))}));const E=dv(c,e);if(!E&&!e._queryParams.loadsAllData()){const M=om(e);(0,P.hu)(!n.queryToTagMap.has(M),"View does not exist, but we have a tag");const F=function Vb(){return xb++}();n.queryToTagMap.set(M,F),n.tagToQueryMap.set(F,M)}let S=function Zd(n,e,t,r,o,u){const c=vc(n,e,r,o,u);return n.views.has(e._queryIdentifier)||n.views.set(e._queryIdentifier,c),function oi(n,e){n.eventRegistrations_.push(e)}(c,t),function zs(n,e){const t=n.viewCache_.eventCache,r=[];return t.getNode().isLeafNode()||t.getNode().forEachChild(fn,(u,c)=>{r.push(Ld(u,c))}),t.isFullyInitialized()&&r.push(Uy(t.getNode())),rm(n,r,t.getNode(),e)}(c,t)}(c,e,t,Lf(n.pendingWriteTree_,r),o,g);if(!E&&!u){const M=cv(c,e);S=S.concat(function Aw(n,e,t){const r=e._path,o=gv(n,e),u=Lb(n,t),c=n.listenProvider_.startListening(Gf(e),o,u.hashFn,u.onComplete),g=n.syncPointTree_.subtree(r);if(o)(0,P.hu)(!uu(g.value),"If we're adding a query, it shouldn't be shadowed");else{const E=g.fold((I,S,M)=>{if(!Nt(I)&&S&&uu(S))return[Uf(S).query];{let F=[];return S&&(F=F.concat(lv(S).map(W=>W.query))),Sn(M,(W,Y)=>{F=F.concat(Y)}),F}});for(let I=0;I<E.length;++I){const S=E[I];n.listenProvider_.stopListening(Gf(S),gv(n,S))}}return c}(n,e,M))}return S}function sm(n,e,t){const o=n.pendingWriteTree_,u=n.syncPointTree_.findOnPath(e,(c,g)=>{const I=au(g,zr(c,e));if(I)return I});return Eb(o,e,u,t,!0)}function Qu(n,e){return Dw(e,n.syncPointTree_,null,Lf(n.pendingWriteTree_,Kt()))}function Dw(n,e,t,r){if(Nt(n.path))return Fb(n,e,t,r);{const o=e.get(Kt());null==t&&null!=o&&(t=au(o,Kt()));let u=[];const c=Mt(n.path),g=n.operationForChild(c),E=e.children.get(c);if(E&&g){const I=t?t.getImmediateChild(c):null,S=Cb(r,c);u=u.concat(Dw(g,E,I,S))}return o&&(u=u.concat(Yu(o,n,r,t))),u}}function Fb(n,e,t,r){const o=e.get(Kt());null==t&&null!=o&&(t=au(o,Kt()));let u=[];return e.children.inorderTraversal((c,g)=>{const E=t?t.getImmediateChild(c):null,I=Cb(r,c),S=n.operationForChild(c);S&&(u=u.concat(Fb(S,g,E,I)))}),o&&(u=u.concat(Yu(o,n,r,t))),u}function Lb(n,e){const t=e.query,r=gv(n,t);return{hashFn:()=>(function Sb(n){return n.viewCache_.serverCache.getNode()}(e)||ht.EMPTY_NODE).hash(),onComplete:o=>{if("ok"===o)return r?function Rb(n,e,t){const r=am(n,t);if(r){const o=bw(r),u=o.path,c=o.queryId,g=zr(u,e);return mv(n,u,new Of(Eo(c),g))}return[]}(n,t._path,r):function Cw(n,e){return Qu(n,new Of({fromUser:!1,fromServer:!0,queryId:null,tagged:!1},e))}(n,t._path);{const u=function Dy(n,e){let t="Unknown Error";"too_big"===n?t="The data requested exceeds the maximum size that can be accessed with a single request.":"permission_denied"===n?t="Client doesn't have permission to access the desired data.":"unavailable"===n&&(t="The service is unavailable");const r=new Error(n+" at "+e._path.toString()+": "+t);return r.code=n.toUpperCase(),r}(o,t);return im(n,t,null,u)}}}}function gv(n,e){const t=om(e);return n.queryToTagMap.get(t)}function om(n){return n._path.toString()+"$"+n._queryIdentifier}function am(n,e){return n.tagToQueryMap.get(e)}function bw(n){const e=n.indexOf("$");return(0,P.hu)(-1!==e&&e<n.length-1,"Bad queryKey."),{queryId:n.substr(e+1),path:new nn(n.substr(0,e))}}function mv(n,e,t){const r=n.syncPointTree_.get(e);return(0,P.hu)(r,"Missing sync point for query tag that we're tracking"),Yu(r,t,Lf(n.pendingWriteTree_,e),null)}function Gf(n){return n._queryParams.loadsAllData()&&!n._queryParams.isDefault()?new(function Iw(){return(0,P.hu)(jf,"Reference.ts has not been loaded"),jf}())(n._repo,n._path):n}class Jd{constructor(e){this.node_=e}getImmediateChild(e){const t=this.node_.getImmediateChild(e);return new Jd(t)}node(){return this.node_}}class _v{constructor(e,t){this.syncTree_=e,this.path_=t}getImmediateChild(e){const t=Cn(this.path_,e);return new _v(this.syncTree_,t)}node(){return sm(this.syncTree_,this.path_)}}const xw=function(n,e,t){return n&&"object"==typeof n?((0,P.hu)(".sv"in n,"Unexpected leaf node or priority contents"),"string"==typeof n[".sv"]?Bb(n[".sv"],e,t):"object"==typeof n[".sv"]?Ub(n[".sv"],e):void(0,P.hu)(!1,"Unexpected server value: "+JSON.stringify(n,null,2))):n},Bb=function(n,e,t){if("timestamp"===n)return t.timestamp;(0,P.hu)(!1,"Unexpected server value: "+n)},Ub=function(n,e,t){n.hasOwnProperty("increment")||(0,P.hu)(!1,"Unexpected server value: "+JSON.stringify(n,null,2));const r=n.increment;"number"!=typeof r&&(0,P.hu)(!1,"Unexpected increment value: "+r);const o=e.node();if((0,P.hu)(null!=o,"Expected ChildrenNode.EMPTY_NODE for nulls"),!o.isLeafNode())return r;const c=o.getValue();return"number"!=typeof c?r:c+r},Mw=function(n,e,t,r){return um(e,new _v(t,n),r)},yv=function(n,e,t){return um(n,new Jd(e),t)};function um(n,e,t){const r=n.getPriority().val(),o=xw(r,e.getImmediateChild(".priority"),t);let u;if(n.isLeafNode()){const c=n,g=xw(c.getValue(),e,t);return g!==c.getValue()||o!==c.getPriority().val()?new fc(g,zn(o)):n}{const c=n;return u=c,o!==c.getPriority().val()&&(u=u.updatePriority(new fc(o))),c.forEachChild(fn,(g,E)=>{const I=um(E,e.getImmediateChild(g),t);I!==E&&(u=u.updateImmediateChild(g,I))}),u}}class vv{constructor(e="",t=null,r={children:{},childCount:0}){this.name=e,this.parent=t,this.node=r}}function $f(n,e){let t=e instanceof nn?e:new nn(e),r=n,o=Mt(t);for(;null!==o;){const u=(0,P.DV)(r.node.children,o)||{children:{},childCount:0};r=new vv(o,r,u),t=dn(t),o=Mt(t)}return r}function Ju(n){return n.node.value}function Wf(n,e){n.node.value=e,Kf(n)}function jb(n){return n.node.childCount>0}function lm(n,e){Sn(n.node.children,(t,r)=>{e(new vv(t,n,r))})}function Hb(n,e,t,r){t&&!r&&e(n),lm(n,o=>{Hb(o,e,!0,r)}),t&&r&&e(n)}function zf(n){return new nn(null===n.parent?n.name:zf(n.parent)+"/"+n.name)}function Kf(n){null!==n.parent&&function wv(n,e,t){const r=function Ev(n){return void 0===Ju(n)&&!jb(n)}(t),o=(0,P.r3)(n.node.children,e);r&&o?(delete n.node.children[e],n.node.childCount--,Kf(n)):!r&&!o&&(n.node.children[e]=t.node,n.node.childCount++,Kf(n))}(n.parent,n.name,n)}const Gb=/[\[\].#$\/\u0000-\u001F\u007F]/,Iv=/[\[\].#$\u0000-\u001F\u007F]/,Zf=10485760,Yf=function(n){return"string"==typeof n&&0!==n.length&&!Gb.test(n)},$b=function(n){return"string"==typeof n&&0!==n.length&&!Iv.test(n)},Xd=function(n){return null===n||"string"==typeof n||"number"==typeof n&&!fr(n)||n&&"object"==typeof n&&(0,P.r3)(n,".sv")},Io=function(n,e,t,r){r&&void 0===e||Qf((0,P.gK)(n,"value"),e,t)},Qf=function(n,e,t){const r=t instanceof nn?new uM(t,n):t;if(void 0===e)throw new Error(n+"contains undefined "+kd(r));if("function"==typeof e)throw new Error(n+"contains a function "+kd(r)+" with contents = "+e.toString());if(fr(e))throw new Error(n+"contains "+e.toString()+" "+kd(r));if("string"==typeof e&&e.length>Zf/3&&(0,P.ug)(e)>Zf)throw new Error(n+"contains a string greater than "+Zf+" utf8 bytes "+kd(r)+" ('"+e.substring(0,50)+"...')");if(e&&"object"==typeof e){let o=!1,u=!1;if(Sn(e,(c,g)=>{if(".value"===c)o=!0;else if(".priority"!==c&&".sv"!==c&&(u=!0,!Yf(c)))throw new Error(n+" contains an invalid key ("+c+") "+kd(r)+'.  Keys must be non-empty strings and can\'t contain ".", "#", "$", "/", "[", or "]"');(function lM(n,e){n.parts_.length>0&&(n.byteLength_+=1),n.parts_.push(e),n.byteLength_+=(0,P.ug)(e),rb(n)})(r,c),Qf(n,g,r),function cM(n){const e=n.parts_.pop();n.byteLength_-=(0,P.ug)(e),n.parts_.length>0&&(n.byteLength_-=1)}(r)}),o&&u)throw new Error(n+' contains ".value" child '+kd(r)+" in addition to actual children.")}},cm=function(n,e,t,r){if(r&&void 0===e)return;const o=(0,P.gK)(n,"values");if(!e||"object"!=typeof e||Array.isArray(e))throw new Error(o+" must be an object containing the children to replace.");const u=[];Sn(e,(c,g)=>{const E=new nn(c);if(Qf(o,g,Cn(t,E)),".priority"===H0(E)&&!Xd(g))throw new Error(o+"contains an invalid value for '"+E.toString()+"', which must be a valid Firebase priority (a string, finite number, server value, or null).");u.push(E)}),function(n,e){let t,r;for(t=0;t<e.length;t++){r=e[t];const u=Lg(r);for(let c=0;c<u.length;c++)if((".priority"!==u[c]||c!==u.length-1)&&!Yf(u[c]))throw new Error(n+"contains an invalid key ("+u[c]+") in path "+r.toString()+'. Keys must be non-empty strings and can\'t contain ".", "#", "$", "/", "[", or "]"')}e.sort(aM);let o=null;for(t=0;t<e.length;t++){if(r=e[t],null!==o&&yo(o,r))throw new Error(n+"contains a path "+o.toString()+" that is ancestor of another path "+r.toString());o=r}}(o,u)},dm=function(n,e,t){if(!t||void 0!==e){if(fr(e))throw new Error((0,P.gK)(n,"priority")+"is "+e.toString()+", but must be a valid Firebase priority (a string, finite number, server value, or null).");if(!Xd(e))throw new Error((0,P.gK)(n,"priority")+"must be a valid Firebase priority (a string, finite number, server value, or null).")}},eh=function(n,e,t,r){if(!(r&&void 0===t||Yf(t)))throw new Error((0,P.gK)(n,e)+'was an invalid key = "'+t+'".  Firebase keys must be non-empty strings and can\'t contain ".", "#", "$", "/", "[", or "]").')},Ec=function(n,e,t,r){if(!(r&&void 0===t||$b(t)))throw new Error((0,P.gK)(n,e)+'was an invalid path = "'+t+'". Paths must be non-empty strings and can\'t contain ".", "#", "$", "[", or "]"')},Ks=function(n,e){if(".info"===Mt(e))throw new Error(n+" failed = Can't modify data under /.info/")},Cv=function(n,e){const t=e.path.toString();if("string"!=typeof e.repoInfo.host||0===e.repoInfo.host.length||!Yf(e.repoInfo.namespace)&&"localhost"!==e.repoInfo.host.split(":")[0]||0!==t.length&&!function(n){return n&&(n=n.replace(/^\/*\.info(\/|$)/,"/")),$b(n)}(t))throw new Error((0,P.gK)(n,"url")+'must be a valid firebase URL and the path can\'t contain ".", "#", "$", "[", or "]".')};class Pw{constructor(){this.eventLists_=[],this.recursionDepth_=0}}function th(n,e){let t=null;for(let r=0;r<e.length;r++){const o=e[r],u=o.getPath();null!==t&&!G0(u,t.path)&&(n.eventLists_.push(t),t=null),null===t&&(t={events:[],path:u}),t.events.push(o)}t&&n.eventLists_.push(t)}function hm(n,e,t){th(n,t),Ow(n,r=>G0(r,e))}function Zs(n,e,t){th(n,t),Ow(n,r=>yo(r,e)||yo(e,r))}function Ow(n,e){n.recursionDepth_++;let t=!0;for(let r=0;r<n.eventLists_.length;r++){const o=n.eventLists_[r];o&&(e(o.path)?(qb(n.eventLists_[r]),n.eventLists_[r]=null):t=!1)}t&&(n.eventLists_=[]),n.recursionDepth_--}function qb(n){for(let e=0;e<n.events.length;e++){const t=n.events[e];if(null!==t){n.events[e]=null;const r=t.getEventRunner();aa&&un("event: "+t.toString()),b(r)}}}const Dv="repo_interrupt";class kw{constructor(e,t,r,o){this.repoInfo_=e,this.forceRestClient_=t,this.authTokenProvider_=r,this.appCheckProvider_=o,this.dataUpdateCount=0,this.statsListener_=null,this.eventQueue_=new Pw,this.nextWriteId_=1,this.interceptServerDataCallback_=null,this.onDisconnect_=Ud(),this.transactionQueueTree_=new vv,this.persistentConnection_=null,this.key=this.repoInfo_.toURLString()}toString(){return(this.repoInfo_.secure?"https://":"http://")+this.repoInfo_.host}}function Tv(n){const t=n.infoData_.getNode(new nn(".info/serverTimeOffset")).val()||0;return(new Date).getTime()+t}function nh(n){return function(n){return(n=n||{}).timestamp=n.timestamp||(new Date).getTime(),n}({timestamp:Tv(n)})}function Av(n,e,t,r,o){n.dataUpdateCount++;const u=new nn(e);t=n.interceptServerDataCallback_?n.interceptServerDataCallback_(e,t):t;let c=[];if(o)if(r){const E=(0,P.UI)(t,I=>zn(I));c=function Ob(n,e,t,r){const o=am(n,r);if(o){const u=bw(o),c=u.path,g=u.queryId,E=zr(c,e),I=pn.fromObject(t);return mv(n,c,new kf(Eo(g),E,I))}return[]}(n.serverSyncTree_,u,E,o)}else{const E=zn(t);c=function Pb(n,e,t,r){const o=am(n,r);if(null!=o){const u=bw(o),c=u.path,g=u.queryId,E=zr(c,e);return mv(n,c,new mc(Eo(g),E,t))}return[]}(n.serverSyncTree_,u,E,o)}else if(r){const E=(0,P.UI)(t,I=>zn(I));c=function Nb(n,e,t){const r=pn.fromObject(t);return Qu(n,new kf({fromUser:!1,fromServer:!0,queryId:null,tagged:!1},e,r))}(n.serverSyncTree_,u,E)}else{const E=zn(t);c=Hf(n.serverSyncTree_,u,E)}let g=u;c.length>0&&(g=Jf(n,u)),Zs(n.eventQueue_,g,c)}function Sv(n,e){fm(n,"connected",e),!1===e&&function Kb(n){Co(n,"onDisconnectEvents");const e=nh(n),t=Ud();qy(n.onDisconnect_,Kt(),(o,u)=>{const c=Mw(o,u,n.serverSyncTree_,e);qu(t,o,c)});let r=[];qy(t,Kt(),(o,u)=>{r=r.concat(Hf(n.serverSyncTree_,o,u));const c=Ys(n,o);Jf(n,c)}),n.onDisconnect_=Ud(),Zs(n.eventQueue_,Kt(),r)}(n)}function fm(n,e,t){const r=new nn("/.info/"+e),o=zn(t);n.infoData_.updateSnapshot(r,o);const u=Hf(n.infoSyncTree_,r,o);Zs(n.eventQueue_,r,u)}function xv(n){return n.nextWriteId_++}function Mv(n,e,t,r,o){Co(n,"set",{path:e.toString(),value:t,priority:r});const u=nh(n),c=zn(t,r),g=sm(n.serverSyncTree_,e),E=yv(c,g,u),I=xv(n),S=fv(n.serverSyncTree_,e,E,I,!0);th(n.eventQueue_,S),n.server_.put(e.toString(),c.val(!0),(F,W)=>{const Y="ok"===F;Y||rr("set at "+e+" failed: "+F);const xe=lu(n.serverSyncTree_,I,!Y);Zs(n.eventQueue_,e,xe),Xu(0,o,F,W)});const M=Ys(n,e);Jf(n,M),Zs(n.eventQueue_,M,[])}function vr(n,e,t){n.server_.onDisconnectCancel(e.toString(),(r,o)=>{"ok"===r&&Zg(n.onDisconnect_,e),Xu(0,t,r,o)})}function Nv(n,e,t,r){const o=zn(t);n.server_.onDisconnectPut(e.toString(),o.val(!0),(u,c)=>{"ok"===u&&qu(n.onDisconnect_,e,o),Xu(0,r,u,c)})}function Rv(n,e,t){let r;r=".info"===Mt(e._path)?im(n.infoSyncTree_,e,t):im(n.serverSyncTree_,e,t),hm(n.eventQueue_,e._path,r)}function Pv(n){n.persistentConnection_&&n.persistentConnection_.interrupt(Dv)}function Co(n,...e){let t="";n.persistentConnection_&&(t=n.persistentConnection_.id+":"),un(t,...e)}function Xu(n,e,t,r){e&&b(()=>{if("ok"===t)e(null);else{const o=(t||"error").toUpperCase();let u=o;r&&(u+=": "+r);const c=new Error(u);c.code=o,e(c)}})}function pm(n,e,t){return sm(n.serverSyncTree_,e,t)||ht.EMPTY_NODE}function gm(n,e=n.transactionQueueTree_){if(e||_m(n,e),Ju(e)){const t=Do(n,e);(0,P.hu)(t.length>0,"Sending zero length transaction queue"),t.every(o=>0===o.status)&&function jw(n,e,t){const r=t.map(I=>I.currentWriteId),o=pm(n,e,r);let u=o;const c=o.hash();for(let I=0;I<t.length;I++){const S=t[I];(0,P.hu)(0===S.status,"tryToSendTransactionQueue_: items in queue should all be run."),S.status=1,S.retryCount++;const M=zr(e,S.path);u=u.updateChild(M,S.currentOutputSnapshotRaw)}const g=u.val(!0),E=e;n.server_.put(E.toString(),g,I=>{Co(n,"transaction put response",{path:E.toString(),status:I});let S=[];if("ok"===I){const M=[];for(let F=0;F<t.length;F++)t[F].status=2,S=S.concat(lu(n.serverSyncTree_,t[F].currentWriteId)),t[F].onComplete&&M.push(()=>t[F].onComplete(null,!0,t[F].currentOutputSnapshotResolved)),t[F].unwatcher();_m(n,$f(n.transactionQueueTree_,e)),gm(n,n.transactionQueueTree_),Zs(n.eventQueue_,e,S);for(let F=0;F<M.length;F++)b(M[F])}else{if("datastale"===I)for(let M=0;M<t.length;M++)t[M].status=3===t[M].status?4:0;else{rr("transaction at "+E.toString()+" failed: "+I);for(let M=0;M<t.length;M++)t[M].status=4,t[M].abortReason=I}Jf(n,e)}},c)}(n,zf(e),t)}else jb(e)&&lm(e,t=>{gm(n,t)})}function Jf(n,e){const t=mm(n,e),r=zf(t);return function Hw(n,e,t){if(0===e.length)return;const r=[];let o=[];const c=e.filter(g=>0===g.status).map(g=>g.currentWriteId);for(let g=0;g<e.length;g++){const E=e[g],I=zr(t,E.path);let M,S=!1;if((0,P.hu)(null!==I,"rerunTransactionsUnderNode_: relativePath should not be null."),4===E.status)S=!0,M=E.abortReason,o=o.concat(lu(n.serverSyncTree_,E.currentWriteId,!0));else if(0===E.status)if(E.retryCount>=25)S=!0,M="maxretry",o=o.concat(lu(n.serverSyncTree_,E.currentWriteId,!0));else{const F=pm(n,E.path,c);E.currentInputSnapshot=F;const W=e[g].update(F.val());if(void 0!==W){Qf("transaction failed: Data returned ",W,E.path);let Y=zn(W);"object"==typeof W&&null!=W&&(0,P.r3)(W,".priority")||(Y=Y.updatePriority(F.getPriority()));const qe=E.currentWriteId,Pt=nh(n),Bt=yv(Y,F,Pt);E.currentOutputSnapshotRaw=Y,E.currentOutputSnapshotResolved=Bt,E.currentWriteId=xv(n),c.splice(c.indexOf(qe),1),o=o.concat(fv(n.serverSyncTree_,E.path,Bt,E.currentWriteId,E.applyLocally)),o=o.concat(lu(n.serverSyncTree_,qe,!0))}else S=!0,M="nodata",o=o.concat(lu(n.serverSyncTree_,E.currentWriteId,!0))}Zs(n.eventQueue_,t,o),o=[],S&&(e[g].status=2,setTimeout(e[g].unwatcher,Math.floor(0)),e[g].onComplete&&r.push("nodata"===M?()=>e[g].onComplete(null,!1,e[g].currentInputSnapshot):()=>e[g].onComplete(new Error(M),!1,null)))}_m(n,n.transactionQueueTree_);for(let g=0;g<r.length;g++)b(r[g]);gm(n,n.transactionQueueTree_)}(n,Do(n,t),r),r}function mm(n,e){let t,r=n.transactionQueueTree_;for(t=Mt(e);null!==t&&void 0===Ju(r);)r=$f(r,t),t=Mt(e=dn(e));return r}function Do(n,e){const t=[];return Gw(n,e,t),t.sort((r,o)=>r.order-o.order),t}function Gw(n,e,t){const r=Ju(e);if(r)for(let o=0;o<r.length;o++)t.push(r[o]);lm(e,o=>{Gw(n,o,t)})}function _m(n,e){const t=Ju(e);if(t){let r=0;for(let o=0;o<t.length;o++)2!==t[o].status&&(t[r]=t[o],r++);t.length=r,Wf(e,t.length>0?t:void 0)}lm(e,r=>{_m(n,r)})}function Ys(n,e){const t=zf(mm(n,e)),r=$f(n.transactionQueueTree_,e);return function qf(n,e,t){let r=t?n:n.parent;for(;null!==r;){if(e(r))return!0;r=r.parent}}(r,o=>{bs(n,o)}),bs(n,r),Hb(r,o=>{bs(n,o)}),t}function bs(n,e){const t=Ju(e);if(t){const r=[];let o=[],u=-1;for(let c=0;c<t.length;c++)3===t[c].status||(1===t[c].status?((0,P.hu)(u===c-1,"All SENT items should be at beginning of queue."),u=c,t[c].status=3,t[c].abortReason="set"):((0,P.hu)(0===t[c].status,"Unexpected transaction status in abort"),t[c].unwatcher(),o=o.concat(lu(n.serverSyncTree_,t[c].currentWriteId,!0)),t[c].onComplete&&r.push(t[c].onComplete.bind(null,new Error("set"),!1,null))));-1===u?Wf(e,void 0):t.length=u+1,Zs(n.eventQueue_,zf(e),o);for(let c=0;c<r.length;c++)b(r[c])}}const ym=function(n,e){const t=Jb(n),r=t.namespace;return"firebase.com"===t.domain&&Is(t.host+" is no longer supported. Please use <YOUR FIREBASE>.firebaseio.com instead"),(!r||"undefined"===r)&&"localhost"!==t.domain&&Is("Cannot parse Firebase url. Please use https://<YOUR FIREBASE>.firebaseio.com"),t.secure||"undefined"!=typeof window&&window.location&&window.location.protocol&&-1!==window.location.protocol.indexOf("https:")&&rr("Insecure Firebase access from a secure page. Please use https in calls to new Firebase()."),{repoInfo:new nu(t.host,t.secure,r,e,"ws"===t.scheme||"wss"===t.scheme,"",r!==t.subdomain),path:new nn(t.pathString)}},Jb=function(n){let e="",t="",r="",o="",u="",c=!0,g="https",E=443;if("string"==typeof n){let I=n.indexOf("//");I>=0&&(g=n.substring(0,I-1),n=n.substring(I+2));let S=n.indexOf("/");-1===S&&(S=n.length);let M=n.indexOf("?");-1===M&&(M=n.length),e=n.substring(0,Math.min(S,M)),S<M&&(o=function bo(n){let e="";const t=n.split("/");for(let r=0;r<t.length;r++)if(t[r].length>0){let o=t[r];try{o=decodeURIComponent(o.replace(/\+/g," "))}catch(u){}e+="/"+o}return e}(n.substring(S,M)));const F=function $w(n){const e={};"?"===n.charAt(0)&&(n=n.substring(1));for(const t of n.split("&")){if(0===t.length)continue;const r=t.split("=");2===r.length?e[decodeURIComponent(r[0])]=decodeURIComponent(r[1]):rr(`Invalid query segment '${t}' in query '${n}'`)}return e}(n.substring(Math.min(n.length,M)));I=e.indexOf(":"),I>=0?(c="https"===g||"wss"===g,E=parseInt(e.substring(I+1),10)):I=e.length;const W=e.slice(0,I);if("localhost"===W.toLowerCase())t="localhost";else if(W.split(".").length<=2)t=W;else{const Y=e.indexOf(".");r=e.substring(0,Y).toLowerCase(),t=e.substring(Y+1),u=r}"ns"in F&&(u=F.ns)}return{host:e,port:E,domain:t,subdomain:r,secure:c,scheme:g,pathString:o,namespace:u}};class Ww{constructor(e,t,r,o){this.eventType=e,this.eventRegistration=t,this.snapshot=r,this.prevName=o}getPath(){const e=this.snapshot.ref;return"value"===this.eventType?e._path:e.parent._path}getEventType(){return this.eventType}getEventRunner(){return this.eventRegistration.getEventRunner(this)}toString(){return this.getPath().toString()+":"+this.eventType+":"+(0,P.Pz)(this.snapshot.exportVal())}}class qw{constructor(e,t,r){this.eventRegistration=e,this.error=t,this.path=r}getPath(){return this.path}getEventType(){return"cancel"}getEventRunner(){return this.eventRegistration.getEventRunner(this)}toString(){return this.path.toString()+":cancel"}}class zw{constructor(e,t){this.snapshotCallback=e,this.cancelCallback=t}onValue(e,t){this.snapshotCallback.call(null,e,t)}onCancel(e){return(0,P.hu)(this.hasCancelCallback,"Raising a cancel event on a listener with no cancel callback"),this.cancelCallback.call(null,e)}get hasCancelCallback(){return!!this.cancelCallback}matches(e){return this.snapshotCallback===e.snapshotCallback||void 0!==this.snapshotCallback.userCallback&&this.snapshotCallback.userCallback===e.snapshotCallback.userCallback&&this.snapshotCallback.context===e.snapshotCallback.context}}class vm{constructor(e,t){this._repo=e,this._path=t}cancel(){const e=new P.BH;return vr(this._repo,this._path,e.wrapCallback(()=>{})),e.promise}remove(){Ks("OnDisconnect.remove",this._path);const e=new P.BH;return Nv(this._repo,this._path,null,e.wrapCallback(()=>{})),e.promise}set(e){Ks("OnDisconnect.set",this._path),Io("OnDisconnect.set",e,this._path,!1);const t=new P.BH;return Nv(this._repo,this._path,e,t.wrapCallback(()=>{})),t.promise}setWithPriority(e,t){Ks("OnDisconnect.setWithPriority",this._path),Io("OnDisconnect.setWithPriority",e,this._path,!1),dm("OnDisconnect.setWithPriority",t,!1);const r=new P.BH;return function Zb(n,e,t,r,o){const u=zn(t,r);n.server_.onDisconnectPut(e.toString(),u.val(!0),(c,g)=>{"ok"===c&&qu(n.onDisconnect_,e,u),Xu(0,o,c,g)})}(this._repo,this._path,e,t,r.wrapCallback(()=>{})),r.promise}update(e){Ks("OnDisconnect.update",this._path),cm("OnDisconnect.update",e,this._path,!1);const t=new P.BH;return function Yb(n,e,t,r){if((0,P.xb)(t))return un("onDisconnect().update() called with empty data.  Don't do anything."),void Xu(0,r,"ok",void 0);n.server_.onDisconnectMerge(e.toString(),t,(o,u)=>{"ok"===o&&Sn(t,(c,g)=>{const E=zn(g);qu(n.onDisconnect_,Cn(e,c),E)}),Xu(0,r,o,u)})}(this._repo,this._path,e,t.wrapCallback(()=>{})),t.promise}}class Nr{constructor(e,t,r,o){this._repo=e,this._path=t,this._queryParams=r,this._orderByCalled=o}get key(){return Nt(this._path)?null:H0(this._path)}get ref(){return new Ts(this._repo,this._path)}get _queryIdentifier(){const e=Pf(this._queryParams),t=sc(e);return"{}"===t?"default":t}get _queryObject(){return Pf(this._queryParams)}isEqual(e){if(!((e=(0,P.m9)(e))instanceof Nr))return!1;const t=this._repo===e._repo,r=G0(this._path,e._path);return t&&r&&this._queryIdentifier===e._queryIdentifier}toJSON(){return this.toString()}toString(){return this._repo.toString()+function nb(n){let e="";for(let t=n.pieceNum_;t<n.pieces_.length;t++)""!==n.pieces_[t]&&(e+="/"+encodeURIComponent(String(n.pieces_[t])));return e||"/"}(this._path)}}function Em(n,e){if(!0===n._orderByCalled)throw new Error(e+": You can't combine multiple orderBy calls.")}function cu(n){let e=null,t=null;if(n.hasStart()&&(e=n.getIndexStartValue()),n.hasEnd()&&(t=n.getIndexEndValue()),n.getIndex()===da){const r="Query: When ordering by key, you may only pass one argument to startAt(), endAt(), or equalTo().",o="Query: When ordering by key, the argument passed to startAt(), startAfter(), endAt(), endBefore(), or equalTo() must be a string.";if(n.hasStart()){if(n.getIndexStartName()!==Mi)throw new Error(r);if("string"!=typeof e)throw new Error(o)}if(n.hasEnd()){if(n.getIndexEndName()!==Cs)throw new Error(r);if("string"!=typeof t)throw new Error(o)}}else if(n.getIndex()===fn){if(null!=e&&!Xd(e)||null!=t&&!Xd(t))throw new Error("Query: When ordering by priority, the first argument passed to startAt(), startAfter() endAt(), endBefore(), or equalTo() must be a valid priority value (null, a number, or a string).")}else if((0,P.hu)(n.getIndex()instanceof Wg||n.getIndex()===Vy,"unknown index type."),null!=e&&"object"==typeof e||null!=t&&"object"==typeof t)throw new Error("Query: First argument passed to startAt(), startAfter(), endAt(), endBefore(), or equalTo() cannot be an object.")}function wm(n){if(n.hasStart()&&n.hasEnd()&&n.hasLimit()&&!n.hasAnchoredLimit())throw new Error("Query: Can't combine startAt(), startAfter(), endAt(), endBefore(), and limit(). Use limitToFirst() or limitToLast() instead.")}class Ts extends Nr{constructor(e,t){super(e,t,new zg,!1)}get parent(){const e=Py(this._path);return null===e?null:new Ts(this._repo,e)}get root(){let e=this;for(;null!==e.parent;)e=e.parent;return e}}class el{constructor(e,t,r){this._node=e,this.ref=t,this._index=r}get priority(){return this._node.getPriority().val()}get key(){return this.ref.key}get size(){return this._node.numChildren()}child(e){const t=new nn(e),r=tl(this.ref,e);return new el(this._node.getChild(t),r,fn)}exists(){return!this._node.isEmpty()}exportVal(){return this._node.val(!0)}forEach(e){return!this._node.isLeafNode()&&!!this._node.forEachChild(this._index,(r,o)=>e(new el(o,tl(this.ref,r),fn)))}hasChild(e){const t=new nn(e);return!this._node.getChild(t).isEmpty()}hasChildren(){return!this._node.isLeafNode()&&!this._node.isEmpty()}toJSON(){return this.exportVal()}val(){return this._node.val()}}function Xf(n,e){return(n=(0,P.m9)(n))._checkNotDeleted("ref"),void 0!==e?tl(n._root,e):n._root}function Kw(n,e){(n=(0,P.m9)(n))._checkNotDeleted("refFromURL");const t=ym(e,n._repo.repoInfo_.nodeAdmin);Cv("refFromURL",t);const r=t.repoInfo;return!n._repo.repoInfo_.isCustomHost()&&r.host!==n._repo.repoInfo_.host&&Is("refFromURL: Host name does not match the current database: (found "+r.host+" but expected "+n._repo.repoInfo_.host+")"),Xf(n,t.path.toString())}function tl(n,e){return null===Mt((n=(0,P.m9)(n))._path)?(t=e,t&&(t=t.replace(/^\/*\.info(\/|$)/,"/")),Ec("child","path",t,!1)):Ec("child","path",e,!1),new Ts(n._repo,Cn(n._path,e));var t}function Im(n,e){n=(0,P.m9)(n),Ks("set",n._path),Io("set",e,n._path,!1);const t=new P.BH;return Mv(n._repo,n._path,e,null,t.wrapCallback(()=>{})),t.promise}function Qw(n,e){cm("update",e,n._path,!1);const t=new P.BH;return function Vw(n,e,t,r){Co(n,"update",{path:e.toString(),value:t});let o=!0;const u=nh(n),c={};if(Sn(t,(g,E)=>{o=!1,c[g]=Mw(Cn(e,g),zn(E),n.serverSyncTree_,u)}),o)un("update() called with empty data.  Don't do anything."),Xu(0,r,"ok",void 0);else{const g=xv(n),E=function Mb(n,e,t,r){!function lw(n,e,t,r){(0,P.hu)(r>n.lastWriteId,"Stacking an older merge on top of newer ones"),n.allWrites.push({path:e,children:t,writeId:r,visible:!0}),n.visibleWrites=Jy(n.visibleWrites,e,t),n.lastWriteId=r}(n.pendingWriteTree_,e,t,r);const o=pn.fromObject(t);return Qu(n,new kf({fromUser:!0,fromServer:!1,queryId:null,tagged:!1},e,o))}(n.serverSyncTree_,e,c,g);th(n.eventQueue_,E),n.server_.merge(e.toString(),t,(I,S)=>{const M="ok"===I;M||rr("update at "+e+" failed: "+I);const F=lu(n.serverSyncTree_,g,!M),W=F.length>0?Jf(n,e):e;Zs(n.eventQueue_,W,F),Xu(0,r,I,S)}),Sn(t,I=>{const S=Ys(n,Cn(e,I));Jf(n,S)}),Zs(n.eventQueue_,e,[])}}(n._repo,n._path,e,t.wrapCallback(()=>{})),t.promise}function Jw(n){return function zb(n,e){const t=function pv(n,e){const t=e._path;let r=null;n.syncPointTree_.foreachOnPath(t,(I,S)=>{const M=zr(I,t);r=r||au(S,M)});let o=n.syncPointTree_.get(t);o?r=r||au(o,Kt()):(o=new yc,n.syncPointTree_=n.syncPointTree_.set(t,o));const u=null!=r,c=u?new ha(r,!0,!1):null;return function uv(n){return Jg(n.viewCache_)}(vc(o,e,Lf(n.pendingWriteTree_,e._path),u?c.getNode():ht.EMPTY_NODE,u))}(n.serverSyncTree_,e);return null!=t?Promise.resolve(t):n.server_.get(e).then(r=>{const o=zn(r).withIndex(e._queryParams.getIndex()),u=Hf(n.serverSyncTree_,e._path,o);return hm(n.eventQueue_,e._path,u),Promise.resolve(o)},r=>(Co(n,"get for query "+(0,P.Pz)(e)+" failed: "+r),Promise.reject(new Error(r))))}((n=(0,P.m9)(n))._repo,n).then(e=>new el(e,new Ts(n._repo,n._path),n._queryParams.getIndex()))}class ep{constructor(e){this.callbackContext=e}respondsTo(e){return"value"===e}createEvent(e,t){const r=t._queryParams.getIndex();return new Ww("value",this,new el(e.snapshotNode,new Ts(t._repo,t._path),r))}getEventRunner(e){return"cancel"===e.getEventType()?()=>this.callbackContext.onCancel(e.error):()=>this.callbackContext.onValue(e.snapshot,null)}createCancelEvent(e,t){return this.callbackContext.hasCancelCallback?new qw(this,e,t):null}matches(e){return e instanceof ep&&(!e.callbackContext||!this.callbackContext||e.callbackContext.matches(this.callbackContext))}hasAnyCallback(){return null!==this.callbackContext}}class tp{constructor(e,t){this.eventType=e,this.callbackContext=t}respondsTo(e){let t="children_added"===e?"child_added":e;return t="children_removed"===t?"child_removed":t,this.eventType===t}createCancelEvent(e,t){return this.callbackContext.hasCancelCallback?new qw(this,e,t):null}createEvent(e,t){(0,P.hu)(null!=e.childName,"Child events should have a childName.");const r=tl(new Ts(t._repo,t._path),e.childName),o=t._queryParams.getIndex();return new Ww(e.type,this,new el(e.snapshotNode,r,o),e.prevName)}getEventRunner(e){return"cancel"===e.getEventType()?()=>this.callbackContext.onCancel(e.error):()=>this.callbackContext.onValue(e.snapshot,e.prevName)}matches(e){return e instanceof tp&&this.eventType===e.eventType&&(!this.callbackContext||!e.callbackContext||this.callbackContext.matches(e.callbackContext))}hasAnyCallback(){return!!this.callbackContext}}function rh(n,e,t,r,o){let u;if("object"==typeof r&&(u=void 0,o=r),"function"==typeof r&&(u=r),o&&o.onlyOnce){const E=t,I=(S,M)=>{Rv(n._repo,n,g),E(S,M)};I.userCallback=t.userCallback,I.context=t.context,t=I}const c=new zw(t,u||void 0),g="value"===e?new ep(c):new tp(e,c);return function Bw(n,e,t){let r;r=".info"===Mt(e._path)?kb(n.infoSyncTree_,e,t):kb(n.serverSyncTree_,e,t),hm(n.eventQueue_,e._path,r)}(n._repo,n,g),()=>Rv(n._repo,n,g)}function Fv(n,e,t,r){return rh(n,"value",e,t,r)}function Xw(n,e,t,r){return rh(n,"child_added",e,t,r)}function eI(n,e,t,r){return rh(n,"child_changed",e,t,r)}function tI(n,e,t,r){return rh(n,"child_moved",e,t,r)}function nI(n,e,t,r){return rh(n,"child_removed",e,t,r)}function rI(n,e,t){let r=null;const o=t?new zw(t):null;"value"===e?r=new ep(o):e&&(r=new tp(e,o)),Rv(n._repo,n,r)}class To{}class iI extends To{constructor(e,t){super(),this._value=e,this._key=t}_apply(e){Io("endAt",this._value,e._path,!0);const t=$y(e._queryParams,this._value,this._key);if(wm(t),cu(t),e._queryParams.hasEnd())throw new Error("endAt: Starting point was already set (by another call to endAt, endBefore or equalTo).");return new Nr(e._repo,e._path,t,e._orderByCalled)}}class tT extends To{constructor(e,t){super(),this._value=e,this._key=t}_apply(e){Io("endBefore",this._value,e._path,!1);const t=function Wy(n,e,t){let r,o;return n.index_===da?("string"==typeof e&&(e=X0(e)),o=$y(n,e,t)):(r=null==t?Mi:X0(t),o=$y(n,e,r)),o.endBeforeSet_=!0,o}(e._queryParams,this._value,this._key);if(wm(t),cu(t),e._queryParams.hasEnd())throw new Error("endBefore: Starting point was already set (by another call to endAt, endBefore or equalTo).");return new Nr(e._repo,e._path,t,e._orderByCalled)}}class sI extends To{constructor(e,t){super(),this._value=e,this._key=t}_apply(e){Io("startAt",this._value,e._path,!0);const t=Gy(e._queryParams,this._value,this._key);if(wm(t),cu(t),e._queryParams.hasStart())throw new Error("startAt: Starting point was already set (by another call to startAt, startBefore or equalTo).");return new Nr(e._repo,e._path,t,e._orderByCalled)}}class iT extends To{constructor(e,t){super(),this._value=e,this._key=t}_apply(e){Io("startAfter",this._value,e._path,!1);const t=function lb(n,e,t){let r;if(n.index_===da)"string"==typeof e&&(e=By(e)),r=Gy(n,e,t);else{let o;o=null==t?Cs:By(t),r=Gy(n,e,o)}return r.startAfterSet_=!0,r}(e._queryParams,this._value,this._key);if(wm(t),cu(t),e._queryParams.hasStart())throw new Error("startAfter: Starting point was already set (by another call to startAt, startAfter, or equalTo).");return new Nr(e._repo,e._path,t,e._orderByCalled)}}class oT extends To{constructor(e){super(),this._limit=e}_apply(e){if(e._queryParams.hasLimit())throw new Error("limitToFirst: Limit was already set (by another call to limitToFirst or limitToLast).");return new Nr(e._repo,e._path,function pM(n,e){const t=n.copy();return t.limitSet_=!0,t.limit_=e,t.viewFrom_="l",t}(e._queryParams,this._limit),e._orderByCalled)}}class uT extends To{constructor(e){super(),this._limit=e}_apply(e){if(e._queryParams.hasLimit())throw new Error("limitToLast: Limit was already set (by another call to limitToFirst or limitToLast).");return new Nr(e._repo,e._path,function tw(n,e){const t=n.copy();return t.limitSet_=!0,t.limit_=e,t.viewFrom_="r",t}(e._queryParams,this._limit),e._orderByCalled)}}class aI extends To{constructor(e){super(),this._path=e}_apply(e){Em(e,"orderByChild");const t=new nn(this._path);if(Nt(t))throw new Error("orderByChild: cannot pass in empty path. Use orderByValue() instead.");const r=new Wg(t),o=Kg(e._queryParams,r);return cu(o),new Nr(e._repo,e._path,o,!0)}}class lI extends To{_apply(e){Em(e,"orderByKey");const t=Kg(e._queryParams,da);return cu(t),new Nr(e._repo,e._path,t,!0)}}class dI extends To{_apply(e){Em(e,"orderByPriority");const t=Kg(e._queryParams,fn);return cu(t),new Nr(e._repo,e._path,t,!0)}}class fI extends To{_apply(e){Em(e,"orderByValue");const t=Kg(e._queryParams,Vy);return cu(t),new Nr(e._repo,e._path,t,!0)}}class gI extends To{constructor(e,t){super(),this._value=e,this._key=t}_apply(e){if(Io("equalTo",this._value,e._path,!1),e._queryParams.hasStart())throw new Error("equalTo: Starting point was already set (by another call to startAt/startAfter or equalTo).");if(e._queryParams.hasEnd())throw new Error("equalTo: Ending point was already set (by another call to endAt/endBefore or equalTo).");return new iI(this._value,this._key)._apply(new sI(this._value,this._key)._apply(e))}}function Zr(n,...e){let t=(0,P.m9)(n);for(const r of e)t=r._apply(t);return t}(function qd(n){(0,P.hu)(!ou,"__referenceConstructor has already been defined"),ou=n})(Ts),function ww(n){(0,P.hu)(!jf,"__referenceConstructor has already been defined"),jf=n}(Ts);const Lv={};function Cm(n,e,t,r,o){let u=r||n.options.databaseURL;void 0===u&&(n.options.projectId||Is("Can't determine Firebase Database URL. Be sure to include  a Project ID when calling firebase.initializeApp()."),un("Using default host for project ",n.options.projectId),u=`${n.options.projectId}-default-rtdb.firebaseio.com`);let E,I,c=ym(u,o),g=c.repoInfo;"undefined"!=typeof process&&(I=process.env.FIREBASE_DATABASE_EMULATOR_HOST),I?(E=!0,u=`http://${I}?ns=${g.namespace}`,c=ym(u,o),g=c.repoInfo):E=!c.repoInfo.secure;const S=o&&E?new Se(Se.OWNER):new Pe(n.name,n.options,e);Cv("Invalid Firebase Database URL",c),Nt(c.path)||Is("Database URL must point to the root of a Firebase Database (not including a child path).");const M=function _I(n,e,t,r){let o=Lv[e.name];o||(o={},Lv[e.name]=o);let u=o[n.toURLString()];return u&&Is("Database initialized multiple times. Please make sure the format of the database URL matches with each database() call."),u=new kw(n,false,t,r),o[n.toURLString()]=u,u}(g,n,S,new te(n.name,t));return new vM(M,n)}class vM{constructor(e,t){this._repoInternal=e,this.app=t,this.type="database",this._instanceStarted=!1}get _repo(){return this._instanceStarted||(function Fw(n,e,t){if(n.stats_=cc(n.repoInfo_),n.forceRestClient_||("object"==typeof window&&window.navigator&&window.navigator.userAgent||"").search(/googlebot|google webmaster tools|bingbot|yahoo! slurp|baiduspider|yandexbot|duckduckbot/i)>=0)n.server_=new Bd(n.repoInfo_,(r,o,u,c)=>{Av(n,r,o,u,c)},n.authTokenProvider_,n.appCheckProvider_),setTimeout(()=>Sv(n,!0),0);else{if(null!=t){if("object"!=typeof t)throw new Error("Only objects are supported for option databaseAuthVariableOverride");try{(0,P.Pz)(t)}catch(r){throw new Error("Invalid authOverride provided: "+r)}}n.persistentConnection_=new dc(n.repoInfo_,e,(r,o,u,c)=>{Av(n,r,o,u,c)},r=>{Sv(n,r)},r=>{!function Lw(n,e){Sn(e,(t,r)=>{fm(n,t,r)})}(n,r)},n.authTokenProvider_,n.appCheckProvider_,t),n.server_=n.persistentConnection_}n.authTokenProvider_.addTokenChangeListener(r=>{n.server_.refreshAuthToken(r)}),n.appCheckProvider_.addTokenChangeListener(r=>{n.server_.refreshAppCheckToken(r.token)}),n.statsReporter_=function GD(n,e){const t=n.toString();return lc[t]||(lc[t]=e()),lc[t]}(n.repoInfo_,()=>new iw(n.stats_,n.server_)),n.infoData_=new cb,n.infoSyncTree_=new hv({startListening:(r,o,u,c)=>{let g=[];const E=n.infoData_.getNode(r._path);return E.isEmpty()||(g=Hf(n.infoSyncTree_,r._path,E),setTimeout(()=>{c("ok")},0)),g},stopListening:()=>{}}),fm(n,"connected",!1),n.serverSyncTree_=new hv({startListening:(r,o,u,c)=>(n.server_.listen(r,u,o,(g,E)=>{const I=c(g,E);Zs(n.eventQueue_,r._path,I)}),[]),stopListening:(r,o)=>{n.server_.unlisten(r,o)}})}(this._repoInternal,this.app.options.appId,this.app.options.databaseAuthVariableOverride),this._instanceStarted=!0),this._repoInternal}get _root(){return this._rootInternal||(this._rootInternal=new Ts(this._repo,Kt())),this._rootInternal}_delete(){return null!==this._rootInternal&&(function yM(n,e){const t=Lv[e];(!t||t[n.key]!==n)&&Is(`Database ${e}(${n.repoInfo_}) has already been deleted.`),Pv(n),delete t[n.key]}(this._repo,this.app.name),this._repoInternal=null,this._rootInternal=null),Promise.resolve()}_checkNotDeleted(e){null===this._rootInternal&&Is("Cannot call "+e+" on a deleted database.")}}function Dm(n,e){ws(n,e)}const bm={".sv":"timestamp"};class EM{constructor(e,t){this.committed=e,this.snapshot=t}toJSON(){return{committed:this.committed,snapshot:this.snapshot.toJSON()}}}dc.prototype.simpleListen=function(n,e){this.sendRequest("q",{p:n},e)},dc.prototype.echo=function(n,e){this.sendRequest("echo",{d:n},e)},function fT(n){mf(ys.SDK_VERSION),(0,ys._registerComponent)(new Ws.wA("database",(e,{instanceIdentifier:t})=>Cm(e.getProvider("app").getImmediate(),e.getProvider("auth-internal"),e.getProvider("app-check-internal"),t),"PUBLIC").setMultipleInstances(!0)),(0,ys.registerVersion)(Sd,"0.12.5",n),(0,ys.registerVersion)(Sd,"0.12.5","esm2017")}();const II=new vs.Yd("@firebase/database-compat"),Vv=function(n){II.warn("FIREBASE WARNING: "+n)};class mT{constructor(e){this._delegate=e}cancel(e){(0,P.Dv)("OnDisconnect.cancel",0,1,arguments.length),(0,P.Wj)("OnDisconnect.cancel","onComplete",e,!0);const t=this._delegate.cancel();return e&&t.then(()=>e(null),r=>e(r)),t}remove(e){(0,P.Dv)("OnDisconnect.remove",0,1,arguments.length),(0,P.Wj)("OnDisconnect.remove","onComplete",e,!0);const t=this._delegate.remove();return e&&t.then(()=>e(null),r=>e(r)),t}set(e,t){(0,P.Dv)("OnDisconnect.set",1,2,arguments.length),(0,P.Wj)("OnDisconnect.set","onComplete",t,!0);const r=this._delegate.set(e);return t&&r.then(()=>t(null),o=>t(o)),r}setWithPriority(e,t,r){(0,P.Dv)("OnDisconnect.setWithPriority",2,3,arguments.length),(0,P.Wj)("OnDisconnect.setWithPriority","onComplete",r,!0);const o=this._delegate.setWithPriority(e,t);return r&&o.then(()=>r(null),u=>r(u)),o}update(e,t){if((0,P.Dv)("OnDisconnect.update",1,2,arguments.length),Array.isArray(e)){const o={};for(let u=0;u<e.length;++u)o[""+u]=e[u];e=o,Vv("Passing an Array to firebase.database.onDisconnect().update() is deprecated. Use set() if you want to overwrite the existing data, or an Object with integer keys if you really do want to only update some of the children.")}(0,P.Wj)("OnDisconnect.update","onComplete",t,!0);const r=this._delegate.update(e);return t&&r.then(()=>t(null),o=>t(o)),r}}class np{constructor(e,t){this.committed=e,this.snapshot=t}toJSON(){return(0,P.Dv)("TransactionResult.toJSON",0,1,arguments.length),{committed:this.committed,snapshot:this.snapshot.toJSON()}}}class nl{constructor(e,t){this._database=e,this._delegate=t}val(){return(0,P.Dv)("DataSnapshot.val",0,0,arguments.length),this._delegate.val()}exportVal(){return(0,P.Dv)("DataSnapshot.exportVal",0,0,arguments.length),this._delegate.exportVal()}toJSON(){return(0,P.Dv)("DataSnapshot.toJSON",0,1,arguments.length),this._delegate.toJSON()}exists(){return(0,P.Dv)("DataSnapshot.exists",0,0,arguments.length),this._delegate.exists()}child(e){return(0,P.Dv)("DataSnapshot.child",0,1,arguments.length),e=String(e),Ec("DataSnapshot.child","path",e,!1),new nl(this._database,this._delegate.child(e))}hasChild(e){return(0,P.Dv)("DataSnapshot.hasChild",1,1,arguments.length),Ec("DataSnapshot.hasChild","path",e,!1),this._delegate.hasChild(e)}getPriority(){return(0,P.Dv)("DataSnapshot.getPriority",0,0,arguments.length),this._delegate.priority}forEach(e){return(0,P.Dv)("DataSnapshot.forEach",1,1,arguments.length),(0,P.Wj)("DataSnapshot.forEach","action",e,!1),this._delegate.forEach(t=>e(new nl(this._database,t)))}hasChildren(){return(0,P.Dv)("DataSnapshot.hasChildren",0,0,arguments.length),this._delegate.hasChildren()}get key(){return this._delegate.key}numChildren(){return(0,P.Dv)("DataSnapshot.numChildren",0,0,arguments.length),this._delegate.size}getRef(){return(0,P.Dv)("DataSnapshot.ref",0,0,arguments.length),new As(this._database,this._delegate.ref)}get ref(){return this.getRef()}}class Yr{constructor(e,t){this.database=e,this._delegate=t}on(e,t,r,o){var u;(0,P.Dv)("Query.on",2,4,arguments.length),(0,P.Wj)("Query.on","callback",t,!1);const c=Yr.getCancelAndContextArgs_("Query.on",r,o),g=(I,S)=>{t.call(c.context,new nl(this.database,I),S)};g.userCallback=t,g.context=c.context;const E=null===(u=c.cancel)||void 0===u?void 0:u.bind(c.context);switch(e){case"value":return Fv(this._delegate,g,E),t;case"child_added":return Xw(this._delegate,g,E),t;case"child_removed":return nI(this._delegate,g,E),t;case"child_changed":return eI(this._delegate,g,E),t;case"child_moved":return tI(this._delegate,g,E),t;default:throw new Error((0,P.gK)("Query.on","eventType")+'must be a valid event type = "value", "child_added", "child_removed", "child_changed", or "child_moved".')}}off(e,t,r){if((0,P.Dv)("Query.off",0,3,arguments.length),function(n,e,t){if(void 0!==e)switch(e){case"value":case"child_added":case"child_removed":case"child_changed":case"child_moved":break;default:throw new Error((0,P.gK)("Query.off","eventType")+'must be a valid event type = "value", "child_added", "child_removed", "child_changed", or "child_moved".')}}(0,e),(0,P.Wj)("Query.off","callback",t,!0),(0,P.lb)("Query.off","context",r,!0),t){const o=()=>{};o.userCallback=t,o.context=r,rI(this._delegate,e,o)}else rI(this._delegate,e)}get(){return Jw(this._delegate).then(e=>new nl(this.database,e))}once(e,t,r,o){(0,P.Dv)("Query.once",1,4,arguments.length),(0,P.Wj)("Query.once","callback",t,!0);const u=Yr.getCancelAndContextArgs_("Query.once",r,o),c=new P.BH,g=(I,S)=>{const M=new nl(this.database,I);t&&t.call(u.context,M,S),c.resolve(M)};g.userCallback=t,g.context=u.context;const E=I=>{u.cancel&&u.cancel.call(u.context,I),c.reject(I)};switch(e){case"value":Fv(this._delegate,g,E,{onlyOnce:!0});break;case"child_added":Xw(this._delegate,g,E,{onlyOnce:!0});break;case"child_removed":nI(this._delegate,g,E,{onlyOnce:!0});break;case"child_changed":eI(this._delegate,g,E,{onlyOnce:!0});break;case"child_moved":tI(this._delegate,g,E,{onlyOnce:!0});break;default:throw new Error((0,P.gK)("Query.once","eventType")+'must be a valid event type = "value", "child_added", "child_removed", "child_changed", or "child_moved".')}return c.promise}limitToFirst(e){return(0,P.Dv)("Query.limitToFirst",1,1,arguments.length),new Yr(this.database,Zr(this._delegate,function aT(n){if("number"!=typeof n||Math.floor(n)!==n||n<=0)throw new Error("limitToFirst: First argument must be a positive integer.");return new oT(n)}(e)))}limitToLast(e){return(0,P.Dv)("Query.limitToLast",1,1,arguments.length),new Yr(this.database,Zr(this._delegate,function oI(n){if("number"!=typeof n||Math.floor(n)!==n||n<=0)throw new Error("limitToLast: First argument must be a positive integer.");return new uT(n)}(e)))}orderByChild(e){return(0,P.Dv)("Query.orderByChild",1,1,arguments.length),new Yr(this.database,Zr(this._delegate,function uI(n){if("$key"===n)throw new Error('orderByChild: "$key" is invalid.  Use orderByKey() instead.');if("$priority"===n)throw new Error('orderByChild: "$priority" is invalid.  Use orderByPriority() instead.');if("$value"===n)throw new Error('orderByChild: "$value" is invalid.  Use orderByValue() instead.');return Ec("orderByChild","path",n,!1),new aI(n)}(e)))}orderByKey(){return(0,P.Dv)("Query.orderByKey",0,0,arguments.length),new Yr(this.database,Zr(this._delegate,function cI(){return new lI}()))}orderByPriority(){return(0,P.Dv)("Query.orderByPriority",0,0,arguments.length),new Yr(this.database,Zr(this._delegate,function hI(){return new dI}()))}orderByValue(){return(0,P.Dv)("Query.orderByValue",0,0,arguments.length),new Yr(this.database,Zr(this._delegate,function pI(){return new fI}()))}startAt(e=null,t){return(0,P.Dv)("Query.startAt",0,2,arguments.length),new Yr(this.database,Zr(this._delegate,function rT(n=null,e){return eh("startAt","key",e,!0),new sI(n,e)}(e,t)))}startAfter(e=null,t){return(0,P.Dv)("Query.startAfter",0,2,arguments.length),new Yr(this.database,Zr(this._delegate,function sT(n,e){return eh("startAfter","key",e,!0),new iT(n,e)}(e,t)))}endAt(e=null,t){return(0,P.Dv)("Query.endAt",0,2,arguments.length),new Yr(this.database,Zr(this._delegate,function eT(n,e){return eh("endAt","key",e,!0),new iI(n,e)}(e,t)))}endBefore(e=null,t){return(0,P.Dv)("Query.endBefore",0,2,arguments.length),new Yr(this.database,Zr(this._delegate,function nT(n,e){return eh("endBefore","key",e,!0),new tT(n,e)}(e,t)))}equalTo(e,t){return(0,P.Dv)("Query.equalTo",1,2,arguments.length),new Yr(this.database,Zr(this._delegate,function mI(n,e){return eh("equalTo","key",e,!0),new gI(n,e)}(e,t)))}toString(){return(0,P.Dv)("Query.toString",0,0,arguments.length),this._delegate.toString()}toJSON(){return(0,P.Dv)("Query.toJSON",0,1,arguments.length),this._delegate.toJSON()}isEqual(e){if((0,P.Dv)("Query.isEqual",1,1,arguments.length),!(e instanceof Yr))throw new Error("Query.isEqual failed: First argument must be an instance of firebase.database.Query.");return this._delegate.isEqual(e._delegate)}static getCancelAndContextArgs_(e,t,r){const o={cancel:void 0,context:void 0};if(t&&r)o.cancel=t,(0,P.Wj)(e,"cancel",o.cancel,!0),o.context=r,(0,P.lb)(e,"context",o.context,!0);else if(t)if("object"==typeof t&&null!==t)o.context=t;else{if("function"!=typeof t)throw new Error((0,P.gK)(e,"cancelOrContext")+" must either be a cancel callback or a context object.");o.cancel=t}return o}get ref(){return new As(this.database,new Ts(this._delegate._repo,this._delegate._path))}}class As extends Yr{constructor(e,t){super(e,new Nr(t._repo,t._path,new zg,!1)),this.database=e,this._delegate=t}getKey(){return(0,P.Dv)("Reference.key",0,0,arguments.length),this._delegate.key}child(e){return(0,P.Dv)("Reference.child",1,1,arguments.length),"number"==typeof e&&(e=String(e)),new As(this.database,tl(this._delegate,e))}getParent(){(0,P.Dv)("Reference.parent",0,0,arguments.length);const e=this._delegate.parent;return e?new As(this.database,e):null}getRoot(){return(0,P.Dv)("Reference.root",0,0,arguments.length),new As(this.database,this._delegate.root)}set(e,t){(0,P.Dv)("Reference.set",1,2,arguments.length),(0,P.Wj)("Reference.set","onComplete",t,!0);const r=Im(this._delegate,e);return t&&r.then(()=>t(null),o=>t(o)),r}update(e,t){if((0,P.Dv)("Reference.update",1,2,arguments.length),Array.isArray(e)){const o={};for(let u=0;u<e.length;++u)o[""+u]=e[u];e=o,Vv("Passing an Array to Firebase.update() is deprecated. Use set() if you want to overwrite the existing data, or an Object with integer keys if you really do want to only update some of the children.")}Ks("Reference.update",this._delegate._path),(0,P.Wj)("Reference.update","onComplete",t,!0);const r=Qw(this._delegate,e);return t&&r.then(()=>t(null),o=>t(o)),r}setWithPriority(e,t,r){(0,P.Dv)("Reference.setWithPriority",2,3,arguments.length),(0,P.Wj)("Reference.setWithPriority","onComplete",r,!0);const o=function Yw(n,e,t){if(Ks("setWithPriority",n._path),Io("setWithPriority",e,n._path,!1),dm("setWithPriority",t,!1),".length"===n.key||".keys"===n.key)throw"setWithPriority failed: "+n.key+" is a read-only object.";const r=new P.BH;return Mv(n._repo,n._path,e,t,r.wrapCallback(()=>{})),r.promise}(this._delegate,e,t);return r&&o.then(()=>r(null),u=>r(u)),o}remove(e){(0,P.Dv)("Reference.remove",0,1,arguments.length),(0,P.Wj)("Reference.remove","onComplete",e,!0);const t=function kv(n){return Ks("remove",n._path),Im(n,null)}(this._delegate);return e&&t.then(()=>e(null),r=>e(r)),t}transaction(e,t,r){(0,P.Dv)("Reference.transaction",1,3,arguments.length),(0,P.Wj)("Reference.transaction","transactionUpdate",e,!1),(0,P.Wj)("Reference.transaction","onComplete",t,!0),function(n,e,t,r){if(void 0!==t&&"boolean"!=typeof t)throw new Error((0,P.gK)("Reference.transaction","applyLocally")+"must be a boolean.")}(0,0,r);const o=function vI(n,e,t){var r;if(n=(0,P.m9)(n),Ks("Reference.transaction",n._path),".length"===n.key||".keys"===n.key)throw"Reference.transaction failed: "+n.key+" is a read-only object.";const o=null===(r=null==t?void 0:t.applyLocally)||void 0===r||r,u=new P.BH,g=Fv(n,()=>{});return function Qb(n,e,t,r,o,u){Co(n,"transaction on "+e);const c={path:e,update:t,onComplete:r,status:null,order:Es(),applyLocally:u,retryCount:0,unwatcher:o,abortReason:null,currentWriteId:null,currentInputSnapshot:null,currentOutputSnapshotRaw:null,currentOutputSnapshotResolved:null},g=pm(n,e,void 0);c.currentInputSnapshot=g;const E=c.update(g.val());if(void 0===E)c.unwatcher(),c.currentOutputSnapshotRaw=null,c.currentOutputSnapshotResolved=null,c.onComplete&&c.onComplete(null,!1,c.currentInputSnapshot);else{Qf("transaction failed: Data returned ",E,c.path),c.status=0;const I=$f(n.transactionQueueTree_,e),S=Ju(I)||[];let M;S.push(c),Wf(I,S),"object"==typeof E&&null!==E&&(0,P.r3)(E,".priority")?(M=(0,P.DV)(E,".priority"),(0,P.hu)(Xd(M),"Invalid priority returned by transaction. Priority must be a valid string, finite number, server value, or null.")):M=(sm(n.serverSyncTree_,e)||ht.EMPTY_NODE).getPriority().val();const F=nh(n),W=zn(E,M),Y=yv(W,g,F);c.currentOutputSnapshotRaw=W,c.currentOutputSnapshotResolved=Y,c.currentWriteId=xv(n);const xe=fv(n.serverSyncTree_,e,Y,c.currentWriteId,c.applyLocally);Zs(n.eventQueue_,e,xe),gm(n,n.transactionQueueTree_)}}(n._repo,n._path,e,(E,I,S)=>{let M=null;E?u.reject(E):(M=new el(S,new Ts(n._repo,n._path),fn),u.resolve(new EM(I,M)))},g,o),u.promise}(this._delegate,e,{applyLocally:r}).then(u=>new np(u.committed,new nl(this.database,u.snapshot)));return t&&o.then(u=>t(null,u.committed,u.snapshot),u=>t(u,!1,null)),o}setPriority(e,t){(0,P.Dv)("Reference.setPriority",1,2,arguments.length),(0,P.Wj)("Reference.setPriority","onComplete",t,!0);const r=function Zw(n,e){n=(0,P.m9)(n),Ks("setPriority",n._path),dm("setPriority",e,!1);const t=new P.BH;return Mv(n._repo,Cn(n._path,".priority"),e,null,t.wrapCallback(()=>{})),t.promise}(this._delegate,e);return t&&r.then(()=>t(null),o=>t(o)),r}push(e,t){(0,P.Dv)("Reference.push",0,2,arguments.length),(0,P.Wj)("Reference.push","onComplete",t,!0);const r=function Ov(n,e){n=(0,P.m9)(n),Ks("push",n._path),Io("push",e,n._path,!0);const t=Tv(n._repo),r=ab(t),o=tl(n,r),u=tl(n,r);let c;return c=null!=e?Im(u,e).then(()=>u):Promise.resolve(u),o.then=c.then.bind(c),o.catch=c.then.bind(c,void 0),o}(this._delegate,e),o=r.then(c=>new As(this.database,c));t&&o.then(()=>t(null),c=>t(c));const u=new As(this.database,r);return u.then=o.then.bind(o),u.catch=o.catch.bind(o,void 0),u}onDisconnect(){return Ks("Reference.onDisconnect",this._delegate._path),new mT(new vm(this._delegate._repo,this._delegate._path))}get key(){return this.getKey()}get parent(){return this.getParent()}get root(){return this.getRoot()}}class rl{constructor(e,t){this._delegate=e,this.app=t,this.INTERNAL={delete:()=>this._delegate._delete()}}useEmulator(e,t,r={}){!function cT(n,e,t,r={}){(n=(0,P.m9)(n))._checkNotDeleted("useEmulator"),n._instanceStarted&&Is("Cannot call useEmulator() after instance has already been initialized.");const o=n._repoInternal;let u;if(o.repoInfo_.nodeAdmin)r.mockUserToken&&Is('mockUserToken is not supported by the Admin SDK. For client access with mock users, please use the "firebase" package instead of "firebase-admin".'),u=new Se(Se.OWNER);else if(r.mockUserToken){const c="string"==typeof r.mockUserToken?r.mockUserToken:(0,P.Sg)(r.mockUserToken,n.app.options.projectId);u=new Se(c)}!function _M(n,e,t,r){n.repoInfo_=new nu(`${e}:${t}`,!1,n.repoInfo_.namespace,n.repoInfo_.webSocketOnly,n.repoInfo_.nodeAdmin,n.repoInfo_.persistenceKey,n.repoInfo_.includeNamespaceInQueryParams),r&&(n.authTokenProvider_=r)}(o,e,t,u)}(this._delegate,e,t,r)}ref(e){if((0,P.Dv)("database.ref",0,1,arguments.length),e instanceof As){const t=Kw(this._delegate,e.toString());return new As(this,t)}{const t=Xf(this._delegate,e);return new As(this,t)}}refFromURL(e){(0,P.Dv)("database.refFromURL",1,1,arguments.length);const r=Kw(this._delegate,e);return new As(this,r)}goOffline(){return(0,P.Dv)("database.goOffline",0,0,arguments.length),function dT(n){(n=(0,P.m9)(n))._checkNotDeleted("goOffline"),Pv(n._repo)}(this._delegate)}goOnline(){return(0,P.Dv)("database.goOnline",0,0,arguments.length),function hT(n){(n=(0,P.m9)(n))._checkNotDeleted("goOnline"),function Uw(n){n.persistentConnection_&&n.persistentConnection_.resume(Dv)}(n._repo)}(this._delegate)}}rl.ServerValue={TIMESTAMP:function Tm(){return bm}(),increment:n=>function Kn(n){return{".sv":{increment:n}}}(n)};var DI=Object.freeze({__proto__:null,initStandalone:function CI({app:n,url:e,version:t,customAuthImpl:r,namespace:o,nodeAdmin:u=!1}){mf(t);const c=new Ws.zt("auth-internal",new Ws.H0("database-standalone"));return c.setComponent(new Ws.wA("auth-internal",()=>r,"PRIVATE")),{instance:new rl(Cm(n,c,void 0,e,u),n),namespace:o}}});const bI=rl.ServerValue;!function _T(n){n.INTERNAL.registerComponent(new Ws.wA("database-compat",(e,{instanceIdentifier:t})=>{const r=e.getProvider("app-compat").getImmediate(),o=e.getProvider("database").getImmediate({identifier:t});return new rl(o,r)},"PUBLIC").setServiceProps({Reference:As,Query:Yr,Database:rl,DataSnapshot:nl,enableLogging:Dm,INTERNAL:DI,ServerValue:bI}).setMultipleInstances(!0)),n.registerVersion("@firebase/database-compat","0.1.5")}(Lu.Z);var ih=L(7579),il=L(5363),yT=L(6063);class vT extends ih.x{constructor(e=1/0,t=1/0,r=yT.l){super(),this._bufferSize=e,this._windowTime=t,this._timestampProvider=r,this._buffer=[],this._infiniteTimeWindow=!0,this._infiniteTimeWindow=t===1/0,this._bufferSize=Math.max(1,e),this._windowTime=Math.max(1,t)}next(e){const{isStopped:t,_buffer:r,_infiniteTimeWindow:o,_timestampProvider:u,_windowTime:c}=this;t||(r.push(e),!o&&r.push(u.now()+c)),this._trimBuffer(),super.next(e)}_subscribe(e){this._throwIfClosed(),this._trimBuffer();const t=this._innerSubscribe(e),{_infiniteTimeWindow:r,_buffer:o}=this,u=o.slice();for(let c=0;c<u.length&&!e.closed;c+=r?1:2)e.next(u[c]);return this._checkFinalizedStatuses(e),t}_trimBuffer(){const{_bufferSize:e,_timestampProvider:t,_buffer:r,_infiniteTimeWindow:o}=this,u=(o?1:2)*e;if(e<1/0&&u<r.length&&r.splice(0,r.length-u),!o){const c=t.now();let g=0;for(let E=1;E<r.length&&r[E]<=c;E+=2)g=E;g&&r.splice(0,g+1)}}}function TI(n,e,t){var r,o;let u,c=!1;return n&&"object"==typeof n?(u=null!==(r=n.bufferSize)&&void 0!==r?r:1/0,e=null!==(o=n.windowTime)&&void 0!==o?o:1/0,c=!!n.refCount,t=n.scheduler):u=null!=n?n:1/0,(0,nc.B)({connector:()=>new vT(u,e,t),resetOnError:!0,resetOnComplete:!1,resetOnRefCountZero:c})}const Bv=(0,L(3888).d)(n=>function(){n(this),this.name="EmptyError",this.message="no elements in sequence"});function rp(n,e){return(0,Gs.e)((t,r)=>{let o=0;t.subscribe(new Wr.Q(r,u=>n.call(e,u,o++)&&r.next(u)))})}var ET=L(5698);function SI(n){return(0,Gs.e)((e,t)=>{let r=!1;e.subscribe(new Wr.Q(t,o=>{r=!0,t.next(o)},()=>{r||t.next(n),t.complete()}))})}function wT(n=IT){return(0,Gs.e)((e,t)=>{let r=!1;e.subscribe(new Wr.Q(t,o=>{r=!0,t.next(o)},()=>r?t.complete():t.error(n())))})}function IT(){return new Bv}var DM=L(576);function CT(n,e){return(0,DM.m)(e)?$s(()=>n,e):$s(()=>n)}var xI=L(9468);L(5867);const jv=new Map,xT={activated:!1,tokenObservers:[]},NI={initialized:!1,enabled:!1};function Rr(n){return jv.get(n)||xT}function Ss(n,e){jv.set(n,e)}function Am(){return NI}class RT{constructor(e,t,r,o,u){if(this.operation=e,this.retryPolicy=t,this.getWaitDuration=r,this.lowerBound=o,this.upperBound=u,this.pending=null,this.nextErrorWaitInterval=o,o>u)throw new Error("Proactive refresh lower bound greater than upper bound!")}start(){this.nextErrorWaitInterval=this.lowerBound,this.process(!0).catch(()=>{})}stop(){this.pending&&(this.pending.reject("cancelled"),this.pending=null)}isRunning(){return!!this.pending}process(e){var t=this;return(0,pe.Z)(function*(){t.stop();try{t.pending=new P.BH,yield function OI(n){return new Promise(e=>{setTimeout(e,n)})}(t.getNextRun(e)),t.pending.resolve(),yield t.pending.promise,t.pending=new P.BH,yield t.operation(),t.pending.resolve(),yield t.pending.promise,t.process(!0).catch(()=>{})}catch(r){t.retryPolicy(r)?t.process(!1).catch(()=>{}):t.stop()}})()}getNextRun(e){if(e)return this.nextErrorWaitInterval=this.lowerBound,this.getWaitDuration();{const t=this.nextErrorWaitInterval;return this.nextErrorWaitInterval*=2,this.nextErrorWaitInterval>this.upperBound&&(this.nextErrorWaitInterval=this.upperBound),t}}}const Ni=new P.LL("appCheck","AppCheck",{"already-initialized":"You have already called initializeAppCheck() for FirebaseApp {$appName} with different options. To avoid this error, call initializeAppCheck() with the same options as when it was originally called. This will return the already initialized instance.","use-before-activation":"App Check is being used before initializeAppCheck() is called for FirebaseApp {$appName}. Call initializeAppCheck() before instantiating other Firebase services.","fetch-network-error":"Fetch failed to connect to a network. Check Internet connection. Original error: {$originalErrorMessage}.","fetch-parse-error":"Fetch client could not parse response. Original error: {$originalErrorMessage}.","fetch-status-error":"Fetch server returned an HTTP error status. HTTP status: {$httpStatus}.","storage-open":"Error thrown when opening storage. Original error: {$originalErrorMessage}.","storage-get":"Error thrown when reading from storage. Original error: {$originalErrorMessage}.","storage-set":"Error thrown when writing to storage. Original error: {$originalErrorMessage}.","recaptcha-error":"ReCAPTCHA error.",throttled:"Requests throttled due to {$httpStatus} error. Attempts allowed again after {$time}"});function kI(n){if(!Rr(n).activated)throw Ni.create("use-before-activation",{appName:n.name})}function $v(n,e){return Nm.apply(this,arguments)}function Nm(){return(Nm=(0,pe.Z)(function*({url:n,body:e},t){const r={"Content-Type":"application/json"},o=t.getImmediate({optional:!0});o&&(r["X-Firebase-Client"]=o.getPlatformInfoString());const u={method:"POST",body:JSON.stringify(e),headers:r};let c,g;try{c=yield fetch(n,u)}catch(M){throw Ni.create("fetch-network-error",{originalErrorMessage:M.message})}if(200!==c.status)throw Ni.create("fetch-status-error",{httpStatus:c.status});try{g=yield c.json()}catch(M){throw Ni.create("fetch-parse-error",{originalErrorMessage:M.message})}const E=g.ttl.match(/^([\d.]+)(s)$/);if(!E||!E[2]||isNaN(Number(E[1])))throw Ni.create("fetch-parse-error",{originalErrorMessage:`ttl field (timeToLive) is not in standard Protobuf Duration format: ${g.ttl}`});const I=1e3*Number(E[1]),S=Date.now();return{token:g.attestationToken,expireTimeMillis:S+I,issuedAtTimeMillis:S}})).apply(this,arguments)}function FT(n,e){const{projectId:t,appId:r,apiKey:o}=n.options;return{url:`https://content-firebaseappcheck.googleapis.com/v1beta/projects/${t}/apps/${r}:exchangeDebugToken?key=${o}`,body:{debug_token:e}}}const sp="firebase-app-check-store";let sh=null;function Rm(){return sh||(sh=new Promise((n,e)=>{try{const t=indexedDB.open("firebase-app-check-database",1);t.onsuccess=r=>{n(r.target.result)},t.onerror=r=>{var o;e(Ni.create("storage-open",{originalErrorMessage:null===(o=r.target.error)||void 0===o?void 0:o.message}))},t.onupgradeneeded=r=>{0===r.oldVersion&&r.target.result.createObjectStore(sp,{keyPath:"compositeKey"})}}catch(t){e(Ni.create("storage-open",{originalErrorMessage:t.message}))}}),sh)}function qv(){return(qv=(0,pe.Z)(function*(n,e){const r=(yield Rm()).transaction(sp,"readwrite"),u=r.objectStore(sp).put({compositeKey:n,value:e});return new Promise((c,g)=>{u.onsuccess=E=>{c()},r.onerror=E=>{var I;g(Ni.create("storage-set",{originalErrorMessage:null===(I=E.target.error)||void 0===I?void 0:I.message}))}})})).apply(this,arguments)}const op=new vs.Yd("@firebase/app-check");function HI(n,e){return(0,P.hl)()?function Wv(n,e){return function Pm(n,e){return qv.apply(this,arguments)}(function Zv(n){return`${n.options.appId}-${n.name}`}(n),e)}(n,e).catch(t=>{op.warn(`Failed to write token to IndexedDB. Error: ${t}`)}):Promise.resolve()}function Dc(){return Am().enabled}function oh(){return Qv.apply(this,arguments)}function Qv(){return(Qv=(0,pe.Z)(function*(){const n=Am();if(n.enabled&&n.token)return n.token.promise;throw Error("\n            Can't get debug token in production mode.\n        ")})).apply(this,arguments)}const GI={error:"UNKNOWN_ERROR"};function UT(n){return P.US.encodeString(JSON.stringify(n),!1)}function Om(n){return Jv.apply(this,arguments)}function Jv(){return(Jv=(0,pe.Z)(function*(n,e=!1){const t=n.app;kI(t);const r=Rr(t);let u,o=r.token;if(!o){const E=yield r.cachedTokenPromise;E&&sl(E)&&(o=E)}if(!e&&o&&sl(o))return{token:o.token};let g,c=!1;if(Dc()){r.exchangeTokenPromise||(r.exchangeTokenPromise=$v(FT(t,yield oh()),n.platformLoggerProvider).then(I=>(r.exchangeTokenPromise=void 0,I)),c=!0);const E=yield r.exchangeTokenPromise;return yield HI(t,E),Ss(t,Object.assign(Object.assign({},r),{token:E})),{token:E.token}}try{r.exchangeTokenPromise||(r.exchangeTokenPromise=r.provider.getToken().then(E=>(r.exchangeTokenPromise=void 0,E)),c=!0),o=yield r.exchangeTokenPromise}catch(E){"appCheck/throttled"===E.code?op.warn(E.message):op.error(E),u=E}return o?(g={token:o.token},Ss(t,Object.assign(Object.assign({},r),{token:o})),yield HI(t,o)):g=jT(u),c&&up(t,g),g})).apply(this,arguments)}function km(n,e){const t=Rr(n),r=t.tokenObservers.filter(o=>o.next!==e);0===r.length&&t.tokenRefresher&&t.tokenRefresher.isRunning()&&t.tokenRefresher.stop(),Ss(n,Object.assign(Object.assign({},t),{tokenObservers:r}))}function eE(n){const{app:e}=n,t=Rr(e);let r=t.tokenRefresher;r||(r=function tE(n){const{app:e}=n;return new RT((0,pe.Z)(function*(){let r;if(r=Rr(e).token?yield Om(n,!0):yield Om(n),r.error)throw r.error}),()=>!0,()=>{const t=Rr(e);if(t.token){let r=t.token.issuedAtTimeMillis+.5*(t.token.expireTimeMillis-t.token.issuedAtTimeMillis)+3e5;return r=Math.min(r,t.token.expireTimeMillis-3e5),Math.max(0,r-Date.now())}return 0},3e4,96e4)}(n),Ss(e,Object.assign(Object.assign({},t),{tokenRefresher:r}))),!r.isRunning()&&t.isTokenAutoRefreshEnabled&&r.start()}function up(n,e){const t=Rr(n).tokenObservers;for(const r of t)try{"EXTERNAL"===r.type&&null!=e.error?r.error(e.error):r.next(e)}catch(o){}}function sl(n){return n.expireTimeMillis-Date.now()>0}function jT(n){return{token:UT(GI),error:n}}class $I{constructor(e,t){this.app=e,this.platformLoggerProvider=t}_delete(){const{tokenObservers:e}=Rr(this.app);for(const t of e)km(this.app,t.next);return Promise.resolve()}}const KI="app-check-internal";!function JT(){(0,ys._registerComponent)(new Ws.wA("app-check",n=>function WI(n,e){return new $I(n,e)}(n.getProvider("app").getImmediate(),n.getProvider("platform-logger")),"PUBLIC").setInstantiationMode("EXPLICIT").setInstanceCreatedCallback((n,e,t)=>{n.getProvider(KI).initialize()})),(0,ys._registerComponent)(new Ws.wA(KI,n=>function HT(n){return{getToken:e=>Om(n,e),addTokenListener:e=>function Xv(n,e,t,r){const{app:o}=n,u=Rr(o),c={next:t,error:r,type:e};if(Ss(o,Object.assign(Object.assign({},u),{tokenObservers:[...u.tokenObservers,c]})),u.token&&sl(u.token)){const g=u.token;Promise.resolve().then(()=>{t({token:g.token}),eE(n)}).catch(()=>{})}u.cachedTokenPromise.then(()=>eE(n))}(n,"INTERNAL",e),removeTokenListener:e=>km(n.app,e)}}(n.getProvider("app-check").getImmediate()),"PUBLIC").setInstantiationMode("EXPLICIT")),(0,ys.registerVersion)("@firebase/app-check","0.5.3")}();class lp{constructor(){return(0,vn.vb)("app-check")}}"undefined"!=typeof window&&window;var iA=L(127);const Ac=new _.OlP("angularfire2.auth.use-emulator"),aE=new _.OlP("angularfire2.auth.settings"),uE=new _.OlP("angularfire2.auth.tenant-id"),lE=new _.OlP("angularfire2.auth.langugage-code"),ah=new _.OlP("angularfire2.auth.use-device-language"),uh=new _.OlP("angularfire.auth.persistence"),cE=(n,e,t,r,o,u,c,g)=>(0,Pn.cc)(`${n.name}.auth`,"AngularFireAuth",n.name,()=>{const E=e.runOutsideAngular(()=>n.auth());if(t&&E.useEmulator(...t),r&&(E.tenantId=r),E.languageCode=o,u&&E.useDeviceLanguage(),c)for(const[I,S]of Object.entries(c))E.settings[I]=S;return g&&E.setPersistence(g),E},[t,r,o,u,c,g]);let dE=(()=>{class n{constructor(t,r,o,u,c,g,E,I,S,M,F,W){const Y=new ih.x,xe=eu(void 0).pipe((0,il.Q)(c.outsideAngular),$s(()=>u.runOutsideAngular(()=>Promise.resolve().then(L.bind(L,2438)))),(0,Ht.U)(()=>(0,Pn.on)(t,u,r)),(0,Ht.U)(qe=>cE(qe,u,g,I,S,M,E,F)),TI({bufferSize:1,refCount:!1}));if(xa(o))this.authState=this.user=this.idToken=this.idTokenResult=this.credential=eu(null);else{xe.pipe(function CM(n,e){const t=arguments.length>=2;return r=>r.pipe(n?rp((o,u)=>n(o,u,r)):ff.y,(0,ET.q)(1),t?SI(e):wT(()=>new Bv))}()).subscribe();const Pt=xe.pipe($s(zt=>zt.getRedirectResult().then(ar=>ar,()=>null)),vn.iC,TI({bufferSize:1,refCount:!1})),Bt=xe.pipe($s(zt=>new uo.y(ar=>({unsubscribe:u.runOutsideAngular(()=>zt.onAuthStateChanged(gu=>ar.next(gu),gu=>ar.error(gu),()=>ar.complete()))})))),or=xe.pipe($s(zt=>new uo.y(ar=>({unsubscribe:u.runOutsideAngular(()=>zt.onIdTokenChanged(gu=>ar.next(gu),gu=>ar.error(gu),()=>ar.complete()))}))));this.authState=Pt.pipe(CT(Bt),(0,xI.R)(c.outsideAngular),(0,il.Q)(c.insideAngular)),this.user=Pt.pipe(CT(or),(0,xI.R)(c.outsideAngular),(0,il.Q)(c.insideAngular)),this.idToken=this.user.pipe($s(zt=>zt?(0,Wi.D)(zt.getIdToken()):eu(null))),this.idTokenResult=this.user.pipe($s(zt=>zt?(0,Wi.D)(zt.getIdTokenResult()):eu(null))),this.credential=(0,tc.T)(Pt,Y,this.authState.pipe(rp(zt=>!zt))).pipe((0,Ht.U)(zt=>(null==zt?void 0:zt.user)?zt:null),(0,xI.R)(c.outsideAngular),(0,il.Q)(c.insideAngular))}return(0,Pn.pX)(this,xe,u,{spy:{apply:(qe,Pt,Bt)=>{(qe.startsWith("signIn")||qe.startsWith("createUser"))&&Bt.then(or=>Y.next(or))}}})}}return n.\u0275fac=function(t){return new(t||n)(_.LFG(Pn.Dh),_.LFG(Pn.xv,8),_.LFG(_.Lbi),_.LFG(_.R0b),_.LFG(vn.HU),_.LFG(Ac,8),_.LFG(aE,8),_.LFG(uE,8),_.LFG(lE,8),_.LFG(ah,8),_.LFG(uh,8),_.LFG(lp,8))},n.\u0275prov=_.Yz7({token:n,factory:n.\u0275fac,providedIn:"any"}),n})();function fE(n){return null==n}function XI(n){return"function"==typeof n.set}function eC(n,e){return XI(e)?e:n.ref(e)}function oA(n,e){if(function JI(n){return"string"==typeof n}(n))return e.stringCase();if(XI(n))return e.firebaseCase();if(function hE(n){return"function"==typeof n.exportVal}(n))return e.snapshotCase();throw new Error("Expects a string, snapshot, or reference. Got: "+typeof n)}function Sc(n,e,t="on",r=bd.z){return new uo.y(o=>{let u=null;return u=n[t](e,(c,g)=>{r.schedule(()=>{o.next({snapshot:c,prevKey:g})}),"once"===t&&r.schedule(()=>o.complete())},c=>{r.schedule(()=>o.error(c))}),"on"===t?{unsubscribe(){null!=u&&n.off(e,u)}}:{unsubscribe(){}}}).pipe((0,Ht.U)(o=>{const{snapshot:u,prevKey:c}=o;let g=null;return u.exists()&&(g=u.key),{type:e,payload:u,prevKey:c,key:g}}),(0,nc.B)())}function gE(n,e){const t=n.length;for(let r=0;r<t;r++)if(n[r].payload.key===e)return r;return-1}function _E(n,e){const{payload:t,prevKey:r,key:o}=e,u=gE(n,o),c=function mE(n,e){if(fE(e))return 0;{const t=gE(n,e);return-1===t?n.length:t+1}}(n,r);switch(e.type){case"value":if(e.payload&&e.payload.exists()){let g=null;e.payload.forEach(E=>{const I={payload:E,type:"value",prevKey:g,key:E.key};return g=E.key,n=[...n,I],!1})}return n;case"child_added":if(u>-1){const g=n[u-1];(g&&g.key||null)!==r&&(n=n.filter(E=>E.payload.key!==t.key)).splice(c,0,e)}else{if(null==r)return[e,...n];(n=n.slice()).splice(c,0,e)}return n;case"child_removed":return n.filter(g=>g.payload.key!==t.key);case"child_changed":return n.map(g=>g.payload.key===o?e:g);case"child_moved":if(u>-1){const g=n.splice(u,1)[0];return(n=n.slice()).splice(c,0,g),n}return n;default:return n}}function tC(n){return(fE(n)||0===n.length)&&(n=["child_added","child_removed","child_changed","child_moved"]),n}function nC(n,e,t){return function pE(n,e,t){return Sc(n,"value","once",t).pipe($s(r=>{const o=[eu(r)];return e.forEach(u=>o.push(Sc(n,u,"on",t))),(0,tc.T)(...o).pipe(Fu(_E,[]))}),bg())}(n,e=tC(e),t)}function rC(n,e,t){const r=(e=tC(e)).map(o=>Sc(n,o,"on",t));return(0,tc.T)(...r)}function sC(n,e){return function(r,o){return oA(r,{stringCase:()=>n.child(r)[e](o),firebaseCase:()=>r[e](o),snapshotCase:()=>r.ref[e](o)})}}function uA(n){return function(t){return t?oA(t,{stringCase:()=>n.child(t).remove(),firebaseCase:()=>t.remove(),snapshotCase:()=>t.ref.remove()}):n.remove()}}function oC(n,e){return function(){return Sc(n,"value","on",e)}}const aC=new _.OlP("angularfire2.realtimeDatabaseURL"),uC=new _.OlP("angularfire2.database.use-emulator");let dA=(()=>{class n{constructor(t,r,o,u,c,g,E,I,S,M,F,W,Y,xe,qe){this.schedulers=g;const Pt=E,Bt=(0,Pn.on)(t,c,r);I&&cE(Bt,c,S,F,W,Y,M,xe),this.database=(0,Pn.cc)(`${Bt.name}.database.${o}`,"AngularFireDatabase",Bt.name,()=>{const or=c.runOutsideAngular(()=>Bt.database(o||void 0));return Pt&&or.useEmulator(...Pt),or},[Pt])}list(t,r){const o=this.schedulers.ngZone.runOutsideAngular(()=>eC(this.database,t));let u=o;return r&&(u=r(o)),function lA(n,e){const t=e.schedulers.outsideAngular,r=e.schedulers.ngZone.run(()=>n.ref);return{query:n,update:sC(r,"update"),set:sC(r,"set"),push:o=>r.push(o),remove:uA(r),snapshotChanges:o=>nC(n,o,t).pipe(vn.iC),stateChanges:o=>rC(n,o,t).pipe(vn.iC),auditTrail:o=>function aA(n,e,t){return function yE(n,e,t){return function iC(n,e){return Sc(n,"value","on",e).pipe((0,Ht.U)(t=>{let r;return t.payload.forEach(o=>(r=o.key,!1)),{data:t,lastKeyToLoad:r}}))}(n,t).pipe(function Ey(...n){const e=(0,fs.jO)(n);return(0,Gs.e)((t,r)=>{const o=n.length,u=new Array(o);let c=n.map(()=>!1),g=!1;for(let E=0;E<o;E++)(0,Mu.Xf)(n[E]).subscribe(new Wr.Q(r,I=>{u[E]=I,!g&&!c[E]&&(c[E]=!0,(g=c.every(ff.y))&&(c=null))},vy.Z));t.subscribe(new Wr.Q(r,E=>{if(g){const I=[E,...u];r.next(e?e(...I):I)}}))})}(e),(0,Ht.U)(([o,u])=>{const c=o.lastKeyToLoad,g=u.map(E=>E.key);return{actions:u,lastKeyToLoad:c,loadedKeys:g}}),function pf(n){return(0,Gs.e)((e,t)=>{let r=!1,o=0;e.subscribe(new Wr.Q(t,u=>(r||(r=!n(u,o++)))&&t.next(u)))})}(o=>-1===o.loadedKeys.indexOf(o.lastKeyToLoad)),(0,Ht.U)(o=>o.actions))}(n,rC(n,e).pipe(Fu((o,u)=>[...o,u],[])),t)}(n,o,t).pipe(vn.iC),valueChanges:(o,u)=>nC(n,o,t).pipe((0,Ht.U)(g=>g.map(E=>u&&u.idField?Object.assign(Object.assign({},E.payload.val()),{[u.idField]:E.key}):E.payload.val())),vn.iC)}}(u,this)}object(t){return function cA(n,e){return{query:n,snapshotChanges:()=>oC(n,e.schedulers.outsideAngular)().pipe(vn.iC),update:t=>n.ref.update(t),set:t=>n.ref.set(t),remove:()=>n.ref.remove(),valueChanges:()=>oC(n,e.schedulers.outsideAngular)().pipe(vn.iC,(0,Ht.U)(r=>r.payload.exists()?r.payload.val():null))}}(this.schedulers.ngZone.runOutsideAngular(()=>eC(this.database,t)),this)}createPushId(){return this.schedulers.ngZone.runOutsideAngular(()=>this.database.ref()).push().key}}return n.\u0275fac=function(t){return new(t||n)(_.LFG(Pn.Dh),_.LFG(Pn.xv,8),_.LFG(aC,8),_.LFG(_.Lbi),_.LFG(_.R0b),_.LFG(vn.HU),_.LFG(uC,8),_.LFG(dE,8),_.LFG(Ac,8),_.LFG(aE,8),_.LFG(uE,8),_.LFG(lE,8),_.LFG(ah,8),_.LFG(uh,8),_.LFG(lp,8))},n.\u0275prov=_.Yz7({token:n,factory:n.\u0275fac,providedIn:"any"}),n})(),lC=(()=>{class n{constructor(){iA.Z.registerVersion("angularfire",vn.q4.full,"rtdb-compat")}}return n.\u0275fac=function(t){return new(t||n)},n.\u0275mod=_.oAB({type:n}),n.\u0275inj=_.cJS({providers:[dA]}),n})();class Um{}var Ri=L(6131);function cC(...n){return function lh(){return(0,Ri.J)(1)}()((0,Wi.D)(n,(0,fs.yG)(n)))}function vE(...n){const e=(0,fs.yG)(n);return(0,Gs.e)((t,r)=>{(e?cC(n,t,e):cC(n,t)).subscribe(r)})}function dC(){return(0,Gs.e)((n,e)=>{let t,r=!1;n.subscribe(new Wr.Q(e,o=>{const u=t;t=o,r&&e.next([u,o]),r=!0}))})}var Ze,cp="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{},hu={},EE=EE||{},vt=cp||self;function jm(){}function wE(n){var e=typeof n;return"array"==(e="object"!=e?e:n?Array.isArray(n)?"array":e:"null")||"object"==e&&"number"==typeof n.length}function xc(n){var e=typeof n;return"object"==e&&null!=n||"function"==e}var Hm="closure_uid_"+(1e9*Math.random()>>>0),Gm=0;function IE(n,e,t){return n.call.apply(n.bind,arguments)}function WM(n,e,t){if(!n)throw Error();if(2<arguments.length){var r=Array.prototype.slice.call(arguments,2);return function(){var o=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(o,r),n.apply(e,o)}}return function(){return n.apply(e,arguments)}}function Pr(n,e,t){return(Pr=Function.prototype.bind&&-1!=Function.prototype.bind.toString().indexOf("native code")?IE:WM).apply(null,arguments)}function $m(n,e){var t=Array.prototype.slice.call(arguments,1);return function(){var r=t.slice();return r.push.apply(r,arguments),n.apply(this,r)}}function Or(n,e){function t(){}t.prototype=e.prototype,n.Z=e.prototype,n.prototype=new t,n.prototype.constructor=n,n.Vb=function(r,o,u){for(var c=Array(arguments.length-2),g=2;g<arguments.length;g++)c[g-2]=arguments[g];return e.prototype[o].apply(r,c)}}function Ao(){this.s=this.s,this.o=this.o}var hA={};Ao.prototype.s=!1,Ao.prototype.na=function(){if(!this.s&&(this.s=!0,this.M(),0)){var n=function hC(n){return Object.prototype.hasOwnProperty.call(n,Hm)&&n[Hm]||(n[Hm]=++Gm)}(this);delete hA[n]}},Ao.prototype.M=function(){if(this.o)for(;this.o.length;)this.o.shift()()};const Wm=Array.prototype.indexOf?function(n,e){return Array.prototype.indexOf.call(n,e,void 0)}:function(n,e){if("string"==typeof n)return"string"!=typeof e||1!=e.length?-1:n.indexOf(e,0);for(let t=0;t<n.length;t++)if(t in n&&n[t]===e)return t;return-1},qm=Array.prototype.forEach?function(n,e,t){Array.prototype.forEach.call(n,e,t)}:function(n,e,t){const r=n.length,o="string"==typeof n?n.split(""):n;for(let u=0;u<r;u++)u in o&&e.call(t,o[u],u,n)};function pC(n){return Array.prototype.concat.apply([],arguments)}function CE(n){const e=n.length;if(0<e){const t=Array(e);for(let r=0;r<e;r++)t[r]=n[r];return t}return[]}function dp(n){return/^[\s\xa0]*$/.test(n)}var ai,DE=String.prototype.trim?function(n){return n.trim()}:function(n){return/^[\s\xa0]*([\s\S]*?)[\s\xa0]*$/.exec(n)[1]};function Pi(n,e){return-1!=n.indexOf(e)}function zm(n,e){return n<e?-1:n>e?1:0}e:{var gC=vt.navigator;if(gC){var mC=gC.userAgent;if(mC){ai=mC;break e}}ai=""}function Km(n,e,t){for(const r in n)e.call(t,n[r],r,n)}function _C(n){const e={};for(const t in n)e[t]=n[t];return e}var bE="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function TE(n,e){let t,r;for(let o=1;o<arguments.length;o++){for(t in r=arguments[o],r)n[t]=r[t];for(let u=0;u<bE.length;u++)t=bE[u],Object.prototype.hasOwnProperty.call(r,t)&&(n[t]=r[t])}}function Zm(n){return Zm[" "](n),n}Zm[" "]=jm;var AE,n,fA=Pi(ai,"Opera"),ch=Pi(ai,"Trident")||Pi(ai,"MSIE"),pA=Pi(ai,"Edge"),Ym=pA||ch,gA=Pi(ai,"Gecko")&&!(Pi(ai.toLowerCase(),"webkit")&&!Pi(ai,"Edge"))&&!(Pi(ai,"Trident")||Pi(ai,"MSIE"))&&!Pi(ai,"Edge"),zM=Pi(ai.toLowerCase(),"webkit")&&!Pi(ai,"Edge");function mA(){var n=vt.document;return n?n.documentMode:void 0}e:{var vC="",EC=(n=ai,gA?/rv:([^\);]+)(\)|;)/.exec(n):pA?/Edge\/([\d\.]+)/.exec(n):ch?/\b(?:MSIE|rv)[: ]([^\);]+)(\)|;)/.exec(n):zM?/WebKit\/(\S+)/.exec(n):fA?/(?:Version)[ \/]?(\S+)/.exec(n):void 0);if(EC&&(vC=EC?EC[1]:""),ch){var wC=mA();if(null!=wC&&wC>parseFloat(vC)){AE=String(wC);break e}}AE=vC}var KM={};var dh=vt.document&&ch&&(mA()||parseInt(AE,10))||void 0,CC=function(){if(!vt.addEventListener||!Object.defineProperty)return!1;var n=!1,e=Object.defineProperty({},"passive",{get:function(){n=!0}});try{vt.addEventListener("test",jm,e),vt.removeEventListener("test",jm,e)}catch(t){}return n}();function ui(n,e){this.type=n,this.g=this.target=e,this.defaultPrevented=!1}function hp(n,e){if(ui.call(this,n?n.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,n){var t=this.type=n.type,r=n.changedTouches&&n.changedTouches.length?n.changedTouches[0]:null;if(this.target=n.target||n.srcElement,this.g=e,e=n.relatedTarget){if(gA){e:{try{Zm(e.nodeName);var o=!0;break e}catch(u){}o=!1}o||(e=null)}}else"mouseover"==t?e=n.fromElement:"mouseout"==t&&(e=n.toElement);this.relatedTarget=e,r?(this.clientX=void 0!==r.clientX?r.clientX:r.pageX,this.clientY=void 0!==r.clientY?r.clientY:r.pageY,this.screenX=r.screenX||0,this.screenY=r.screenY||0):(this.clientX=void 0!==n.clientX?n.clientX:n.pageX,this.clientY=void 0!==n.clientY?n.clientY:n.pageY,this.screenX=n.screenX||0,this.screenY=n.screenY||0),this.button=n.button,this.key=n.key||"",this.ctrlKey=n.ctrlKey,this.altKey=n.altKey,this.shiftKey=n.shiftKey,this.metaKey=n.metaKey,this.pointerId=n.pointerId||0,this.pointerType="string"==typeof n.pointerType?n.pointerType:SE[n.pointerType]||"",this.state=n.state,this.i=n,n.defaultPrevented&&hp.Z.h.call(this)}}ui.prototype.h=function(){this.defaultPrevented=!0},Or(hp,ui);var SE={2:"touch",3:"pen",4:"mouse"};hp.prototype.h=function(){hp.Z.h.call(this);var n=this.i;n.preventDefault?n.preventDefault():n.returnValue=!1};var hh="closure_listenable_"+(1e6*Math.random()|0),DC=0;function _A(n,e,t,r,o){this.listener=n,this.proxy=null,this.src=e,this.type=t,this.capture=!!r,this.ia=o,this.key=++DC,this.ca=this.fa=!1}function xE(n){n.ca=!0,n.listener=null,n.proxy=null,n.src=null,n.ia=null}function Xm(n){this.src=n,this.g={},this.h=0}function fh(n,e){var t=e.type;if(t in n.g){var u,r=n.g[t],o=Wm(r,e);(u=0<=o)&&Array.prototype.splice.call(r,o,1),u&&(xE(e),0==n.g[t].length&&(delete n.g[t],n.h--))}}function e_(n,e,t,r){for(var o=0;o<n.length;++o){var u=n[o];if(!u.ca&&u.listener==e&&u.capture==!!t&&u.ia==r)return o}return-1}Xm.prototype.add=function(n,e,t,r,o){var u=n.toString();(n=this.g[u])||(n=this.g[u]=[],this.h++);var c=e_(n,e,r,o);return-1<c?(e=n[c],t||(e.fa=!1)):((e=new _A(e,this.src,u,!!r,o)).fa=t,n.push(e)),e};var bC="closure_lm_"+(1e6*Math.random()|0),TC={};function yA(n,e,t,r,o){if(r&&r.once)return xC(n,e,t,r,o);if(Array.isArray(e)){for(var u=0;u<e.length;u++)yA(n,e[u],t,r,o);return null}return t=fp(t),n&&n[hh]?n.N(e,t,xc(r)?!!r.capture:!!r,o):AC(n,e,t,!1,r,o)}function AC(n,e,t,r,o,u){if(!e)throw Error("Invalid event type");var c=xc(o)?!!o.capture:!!o,g=Oi(n);if(g||(n[bC]=g=new Xm(n)),(t=g.add(e,t,r,c,u)).proxy)return t;if(r=function SC(){var e=EA;return function n(t){return e.call(n.src,n.listener,t)}}(),t.proxy=r,r.src=n,r.listener=t,n.addEventListener)CC||(o=c),void 0===o&&(o=!1),n.addEventListener(e.toString(),r,o);else if(n.attachEvent)n.attachEvent(t_(e.toString()),r);else{if(!n.addListener||!n.removeListener)throw Error("addEventListener and attachEvent are unavailable.");n.addListener(r)}return t}function xC(n,e,t,r,o){if(Array.isArray(e)){for(var u=0;u<e.length;u++)xC(n,e[u],t,r,o);return null}return t=fp(t),n&&n[hh]?n.O(e,t,xc(r)?!!r.capture:!!r,o):AC(n,e,t,!0,r,o)}function vA(n,e,t,r,o){if(Array.isArray(e))for(var u=0;u<e.length;u++)vA(n,e[u],t,r,o);else r=xc(r)?!!r.capture:!!r,t=fp(t),n&&n[hh]?(n=n.i,(e=String(e).toString())in n.g&&-1<(t=e_(u=n.g[e],t,r,o))&&(xE(u[t]),Array.prototype.splice.call(u,t,1),0==u.length&&(delete n.g[e],n.h--))):n&&(n=Oi(n))&&(e=n.g[e.toString()],n=-1,e&&(n=e_(e,t,r,o)),(t=-1<n?e[n]:null)&&ME(t))}function ME(n){if("number"!=typeof n&&n&&!n.ca){var e=n.src;if(e&&e[hh])fh(e.i,n);else{var t=n.type,r=n.proxy;e.removeEventListener?e.removeEventListener(t,r,n.capture):e.detachEvent?e.detachEvent(t_(t),r):e.addListener&&e.removeListener&&e.removeListener(r),(t=Oi(e))?(fh(t,n),0==t.h&&(t.src=null,e[bC]=null)):xE(n)}}}function t_(n){return n in TC?TC[n]:TC[n]="on"+n}function EA(n,e){if(n.ca)n=!0;else{e=new hp(e,this);var t=n.listener,r=n.ia||n.src;n.fa&&ME(n),n=t.call(r,e)}return n}function Oi(n){return(n=n[bC])instanceof Xm?n:null}var NE="__closure_events_fn_"+(1e9*Math.random()>>>0);function fp(n){return"function"==typeof n?n:(n[NE]||(n[NE]=function(e){return n.handleEvent(e)}),n[NE])}function kr(){Ao.call(this),this.i=new Xm(this),this.P=this,this.I=null}function Qr(n,e){var t,r=n.I;if(r)for(t=[];r;r=r.I)t.push(r);if(n=n.P,r=e.type||e,"string"==typeof e)e=new ui(e,n);else if(e instanceof ui)e.target=e.target||n;else{var o=e;TE(e=new ui(r,n),o)}if(o=!0,t)for(var u=t.length-1;0<=u;u--){var c=e.g=t[u];o=ph(c,r,!0,e)&&o}if(o=ph(c=e.g=n,r,!0,e)&&o,o=ph(c,r,!1,e)&&o,t)for(u=0;u<t.length;u++)o=ph(c=e.g=t[u],r,!1,e)&&o}function ph(n,e,t,r){if(!(e=n.i.g[String(e)]))return!0;e=e.concat();for(var o=!0,u=0;u<e.length;++u){var c=e[u];if(c&&!c.ca&&c.capture==t){var g=c.listener,E=c.ia||c.src;c.fa&&fh(n.i,c),o=!1!==g.call(E,r)&&o}}return o&&!r.defaultPrevented}Or(kr,Ao),kr.prototype[hh]=!0,kr.prototype.removeEventListener=function(n,e,t,r){vA(this,n,e,t,r)},kr.prototype.M=function(){if(kr.Z.M.call(this),this.i){var e,n=this.i;for(e in n.g){for(var t=n.g[e],r=0;r<t.length;r++)xE(t[r]);delete n.g[e],n.h--}}this.I=null},kr.prototype.N=function(n,e,t,r){return this.i.add(String(n),e,!1,t,r)},kr.prototype.O=function(n,e,t,r){return this.i.add(String(n),e,!0,t,r)};var n_=vt.JSON.stringify;function MC(){var n=CA;let e=null;return n.g&&(e=n.g,n.g=n.g.next,n.g||(n.h=null),e.next=null),e}var pp,RE=new class{constructor(n,e){this.i=n,this.j=e,this.h=0,this.g=null}get(){let n;return 0<this.h?(this.h--,n=this.g,this.g=n.next,n.next=null):n=this.i(),n}}(()=>new NC,n=>n.reset());class NC{constructor(){this.next=this.g=this.h=null}set(e,t){this.h=e,this.g=t,this.next=null}reset(){this.next=this.g=this.h=null}}function IA(n){vt.setTimeout(()=>{throw n},0)}function PE(n,e){pp||function So(){var n=vt.Promise.resolve(void 0);pp=function(){n.then(DA)}}(),OE||(pp(),OE=!0),CA.add(n,e)}var OE=!1,CA=new class wA{constructor(){this.h=this.g=null}add(e,t){const r=RE.get();r.set(e,t),this.h?this.h.next=r:this.g=r,this.h=r}};function DA(){for(var n;n=MC();){try{n.h.call(n.g)}catch(t){IA(t)}var e=RE;e.j(n),100>e.h&&(e.h++,n.next=e.g,e.g=n)}OE=!1}function gp(n,e){kr.call(this),this.h=n||1,this.g=e||vt,this.j=Pr(this.kb,this),this.l=Date.now()}function RC(n){n.da=!1,n.S&&(n.g.clearTimeout(n.S),n.S=null)}function kE(n,e,t){if("function"==typeof n)t&&(n=Pr(n,t));else{if(!n||"function"!=typeof n.handleEvent)throw Error("Invalid listener argument");n=Pr(n.handleEvent,n)}return 2147483647<Number(e)?-1:vt.setTimeout(n,e||0)}function FE(n){n.g=kE(()=>{n.g=null,n.i&&(n.i=!1,FE(n))},n.j);const e=n.h;n.h=null,n.m.apply(null,e)}Or(gp,kr),(Ze=gp.prototype).da=!1,Ze.S=null,Ze.kb=function(){if(this.da){var n=Date.now()-this.l;0<n&&n<.8*this.h?this.S=this.g.setTimeout(this.j,this.h-n):(this.S&&(this.g.clearTimeout(this.S),this.S=null),Qr(this,"tick"),this.da&&(RC(this),this.start()))}},Ze.start=function(){this.da=!0,this.S||(this.S=this.g.setTimeout(this.j,this.h),this.l=Date.now())},Ze.M=function(){gp.Z.M.call(this),RC(this),delete this.g};class bA extends Ao{constructor(e,t){super(),this.m=e,this.j=t,this.h=null,this.i=!1,this.g=null}l(e){this.h=arguments,this.g?this.i=!0:FE(this)}M(){super.M(),this.g&&(vt.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)}}function r_(n){Ao.call(this),this.h=n,this.g={}}Or(r_,Ao);var LE=[];function VE(n,e,t,r){Array.isArray(t)||(t&&(LE[0]=t.toString()),t=LE);for(var o=0;o<t.length;o++){var u=yA(e,t[o],r||n.handleEvent,!1,n.h||n);if(!u)break;n.g[u.key]=u}}function PC(n){Km(n.g,function(e,t){this.g.hasOwnProperty(t)&&ME(e)},n),n.g={}}function i_(){this.g=!0}function al(n,e,t,r){n.info(function(){return"XMLHTTP TEXT ("+e+"): "+function TA(n,e){if(!n.g)return e;if(!e)return null;try{var t=JSON.parse(e);if(t)for(n=0;n<t.length;n++)if(Array.isArray(t[n])){var r=t[n];if(!(2>r.length)){var o=r[1];if(Array.isArray(o)&&!(1>o.length)){var u=o[0];if("noop"!=u&&"stop"!=u&&"close"!=u)for(var c=1;c<o.length;c++)o[c]=""}}}return n_(t)}catch(g){return e}}(n,t)+(r?" "+r:"")})}r_.prototype.M=function(){r_.Z.M.call(this),PC(this)},r_.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")},i_.prototype.Aa=function(){this.g=!1},i_.prototype.info=function(){};var ul={},BE=null;function o_(){return BE=BE||new kr}function FC(n){ui.call(this,ul.Ma,n)}function a_(n){const e=o_();Qr(e,new FC(e,n))}function AA(n,e){ui.call(this,ul.STAT_EVENT,n),this.stat=e}function li(n){const e=o_();Qr(e,new AA(e,n))}function LC(n,e){ui.call(this,ul.Na,n),this.size=e}function mp(n,e){if("function"!=typeof n)throw Error("Fn must not be null and must be a function");return vt.setTimeout(function(){n()},e)}ul.Ma="serverreachability",Or(FC,ui),ul.STAT_EVENT="statevent",Or(AA,ui),ul.Na="timingevent",Or(LC,ui);var u_={NO_ERROR:0,lb:1,yb:2,xb:3,sb:4,wb:5,zb:6,Ja:7,TIMEOUT:8,Cb:9},SA={qb:"complete",Mb:"success",Ka:"error",Ja:"abort",Eb:"ready",Fb:"readystatechange",TIMEOUT:"timeout",Ab:"incrementaldata",Db:"progress",tb:"downloadprogress",Ub:"uploadprogress"};function VC(){}function MA(){}VC.prototype.h=null;var jE,l_={OPEN:"a",pb:"b",Ka:"c",Bb:"d"};function UE(){ui.call(this,"d")}function gh(){ui.call(this,"c")}function c_(){}function mh(n,e,t,r){this.l=n,this.j=e,this.m=t,this.X=r||1,this.V=new r_(this),this.P=BC,this.W=new gp(n=Ym?125:void 0),this.H=null,this.i=!1,this.s=this.A=this.v=this.K=this.F=this.Y=this.B=null,this.D=[],this.g=null,this.C=0,this.o=this.u=null,this.N=-1,this.I=!1,this.O=0,this.L=null,this.aa=this.J=this.$=this.U=!1,this.h=new ll}function ll(){this.i=null,this.g="",this.h=!1}Or(UE,ui),Or(gh,ui),Or(c_,VC),c_.prototype.g=function(){return new XMLHttpRequest},c_.prototype.i=function(){return{}},jE=new c_;var BC=45e3,_p={},_h={};function HE(n,e,t){n.K=1,n.v=Ep(pa(e)),n.s=t,n.U=!0,d_(n,null)}function d_(n,e){n.F=Date.now(),f_(n),n.A=pa(n.v);var t=n.A,r=n.X;Array.isArray(r)||(r=[String(r)]),BA(t.h,"t",r),n.C=0,t=n.l.H,n.h=new ll,n.g=aN(n.l,t?e:null,!n.s),0<n.O&&(n.L=new bA(Pr(n.Ia,n,n.g),n.O)),VE(n.V,n.g,"readystatechange",n.gb),e=n.H?_C(n.H):{},n.s?(n.u||(n.u="POST"),e["Content-Type"]="application/x-www-form-urlencoded",n.g.ea(n.A,n.u,n.s,e)):(n.u="GET",n.g.ea(n.A,n.u,null,e)),a_(1),function OC(n,e,t,r,o,u){n.info(function(){if(n.g)if(u)for(var c="",g=u.split("&"),E=0;E<g.length;E++){var I=g[E].split("=");if(1<I.length){var S=I[0];I=I[1];var M=S.split("_");c=2<=M.length&&"type"==M[1]?c+(S+"=")+I+"&":c+(S+"=redacted&")}}else c=null;else c=u;return"XMLHTTP REQ ("+r+") [attempt "+o+"]: "+e+"\n"+t+"\n"+c})}(n.j,n.u,n.A,n.m,n.X,n.s)}function h_(n){return!!n.g&&"GET"==n.u&&2!=n.K&&n.l.Ba}function GE(n,e,t){let o,r=!0;for(;!n.I&&n.C<t.length;){if(o=UC(n,t),o==_h){4==e&&(n.o=4,li(14),r=!1),al(n.j,n.m,null,"[Incomplete Response]");break}if(o==_p){n.o=4,li(15),al(n.j,n.m,t,"[Invalid Chunk]"),r=!1;break}al(n.j,n.m,o,null),jC(n,o)}h_(n)&&o!=_h&&o!=_p&&(n.h.g="",n.C=0),4!=e||0!=t.length||n.h.h||(n.o=1,li(16),r=!1),n.i=n.i&&r,r?0<t.length&&!n.aa&&(n.aa=!0,(e=n.l).g==n&&e.$&&!e.L&&(e.h.info("Great, no buffering proxy detected. Bytes received: "+t.length),qA(e),e.L=!0,li(11))):(al(n.j,n.m,t,"[Invalid Chunked Response]"),yh(n),p_(n))}function UC(n,e){var t=n.C,r=e.indexOf("\n",t);return-1==r?_h:(t=Number(e.substring(t,r)),isNaN(t)?_p:(r+=1)+t>e.length?_h:(e=e.substr(r,t),n.C=r+t,e))}function f_(n){n.Y=Date.now()+n.P,NA(n,n.P)}function NA(n,e){if(null!=n.B)throw Error("WatchDog timer not null");n.B=mp(Pr(n.eb,n),e)}function $E(n){n.B&&(vt.clearTimeout(n.B),n.B=null)}function p_(n){0==n.l.G||n.I||rN(n.l,n)}function yh(n){$E(n);var e=n.L;e&&"function"==typeof e.na&&e.na(),n.L=null,RC(n.W),PC(n.V),n.g&&(e=n.g,n.g=null,e.abort(),e.na())}function jC(n,e){try{var t=n.l;if(0!=t.G&&(t.g==n||qC(t.i,n)))if(t.I=n.N,!n.J&&qC(t.i,n)&&3==t.G){try{var r=t.Ca.g.parse(e)}catch(I){r=null}if(Array.isArray(r)&&3==r.length){var o=r;if(0==o[0])e:if(t.u)t.ta=o[1],0<t.ta-t.U&&37500>o[2]&&t.N&&0==t.A&&!t.v&&(t.v=mp(Pr(t.ab,t),6e3));else{if(t.g){if(!(t.g.F+3e3<n.F))break e;ZC(t),Eh(t)}WA(t),li(18)}if(1>=GA(t.i)&&t.ka){try{t.ka()}catch(I){}t.ka=void 0}}else Ap(t,11)}else if((n.J||t.g==n)&&ZC(t),!dp(e))for(o=t.Ca.g.parse(e),e=0;e<o.length;e++){let I=o[e];if(t.U=I[0],I=I[1],2==t.G)if("c"==I[0]){t.J=I[1],t.la=I[2];const S=I[3];null!=S&&(t.ma=S,t.h.info("VER="+t.ma));const M=I[4];null!=M&&(t.za=M,t.h.info("SVER="+t.za));const F=I[5];null!=F&&"number"==typeof F&&0<F&&(t.K=r=1.5*F,t.h.info("backChannelRequestTimeoutMs_="+r)),r=t;const W=n.g;if(W){const Y=W.g?W.g.getResponseHeader("X-Client-Wire-Protocol"):null;if(Y){var u=r.i;!u.g&&(Pi(Y,"spdy")||Pi(Y,"quic")||Pi(Y,"h2"))&&(u.j=u.l,u.g=new Set,u.h&&(zC(u,u.h),u.h=null))}if(r.D){const xe=W.g?W.g.getResponseHeader("X-HTTP-Session-Id"):null;xe&&(r.sa=xe,On(r.F,r.D,xe))}}t.G=3,t.j&&t.j.xa(),t.$&&(t.O=Date.now()-n.F,t.h.info("Handshake RTT: "+t.O+"ms"));var c=n;if((r=t).oa=oN(r,r.H?r.la:null,r.W),c.J){i(r.i,c);var g=c,E=r.K;E&&g.setTimeout(E),g.B&&($E(g),f_(g)),r.g=c}else tN(r);0<t.l.length&&KC(t)}else"stop"!=I[0]&&"close"!=I[0]||Ap(t,7);else 3==t.G&&("stop"==I[0]||"close"==I[0]?"stop"==I[0]?Ap(t,7):Tp(t):"noop"!=I[0]&&t.j&&t.j.wa(I),t.A=0)}a_(4)}catch(I){}}function g_(n,e){if(n.forEach&&"function"==typeof n.forEach)n.forEach(e,void 0);else if(wE(n)||"string"==typeof n)qm(n,e,void 0);else{if(n.T&&"function"==typeof n.T)var t=n.T();else if(n.R&&"function"==typeof n.R)t=void 0;else if(wE(n)||"string"==typeof n){t=[];for(var r=n.length,o=0;o<r;o++)t.push(o)}else for(o in t=[],r=0,n)t[r++]=o;r=function ZM(n){if(n.R&&"function"==typeof n.R)return n.R();if("string"==typeof n)return n.split("");if(wE(n)){for(var e=[],t=n.length,r=0;r<t;r++)e.push(n[r]);return e}for(r in e=[],t=0,n)e[t++]=n[r];return e}(n),o=r.length;for(var u=0;u<o;u++)e.call(void 0,r[u],t&&t[u],n)}}function vh(n,e){this.h={},this.g=[],this.i=0;var t=arguments.length;if(1<t){if(t%2)throw Error("Uneven number of arguments");for(var r=0;r<t;r+=2)this.set(arguments[r],arguments[r+1])}else if(n)if(n instanceof vh)for(t=n.T(),r=0;r<t.length;r++)this.set(t[r],n.get(t[r]));else for(r in n)this.set(r,n[r])}function WE(n){if(n.i!=n.g.length){for(var e=0,t=0;e<n.g.length;){var r=n.g[e];Mc(n.h,r)&&(n.g[t++]=r),e++}n.g.length=t}if(n.i!=n.g.length){var o={};for(t=e=0;e<n.g.length;)Mc(o,r=n.g[e])||(n.g[t++]=r,o[r]=1),e++;n.g.length=t}}function Mc(n,e){return Object.prototype.hasOwnProperty.call(n,e)}(Ze=mh.prototype).setTimeout=function(n){this.P=n},Ze.gb=function(n){n=n.target;const e=this.L;e&&3==xo(n)?e.l():this.Ia(n)},Ze.Ia=function(n){try{if(n==this.g)e:{const S=xo(this.g);var e=this.g.Da();const M=this.g.ba();if(!(3>S)&&(3!=S||Ym||this.g&&(this.h.h||this.g.ga()||E_(this.g)))){this.I||4!=S||7==e||a_(8==e||0>=M?3:2),$E(this);var t=this.g.ba();this.N=t;t:if(h_(this)){var r=E_(this.g);n="";var o=r.length,u=4==xo(this.g);if(!this.h.i){if("undefined"==typeof TextDecoder){yh(this),p_(this);var c="";break t}this.h.i=new vt.TextDecoder}for(e=0;e<o;e++)this.h.h=!0,n+=this.h.i.decode(r[e],{stream:u&&e==o-1});r.splice(0,o),this.h.g+=n,this.C=0,c=this.h.g}else c=this.g.ga();if(this.i=200==t,function s_(n,e,t,r,o,u,c){n.info(function(){return"XMLHTTP RESP ("+r+") [ attempt "+o+"]: "+e+"\n"+t+"\n"+u+" "+c})}(this.j,this.u,this.A,this.m,this.X,S,t),this.i){if(this.$&&!this.J){t:{if(this.g){var g,E=this.g;if((g=E.g?E.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!dp(g)){var I=g;break t}}I=null}if(!(t=I)){this.i=!1,this.o=3,li(12),yh(this),p_(this);break e}al(this.j,this.m,t,"Initial handshake response via X-HTTP-Initial-Response"),this.J=!0,jC(this,t)}this.U?(GE(this,S,c),Ym&&this.i&&3==S&&(VE(this.V,this.W,"tick",this.fb),this.W.start())):(al(this.j,this.m,c,null),jC(this,c)),4==S&&yh(this),this.i&&!this.I&&(4==S?rN(this.l,this):(this.i=!1,f_(this)))}else 400==t&&0<c.indexOf("Unknown SID")?(this.o=3,li(12)):(this.o=0,li(13)),yh(this),p_(this)}}}catch(S){}},Ze.fb=function(){if(this.g){var n=xo(this.g),e=this.g.ga();this.C<e.length&&($E(this),GE(this,n,e),this.i&&4!=n&&f_(this))}},Ze.cancel=function(){this.I=!0,yh(this)},Ze.eb=function(){this.B=null;const n=Date.now();0<=n-this.Y?(function kC(n,e){n.info(function(){return"TIMEOUT: "+e})}(this.j,this.A),2!=this.K&&(a_(3),li(17)),yh(this),this.o=2,p_(this)):NA(this,this.Y-n)},(Ze=vh.prototype).R=function(){WE(this);for(var n=[],e=0;e<this.g.length;e++)n.push(this.h[this.g[e]]);return n},Ze.T=function(){return WE(this),this.g.concat()},Ze.get=function(n,e){return Mc(this.h,n)?this.h[n]:e},Ze.set=function(n,e){Mc(this.h,n)||(this.i++,this.g.push(n)),this.h[n]=e},Ze.forEach=function(n,e){for(var t=this.T(),r=0;r<t.length;r++){var o=t[r],u=this.get(o);n.call(e,u,o,this)}};var HC=/^(?:([^:/?#.]+):)?(?:\/\/(?:([^\\/?#]*)@)?([^\\/?#]*?)(?::([0-9]+))?(?=[\\/?#]|$))?([^?#]+)?(?:\?([^#]*))?(?:#([\s\S]*))?$/;function cl(n,e){if(this.i=this.s=this.j="",this.m=null,this.o=this.l="",this.g=!1,n instanceof cl){this.g=void 0!==e?e:n.g,m_(this,n.j),this.s=n.s,__(this,n.i),yp(this,n.m),this.l=n.l,e=n.h;var t=new Cp;t.i=e.i,e.g&&(t.g=new vh(e.g),t.h=e.h),vp(this,t),this.o=n.o}else n&&(t=String(n).match(HC))?(this.g=!!e,m_(this,t[1]||"",!0),this.s=wp(t[2]||""),__(this,t[3]||"",!0),yp(this,t[4]),this.l=wp(t[5]||"",!0),vp(this,t[6]||"",!0),this.o=wp(t[7]||"")):(this.g=!!e,this.h=new Cp(null,this.g))}function pa(n){return new cl(n)}function m_(n,e,t){n.j=t?wp(e,!0):e,n.j&&(n.j=n.j.replace(/:$/,""))}function __(n,e,t){n.i=t?wp(e,!0):e}function yp(n,e){if(e){if(e=Number(e),isNaN(e)||0>e)throw Error("Bad port number "+e);n.m=e}else n.m=null}function vp(n,e,t){e instanceof Cp?(n.h=e,function YM(n,e){e&&!n.j&&(dl(n),n.i=null,n.g.forEach(function(t,r){var o=r.toLowerCase();r!=o&&($C(this,r),BA(this,o,t))},n)),n.j=e}(n.h,n.g)):(t||(e=Ip(e,LA)),n.h=new Cp(e,n.g))}function On(n,e,t){n.h.set(e,t)}function Ep(n){return On(n,"zx",Math.floor(2147483648*Math.random()).toString(36)+Math.abs(Math.floor(2147483648*Math.random())^Date.now()).toString(36)),n}function wp(n,e){return n?e?decodeURI(n.replace(/%25/g,"%2525")):decodeURIComponent(n):""}function Ip(n,e,t){return"string"==typeof n?(n=encodeURI(n).replace(e,PA),t&&(n=n.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),n):null}function PA(n){return"%"+((n=n.charCodeAt(0))>>4&15).toString(16)+(15&n).toString(16)}cl.prototype.toString=function(){var n=[],e=this.j;e&&n.push(Ip(e,OA,!0),":");var t=this.i;return(t||"file"==e)&&(n.push("//"),(e=this.s)&&n.push(Ip(e,OA,!0),"@"),n.push(encodeURIComponent(String(t)).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),null!=(t=this.m)&&n.push(":",String(t))),(t=this.l)&&(this.i&&"/"!=t.charAt(0)&&n.push("/"),n.push(Ip(t,"/"==t.charAt(0)?FA:kA,!0))),(t=this.h.toString())&&n.push("?",t),(t=this.o)&&n.push("#",Ip(t,VA)),n.join("")};var OA=/[#\/\?@]/g,kA=/[#\?:]/g,FA=/[#\?]/g,LA=/[#\?@]/g,VA=/#/g;function Cp(n,e){this.h=this.g=null,this.i=n||null,this.j=!!e}function dl(n){n.g||(n.g=new vh,n.h=0,n.i&&function GC(n,e){if(n){n=n.split("&");for(var t=0;t<n.length;t++){var r=n[t].indexOf("="),o=null;if(0<=r){var u=n[t].substring(0,r);o=n[t].substring(r+1)}else u=n[t];e(u,o?decodeURIComponent(o.replace(/\+/g," ")):"")}}}(n.i,function(e,t){n.add(decodeURIComponent(e.replace(/\+/g," ")),t)}))}function $C(n,e){dl(n),e=Dp(n,e),Mc(n.g.h,e)&&(n.i=null,n.h-=n.g.get(e).length,Mc((n=n.g).h,e)&&(delete n.h[e],n.i--,n.g.length>2*n.i&&WE(n)))}function WC(n,e){return dl(n),e=Dp(n,e),Mc(n.g.h,e)}function BA(n,e,t){$C(n,e),0<t.length&&(n.i=null,n.g.set(Dp(n,e),CE(t)),n.h+=t.length)}function Dp(n,e){return e=String(e),n.j&&(e=e.toLowerCase()),e}function UA(n){this.l=n||jA,n=vt.PerformanceNavigationTiming?0<(n=vt.performance.getEntriesByType("navigation")).length&&("hq"==n[0].nextHopProtocol||"h2"==n[0].nextHopProtocol):!!(vt.g&&vt.g.Ea&&vt.g.Ea()&&vt.g.Ea().Zb),this.j=n?this.l:1,this.g=null,1<this.j&&(this.g=new Set),this.h=null,this.i=[]}(Ze=Cp.prototype).add=function(n,e){dl(this),this.i=null,n=Dp(this,n);var t=this.g.get(n);return t||this.g.set(n,t=[]),t.push(e),this.h+=1,this},Ze.forEach=function(n,e){dl(this),this.g.forEach(function(t,r){qm(t,function(o){n.call(e,o,r,this)},this)},this)},Ze.T=function(){dl(this);for(var n=this.g.R(),e=this.g.T(),t=[],r=0;r<e.length;r++)for(var o=n[r],u=0;u<o.length;u++)t.push(e[r]);return t},Ze.R=function(n){dl(this);var e=[];if("string"==typeof n)WC(this,n)&&(e=pC(e,this.g.get(Dp(this,n))));else{n=this.g.R();for(var t=0;t<n.length;t++)e=pC(e,n[t])}return e},Ze.set=function(n,e){return dl(this),this.i=null,WC(this,n=Dp(this,n))&&(this.h-=this.g.get(n).length),this.g.set(n,[e]),this.h+=1,this},Ze.get=function(n,e){return n&&0<(n=this.R(n)).length?String(n[0]):e},Ze.toString=function(){if(this.i)return this.i;if(!this.g)return"";for(var n=[],e=this.g.T(),t=0;t<e.length;t++){var r=e[t],o=encodeURIComponent(String(r));r=this.R(r);for(var u=0;u<r.length;u++){var c=o;""!==r[u]&&(c+="="+encodeURIComponent(String(r[u]))),n.push(c)}}return this.i=n.join("&")};var jA=10;function HA(n){return!!n.h||!!n.g&&n.g.size>=n.j}function GA(n){return n.h?1:n.g?n.g.size:0}function qC(n,e){return n.h?n.h==e:!!n.g&&n.g.has(e)}function zC(n,e){n.g?n.g.add(e):n.h=e}function i(n,e){n.h&&n.h==e?n.h=null:n.g&&n.g.has(e)&&n.g.delete(e)}function s(n){if(null!=n.h)return n.i.concat(n.h.D);if(null!=n.g&&0!==n.g.size){let e=n.i;for(const t of n.g.values())e=e.concat(t.D);return e}return CE(n.i)}function a(){}function l(){this.g=new a}function d(n,e,t){const r=t||"";try{g_(n,function(o,u){let c=o;xc(o)&&(c=n_(o)),e.push(r+u+"="+encodeURIComponent(c))})}catch(o){throw e.push(r+"type="+encodeURIComponent("_badmap")),o}}function y(n,e,t,r,o){try{e.onload=null,e.onerror=null,e.onabort=null,e.ontimeout=null,o(r)}catch(u){}}function w(n){this.l=n.$b||null,this.j=n.ib||!1}function C(n,e){kr.call(this),this.D=n,this.u=e,this.m=void 0,this.readyState=A,this.status=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.v=new Headers,this.h=null,this.C="GET",this.B="",this.g=!1,this.A=this.j=this.l=null}UA.prototype.cancel=function(){if(this.i=s(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&0!==this.g.size){for(const n of this.g.values())n.cancel();this.g.clear()}},a.prototype.stringify=function(n){return vt.JSON.stringify(n,void 0)},a.prototype.parse=function(n){return vt.JSON.parse(n,void 0)},Or(w,VC),w.prototype.g=function(){return new C(this.l,this.j)},w.prototype.i=function(n){return function(){return n}}({}),Or(C,kr);var A=0;function N(n){n.j.read().then(n.Sa.bind(n)).catch(n.ha.bind(n))}function O(n){n.readyState=4,n.l=null,n.j=null,n.A=null,j(n)}function j(n){n.onreadystatechange&&n.onreadystatechange.call(n)}(Ze=C.prototype).open=function(n,e){if(this.readyState!=A)throw this.abort(),Error("Error reopening a connection");this.C=n,this.B=e,this.readyState=1,j(this)},Ze.send=function(n){if(1!=this.readyState)throw this.abort(),Error("need to call open() first. ");this.g=!0;const e={headers:this.v,method:this.C,credentials:this.m,cache:void 0};n&&(e.body=n),(this.D||vt).fetch(new Request(this.B,e)).then(this.Va.bind(this),this.ha.bind(this))},Ze.abort=function(){this.response=this.responseText="",this.v=new Headers,this.status=0,this.j&&this.j.cancel("Request was aborted."),1<=this.readyState&&this.g&&4!=this.readyState&&(this.g=!1,O(this)),this.readyState=A},Ze.Va=function(n){if(this.g&&(this.l=n,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=n.headers,this.readyState=2,j(this)),this.g&&(this.readyState=3,j(this),this.g)))if("arraybuffer"===this.responseType)n.arrayBuffer().then(this.Ta.bind(this),this.ha.bind(this));else if(void 0!==vt.ReadableStream&&"body"in n){if(this.j=n.body.getReader(),this.u){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.A=new TextDecoder;N(this)}else n.text().then(this.Ua.bind(this),this.ha.bind(this))},Ze.Sa=function(n){if(this.g){if(this.u&&n.value)this.response.push(n.value);else if(!this.u){var e=n.value?n.value:new Uint8Array(0);(e=this.A.decode(e,{stream:!n.done}))&&(this.response=this.responseText+=e)}n.done?O(this):j(this),3==this.readyState&&N(this)}},Ze.Ua=function(n){this.g&&(this.response=this.responseText=n,O(this))},Ze.Ta=function(n){this.g&&(this.response=n,O(this))},Ze.ha=function(){this.g&&O(this)},Ze.setRequestHeader=function(n,e){this.v.append(n,e)},Ze.getResponseHeader=function(n){return this.h&&this.h.get(n.toLowerCase())||""},Ze.getAllResponseHeaders=function(){if(!this.h)return"";const n=[],e=this.h.entries();for(var t=e.next();!t.done;)n.push((t=t.value)[0]+": "+t[1]),t=e.next();return n.join("\r\n")},Object.defineProperty(C.prototype,"withCredentials",{get:function(){return"include"===this.m},set:function(n){this.m=n?"include":"same-origin"}});var Z=vt.JSON.parse;function se(n){kr.call(this),this.headers=new vh,this.u=n||null,this.h=!1,this.C=this.g=null,this.H="",this.m=0,this.j="",this.l=this.F=this.v=this.D=!1,this.B=0,this.A=null,this.J=Oe,this.K=this.L=!1}Or(se,kr);var Oe="",Ve=/^https?$/i,Qe=["POST","PUT"];function ft(n){return"content-type"==n.toLowerCase()}function Rt(n,e){n.h=!1,n.g&&(n.l=!0,n.g.abort(),n.l=!1),n.j=e,n.m=5,Qt(n),ga(n)}function Qt(n){n.D||(n.D=!0,Qr(n,"complete"),Qr(n,"error"))}function ns(n){if(n.h&&void 0!==EE&&(!n.C[1]||4!=xo(n)||2!=n.ba()))if(n.v&&4==xo(n))kE(n.Fa,0,n);else if(Qr(n,"readystatechange"),4==xo(n)){n.h=!1;try{const g=n.ba();e:switch(g){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var e=!0;break e;default:e=!1}var t;if(!(t=e)){var r;if(r=0===g){var o=String(n.H).match(HC)[1]||null;if(!o&&vt.self&&vt.self.location){var u=vt.self.location.protocol;o=u.substr(0,u.length-1)}r=!Ve.test(o?o.toLowerCase():"")}t=r}if(t)Qr(n,"complete"),Qr(n,"success");else{n.m=6;try{var c=2<xo(n)?n.g.statusText:""}catch(E){c=""}n.j=c+" ["+n.ba()+"]",Qt(n)}}finally{ga(n)}}}function ga(n,e){if(n.g){v_(n);const t=n.g,r=n.C[0]?jm:null;n.g=null,n.C=null,e||Qr(n,"ready");try{t.onreadystatechange=r}catch(o){}}}function v_(n){n.g&&n.K&&(n.g.ontimeout=null),n.A&&(vt.clearTimeout(n.A),n.A=null)}function xo(n){return n.g?n.g.readyState:0}function E_(n){try{if(!n.g)return null;if("response"in n.g)return n.g.response;switch(n.J){case Oe:case"text":return n.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in n.g)return n.g.mozResponseArrayBuffer}return null}catch(e){return null}}function bp(n,e,t){e:{for(r in t){var r=!1;break e}r=!0}r||(t=function qE(n){let e="";return Km(n,function(t,r){e+=r,e+=":",e+=t,e+="\r\n"}),e}(t),"string"==typeof n?null!=t&&encodeURIComponent(String(t)):On(n,e,t))}function Nc(n,e,t){return t&&t.internalChannelParams&&t.internalChannelParams[n]||e}function w_(n){this.za=0,this.l=[],this.h=new i_,this.la=this.oa=this.F=this.W=this.g=this.sa=this.D=this.aa=this.o=this.P=this.s=null,this.Za=this.V=0,this.Xa=Nc("failFast",!1,n),this.N=this.v=this.u=this.m=this.j=null,this.X=!0,this.I=this.ta=this.U=-1,this.Y=this.A=this.C=0,this.Pa=Nc("baseRetryDelayMs",5e3,n),this.$a=Nc("retryDelaySeedMs",1e4,n),this.Ya=Nc("forwardChannelMaxRetries",2,n),this.ra=Nc("forwardChannelRequestTimeoutMs",2e4,n),this.qa=n&&n.xmlHttpFactory||void 0,this.Ba=n&&n.Yb||!1,this.K=void 0,this.H=n&&n.supportsCrossDomainXhr||!1,this.J="",this.i=new UA(n&&n.concurrentRequestLimit),this.Ca=new l,this.ja=n&&n.fastHandshake||!1,this.Ra=n&&n.Wb||!1,n&&n.Aa&&this.h.Aa(),n&&n.forceLongPolling&&(this.X=!1),this.$=!this.ja&&this.X&&n&&n.detectBufferingProxy||!1,this.ka=void 0,this.O=0,this.L=!1,this.B=null,this.Wa=!n||!1!==n.Xb}function Tp(n){if(JM(n),3==n.G){var e=n.V++,t=pa(n.F);On(t,"SID",n.J),On(t,"RID",e),On(t,"TYPE","terminate"),zE(n,t),(e=new mh(n,n.h,e,void 0)).K=2,e.v=Ep(pa(t)),t=!1,vt.navigator&&vt.navigator.sendBeacon&&(t=vt.navigator.sendBeacon(e.v.toString(),"")),!t&&vt.Image&&((new Image).src=e.v,t=!0),t||(e.g=aN(e.l,null),e.g.ea(e.v)),e.F=Date.now(),f_(e)}sN(n)}function Eh(n){n.g&&(qA(n),n.g.cancel(),n.g=null)}function JM(n){Eh(n),n.u&&(vt.clearTimeout(n.u),n.u=null),ZC(n),n.i.cancel(),n.m&&("number"==typeof n.m&&vt.clearTimeout(n.m),n.m=null)}function $A(n,e){n.l.push(new class{constructor(n,e){this.h=n,this.g=e}}(n.Za++,e)),3==n.G&&KC(n)}function KC(n){HA(n.i)||n.m||(n.m=!0,PE(n.Ha,n),n.C=0)}function XM(n,e){var t;t=e?e.m:n.V++;const r=pa(n.F);On(r,"SID",n.J),On(r,"RID",t),On(r,"AID",n.U),zE(n,r),n.o&&n.s&&bp(r,n.o,n.s),t=new mh(n,n.h,t,n.C+1),null===n.o&&(t.H=n.s),e&&(n.l=e.D.concat(n.l)),e=eN(n,t,1e3),t.setTimeout(Math.round(.5*n.ra)+Math.round(.5*n.ra*Math.random())),zC(n.i,t),HE(t,r,e)}function zE(n,e){n.j&&g_({},function(t,r){On(e,r,t)})}function eN(n,e,t){t=Math.min(n.l.length,t);var r=n.j?Pr(n.j.Oa,n.j,n):null;e:{var o=n.l;let u=-1;for(;;){const c=["count="+t];-1==u?0<t?(u=o[0].h,c.push("ofs="+u)):u=0:c.push("ofs="+u);let g=!0;for(let E=0;E<t;E++){let I=o[E].h;const S=o[E].g;if(I-=u,0>I)u=Math.max(0,o[E].h-100),g=!1;else try{d(S,c,"req"+I+"_")}catch(M){r&&r(S)}}if(g){r=c.join("&");break e}}}return n=n.l.splice(0,t),e.D=n,r}function tN(n){n.g||n.u||(n.Y=1,PE(n.Ga,n),n.A=0)}function WA(n){return!(n.g||n.u||3<=n.A||(n.Y++,n.u=mp(Pr(n.Ga,n),iN(n,n.A)),n.A++,0))}function qA(n){null!=n.B&&(vt.clearTimeout(n.B),n.B=null)}function nN(n){n.g=new mh(n,n.h,"rpc",n.Y),null===n.o&&(n.g.H=n.s),n.g.O=0;var e=pa(n.oa);On(e,"RID","rpc"),On(e,"SID",n.J),On(e,"CI",n.N?"0":"1"),On(e,"AID",n.U),zE(n,e),On(e,"TYPE","xmlhttp"),n.o&&n.s&&bp(e,n.o,n.s),n.K&&n.g.setTimeout(n.K);var t=n.g;n=n.la,t.K=1,t.v=Ep(pa(e)),t.s=null,t.U=!0,d_(t,n)}function ZC(n){null!=n.v&&(vt.clearTimeout(n.v),n.v=null)}function rN(n,e){var t=null;if(n.g==e){ZC(n),qA(n),n.g=null;var r=2}else{if(!qC(n.i,e))return;t=e.D,i(n.i,e),r=1}if(n.I=e.N,0!=n.G)if(e.i)if(1==r){t=e.s?e.s.length:0,e=Date.now()-e.F;var o=n.C;Qr(r=o_(),new LC(r,t,e,o)),KC(n)}else tN(n);else if(3==(o=e.o)||0==o&&0<n.I||!(1==r&&function mO(n,e){return!(GA(n.i)>=n.i.j-(n.m?1:0)||(n.m?(n.l=e.D.concat(n.l),0):1==n.G||2==n.G||n.C>=(n.Xa?0:n.Ya)||(n.m=mp(Pr(n.Ha,n,e),iN(n,n.C)),n.C++,0)))}(n,e)||2==r&&WA(n)))switch(t&&0<t.length&&(e=n.i,e.i=e.i.concat(t)),o){case 1:Ap(n,5);break;case 4:Ap(n,10);break;case 3:Ap(n,6);break;default:Ap(n,2)}}function iN(n,e){let t=n.Pa+Math.floor(Math.random()*n.$a);return n.j||(t*=2),t*e}function Ap(n,e){if(n.h.info("Error code "+e),2==e){var t=null;n.j&&(t=null);var r=Pr(n.jb,n);t||(t=new cl("//www.google.com/images/cleardot.gif"),vt.location&&"http"==vt.location.protocol||m_(t,"https"),Ep(t)),function p(n,e){const t=new i_;if(vt.Image){const r=new Image;r.onload=$m(y,t,r,"TestLoadImage: loaded",!0,e),r.onerror=$m(y,t,r,"TestLoadImage: error",!1,e),r.onabort=$m(y,t,r,"TestLoadImage: abort",!1,e),r.ontimeout=$m(y,t,r,"TestLoadImage: timeout",!1,e),vt.setTimeout(function(){r.ontimeout&&r.ontimeout()},1e4),r.src=n}else e(!1)}(t.toString(),r)}else li(2);n.G=0,n.j&&n.j.va(e),sN(n),JM(n)}function sN(n){n.G=0,n.I=-1,n.j&&((0!=s(n.i).length||0!=n.l.length)&&(n.i.i.length=0,CE(n.l),n.l.length=0),n.j.ua())}function oN(n,e,t){let r=function y_(n){return n instanceof cl?pa(n):new cl(n,void 0)}(t);if(""!=r.i)e&&__(r,e+"."+r.i),yp(r,r.m);else{const o=vt.location;r=function RA(n,e,t,r){var o=new cl(null,void 0);return n&&m_(o,n),e&&__(o,e),t&&yp(o,t),r&&(o.l=r),o}(o.protocol,e?e+"."+o.hostname:o.hostname,+o.port,t)}return n.aa&&Km(n.aa,function(o,u){On(r,u,o)}),t=n.sa,(e=n.D)&&t&&On(r,e,t),On(r,"VER",n.ma),zE(n,r),r}function aN(n,e,t){if(e&&!n.H)throw Error("Can't create secondary domain capable XhrIo object.");return(e=new se(t&&n.Ba&&!n.qa?new w({ib:!0}):n.qa)).L=n.H,e}function uN(){}function YC(){if(ch&&!(10<=Number(dh)))throw Error("Environmental error: no available transport.")}function Mo(n,e){kr.call(this),this.g=new w_(e),this.l=n,this.h=e&&e.messageUrlParams||null,n=e&&e.messageHeaders||null,e&&e.clientProtocolHeaderRequired&&(n?n["X-Client-Protocol"]="webchannel":n={"X-Client-Protocol":"webchannel"}),this.g.s=n,n=e&&e.initMessageHeaders||null,e&&e.messageContentType&&(n?n["X-WebChannel-Content-Type"]=e.messageContentType:n={"X-WebChannel-Content-Type":e.messageContentType}),e&&e.ya&&(n?n["X-WebChannel-Client-Profile"]=e.ya:n={"X-WebChannel-Client-Profile":e.ya}),this.g.P=n,(n=e&&e.httpHeadersOverwriteParam)&&!dp(n)&&(this.g.o=n),this.A=e&&e.supportsCrossDomainXhr||!1,this.v=e&&e.sendRawJson||!1,(e=e&&e.httpSessionIdParam)&&!dp(e)&&(this.g.D=e,null!==(n=this.h)&&e in n&&e in(n=this.h)&&delete n[e]),this.j=new I_(this)}function lN(n){UE.call(this);var e=n.__sm__;if(e){e:{for(const t in e){n=t;break e}n=void 0}(this.i=n)&&(n=this.i,e=null!==e&&n in e?e[n]:void 0),this.data=e}else this.data=n}function cN(){gh.call(this),this.status=1}function I_(n){this.g=n}(Ze=se.prototype).ea=function(n,e,t,r){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.H+"; newUri="+n);e=e?e.toUpperCase():"GET",this.H=n,this.j="",this.m=0,this.D=!1,this.h=!0,this.g=this.u?this.u.g():jE.g(),this.C=function xA(n){return n.h||(n.h=n.i())}(this.u?this.u:jE),this.g.onreadystatechange=Pr(this.Fa,this);try{this.F=!0,this.g.open(e,String(n),!0),this.F=!1}catch(u){return void Rt(this,u)}n=t||"";const o=new vh(this.headers);r&&g_(r,function(u,c){o.set(c,u)}),r=function qM(n){e:{var e=ft;const t=n.length,r="string"==typeof n?n.split(""):n;for(let o=0;o<t;o++)if(o in r&&e.call(void 0,r[o],o,n)){e=o;break e}e=-1}return 0>e?null:"string"==typeof n?n.charAt(e):n[e]}(o.T()),t=vt.FormData&&n instanceof vt.FormData,!(0<=Wm(Qe,e))||r||t||o.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8"),o.forEach(function(u,c){this.g.setRequestHeader(c,u)},this),this.J&&(this.g.responseType=this.J),"withCredentials"in this.g&&this.g.withCredentials!==this.L&&(this.g.withCredentials=this.L);try{v_(this),0<this.B&&((this.K=function Ie(n){return ch&&function Qm(){return function yC(n){var e=KM;return Object.prototype.hasOwnProperty.call(e,9)?e[9]:e[9]=n(9)}(function(){let n=0;const e=DE(String(AE)).split("."),t=DE("9").split("."),r=Math.max(e.length,t.length);for(let c=0;0==n&&c<r;c++){var o=e[c]||"",u=t[c]||"";do{if(o=/(\d*)(\D*)(.*)/.exec(o)||["","","",""],u=/(\d*)(\D*)(.*)/.exec(u)||["","","",""],0==o[0].length&&0==u[0].length)break;n=zm(0==o[1].length?0:parseInt(o[1],10),0==u[1].length?0:parseInt(u[1],10))||zm(0==o[2].length,0==u[2].length)||zm(o[2],u[2]),o=o[3],u=u[3]}while(0==n)}return 0<=n})}()&&"number"==typeof n.timeout&&void 0!==n.ontimeout}(this.g))?(this.g.timeout=this.B,this.g.ontimeout=Pr(this.pa,this)):this.A=kE(this.pa,this.B,this)),this.v=!0,this.g.send(n),this.v=!1}catch(u){Rt(this,u)}},Ze.pa=function(){void 0!==EE&&this.g&&(this.j="Timed out after "+this.B+"ms, aborting",this.m=8,Qr(this,"timeout"),this.abort(8))},Ze.abort=function(n){this.g&&this.h&&(this.h=!1,this.l=!0,this.g.abort(),this.l=!1,this.m=n||7,Qr(this,"complete"),Qr(this,"abort"),ga(this))},Ze.M=function(){this.g&&(this.h&&(this.h=!1,this.l=!0,this.g.abort(),this.l=!1),ga(this,!0)),se.Z.M.call(this)},Ze.Fa=function(){this.s||(this.F||this.v||this.l?ns(this):this.cb())},Ze.cb=function(){ns(this)},Ze.ba=function(){try{return 2<xo(this)?this.g.status:-1}catch(n){return-1}},Ze.ga=function(){try{return this.g?this.g.responseText:""}catch(n){return""}},Ze.Qa=function(n){if(this.g){var e=this.g.responseText;return n&&0==e.indexOf(n)&&(e=e.substring(n.length)),Z(e)}},Ze.Da=function(){return this.m},Ze.La=function(){return"string"==typeof this.j?this.j:String(this.j)},(Ze=w_.prototype).ma=8,Ze.G=1,Ze.hb=function(n){try{this.h.info("Origin Trials invoked: "+n)}catch(e){}},Ze.Ha=function(n){if(this.m)if(this.m=null,1==this.G){if(!n){this.V=Math.floor(1e5*Math.random()),n=this.V++;const o=new mh(this,this.h,n,void 0);let u=this.s;if(this.P&&(u?(u=_C(u),TE(u,this.P)):u=this.P),null===this.o&&(o.H=u),this.ja)e:{for(var e=0,t=0;t<this.l.length;t++){var r=this.l[t];if(void 0===(r="__data__"in r.g&&"string"==typeof(r=r.g.__data__)?r.length:void 0))break;if(4096<(e+=r)){e=t;break e}if(4096===e||t===this.l.length-1){e=t+1;break e}}e=1e3}else e=1e3;e=eN(this,o,e),On(t=pa(this.F),"RID",n),On(t,"CVER",22),this.D&&On(t,"X-HTTP-Session-Id",this.D),zE(this,t),this.o&&u&&bp(t,this.o,u),zC(this.i,o),this.Ra&&On(t,"TYPE","init"),this.ja?(On(t,"$req",e),On(t,"SID","null"),o.$=!0,HE(o,t,null)):HE(o,t,e),this.G=2}}else 3==this.G&&(n?XM(this,n):0==this.l.length||HA(this.i)||XM(this))},Ze.Ga=function(){if(this.u=null,nN(this),this.$&&!(this.L||null==this.g||0>=this.O)){var n=2*this.O;this.h.info("BP detection timer enabled: "+n),this.B=mp(Pr(this.bb,this),n)}},Ze.bb=function(){this.B&&(this.B=null,this.h.info("BP detection timeout reached."),this.h.info("Buffering proxy detected and switch to long-polling!"),this.N=!1,this.L=!0,li(10),Eh(this),nN(this))},Ze.ab=function(){null!=this.v&&(this.v=null,Eh(this),WA(this),li(19))},Ze.jb=function(n){n?(this.h.info("Successfully pinged google.com"),li(2)):(this.h.info("Failed to ping google.com"),li(1))},(Ze=uN.prototype).xa=function(){},Ze.wa=function(){},Ze.va=function(){},Ze.ua=function(){},Ze.Oa=function(){},YC.prototype.g=function(n,e){return new Mo(n,e)},Or(Mo,kr),Mo.prototype.m=function(){this.g.j=this.j,this.A&&(this.g.H=!0);var n=this.g,e=this.l,t=this.h||void 0;n.Wa&&(n.h.info("Origin Trials enabled."),PE(Pr(n.hb,n,e))),li(0),n.W=e,n.aa=t||{},n.N=n.X,n.F=oN(n,null,n.W),KC(n)},Mo.prototype.close=function(){Tp(this.g)},Mo.prototype.u=function(n){if("string"==typeof n){var e={};e.__data__=n,$A(this.g,e)}else this.v?((e={}).__data__=n_(n),$A(this.g,e)):$A(this.g,n)},Mo.prototype.M=function(){this.g.j=null,delete this.j,Tp(this.g),delete this.g,Mo.Z.M.call(this)},Or(lN,UE),Or(cN,gh),Or(I_,uN),I_.prototype.xa=function(){Qr(this.g,"a")},I_.prototype.wa=function(n){Qr(this.g,new lN(n))},I_.prototype.va=function(n){Qr(this.g,new cN(n))},I_.prototype.ua=function(){Qr(this.g,"b")},YC.prototype.createWebChannel=YC.prototype.g,Mo.prototype.send=Mo.prototype.u,Mo.prototype.open=Mo.prototype.m,Mo.prototype.close=Mo.prototype.close,u_.NO_ERROR=0,u_.TIMEOUT=8,u_.HTTP_ERROR=6,SA.COMPLETE="complete",MA.EventType=l_,l_.OPEN="a",l_.CLOSE="b",l_.ERROR="c",l_.MESSAGE="d",kr.prototype.listen=kr.prototype.N,se.prototype.listenOnce=se.prototype.O,se.prototype.getLastError=se.prototype.La,se.prototype.getLastErrorCode=se.prototype.Da,se.prototype.getStatus=se.prototype.ba,se.prototype.getResponseJson=se.prototype.Qa,se.prototype.getResponseText=se.prototype.ga,se.prototype.send=se.prototype.ea;var _O=hu.createWebChannelTransport=function(){return new YC},yO=hu.getStatEventTarget=function(){return o_()},zA=hu.ErrorCode=u_,vO=hu.EventType=SA,EO=hu.Event=ul,dN=hu.Stat={rb:0,ub:1,vb:2,Ob:3,Tb:4,Qb:5,Rb:6,Pb:7,Nb:8,Sb:9,PROXY:10,NOPROXY:11,Lb:12,Hb:13,Ib:14,Gb:15,Jb:16,Kb:17,nb:18,mb:19,ob:20},wO=hu.FetchXmlHttpFactory=w,QC=hu.WebChannel=MA,IO=hu.XhrIo=se;const hN="@firebase/firestore";class ki{constructor(e){this.uid=e}isAuthenticated(){return null!=this.uid}toKey(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}isEqual(e){return e.uid===this.uid}}ki.UNAUTHENTICATED=new ki(null),ki.GOOGLE_CREDENTIALS=new ki("google-credentials-uid"),ki.FIRST_PARTY=new ki("first-party-uid"),ki.MOCK_USER=new ki("mock-user");let C_="9.6.7";const wh=new vs.Yd("@firebase/firestore");function KA(){return wh.logLevel}function Le(n,...e){if(wh.logLevel<=vs.in.DEBUG){const t=e.map(ZA);wh.debug(`Firestore (${C_}): ${n}`,...t)}}function Fr(n,...e){if(wh.logLevel<=vs.in.ERROR){const t=e.map(ZA);wh.error(`Firestore (${C_}): ${n}`,...t)}}function KE(n,...e){if(wh.logLevel<=vs.in.WARN){const t=e.map(ZA);wh.warn(`Firestore (${C_}): ${n}`,...t)}}function ZA(n){if("string"==typeof n)return n;try{return JSON.stringify(n)}catch(t){return n}}function ut(n="Unexpected state"){const e=`FIRESTORE (${C_}) INTERNAL ASSERTION FAILED: `+n;throw Fr(e),new Error(e)}function It(n,e){n||ut()}function We(n,e){return n}const ue={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"};class Me extends P.ZR{constructor(e,t){super(e,t),this.code=e,this.message=t,this.toString=()=>`${this.name}: [code=${this.code}]: ${this.message}`}}class ci{constructor(){this.promise=new Promise((e,t)=>{this.resolve=e,this.reject=t})}}class fN{constructor(e,t){this.user=t,this.type="OAuth",this.headers=new Map,this.headers.set("Authorization",`Bearer ${e}`)}}class bO{getToken(){return Promise.resolve(null)}invalidateToken(){}start(e,t){e.enqueueRetryable(()=>t(ki.UNAUTHENTICATED))}shutdown(){}}class TO{constructor(e){this.token=e,this.changeListener=null}getToken(){return Promise.resolve(this.token)}invalidateToken(){}start(e,t){this.changeListener=t,e.enqueueRetryable(()=>t(this.token.user))}shutdown(){this.changeListener=null}}class AO{constructor(e){this.t=e,this.currentUser=ki.UNAUTHENTICATED,this.i=0,this.forceRefresh=!1,this.auth=null}start(e,t){var r=this;let o=this.i;const u=I=>this.i!==o?(o=this.i,t(I)):Promise.resolve();let c=new ci;this.o=()=>{this.i++,this.currentUser=this.u(),c.resolve(),c=new ci,e.enqueueRetryable(()=>u(this.currentUser))};const g=()=>{const I=c;e.enqueueRetryable((0,pe.Z)(function*(){yield I.promise,yield u(r.currentUser)}))},E=I=>{Le("FirebaseAuthCredentialsProvider","Auth detected"),this.auth=I,this.auth.addAuthTokenListener(this.o),g()};this.t.onInit(I=>E(I)),setTimeout(()=>{if(!this.auth){const I=this.t.getImmediate({optional:!0});I?E(I):(Le("FirebaseAuthCredentialsProvider","Auth not yet detected"),c.resolve(),c=new ci)}},0),g()}getToken(){const e=this.i,t=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(t).then(r=>this.i!==e?(Le("FirebaseAuthCredentialsProvider","getToken aborted due to token change."),this.getToken()):r?(It("string"==typeof r.accessToken),new fN(r.accessToken,this.currentUser)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.auth&&this.auth.removeAuthTokenListener(this.o)}u(){const e=this.auth&&this.auth.getUid();return It(null===e||"string"==typeof e),new ki(e)}}class SO{constructor(e,t,r){this.type="FirstParty",this.user=ki.FIRST_PARTY,this.headers=new Map,this.headers.set("X-Goog-AuthUser",t);const o=e.auth.getAuthHeaderValueForFirstParty([]);o&&this.headers.set("Authorization",o),r&&this.headers.set("X-Goog-Iam-Authorization-Token",r)}}class xO{constructor(e,t,r){this.h=e,this.l=t,this.m=r}getToken(){return Promise.resolve(new SO(this.h,this.l,this.m))}start(e,t){e.enqueueRetryable(()=>t(ki.FIRST_PARTY))}shutdown(){}invalidateToken(){}}class pN{constructor(e){this.value=e,this.type="AppCheck",this.headers=new Map,e&&e.length>0&&this.headers.set("x-firebase-appcheck",this.value)}}class MO{constructor(e){this.g=e,this.forceRefresh=!1,this.appCheck=null,this.p=null}start(e,t){const r=u=>{null!=u.error&&Le("FirebaseAppCheckTokenProvider",`Error getting App Check token; using placeholder token instead. Error: ${u.error.message}`);const c=u.token!==this.p;return this.p=u.token,Le("FirebaseAppCheckTokenProvider",`Received ${c?"new":"existing"} token.`),c?t(u.token):Promise.resolve()};this.o=u=>{e.enqueueRetryable(()=>r(u))};const o=u=>{Le("FirebaseAppCheckTokenProvider","AppCheck detected"),this.appCheck=u,this.appCheck.addTokenListener(this.o)};this.g.onInit(u=>o(u)),setTimeout(()=>{if(!this.appCheck){const u=this.g.getImmediate({optional:!0});u?o(u):Le("FirebaseAppCheckTokenProvider","AppCheck not yet detected")}},0)}getToken(){const e=this.forceRefresh;return this.forceRefresh=!1,this.appCheck?this.appCheck.getToken(e).then(t=>t?(It("string"==typeof t.token),this.p=t.token,new pN(t.token)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.appCheck&&this.appCheck.removeTokenListener(this.o)}}class No{constructor(e,t){this.previousValue=e,t&&(t.sequenceNumberHandler=r=>this.I(r),this.T=r=>t.writeSequenceNumber(r))}I(e){return this.previousValue=Math.max(e,this.previousValue),this.previousValue}next(){const e=++this.previousValue;return this.T&&this.T(e),e}}function NO(n){const e="undefined"!=typeof self&&(self.crypto||self.msCrypto),t=new Uint8Array(n);if(e&&"function"==typeof e.getRandomValues)e.getRandomValues(t);else for(let r=0;r<n;r++)t[r]=Math.floor(256*Math.random());return t}No.A=-1;class gN{static R(){const e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",t=Math.floor(256/e.length)*e.length;let r="";for(;r.length<20;){const o=NO(40);for(let u=0;u<o.length;++u)r.length<20&&o[u]<t&&(r+=e.charAt(o[u]%e.length))}return r}}function Gt(n,e){return n<e?-1:n>e?1:0}function D_(n,e,t){return n.length===e.length&&n.every((r,o)=>t(r,e[o]))}function mN(n){return n+"\0"}class di{constructor(e,t){if(this.seconds=e,this.nanoseconds=t,t<0)throw new Me(ue.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(t>=1e9)throw new Me(ue.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(e<-62135596800)throw new Me(ue.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e);if(e>=253402300800)throw new Me(ue.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e)}static now(){return di.fromMillis(Date.now())}static fromDate(e){return di.fromMillis(e.getTime())}static fromMillis(e){const t=Math.floor(e/1e3),r=Math.floor(1e6*(e-1e3*t));return new di(t,r)}toDate(){return new Date(this.toMillis())}toMillis(){return 1e3*this.seconds+this.nanoseconds/1e6}_compareTo(e){return this.seconds===e.seconds?Gt(this.nanoseconds,e.nanoseconds):Gt(this.seconds,e.seconds)}isEqual(e){return e.seconds===this.seconds&&e.nanoseconds===this.nanoseconds}toString(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}toJSON(){return{seconds:this.seconds,nanoseconds:this.nanoseconds}}valueOf(){return String(this.seconds- -62135596800).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")}}class yt{constructor(e){this.timestamp=e}static fromTimestamp(e){return new yt(e)}static min(){return new yt(new di(0,0))}compareTo(e){return this.timestamp._compareTo(e.timestamp)}isEqual(e){return this.timestamp.isEqual(e.timestamp)}toMicroseconds(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3}toString(){return"SnapshotVersion("+this.timestamp.toString()+")"}toTimestamp(){return this.timestamp}}function _N(n){let e=0;for(const t in n)Object.prototype.hasOwnProperty.call(n,t)&&e++;return e}function Sp(n,e){for(const t in n)Object.prototype.hasOwnProperty.call(n,t)&&e(t,n[t])}function yN(n){for(const e in n)if(Object.prototype.hasOwnProperty.call(n,e))return!1;return!0}class ZE{constructor(e,t,r){void 0===t?t=0:t>e.length&&ut(),void 0===r?r=e.length-t:r>e.length-t&&ut(),this.segments=e,this.offset=t,this.len=r}get length(){return this.len}isEqual(e){return 0===ZE.comparator(this,e)}child(e){const t=this.segments.slice(this.offset,this.limit());return e instanceof ZE?e.forEach(r=>{t.push(r)}):t.push(e),this.construct(t)}limit(){return this.offset+this.length}popFirst(e){return this.construct(this.segments,this.offset+(e=void 0===e?1:e),this.length-e)}popLast(){return this.construct(this.segments,this.offset,this.length-1)}firstSegment(){return this.segments[this.offset]}lastSegment(){return this.get(this.length-1)}get(e){return this.segments[this.offset+e]}isEmpty(){return 0===this.length}isPrefixOf(e){if(e.length<this.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}isImmediateParentOf(e){if(this.length+1!==e.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}forEach(e){for(let t=this.offset,r=this.limit();t<r;t++)e(this.segments[t])}toArray(){return this.segments.slice(this.offset,this.limit())}static comparator(e,t){const r=Math.min(e.length,t.length);for(let o=0;o<r;o++){const u=e.get(o),c=t.get(o);if(u<c)return-1;if(u>c)return 1}return e.length<t.length?-1:e.length>t.length?1:0}}class rn extends ZE{construct(e,t,r){return new rn(e,t,r)}canonicalString(){return this.toArray().join("/")}toString(){return this.canonicalString()}static fromString(...e){const t=[];for(const r of e){if(r.indexOf("//")>=0)throw new Me(ue.INVALID_ARGUMENT,`Invalid segment (${r}). Paths must not contain // in them.`);t.push(...r.split("/").filter(o=>o.length>0))}return new rn(t)}static emptyPath(){return new rn([])}}const RO=/^[_a-zA-Z][_a-zA-Z0-9]*$/;class hi extends ZE{construct(e,t,r){return new hi(e,t,r)}static isValidIdentifier(e){return RO.test(e)}canonicalString(){return this.toArray().map(e=>(e=e.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),hi.isValidIdentifier(e)||(e="`"+e+"`"),e)).join(".")}toString(){return this.canonicalString()}isKeyField(){return 1===this.length&&"__name__"===this.get(0)}static keyField(){return new hi(["__name__"])}static fromServerFormat(e){const t=[];let r="",o=0;const u=()=>{if(0===r.length)throw new Me(ue.INVALID_ARGUMENT,`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`);t.push(r),r=""};let c=!1;for(;o<e.length;){const g=e[o];if("\\"===g){if(o+1===e.length)throw new Me(ue.INVALID_ARGUMENT,"Path has trailing escape character: "+e);const E=e[o+1];if("\\"!==E&&"."!==E&&"`"!==E)throw new Me(ue.INVALID_ARGUMENT,"Path has invalid escape sequence: "+e);r+=E,o+=2}else"`"===g?(c=!c,o++):"."!==g||c?(r+=g,o++):(u(),o++)}if(u(),c)throw new Me(ue.INVALID_ARGUMENT,"Unterminated ` in path: "+e);return new hi(t)}static emptyPath(){return new hi([])}}class b_{constructor(e){this.fields=e,e.sort(hi.comparator)}covers(e){for(const t of this.fields)if(t.isPrefixOf(e))return!0;return!1}isEqual(e){return D_(this.fields,e.fields,(t,r)=>t.isEqual(r))}}class Jr{constructor(e){this.binaryString=e}static fromBase64String(e){const t=atob(e);return new Jr(t)}static fromUint8Array(e){const t=function(r){let o="";for(let u=0;u<r.length;++u)o+=String.fromCharCode(r[u]);return o}(e);return new Jr(t)}[Symbol.iterator](){let e=0;return{next:()=>e<this.binaryString.length?{value:this.binaryString.charCodeAt(e++),done:!1}:{value:void 0,done:!0}}}toBase64(){return btoa(this.binaryString)}toUint8Array(){return function(e){const t=new Uint8Array(e.length);for(let r=0;r<e.length;r++)t[r]=e.charCodeAt(r);return t}(this.binaryString)}approximateByteSize(){return 2*this.binaryString.length}compareTo(e){return Gt(this.binaryString,e.binaryString)}isEqual(e){return this.binaryString===e.binaryString}}Jr.EMPTY_BYTE_STRING=new Jr("");const OO=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function Ih(n){if(It(!!n),"string"==typeof n){let e=0;const t=OO.exec(n);if(It(!!t),t[1]){let o=t[1];o=(o+"000000000").substr(0,9),e=Number(o)}const r=new Date(n);return{seconds:Math.floor(r.getTime()/1e3),nanos:e}}return{seconds:pr(n.seconds),nanos:pr(n.nanos)}}function pr(n){return"number"==typeof n?n:"string"==typeof n?Number(n):0}function xp(n){return"string"==typeof n?Jr.fromBase64String(n):Jr.fromUint8Array(n)}function YA(n){var e,t;return"server_timestamp"===(null===(t=((null===(e=null==n?void 0:n.mapValue)||void 0===e?void 0:e.fields)||{}).__type__)||void 0===t?void 0:t.stringValue)}function vN(n){const e=n.mapValue.fields.__previous_value__;return YA(e)?vN(e):e}function YE(n){const e=Ih(n.mapValue.fields.__local_write_time__.timestampValue);return new di(e.seconds,e.nanos)}class kO{constructor(e,t,r,o,u,c,g,E){this.databaseId=e,this.appId=t,this.persistenceKey=r,this.host=o,this.ssl=u,this.forceLongPolling=c,this.autoDetectLongPolling=g,this.useFetchStreams=E}}class Mp{constructor(e,t){this.projectId=e,this.database=t||"(default)"}static empty(){return new Mp("","")}get isDefaultDatabase(){return"(default)"===this.database}isEqual(e){return e instanceof Mp&&e.projectId===this.projectId&&e.database===this.database}}function Np(n){return null==n}function QE(n){return 0===n&&1/n==-1/0}function EN(n){return"number"==typeof n&&Number.isInteger(n)&&!QE(n)&&n<=Number.MAX_SAFE_INTEGER&&n>=Number.MIN_SAFE_INTEGER}class Je{constructor(e){this.path=e}static fromPath(e){return new Je(rn.fromString(e))}static fromName(e){return new Je(rn.fromString(e).popFirst(5))}static empty(){return new Je(rn.emptyPath())}get collectionGroup(){return this.path.popLast().lastSegment()}hasCollectionId(e){return this.path.length>=2&&this.path.get(this.path.length-2)===e}getCollectionGroup(){return this.path.get(this.path.length-2)}getCollectionPath(){return this.path.popLast()}isEqual(e){return null!==e&&0===rn.comparator(this.path,e.path)}toString(){return this.path.toString()}static comparator(e,t){return rn.comparator(e.path,t.path)}static isDocumentKey(e){return e.length%2==0}static fromSegments(e){return new Je(new rn(e.slice()))}}const FO={mapValue:{fields:{__type__:{stringValue:"__max___"}}}};function Rp(n){return"nullValue"in n?0:"booleanValue"in n?1:"integerValue"in n||"doubleValue"in n?2:"timestampValue"in n?3:"stringValue"in n?5:"bytesValue"in n?6:"referenceValue"in n?7:"geoPointValue"in n?8:"arrayValue"in n?9:"mapValue"in n?YA(n)?4:10:ut()}function fu(n,e){if(n===e)return!0;const t=Rp(n);if(t!==Rp(e))return!1;switch(t){case 0:return!0;case 1:return n.booleanValue===e.booleanValue;case 4:return YE(n).isEqual(YE(e));case 3:return function(r,o){if("string"==typeof r.timestampValue&&"string"==typeof o.timestampValue&&r.timestampValue.length===o.timestampValue.length)return r.timestampValue===o.timestampValue;const u=Ih(r.timestampValue),c=Ih(o.timestampValue);return u.seconds===c.seconds&&u.nanos===c.nanos}(n,e);case 5:return n.stringValue===e.stringValue;case 6:return o=e,xp(n.bytesValue).isEqual(xp(o.bytesValue));case 7:return n.referenceValue===e.referenceValue;case 8:return function(r,o){return pr(r.geoPointValue.latitude)===pr(o.geoPointValue.latitude)&&pr(r.geoPointValue.longitude)===pr(o.geoPointValue.longitude)}(n,e);case 2:return function(r,o){if("integerValue"in r&&"integerValue"in o)return pr(r.integerValue)===pr(o.integerValue);if("doubleValue"in r&&"doubleValue"in o){const u=pr(r.doubleValue),c=pr(o.doubleValue);return u===c?QE(u)===QE(c):isNaN(u)&&isNaN(c)}return!1}(n,e);case 9:return D_(n.arrayValue.values||[],e.arrayValue.values||[],fu);case 10:return function(r,o){const u=r.mapValue.fields||{},c=o.mapValue.fields||{};if(_N(u)!==_N(c))return!1;for(const g in u)if(u.hasOwnProperty(g)&&(void 0===c[g]||!fu(u[g],c[g])))return!1;return!0}(n,e);default:return ut()}var o}function JE(n,e){return void 0!==(n.values||[]).find(t=>fu(t,e))}function T_(n,e){if(n===e)return 0;const t=Rp(n),r=Rp(e);if(t!==r)return Gt(t,r);switch(t){case 0:return 0;case 1:return Gt(n.booleanValue,e.booleanValue);case 2:return function(o,u){const c=pr(o.integerValue||o.doubleValue),g=pr(u.integerValue||u.doubleValue);return c<g?-1:c>g?1:c===g?0:isNaN(c)?isNaN(g)?0:-1:1}(n,e);case 3:return wN(n.timestampValue,e.timestampValue);case 4:return wN(YE(n),YE(e));case 5:return Gt(n.stringValue,e.stringValue);case 6:return function(o,u){const c=xp(o),g=xp(u);return c.compareTo(g)}(n.bytesValue,e.bytesValue);case 7:return function(o,u){const c=o.split("/"),g=u.split("/");for(let E=0;E<c.length&&E<g.length;E++){const I=Gt(c[E],g[E]);if(0!==I)return I}return Gt(c.length,g.length)}(n.referenceValue,e.referenceValue);case 8:return function(o,u){const c=Gt(pr(o.latitude),pr(u.latitude));return 0!==c?c:Gt(pr(o.longitude),pr(u.longitude))}(n.geoPointValue,e.geoPointValue);case 9:return function(o,u){const c=o.values||[],g=u.values||[];for(let E=0;E<c.length&&E<g.length;++E){const I=T_(c[E],g[E]);if(I)return I}return Gt(c.length,g.length)}(n.arrayValue,e.arrayValue);case 10:return function(o,u){const c=o.fields||{},g=Object.keys(c),E=u.fields||{},I=Object.keys(E);g.sort(),I.sort();for(let S=0;S<g.length&&S<I.length;++S){const M=Gt(g[S],I[S]);if(0!==M)return M;const F=T_(c[g[S]],E[I[S]]);if(0!==F)return F}return Gt(g.length,I.length)}(n.mapValue,e.mapValue);default:throw ut()}}function wN(n,e){if("string"==typeof n&&"string"==typeof e&&n.length===e.length)return Gt(n,e);const t=Ih(n),r=Ih(e),o=Gt(t.seconds,r.seconds);return 0!==o?o:Gt(t.nanos,r.nanos)}function A_(n){return QA(n)}function QA(n){return"nullValue"in n?"null":"booleanValue"in n?""+n.booleanValue:"integerValue"in n?""+n.integerValue:"doubleValue"in n?""+n.doubleValue:"timestampValue"in n?function(r){const o=Ih(r);return`time(${o.seconds},${o.nanos})`}(n.timestampValue):"stringValue"in n?n.stringValue:"bytesValue"in n?xp(n.bytesValue).toBase64():"referenceValue"in n?Je.fromName(n.referenceValue).toString():"geoPointValue"in n?`geo(${(e=n.geoPointValue).latitude},${e.longitude})`:"arrayValue"in n?function(r){let o="[",u=!0;for(const c of r.values||[])u?u=!1:o+=",",o+=QA(c);return o+"]"}(n.arrayValue):"mapValue"in n?function(r){const o=Object.keys(r.fields||{}).sort();let u="{",c=!0;for(const g of o)c?c=!1:u+=",",u+=`${g}:${QA(r.fields[g])}`;return u+"}"}(n.mapValue):ut();var e}function JC(n,e){return{referenceValue:`projects/${n.projectId}/databases/${n.database}/documents/${e.path.canonicalString()}`}}function JA(n){return!!n&&"integerValue"in n}function XC(n){return!!n&&"arrayValue"in n}function IN(n){return!!n&&"nullValue"in n}function CN(n){return!!n&&"doubleValue"in n&&isNaN(Number(n.doubleValue))}function eD(n){return!!n&&"mapValue"in n}function XE(n){if(n.geoPointValue)return{geoPointValue:Object.assign({},n.geoPointValue)};if(n.timestampValue&&"object"==typeof n.timestampValue)return{timestampValue:Object.assign({},n.timestampValue)};if(n.mapValue){const e={mapValue:{fields:{}}};return Sp(n.mapValue.fields,(t,r)=>e.mapValue.fields[t]=XE(r)),e}if(n.arrayValue){const e={arrayValue:{values:[]}};for(let t=0;t<(n.arrayValue.values||[]).length;++t)e.arrayValue.values[t]=XE(n.arrayValue.values[t]);return e}return Object.assign({},n)}class rs{constructor(e){this.value=e}static empty(){return new rs({mapValue:{}})}field(e){if(e.isEmpty())return this.value;{let t=this.value;for(let r=0;r<e.length-1;++r)if(t=(t.mapValue.fields||{})[e.get(r)],!eD(t))return null;return t=(t.mapValue.fields||{})[e.lastSegment()],t||null}}set(e,t){this.getFieldsMap(e.popLast())[e.lastSegment()]=XE(t)}setAll(e){let t=hi.emptyPath(),r={},o=[];e.forEach((c,g)=>{if(!t.isImmediateParentOf(g)){const E=this.getFieldsMap(t);this.applyChanges(E,r,o),r={},o=[],t=g.popLast()}c?r[g.lastSegment()]=XE(c):o.push(g.lastSegment())});const u=this.getFieldsMap(t);this.applyChanges(u,r,o)}delete(e){const t=this.field(e.popLast());eD(t)&&t.mapValue.fields&&delete t.mapValue.fields[e.lastSegment()]}isEqual(e){return fu(this.value,e.value)}getFieldsMap(e){let t=this.value;t.mapValue.fields||(t.mapValue={fields:{}});for(let r=0;r<e.length;++r){let o=t.mapValue.fields[e.get(r)];eD(o)&&o.mapValue.fields||(o={mapValue:{fields:{}}},t.mapValue.fields[e.get(r)]=o),t=o}return t.mapValue.fields}applyChanges(e,t,r){Sp(t,(o,u)=>e[o]=u);for(const o of r)delete e[o]}clone(){return new rs(XE(this.value))}}function DN(n){const e=[];return Sp(n.fields,(t,r)=>{const o=new hi([t]);if(eD(r)){const u=DN(r.mapValue).fields;if(0===u.length)e.push(o);else for(const c of u)e.push(o.child(c))}else e.push(o)}),new b_(e)}class sr{constructor(e,t,r,o,u,c){this.key=e,this.documentType=t,this.version=r,this.readTime=o,this.data=u,this.documentState=c}static newInvalidDocument(e){return new sr(e,0,yt.min(),yt.min(),rs.empty(),0)}static newFoundDocument(e,t,r){return new sr(e,1,t,yt.min(),r,0)}static newNoDocument(e,t){return new sr(e,2,t,yt.min(),rs.empty(),0)}static newUnknownDocument(e,t){return new sr(e,3,t,yt.min(),rs.empty(),2)}convertToFoundDocument(e,t){return this.version=e,this.documentType=1,this.data=t,this.documentState=0,this}convertToNoDocument(e){return this.version=e,this.documentType=2,this.data=rs.empty(),this.documentState=0,this}convertToUnknownDocument(e){return this.version=e,this.documentType=3,this.data=rs.empty(),this.documentState=2,this}setHasCommittedMutations(){return this.documentState=2,this}setHasLocalMutations(){return this.documentState=1,this}setReadTime(e){return this.readTime=e,this}get hasLocalMutations(){return 1===this.documentState}get hasCommittedMutations(){return 2===this.documentState}get hasPendingWrites(){return this.hasLocalMutations||this.hasCommittedMutations}isValidDocument(){return 0!==this.documentType}isFoundDocument(){return 1===this.documentType}isNoDocument(){return 2===this.documentType}isUnknownDocument(){return 3===this.documentType}isEqual(e){return e instanceof sr&&this.key.isEqual(e.key)&&this.version.isEqual(e.version)&&this.documentType===e.documentType&&this.documentState===e.documentState&&this.data.isEqual(e.data)}mutableCopy(){return new sr(this.key,this.documentType,this.version,this.readTime,this.data.clone(),this.documentState)}toString(){return`Document(${this.key}, ${this.version}, ${JSON.stringify(this.data.value)}, {documentType: ${this.documentType}}), {documentState: ${this.documentState}})`}}let XA=(()=>{class n{constructor(t,r,o,u){this.indexId=t,this.collectionGroup=r,this.fields=o,this.indexState=u}}return n.UNKNOWN_ID=-1,n})();class tD{constructor(e,t){this.fieldPath=e,this.kind=t}}class e0{constructor(e,t){this.sequenceNumber=e,this.offset=t}static empty(){return new e0(0,nD.min())}}class nD{constructor(e,t,r){this.readTime=e,this.documentKey=t,this.largestBatchId=r}static min(){return new nD(yt.min(),Je.empty(),-1)}}class LO{constructor(e,t=null,r=[],o=[],u=null,c=null,g=null){this.path=e,this.collectionGroup=t,this.orderBy=r,this.filters=o,this.limit=u,this.startAt=c,this.endAt=g,this.P=null}}function bN(n,e=null,t=[],r=[],o=null,u=null,c=null){return new LO(n,e,t,r,o,u,c)}function t0(n){const e=We(n);if(null===e.P){let t=e.path.canonicalString();null!==e.collectionGroup&&(t+="|cg:"+e.collectionGroup),t+="|f:",t+=e.filters.map(r=>{return(o=r).field.canonicalString()+o.op.toString()+A_(o.value);var o}).join(","),t+="|ob:",t+=e.orderBy.map(r=>{return(o=r).field.canonicalString()+o.dir;var o}).join(","),Np(e.limit)||(t+="|l:",t+=e.limit),e.startAt&&(t+="|lb:",t+=e.startAt.inclusive?"b:":"a:",t+=e.startAt.position.map(r=>A_(r)).join(",")),e.endAt&&(t+="|ub:",t+=e.endAt.inclusive?"a:":"b:",t+=e.endAt.position.map(r=>A_(r)).join(",")),e.P=t}return e.P}function rD(n,e){if(n.limit!==e.limit||n.orderBy.length!==e.orderBy.length)return!1;for(let o=0;o<n.orderBy.length;o++)if(!qO(n.orderBy[o],e.orderBy[o]))return!1;if(n.filters.length!==e.filters.length)return!1;for(let o=0;o<n.filters.length;o++)if((t=n.filters[o]).op!==(r=e.filters[o]).op||!t.field.isEqual(r.field)||!fu(t.value,r.value))return!1;var t,r;return n.collectionGroup===e.collectionGroup&&!!n.path.isEqual(e.path)&&!!SN(n.startAt,e.startAt)&&SN(n.endAt,e.endAt)}function iD(n){return Je.isDocumentKey(n.path)&&null===n.collectionGroup&&0===n.filters.length}class xs extends class{}{constructor(e,t,r){super(),this.field=e,this.op=t,this.value=r}static create(e,t,r){return e.isKeyField()?"in"===t||"not-in"===t?this.v(e,t,r):new BO(e,t,r):"array-contains"===t?new HO(e,r):"in"===t?new GO(e,r):"not-in"===t?new $O(e,r):"array-contains-any"===t?new WO(e,r):new xs(e,t,r)}static v(e,t,r){return"in"===t?new UO(e,r):new jO(e,r)}matches(e){const t=e.data.field(this.field);return"!="===this.op?null!==t&&this.V(T_(t,this.value)):null!==t&&Rp(this.value)===Rp(t)&&this.V(T_(t,this.value))}V(e){switch(this.op){case"<":return e<0;case"<=":return e<=0;case"==":return 0===e;case"!=":return 0!==e;case">":return e>0;case">=":return e>=0;default:return ut()}}S(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0}}class BO extends xs{constructor(e,t,r){super(e,t,r),this.key=Je.fromName(r.referenceValue)}matches(e){const t=Je.comparator(e.key,this.key);return this.V(t)}}class UO extends xs{constructor(e,t){super(e,"in",t),this.keys=TN(0,t)}matches(e){return this.keys.some(t=>t.isEqual(e.key))}}class jO extends xs{constructor(e,t){super(e,"not-in",t),this.keys=TN(0,t)}matches(e){return!this.keys.some(t=>t.isEqual(e.key))}}function TN(n,e){var t;return((null===(t=e.arrayValue)||void 0===t?void 0:t.values)||[]).map(r=>Je.fromName(r.referenceValue))}class HO extends xs{constructor(e,t){super(e,"array-contains",t)}matches(e){const t=e.data.field(this.field);return XC(t)&&JE(t.arrayValue,this.value)}}class GO extends xs{constructor(e,t){super(e,"in",t)}matches(e){const t=e.data.field(this.field);return null!==t&&JE(this.value.arrayValue,t)}}class $O extends xs{constructor(e,t){super(e,"not-in",t)}matches(e){if(JE(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;const t=e.data.field(this.field);return null!==t&&!JE(this.value.arrayValue,t)}}class WO extends xs{constructor(e,t){super(e,"array-contains-any",t)}matches(e){const t=e.data.field(this.field);return!(!XC(t)||!t.arrayValue.values)&&t.arrayValue.values.some(r=>JE(this.value.arrayValue,r))}}class S_{constructor(e,t){this.position=e,this.inclusive=t}}class x_{constructor(e,t="asc"){this.field=e,this.dir=t}}function qO(n,e){return n.dir===e.dir&&n.field.isEqual(e.field)}function AN(n,e,t){let r=0;for(let o=0;o<n.position.length;o++){const u=e[o],c=n.position[o];if(r=u.field.isKeyField()?Je.comparator(Je.fromName(c.referenceValue),t.key):T_(c,t.data.field(u.field)),"desc"===u.dir&&(r*=-1),0!==r)break}return r}function SN(n,e){if(null===n)return null===e;if(null===e||n.inclusive!==e.inclusive||n.position.length!==e.position.length)return!1;for(let t=0;t<n.position.length;t++)if(!fu(n.position[t],e.position[t]))return!1;return!0}class Rc{constructor(e,t=null,r=[],o=[],u=null,c="F",g=null,E=null){this.path=e,this.collectionGroup=t,this.explicitOrderBy=r,this.filters=o,this.limit=u,this.limitType=c,this.startAt=g,this.endAt=E,this.D=null,this.C=null}}function xN(n,e,t,r,o,u,c,g){return new Rc(n,e,t,r,o,u,c,g)}function M_(n){return new Rc(n)}function sD(n){return!Np(n.limit)&&"F"===n.limitType}function oD(n){return!Np(n.limit)&&"L"===n.limitType}function eS(n){return n.explicitOrderBy.length>0?n.explicitOrderBy[0].field:null}function tS(n){for(const e of n.filters)if(e.S())return e.field;return null}function nS(n){return null!==n.collectionGroup}function N_(n){const e=We(n);if(null===e.D){e.D=[];const t=tS(e),r=eS(e);if(null!==t&&null===r)t.isKeyField()||e.D.push(new x_(t)),e.D.push(new x_(hi.keyField(),"asc"));else{let o=!1;for(const u of e.explicitOrderBy)e.D.push(u),u.field.isKeyField()&&(o=!0);if(!o){const u=e.explicitOrderBy.length>0?e.explicitOrderBy[e.explicitOrderBy.length-1].dir:"asc";e.D.push(new x_(hi.keyField(),u))}}}return e.D}function ma(n){const e=We(n);if(!e.C)if("F"===e.limitType)e.C=bN(e.path,e.collectionGroup,N_(e),e.filters,e.limit,e.startAt,e.endAt);else{const t=[];for(const u of N_(e))t.push(new x_(u.field,"desc"===u.dir?"asc":"desc"));const r=e.endAt?new S_(e.endAt.position,!e.endAt.inclusive):null,o=e.startAt?new S_(e.startAt.position,!e.startAt.inclusive):null;e.C=bN(e.path,e.collectionGroup,t,e.filters,e.limit,r,o)}return e.C}function MN(n,e,t){return new Rc(n.path,n.collectionGroup,n.explicitOrderBy.slice(),n.filters.slice(),e,t,n.startAt,n.endAt)}function n0(n,e){return rD(ma(n),ma(e))&&n.limitType===e.limitType}function NN(n){return`${t0(ma(n))}|lt:${n.limitType}`}function rS(n){return`Query(target=${function VO(n){let e=n.path.canonicalString();return null!==n.collectionGroup&&(e+=" collectionGroup="+n.collectionGroup),n.filters.length>0&&(e+=`, filters: [${n.filters.map(t=>{return`${(r=t).field.canonicalString()} ${r.op} ${A_(r.value)}`;var r}).join(", ")}]`),Np(n.limit)||(e+=", limit: "+n.limit),n.orderBy.length>0&&(e+=`, orderBy: [${n.orderBy.map(t=>{return`${(r=t).field.canonicalString()} (${r.dir})`;var r}).join(", ")}]`),n.startAt&&(e+=", startAt: ",e+=n.startAt.inclusive?"b:":"a:",e+=n.startAt.position.map(t=>A_(t)).join(",")),n.endAt&&(e+=", endAt: ",e+=n.endAt.inclusive?"a:":"b:",e+=n.endAt.position.map(t=>A_(t)).join(",")),`Target(${e})`}(ma(n))}; limitType=${n.limitType})`}function iS(n,e){return e.isFoundDocument()&&function(t,r){const o=r.key.path;return null!==t.collectionGroup?r.key.hasCollectionId(t.collectionGroup)&&t.path.isPrefixOf(o):Je.isDocumentKey(t.path)?t.path.isEqual(o):t.path.isImmediateParentOf(o)}(n,e)&&function(t,r){for(const o of t.explicitOrderBy)if(!o.field.isKeyField()&&null===r.data.field(o.field))return!1;return!0}(n,e)&&function(t,r){for(const o of t.filters)if(!o.matches(r))return!1;return!0}(n,e)&&(r=e,!((t=n).startAt&&!function(o,u,c){const g=AN(o,u,c);return o.inclusive?g<=0:g<0}(t.startAt,N_(t),r)||t.endAt&&!function(o,u,c){const g=AN(o,u,c);return o.inclusive?g>=0:g>0}(t.endAt,N_(t),r)));var t,r}function RN(n){return(e,t)=>{let r=!1;for(const o of N_(n)){const u=zO(o,e,t);if(0!==u)return u;r=r||o.field.isKeyField()}return 0}}function zO(n,e,t){const r=n.field.isKeyField()?Je.comparator(e.key,t.key):function(o,u,c){const g=u.data.field(o),E=c.data.field(o);return null!==g&&null!==E?T_(g,E):ut()}(n.field,e,t);switch(n.dir){case"asc":return r;case"desc":return-1*r;default:return ut()}}function PN(n,e){if(n.N){if(isNaN(e))return{doubleValue:"NaN"};if(e===1/0)return{doubleValue:"Infinity"};if(e===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:QE(e)?"-0":e}}function ON(n){return{integerValue:""+n}}function kN(n,e){return EN(e)?ON(e):PN(n,e)}class aD{constructor(){this._=void 0}}function KO(n,e,t){return n instanceof R_?function(r,o){const u={fields:{__type__:{stringValue:"server_timestamp"},__local_write_time__:{timestampValue:{seconds:r.seconds,nanos:r.nanoseconds}}}};return o&&(u.fields.__previous_value__=o),{mapValue:u}}(t,e):n instanceof Pp?LN(n,e):n instanceof Op?VN(n,e):function(r,o){const u=FN(r,o),c=BN(u)+BN(r.k);return JA(u)&&JA(r.k)?ON(c):PN(r.O,c)}(n,e)}function ZO(n,e,t){return n instanceof Pp?LN(n,e):n instanceof Op?VN(n,e):t}function FN(n,e){return n instanceof P_?JA(t=e)||(r=t)&&"doubleValue"in r?e:{integerValue:0}:null;var r,t}class R_ extends aD{}class Pp extends aD{constructor(e){super(),this.elements=e}}function LN(n,e){const t=UN(e);for(const r of n.elements)t.some(o=>fu(o,r))||t.push(r);return{arrayValue:{values:t}}}class Op extends aD{constructor(e){super(),this.elements=e}}function VN(n,e){let t=UN(e);for(const r of n.elements)t=t.filter(o=>!fu(o,r));return{arrayValue:{values:t}}}class P_ extends aD{constructor(e,t){super(),this.O=e,this.k=t}}function BN(n){return pr(n.integerValue||n.doubleValue)}function UN(n){return XC(n)&&n.arrayValue.values?n.arrayValue.values.slice():[]}class r0{constructor(e,t){this.field=e,this.transform=t}}class QO{constructor(e,t){this.version=e,this.transformResults=t}}class Lr{constructor(e,t){this.updateTime=e,this.exists=t}static none(){return new Lr}static exists(e){return new Lr(void 0,e)}static updateTime(e){return new Lr(e)}get isNone(){return void 0===this.updateTime&&void 0===this.exists}isEqual(e){return this.exists===e.exists&&(this.updateTime?!!e.updateTime&&this.updateTime.isEqual(e.updateTime):!e.updateTime)}}function uD(n,e){return void 0!==n.updateTime?e.isFoundDocument()&&e.version.isEqual(n.updateTime):void 0===n.exists||n.exists===e.isFoundDocument()}class lD{}function JO(n,e,t){n instanceof s0?function(r,o,u){const c=r.value.clone(),g=$N(r.fieldTransforms,o,u.transformResults);c.setAll(g),o.convertToFoundDocument(u.version,c).setHasCommittedMutations()}(n,e,t):n instanceof kp?function(r,o,u){if(!uD(r.precondition,o))return void o.convertToUnknownDocument(u.version);const c=$N(r.fieldTransforms,o,u.transformResults),g=o.data;g.setAll(GN(r)),g.setAll(c),o.convertToFoundDocument(u.version,g).setHasCommittedMutations()}(n,e,t):e.convertToNoDocument(t.version).setHasCommittedMutations()}function sS(n,e,t){var o;n instanceof s0?function(r,o,u){if(!uD(r.precondition,o))return;const c=r.value.clone(),g=WN(r.fieldTransforms,u,o);c.setAll(g),o.convertToFoundDocument(HN(o),c).setHasLocalMutations()}(n,e,t):n instanceof kp?function(r,o,u){if(!uD(r.precondition,o))return;const c=WN(r.fieldTransforms,u,o),g=o.data;g.setAll(GN(r)),g.setAll(c),o.convertToFoundDocument(HN(o),g).setHasLocalMutations()}(n,e,t):uD(n.precondition,o=e)&&o.convertToNoDocument(yt.min())}function XO(n,e){let t=null;for(const r of n.fieldTransforms){const o=e.data.field(r.field),u=FN(r.transform,o||null);null!=u&&(null==t&&(t=rs.empty()),t.set(r.field,u))}return t||null}function jN(n,e){return n.type===e.type&&!!n.key.isEqual(e.key)&&!!n.precondition.isEqual(e.precondition)&&(r=e.fieldTransforms,!!(void 0===(t=n.fieldTransforms)&&void 0===r||t&&r&&D_(t,r,(o,u)=>function YO(n,e){return n.field.isEqual(e.field)&&(r=e.transform,(t=n.transform)instanceof Pp&&r instanceof Pp||t instanceof Op&&r instanceof Op?D_(t.elements,r.elements,fu):t instanceof P_&&r instanceof P_?fu(t.k,r.k):t instanceof R_&&r instanceof R_);var t,r}(o,u))))&&(0===n.type?n.value.isEqual(e.value):1!==n.type||n.data.isEqual(e.data)&&n.fieldMask.isEqual(e.fieldMask));var t,r}function HN(n){return n.isFoundDocument()?n.version:yt.min()}class s0 extends lD{constructor(e,t,r,o=[]){super(),this.key=e,this.value=t,this.precondition=r,this.fieldTransforms=o,this.type=0}}class kp extends lD{constructor(e,t,r,o,u=[]){super(),this.key=e,this.data=t,this.fieldMask=r,this.precondition=o,this.fieldTransforms=u,this.type=1}}function GN(n){const e=new Map;return n.fieldMask.fields.forEach(t=>{if(!t.isEmpty()){const r=n.data.field(t);e.set(t,r)}}),e}function $N(n,e,t){const r=new Map;It(n.length===t.length);for(let o=0;o<t.length;o++){const u=n[o],c=u.transform,g=e.data.field(u.field);r.set(u.field,ZO(c,g,t[o]))}return r}function WN(n,e,t){const r=new Map;for(const o of n){const u=o.transform,c=t.data.field(o.field);r.set(o.field,KO(u,c,e))}return r}class o0 extends lD{constructor(e,t){super(),this.key=e,this.precondition=t,this.type=2,this.fieldTransforms=[]}}class oS extends lD{constructor(e,t){super(),this.key=e,this.precondition=t,this.type=3,this.fieldTransforms=[]}}class ek{constructor(e){this.count=e}}var Vr,Zt;function qN(n){switch(n){default:return ut();case ue.CANCELLED:case ue.UNKNOWN:case ue.DEADLINE_EXCEEDED:case ue.RESOURCE_EXHAUSTED:case ue.INTERNAL:case ue.UNAVAILABLE:case ue.UNAUTHENTICATED:return!1;case ue.INVALID_ARGUMENT:case ue.NOT_FOUND:case ue.ALREADY_EXISTS:case ue.PERMISSION_DENIED:case ue.FAILED_PRECONDITION:case ue.ABORTED:case ue.OUT_OF_RANGE:case ue.UNIMPLEMENTED:case ue.DATA_LOSS:return!0}}function zN(n){if(void 0===n)return Fr("GRPC error has no .code"),ue.UNKNOWN;switch(n){case Vr.OK:return ue.OK;case Vr.CANCELLED:return ue.CANCELLED;case Vr.UNKNOWN:return ue.UNKNOWN;case Vr.DEADLINE_EXCEEDED:return ue.DEADLINE_EXCEEDED;case Vr.RESOURCE_EXHAUSTED:return ue.RESOURCE_EXHAUSTED;case Vr.INTERNAL:return ue.INTERNAL;case Vr.UNAVAILABLE:return ue.UNAVAILABLE;case Vr.UNAUTHENTICATED:return ue.UNAUTHENTICATED;case Vr.INVALID_ARGUMENT:return ue.INVALID_ARGUMENT;case Vr.NOT_FOUND:return ue.NOT_FOUND;case Vr.ALREADY_EXISTS:return ue.ALREADY_EXISTS;case Vr.PERMISSION_DENIED:return ue.PERMISSION_DENIED;case Vr.FAILED_PRECONDITION:return ue.FAILED_PRECONDITION;case Vr.ABORTED:return ue.ABORTED;case Vr.OUT_OF_RANGE:return ue.OUT_OF_RANGE;case Vr.UNIMPLEMENTED:return ue.UNIMPLEMENTED;case Vr.DATA_LOSS:return ue.DATA_LOSS;default:return ut()}}(Zt=Vr||(Vr={}))[Zt.OK=0]="OK",Zt[Zt.CANCELLED=1]="CANCELLED",Zt[Zt.UNKNOWN=2]="UNKNOWN",Zt[Zt.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",Zt[Zt.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",Zt[Zt.NOT_FOUND=5]="NOT_FOUND",Zt[Zt.ALREADY_EXISTS=6]="ALREADY_EXISTS",Zt[Zt.PERMISSION_DENIED=7]="PERMISSION_DENIED",Zt[Zt.UNAUTHENTICATED=16]="UNAUTHENTICATED",Zt[Zt.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",Zt[Zt.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",Zt[Zt.ABORTED=10]="ABORTED",Zt[Zt.OUT_OF_RANGE=11]="OUT_OF_RANGE",Zt[Zt.UNIMPLEMENTED=12]="UNIMPLEMENTED",Zt[Zt.INTERNAL=13]="INTERNAL",Zt[Zt.UNAVAILABLE=14]="UNAVAILABLE",Zt[Zt.DATA_LOSS=15]="DATA_LOSS";class Er{constructor(e,t){this.comparator=e,this.root=t||Fi.EMPTY}insert(e,t){return new Er(this.comparator,this.root.insert(e,t,this.comparator).copy(null,null,Fi.BLACK,null,null))}remove(e){return new Er(this.comparator,this.root.remove(e,this.comparator).copy(null,null,Fi.BLACK,null,null))}get(e){let t=this.root;for(;!t.isEmpty();){const r=this.comparator(e,t.key);if(0===r)return t.value;r<0?t=t.left:r>0&&(t=t.right)}return null}indexOf(e){let t=0,r=this.root;for(;!r.isEmpty();){const o=this.comparator(e,r.key);if(0===o)return t+r.left.size;o<0?r=r.left:(t+=r.left.size+1,r=r.right)}return-1}isEmpty(){return this.root.isEmpty()}get size(){return this.root.size}minKey(){return this.root.minKey()}maxKey(){return this.root.maxKey()}inorderTraversal(e){return this.root.inorderTraversal(e)}forEach(e){this.inorderTraversal((t,r)=>(e(t,r),!1))}toString(){const e=[];return this.inorderTraversal((t,r)=>(e.push(`${t}:${r}`),!1)),`{${e.join(", ")}}`}reverseTraversal(e){return this.root.reverseTraversal(e)}getIterator(){return new cD(this.root,null,this.comparator,!1)}getIteratorFrom(e){return new cD(this.root,e,this.comparator,!1)}getReverseIterator(){return new cD(this.root,null,this.comparator,!0)}getReverseIteratorFrom(e){return new cD(this.root,e,this.comparator,!0)}}class cD{constructor(e,t,r,o){this.isReverse=o,this.nodeStack=[];let u=1;for(;!e.isEmpty();)if(u=t?r(e.key,t):1,o&&(u*=-1),u<0)e=this.isReverse?e.left:e.right;else{if(0===u){this.nodeStack.push(e);break}this.nodeStack.push(e),e=this.isReverse?e.right:e.left}}getNext(){let e=this.nodeStack.pop();const t={key:e.key,value:e.value};if(this.isReverse)for(e=e.left;!e.isEmpty();)this.nodeStack.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack.push(e),e=e.left;return t}hasNext(){return this.nodeStack.length>0}peek(){if(0===this.nodeStack.length)return null;const e=this.nodeStack[this.nodeStack.length-1];return{key:e.key,value:e.value}}}class Fi{constructor(e,t,r,o,u){this.key=e,this.value=t,this.color=null!=r?r:Fi.RED,this.left=null!=o?o:Fi.EMPTY,this.right=null!=u?u:Fi.EMPTY,this.size=this.left.size+1+this.right.size}copy(e,t,r,o,u){return new Fi(null!=e?e:this.key,null!=t?t:this.value,null!=r?r:this.color,null!=o?o:this.left,null!=u?u:this.right)}isEmpty(){return!1}inorderTraversal(e){return this.left.inorderTraversal(e)||e(this.key,this.value)||this.right.inorderTraversal(e)}reverseTraversal(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}min(){return this.left.isEmpty()?this:this.left.min()}minKey(){return this.min().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(e,t,r){let o=this;const u=r(e,o.key);return o=u<0?o.copy(null,null,null,o.left.insert(e,t,r),null):0===u?o.copy(null,t,null,null,null):o.copy(null,null,null,null,o.right.insert(e,t,r)),o.fixUp()}removeMin(){if(this.left.isEmpty())return Fi.EMPTY;let e=this;return e.left.isRed()||e.left.left.isRed()||(e=e.moveRedLeft()),e=e.copy(null,null,null,e.left.removeMin(),null),e.fixUp()}remove(e,t){let r,o=this;if(t(e,o.key)<0)o.left.isEmpty()||o.left.isRed()||o.left.left.isRed()||(o=o.moveRedLeft()),o=o.copy(null,null,null,o.left.remove(e,t),null);else{if(o.left.isRed()&&(o=o.rotateRight()),o.right.isEmpty()||o.right.isRed()||o.right.left.isRed()||(o=o.moveRedRight()),0===t(e,o.key)){if(o.right.isEmpty())return Fi.EMPTY;r=o.right.min(),o=o.copy(r.key,r.value,null,null,o.right.removeMin())}o=o.copy(null,null,null,null,o.right.remove(e,t))}return o.fixUp()}isRed(){return this.color}fixUp(){let e=this;return e.right.isRed()&&!e.left.isRed()&&(e=e.rotateLeft()),e.left.isRed()&&e.left.left.isRed()&&(e=e.rotateRight()),e.left.isRed()&&e.right.isRed()&&(e=e.colorFlip()),e}moveRedLeft(){let e=this.colorFlip();return e.right.left.isRed()&&(e=e.copy(null,null,null,null,e.right.rotateRight()),e=e.rotateLeft(),e=e.colorFlip()),e}moveRedRight(){let e=this.colorFlip();return e.left.left.isRed()&&(e=e.rotateRight(),e=e.colorFlip()),e}rotateLeft(){const e=this.copy(null,null,Fi.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)}rotateRight(){const e=this.copy(null,null,Fi.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)}colorFlip(){const e=this.left.copy(null,null,!this.left.color,null,null),t=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,t)}checkMaxDepth(){const e=this.check();return Math.pow(2,e)<=this.size+1}check(){if(this.isRed()&&this.left.isRed()||this.right.isRed())throw ut();const e=this.left.check();if(e!==this.right.check())throw ut();return e+(this.isRed()?0:1)}}Fi.EMPTY=null,Fi.RED=!0,Fi.BLACK=!1,Fi.EMPTY=new class{constructor(){this.size=0}get key(){throw ut()}get value(){throw ut()}get color(){throw ut()}get left(){throw ut()}get right(){throw ut()}copy(n,e,t,r,o){return this}insert(n,e,t){return new Fi(n,e)}remove(n,e){return this}isEmpty(){return!0}inorderTraversal(n){return!1}reverseTraversal(n){return!1}minKey(){return null}maxKey(){return null}isRed(){return!1}checkMaxDepth(){return!0}check(){return 0}};class Zn{constructor(e){this.comparator=e,this.data=new Er(this.comparator)}has(e){return null!==this.data.get(e)}first(){return this.data.minKey()}last(){return this.data.maxKey()}get size(){return this.data.size}indexOf(e){return this.data.indexOf(e)}forEach(e){this.data.inorderTraversal((t,r)=>(e(t),!1))}forEachInRange(e,t){const r=this.data.getIteratorFrom(e[0]);for(;r.hasNext();){const o=r.getNext();if(this.comparator(o.key,e[1])>=0)return;t(o.key)}}forEachWhile(e,t){let r;for(r=void 0!==t?this.data.getIteratorFrom(t):this.data.getIterator();r.hasNext();)if(!e(r.getNext().key))return}firstAfterOrEqual(e){const t=this.data.getIteratorFrom(e);return t.hasNext()?t.getNext().key:null}getIterator(){return new KN(this.data.getIterator())}getIteratorFrom(e){return new KN(this.data.getIteratorFrom(e))}add(e){return this.copy(this.data.remove(e).insert(e,!0))}delete(e){return this.has(e)?this.copy(this.data.remove(e)):this}isEmpty(){return this.data.isEmpty()}unionWith(e){let t=this;return t.size<e.size&&(t=e,e=this),e.forEach(r=>{t=t.add(r)}),t}isEqual(e){if(!(e instanceof Zn)||this.size!==e.size)return!1;const t=this.data.getIterator(),r=e.data.getIterator();for(;t.hasNext();){const o=t.getNext().key,u=r.getNext().key;if(0!==this.comparator(o,u))return!1}return!0}toArray(){const e=[];return this.forEach(t=>{e.push(t)}),e}toString(){const e=[];return this.forEach(t=>e.push(t)),"SortedSet("+e.toString()+")"}copy(e){const t=new Zn(this.comparator);return t.data=e,t}}class KN{constructor(e){this.iter=e}getNext(){return this.iter.getNext().key}hasNext(){return this.iter.hasNext()}}function O_(n){return n.hasNext()?n.getNext():void 0}const tk=new Er(Je.comparator);function _a(){return tk}const nk=new Er(Je.comparator);function aS(){return nk}const rk=new Er(Je.comparator),ik=new Zn(Je.comparator);function hn(...n){let e=ik;for(const t of n)e=e.add(t);return e}const sk=new Zn(Gt);function dD(){return sk}class a0{constructor(e,t,r,o,u){this.snapshotVersion=e,this.targetChanges=t,this.targetMismatches=r,this.documentUpdates=o,this.resolvedLimboDocuments=u}static createSynthesizedRemoteEventForCurrentChange(e,t){const r=new Map;return r.set(e,u0.createSynthesizedTargetChangeForCurrentChange(e,t)),new a0(yt.min(),r,dD(),_a(),hn())}}class u0{constructor(e,t,r,o,u){this.resumeToken=e,this.current=t,this.addedDocuments=r,this.modifiedDocuments=o,this.removedDocuments=u}static createSynthesizedTargetChangeForCurrentChange(e,t){return new u0(Jr.EMPTY_BYTE_STRING,t,hn(),hn(),hn())}}class hD{constructor(e,t,r,o){this.M=e,this.removedTargetIds=t,this.key=r,this.$=o}}class ZN{constructor(e,t){this.targetId=e,this.F=t}}class YN{constructor(e,t,r=Jr.EMPTY_BYTE_STRING,o=null){this.state=e,this.targetIds=t,this.resumeToken=r,this.cause=o}}class QN{constructor(){this.B=0,this.L=XN(),this.U=Jr.EMPTY_BYTE_STRING,this.q=!1,this.K=!0}get current(){return this.q}get resumeToken(){return this.U}get G(){return 0!==this.B}get j(){return this.K}W(e){e.approximateByteSize()>0&&(this.K=!0,this.U=e)}H(){let e=hn(),t=hn(),r=hn();return this.L.forEach((o,u)=>{switch(u){case 0:e=e.add(o);break;case 2:t=t.add(o);break;case 1:r=r.add(o);break;default:ut()}}),new u0(this.U,this.q,e,t,r)}J(){this.K=!1,this.L=XN()}Y(e,t){this.K=!0,this.L=this.L.insert(e,t)}X(e){this.K=!0,this.L=this.L.remove(e)}Z(){this.B+=1}tt(){this.B-=1}et(){this.K=!0,this.q=!0}}class ok{constructor(e){this.nt=e,this.st=new Map,this.it=_a(),this.rt=JN(),this.ot=new Zn(Gt)}ct(e){for(const t of e.M)e.$&&e.$.isFoundDocument()?this.ut(t,e.$):this.at(t,e.key,e.$);for(const t of e.removedTargetIds)this.at(t,e.key,e.$)}ht(e){this.forEachTarget(e,t=>{const r=this.lt(t);switch(e.state){case 0:this.ft(t)&&r.W(e.resumeToken);break;case 1:r.tt(),r.G||r.J(),r.W(e.resumeToken);break;case 2:r.tt(),r.G||this.removeTarget(t);break;case 3:this.ft(t)&&(r.et(),r.W(e.resumeToken));break;case 4:this.ft(t)&&(this.dt(t),r.W(e.resumeToken));break;default:ut()}})}forEachTarget(e,t){e.targetIds.length>0?e.targetIds.forEach(t):this.st.forEach((r,o)=>{this.ft(o)&&t(o)})}_t(e){const t=e.targetId,r=e.F.count,o=this.wt(t);if(o){const u=o.target;if(iD(u))if(0===r){const c=new Je(u.path);this.at(t,c,sr.newNoDocument(c,yt.min()))}else It(1===r);else this.gt(t)!==r&&(this.dt(t),this.ot=this.ot.add(t))}}yt(e){const t=new Map;this.st.forEach((u,c)=>{const g=this.wt(c);if(g){if(u.current&&iD(g.target)){const E=new Je(g.target.path);null!==this.it.get(E)||this.It(c,E)||this.at(c,E,sr.newNoDocument(E,e))}u.j&&(t.set(c,u.H()),u.J())}});let r=hn();this.rt.forEach((u,c)=>{let g=!0;c.forEachWhile(E=>{const I=this.wt(E);return!I||2===I.purpose||(g=!1,!1)}),g&&(r=r.add(u))}),this.it.forEach((u,c)=>c.setReadTime(e));const o=new a0(e,t,this.ot,this.it,r);return this.it=_a(),this.rt=JN(),this.ot=new Zn(Gt),o}ut(e,t){if(!this.ft(e))return;const r=this.It(e,t.key)?2:0;this.lt(e).Y(t.key,r),this.it=this.it.insert(t.key,t),this.rt=this.rt.insert(t.key,this.Et(t.key).add(e))}at(e,t,r){if(!this.ft(e))return;const o=this.lt(e);this.It(e,t)?o.Y(t,1):o.X(t),this.rt=this.rt.insert(t,this.Et(t).delete(e)),r&&(this.it=this.it.insert(t,r))}removeTarget(e){this.st.delete(e)}gt(e){const t=this.lt(e).H();return this.nt.getRemoteKeysForTarget(e).size+t.addedDocuments.size-t.removedDocuments.size}Z(e){this.lt(e).Z()}lt(e){let t=this.st.get(e);return t||(t=new QN,this.st.set(e,t)),t}Et(e){let t=this.rt.get(e);return t||(t=new Zn(Gt),this.rt=this.rt.insert(e,t)),t}ft(e){const t=null!==this.wt(e);return t||Le("WatchChangeAggregator","Detected inactive target",e),t}wt(e){const t=this.st.get(e);return t&&t.G?null:this.nt.Tt(e)}dt(e){this.st.set(e,new QN),this.nt.getRemoteKeysForTarget(e).forEach(t=>{this.at(e,t,null)})}It(e,t){return this.nt.getRemoteKeysForTarget(e).has(t)}}function JN(){return new Er(Je.comparator)}function XN(){return new Er(Je.comparator)}const ak={asc:"ASCENDING",desc:"DESCENDING"},uk={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"};class lk{constructor(e,t){this.databaseId=e,this.N=t}}function l0(n,e){return n.N?`${new Date(1e3*e.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")}.${("000000000"+e.nanoseconds).slice(-9)}Z`:{seconds:""+e.seconds,nanos:e.nanoseconds}}function eR(n,e){return n.N?e.toBase64():e.toUint8Array()}function ck(n,e){return l0(n,e.toTimestamp())}function fi(n){return It(!!n),yt.fromTimestamp(function(e){const t=Ih(e);return new di(t.seconds,t.nanos)}(n))}function uS(n,e){return(t=n,new rn(["projects",t.projectId,"databases",t.database])).child("documents").child(e).canonicalString();var t}function tR(n){const e=rn.fromString(n);return It(cR(e)),e}function c0(n,e){return uS(n.databaseId,e.path)}function hl(n,e){const t=tR(e);if(t.get(1)!==n.databaseId.projectId)throw new Me(ue.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+t.get(1)+" vs "+n.databaseId.projectId);if(t.get(3)!==n.databaseId.database)throw new Me(ue.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+t.get(3)+" vs "+n.databaseId.database);return new Je(rR(t))}function lS(n,e){return uS(n.databaseId,e)}function nR(n){const e=tR(n);return 4===e.length?rn.emptyPath():rR(e)}function d0(n){return new rn(["projects",n.databaseId.projectId,"databases",n.databaseId.database]).canonicalString()}function rR(n){return It(n.length>4&&"documents"===n.get(4)),n.popFirst(5)}function iR(n,e,t){return{name:c0(n,e),fields:t.value.mapValue.fields}}function sR(n,e,t){const r=hl(n,e.name),o=fi(e.updateTime),u=new rs({mapValue:{fields:e.fields}}),c=sr.newFoundDocument(r,o,u);return t&&c.setHasCommittedMutations(),t?c.setHasCommittedMutations():c}function h0(n,e){let t;if(e instanceof s0)t={update:iR(n,e.key,e.value)};else if(e instanceof o0)t={delete:c0(n,e.key)};else if(e instanceof kp)t={update:iR(n,e.key,e.data),updateMask:vk(e.fieldMask)};else{if(!(e instanceof oS))return ut();t={verify:c0(n,e.key)}}return e.fieldTransforms.length>0&&(t.updateTransforms=e.fieldTransforms.map(r=>function(o,u){const c=u.transform;if(c instanceof R_)return{fieldPath:u.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(c instanceof Pp)return{fieldPath:u.field.canonicalString(),appendMissingElements:{values:c.elements}};if(c instanceof Op)return{fieldPath:u.field.canonicalString(),removeAllFromArray:{values:c.elements}};if(c instanceof P_)return{fieldPath:u.field.canonicalString(),increment:c.k};throw ut()}(0,r))),e.precondition.isNone||(t.currentDocument=void 0!==(o=e.precondition).updateTime?{updateTime:ck(n,o.updateTime)}:void 0!==o.exists?{exists:o.exists}:ut()),t;var o}function cS(n,e){const t=e.currentDocument?void 0!==(o=e.currentDocument).updateTime?Lr.updateTime(fi(o.updateTime)):void 0!==o.exists?Lr.exists(o.exists):Lr.none():Lr.none(),r=e.updateTransforms?e.updateTransforms.map(o=>function(u,c){let g=null;"setToServerValue"in c?(It("REQUEST_TIME"===c.setToServerValue),g=new R_):"appendMissingElements"in c?g=new Pp(c.appendMissingElements.values||[]):"removeAllFromArray"in c?g=new Op(c.removeAllFromArray.values||[]):"increment"in c?g=new P_(u,c.increment):ut();const E=hi.fromServerFormat(c.fieldPath);return new r0(E,g)}(n,o)):[];var o;if(e.update){const o=hl(n,e.update.name),u=new rs({mapValue:{fields:e.update.fields}});if(e.updateMask){const c=new b_((e.updateMask.fieldPaths||[]).map(I=>hi.fromServerFormat(I)));return new kp(o,u,c,t,r)}return new s0(o,u,t,r)}if(e.delete){const o=hl(n,e.delete);return new o0(o,t)}if(e.verify){const o=hl(n,e.verify);return new oS(o,t)}return ut()}function oR(n,e){return{documents:[lS(n,e.path)]}}function aR(n,e){const t={structuredQuery:{}},r=e.path;null!==e.collectionGroup?(t.parent=lS(n,r),t.structuredQuery.from=[{collectionId:e.collectionGroup,allDescendants:!0}]):(t.parent=lS(n,r.popLast()),t.structuredQuery.from=[{collectionId:r.lastSegment()}]);const o=function(E){if(0===E.length)return;const I=E.map(S=>function(M){if("=="===M.op){if(CN(M.value))return{unaryFilter:{field:k_(M.field),op:"IS_NAN"}};if(IN(M.value))return{unaryFilter:{field:k_(M.field),op:"IS_NULL"}}}else if("!="===M.op){if(CN(M.value))return{unaryFilter:{field:k_(M.field),op:"IS_NOT_NAN"}};if(IN(M.value))return{unaryFilter:{field:k_(M.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:k_(M.field),op:mk(M.op),value:M.value}}}(S));return 1===I.length?I[0]:{compositeFilter:{op:"AND",filters:I}}}(e.filters);o&&(t.structuredQuery.where=o);const u=function(E){if(0!==E.length)return E.map(I=>{return{field:k_((S=I).field),direction:gk(S.dir)};var S})}(e.orderBy);u&&(t.structuredQuery.orderBy=u);const c=(I=e.limit,n.N||Np(I)?I:{value:I});var I,g,E;return null!==c&&(t.structuredQuery.limit=c),e.startAt&&(t.structuredQuery.startAt={before:(g=e.startAt).inclusive,values:g.position}),e.endAt&&(t.structuredQuery.endAt={before:!(E=e.endAt).inclusive,values:E.position}),t}function uR(n){let e=nR(n.parent);const t=n.structuredQuery,r=t.from?t.from.length:0;let o=null;if(r>0){It(1===r);const S=t.from[0];S.allDescendants?o=S.collectionId:e=e.child(S.collectionId)}let u=[];t.where&&(u=lR(t.where));let c=[];t.orderBy&&(c=t.orderBy.map(S=>{return new x_(F_((M=S).field),function(F){switch(F){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}}(M.direction));var M}));let g=null;t.limit&&(g=function(S){let M;return M="object"==typeof S?S.value:S,Np(M)?null:M}(t.limit));let E=null;var S;t.startAt&&(E=new S_((S=t.startAt).values||[],!!S.before));let I=null;return t.endAt&&(I=function(S){return new S_(S.values||[],!S.before)}(t.endAt)),xN(e,o,c,u,g,"F",E,I)}function lR(n){return n?void 0!==n.unaryFilter?[yk(n)]:void 0!==n.fieldFilter?[_k(n)]:void 0!==n.compositeFilter?n.compositeFilter.filters.map(e=>lR(e)).reduce((e,t)=>e.concat(t)):ut():[]}function gk(n){return ak[n]}function mk(n){return uk[n]}function k_(n){return{fieldPath:n.canonicalString()}}function F_(n){return hi.fromServerFormat(n.fieldPath)}function _k(n){return xs.create(F_(n.fieldFilter.field),function(e){switch(e){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";default:return ut()}}(n.fieldFilter.op),n.fieldFilter.value)}function yk(n){switch(n.unaryFilter.op){case"IS_NAN":const e=F_(n.unaryFilter.field);return xs.create(e,"==",{doubleValue:NaN});case"IS_NULL":const t=F_(n.unaryFilter.field);return xs.create(t,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":const r=F_(n.unaryFilter.field);return xs.create(r,"!=",{doubleValue:NaN});case"IS_NOT_NULL":const o=F_(n.unaryFilter.field);return xs.create(o,"!=",{nullValue:"NULL_VALUE"});default:return ut()}}function vk(n){const e=[];return n.fields.forEach(t=>e.push(t.canonicalString())),{fieldPaths:e}}function cR(n){return n.length>=4&&"projects"===n.get(0)&&"databases"===n.get(2)}function pi(n){let e="";for(let t=0;t<n.length;t++)e.length>0&&(e=dR(e)),e=Ek(n.get(t),e);return dR(e)}function Ek(n,e){let t=e;const r=n.length;for(let o=0;o<r;o++){const u=n.charAt(o);switch(u){case"\0":t+="\x01\x10";break;case"\x01":t+="\x01\x11";break;default:t+=u}}return t}function dR(n){return n+"\x01\x01"}function fl(n){const e=n.length;if(It(e>=2),2===e)return It("\x01"===n.charAt(0)&&"\x01"===n.charAt(1)),rn.emptyPath();const t=e-2,r=[];let o="";for(let u=0;u<e;){const c=n.indexOf("\x01",u);switch((c<0||c>t)&&ut(),n.charAt(c+1)){case"\x01":const g=n.substring(u,c);let E;0===o.length?E=g:(o+=g,E=o,o=""),r.push(E);break;case"\x10":o+=n.substring(u,c),o+="\0";break;case"\x11":o+=n.substring(u,c+1);break;default:ut()}u=c+2}return new rn(r)}class wk{constructor(e,t){this.seconds=e,this.nanoseconds=t}}class Ro{constructor(e,t,r){this.ownerId=e,this.allowTabSynchronization=t,this.leaseTimestampMs=r}}Ro.store="owner",Ro.key="owner";class Ch{constructor(e,t,r){this.userId=e,this.lastAcknowledgedBatchId=t,this.lastStreamToken=r}}Ch.store="mutationQueues",Ch.keyPath="userId";class kn{constructor(e,t,r,o,u){this.userId=e,this.batchId=t,this.localWriteTimeMs=r,this.baseMutations=o,this.mutations=u}}kn.store="mutations",kn.keyPath="batchId",kn.userMutationsIndex="userMutationsIndex",kn.userMutationsKeyPath=["userId","batchId"];class is{constructor(){}static prefixForUser(e){return[e]}static prefixForPath(e,t){return[e,pi(t)]}static key(e,t,r){return[e,pi(t),r]}}is.store="documentMutations",is.PLACEHOLDER=new is;class Ik{constructor(e,t){this.path=e,this.readTime=t}}class Ck{constructor(e,t){this.path=e,this.version=t}}class gr{constructor(e,t,r,o,u,c){this.unknownDocument=e,this.noDocument=t,this.document=r,this.hasCommittedMutations=o,this.readTime=u,this.parentPath=c}}gr.store="remoteDocuments",gr.readTimeIndex="readTimeIndex",gr.readTimeIndexPath="readTime",gr.collectionReadTimeIndex="collectionReadTimeIndex",gr.collectionReadTimeIndexPath=["parentPath","readTime"];class pl{constructor(e){this.byteSize=e}}pl.store="remoteDocumentGlobal",pl.key="remoteDocumentGlobalKey";class Qs{constructor(e,t,r,o,u,c,g){this.targetId=e,this.canonicalId=t,this.readTime=r,this.resumeToken=o,this.lastListenSequenceNumber=u,this.lastLimboFreeSnapshotVersion=c,this.query=g}}Qs.store="targets",Qs.keyPath="targetId",Qs.queryTargetsIndexName="queryTargetsIndex",Qs.queryTargetsKeyPath=["canonicalId","targetId"];class Li{constructor(e,t,r){this.targetId=e,this.path=t,this.sequenceNumber=r}}Li.store="targetDocuments",Li.keyPath=["targetId","path"],Li.documentTargetsIndex="documentTargetsIndex",Li.documentTargetsKeyPath=["path","targetId"];class Po{constructor(e,t,r,o){this.highestTargetId=e,this.highestListenSequenceNumber=t,this.lastRemoteSnapshotVersion=r,this.targetCount=o}}Po.key="targetGlobalKey",Po.store="targetGlobal";class Fp{constructor(e,t){this.collectionId=e,this.parent=t}}Fp.store="collectionParents",Fp.keyPath=["collectionId","parent"];class Pc{constructor(e,t,r,o){this.clientId=e,this.updateTimeMs=t,this.networkEnabled=r,this.inForeground=o}}Pc.store="clientMetadata",Pc.keyPath="clientId";class L_{constructor(e,t,r){this.bundleId=e,this.createTime=t,this.version=r}}L_.store="bundles",L_.keyPath="bundleId";class V_{constructor(e,t,r){this.name=e,this.readTime=t,this.bundledQuery=r}}V_.store="namedQueries",V_.keyPath="name";class Oo{constructor(e,t,r){this.indexId=e,this.collectionGroup=t,this.fields=r}}Oo.store="indexConfiguration",Oo.keyPath="indexId",Oo.collectionGroupIndex="collectionGroupIndex",Oo.collectionGroupIndexPath="collectionGroup";class ya{constructor(e,t,r,o,u,c){this.indexId=e,this.uid=t,this.sequenceNumber=r,this.readTime=o,this.documentKey=u,this.largestBatchId=c}}ya.store="indexState",ya.keyPath=["indexId","uid"],ya.sequenceNumberIndex="sequenceNumberIndex",ya.sequenceNumberIndexPath=["uid","sequenceNumber"];class va{constructor(e,t,r,o,u){this.indexId=e,this.uid=t,this.arrayValue=r,this.directionalValue=o,this.documentKey=u}}va.store="indexEntries",va.keyPath=["indexId","uid","arrayValue","directionalValue","documentKey"],va.documentKeyIndex="documentKeyIndex",va.documentKeyIndexPath=["indexId","uid","documentKey"];class gi{constructor(e,t,r,o,u,c){this.userId=e,this.collectionPath=t,this.documentId=r,this.collectionGroup=o,this.largestBatchId=u,this.overlayMutation=c}}gi.store="documentOverlays",gi.keyPath=["userId","collectionPath","documentId"],gi.collectionPathOverlayIndex="collectionPathOverlayIndex",gi.collectionPathOverlayIndexPath=["userId","collectionPath","largestBatchId"],gi.collectionGroupOverlayIndex="collectionGroupOverlayIndex",gi.collectionGroupOverlayIndexPath=["userId","collectionGroup","largestBatchId"];const hR=[Ch.store,kn.store,is.store,gr.store,Qs.store,Ro.store,Po.store,Li.store,Pc.store,pl.store,Fp.store,L_.store,V_.store],fR=[...hR,gi.store],Dk=[...fR,Oo.store,ya.store,va.store],pR="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.";class gR{constructor(){this.onCommittedListeners=[]}addOnCommittedListener(e){this.onCommittedListeners.push(e)}raiseOnCommittedEvent(){this.onCommittedListeners.forEach(e=>e())}}class fe{constructor(e){this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,e(t=>{this.isDone=!0,this.result=t,this.nextCallback&&this.nextCallback(t)},t=>{this.isDone=!0,this.error=t,this.catchCallback&&this.catchCallback(t)})}catch(e){return this.next(void 0,e)}next(e,t){return this.callbackAttached&&ut(),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(t,this.error):this.wrapSuccess(e,this.result):new fe((r,o)=>{this.nextCallback=u=>{this.wrapSuccess(e,u).next(r,o)},this.catchCallback=u=>{this.wrapFailure(t,u).next(r,o)}})}toPromise(){return new Promise((e,t)=>{this.next(e,t)})}wrapUserFunction(e){try{const t=e();return t instanceof fe?t:fe.resolve(t)}catch(t){return fe.reject(t)}}wrapSuccess(e,t){return e?this.wrapUserFunction(()=>e(t)):fe.resolve(t)}wrapFailure(e,t){return e?this.wrapUserFunction(()=>e(t)):fe.reject(t)}static resolve(e){return new fe((t,r)=>{t(e)})}static reject(e){return new fe((t,r)=>{r(e)})}static waitFor(e){return new fe((t,r)=>{let o=0,u=0,c=!1;e.forEach(g=>{++o,g.next(()=>{++u,c&&u===o&&t()},E=>r(E))}),c=!0,u===o&&t()})}static or(e){let t=fe.resolve(!1);for(const r of e)t=t.next(o=>o?fe.resolve(o):r());return t}static forEach(e,t){const r=[];return e.forEach((o,u)=>{r.push(t.call(this,o,u))}),this.waitFor(r)}}class fD{constructor(e,t){this.action=e,this.transaction=t,this.aborted=!1,this.At=new ci,this.transaction.oncomplete=()=>{this.At.resolve()},this.transaction.onabort=()=>{t.error?this.At.reject(new f0(e,t.error)):this.At.resolve()},this.transaction.onerror=r=>{const o=dS(r.target.error);this.At.reject(new f0(e,o))}}static open(e,t,r,o){try{return new fD(t,e.transaction(o,r))}catch(u){throw new f0(t,u)}}get Rt(){return this.At.promise}abort(e){e&&this.At.reject(e),this.aborted||(Le("SimpleDb","Aborting transaction:",e?e.message:"Client-initiated abort"),this.aborted=!0,this.transaction.abort())}Pt(){const e=this.transaction;this.aborted||"function"!=typeof e.commit||e.commit()}store(e){const t=this.transaction.objectStore(e);return new Tk(t)}}class pu{constructor(e,t,r){this.name=e,this.version=t,this.bt=r,12.2===pu.vt((0,P.z$)())&&Fr("Firestore persistence suffers from a bug in iOS 12.2 Safari that may cause your app to stop working. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.")}static delete(e){return Le("SimpleDb","Removing database:",e),Vp(window.indexedDB.deleteDatabase(e)).toPromise()}static Vt(){if(!(0,P.hl)())return!1;if(pu.St())return!0;const e=(0,P.z$)(),t=pu.vt(e),r=0<t&&t<10,o=pu.Dt(e),u=0<o&&o<4.5;return!(e.indexOf("MSIE ")>0||e.indexOf("Trident/")>0||e.indexOf("Edge/")>0||r||u)}static St(){var e;return"undefined"!=typeof process&&"YES"===(null===(e=process.env)||void 0===e?void 0:e.Ct)}static Nt(e,t){return e.store(t)}static vt(e){const t=e.match(/i(?:phone|pad|pod) os ([\d_]+)/i),r=t?t[1].split("_").slice(0,2).join("."):"-1";return Number(r)}static Dt(e){const t=e.match(/Android ([\d.]+)/i),r=t?t[1].split(".").slice(0,2).join("."):"-1";return Number(r)}xt(e){var t=this;return(0,pe.Z)(function*(){return t.db||(Le("SimpleDb","Opening database:",t.name),t.db=yield new Promise((r,o)=>{const u=indexedDB.open(t.name,t.version);u.onsuccess=c=>{r(c.target.result)},u.onblocked=()=>{o(new f0(e,"Cannot upgrade IndexedDB schema while another tab is open. Close all tabs that access Firestore and reload this page to proceed."))},u.onerror=c=>{const g=c.target.error;o("VersionError"===g.name?new Me(ue.FAILED_PRECONDITION,"A newer version of the Firestore SDK was previously used and so the persisted data is not compatible with the version of the SDK you are now using. The SDK will operate with persistence disabled. If you need persistence, please re-upgrade to a newer version of the SDK or else clear the persisted IndexedDB data for your app to start fresh."):"InvalidStateError"===g.name?new Me(ue.FAILED_PRECONDITION,"Unable to open an IndexedDB connection. This could be due to running in a private browsing session on a browser whose private browsing sessions do not support IndexedDB: "+g):new f0(e,g))},u.onupgradeneeded=c=>{Le("SimpleDb",'Database "'+t.name+'" requires upgrade from version:',c.oldVersion),t.bt.kt(c.target.result,u.transaction,c.oldVersion,t.version).next(()=>{Le("SimpleDb","Database upgrade to version "+t.version+" complete")})}})),t.Ot&&(t.db.onversionchange=r=>t.Ot(r)),t.db})()}Mt(e){this.Ot=e,this.db&&(this.db.onversionchange=t=>e(t))}runTransaction(e,t,r,o){var u=this;return(0,pe.Z)(function*(){const c="readonly"===t;let g=0;for(;;){++g;try{u.db=yield u.xt(e);const E=fD.open(u.db,e,c?"readonly":"readwrite",r),I=o(E).next(S=>(E.Pt(),S)).catch(S=>(E.abort(S),fe.reject(S))).toPromise();return I.catch(()=>{}),yield E.Rt,I}catch(E){const I="FirebaseError"!==E.name&&g<3;if(Le("SimpleDb","Transaction failed with error:",E.message,"Retrying:",I),u.close(),!I)return Promise.reject(E)}}})()}close(){this.db&&this.db.close(),this.db=void 0}}class bk{constructor(e){this.$t=e,this.Ft=!1,this.Bt=null}get isDone(){return this.Ft}get Lt(){return this.Bt}set cursor(e){this.$t=e}done(){this.Ft=!0}Ut(e){this.Bt=e}delete(){return Vp(this.$t.delete())}}class f0 extends Me{constructor(e,t){super(ue.UNAVAILABLE,`IndexedDB transaction '${e}' failed: ${t}`),this.name="IndexedDbTransactionError"}}function Lp(n){return"IndexedDbTransactionError"===n.name}class Tk{constructor(e){this.store=e}put(e,t){let r;return void 0!==t?(Le("SimpleDb","PUT",this.store.name,e,t),r=this.store.put(t,e)):(Le("SimpleDb","PUT",this.store.name,"<auto-key>",e),r=this.store.put(e)),Vp(r)}add(e){return Le("SimpleDb","ADD",this.store.name,e,e),Vp(this.store.add(e))}get(e){return Vp(this.store.get(e)).next(t=>(void 0===t&&(t=null),Le("SimpleDb","GET",this.store.name,e,t),t))}delete(e){return Le("SimpleDb","DELETE",this.store.name,e),Vp(this.store.delete(e))}count(){return Le("SimpleDb","COUNT",this.store.name),Vp(this.store.count())}qt(e,t){const r=this.options(e,t);if(r.index||"function"!=typeof this.store.getAll){const o=this.cursor(r),u=[];return this.Kt(o,(c,g)=>{u.push(g)}).next(()=>u)}{const o=this.store.getAll(r.range);return new fe((u,c)=>{o.onerror=g=>{c(g.target.error)},o.onsuccess=g=>{u(g.target.result)}})}}Gt(e,t){Le("SimpleDb","DELETE ALL",this.store.name);const r=this.options(e,t);r.jt=!1;const o=this.cursor(r);return this.Kt(o,(u,c,g)=>g.delete())}Qt(e,t){let r;t?r=e:(r={},t=e);const o=this.cursor(r);return this.Kt(o,t)}Wt(e){const t=this.cursor({});return new fe((r,o)=>{t.onerror=u=>{const c=dS(u.target.error);o(c)},t.onsuccess=u=>{const c=u.target.result;c?e(c.primaryKey,c.value).next(g=>{g?c.continue():r()}):r()}})}Kt(e,t){const r=[];return new fe((o,u)=>{e.onerror=c=>{u(c.target.error)},e.onsuccess=c=>{const g=c.target.result;if(!g)return void o();const E=new bk(g),I=t(g.primaryKey,g.value,E);if(I instanceof fe){const S=I.catch(M=>(E.done(),fe.reject(M)));r.push(S)}E.isDone?o():null===E.Lt?g.continue():g.continue(E.Lt)}}).next(()=>fe.waitFor(r))}options(e,t){let r;return void 0!==e&&("string"==typeof e?r=e:t=e),{index:r,range:t}}cursor(e){let t="next";if(e.reverse&&(t="prev"),e.index){const r=this.store.index(e.index);return e.jt?r.openKeyCursor(e.range,t):r.openCursor(e.range,t)}return this.store.openCursor(e.range,t)}}function Vp(n){return new fe((e,t)=>{n.onsuccess=r=>{e(r.target.result)},n.onerror=r=>{const o=dS(r.target.error);t(o)}})}let mR=!1;function dS(n){const e=pu.vt((0,P.z$)());if(e>=12.2&&e<13){const t="An internal error was encountered in the Indexed Database server";if(n.message.indexOf(t)>=0){const r=new Me("internal",`IOS_INDEXEDDB_BUG1: IndexedDb has thrown '${t}'. This is likely due to an unavoidable bug in iOS. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.`);return mR||(mR=!0,setTimeout(()=>{throw r},0)),r}}return n}class _R extends gR{constructor(e,t){super(),this.zt=e,this.currentSequenceNumber=t}}function mi(n,e){const t=We(n);return pu.Nt(t.zt,e)}class hS{constructor(e,t,r,o){this.batchId=e,this.localWriteTime=t,this.baseMutations=r,this.mutations=o}applyToRemoteDocument(e,t){const r=t.mutationResults;for(let o=0;o<this.mutations.length;o++){const u=this.mutations[o];u.key.isEqual(e.key)&&JO(u,e,r[o])}}applyToLocalView(e){for(const t of this.baseMutations)t.key.isEqual(e.key)&&sS(t,e,this.localWriteTime);for(const t of this.mutations)t.key.isEqual(e.key)&&sS(t,e,this.localWriteTime)}applyToLocalDocumentSet(e){this.mutations.forEach(t=>{const r=e.get(t.key),o=r;this.applyToLocalView(o),r.isValidDocument()||o.convertToNoDocument(yt.min())})}keys(){return this.mutations.reduce((e,t)=>e.add(t.key),hn())}isEqual(e){return this.batchId===e.batchId&&D_(this.mutations,e.mutations,(t,r)=>jN(t,r))&&D_(this.baseMutations,e.baseMutations,(t,r)=>jN(t,r))}}class fS{constructor(e,t,r,o){this.batch=e,this.commitVersion=t,this.mutationResults=r,this.docVersions=o}static from(e,t,r){It(e.mutations.length===r.length);let o=rk;const u=e.mutations;for(let c=0;c<u.length;c++)o=o.insert(u[c].key,r[c].version);return new fS(e,t,r,o)}}class pS{constructor(e,t){this.largestBatchId=e,this.mutation=t}getKey(){return this.mutation.key}isEqual(e){return null!==e&&this.mutation===e.mutation}toString(){return`Overlay{\n      largestBatchId: ${this.largestBatchId},\n      mutation: ${this.mutation.toString()}\n    }`}}class Dh{constructor(e,t,r,o,u=yt.min(),c=yt.min(),g=Jr.EMPTY_BYTE_STRING){this.target=e,this.targetId=t,this.purpose=r,this.sequenceNumber=o,this.snapshotVersion=u,this.lastLimboFreeSnapshotVersion=c,this.resumeToken=g}withSequenceNumber(e){return new Dh(this.target,this.targetId,this.purpose,e,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken)}withResumeToken(e,t){return new Dh(this.target,this.targetId,this.purpose,this.sequenceNumber,t,this.lastLimboFreeSnapshotVersion,e)}withLastLimboFreeSnapshotVersion(e){return new Dh(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,e,this.resumeToken)}}class yR{constructor(e){this.Ht=e}}function vR(n,e){let t;if(e.document)t=sR(n.Ht,e.document,!!e.hasCommittedMutations);else if(e.noDocument){const r=Je.fromSegments(e.noDocument.path),o=Up(e.noDocument.readTime);t=sr.newNoDocument(r,o),e.hasCommittedMutations&&t.setHasCommittedMutations()}else{if(!e.unknownDocument)return ut();{const r=Je.fromSegments(e.unknownDocument.path),o=Up(e.unknownDocument.version);t=sr.newUnknownDocument(r,o)}}return e.readTime&&t.setReadTime(mS(e.readTime)),t}function ER(n,e){const t=gS(e.readTime),r=e.key.path.popLast().toArray();if(e.isFoundDocument()){const o={name:c0(c=n.Ht,(g=e).key),fields:g.data.value.mapValue.fields,updateTime:l0(c,g.version.toTimestamp())};return new gr(null,null,o,e.hasCommittedMutations,t,r)}var c,g;if(e.isNoDocument()){const o=e.key.path.toArray(),u=Bp(e.version),c=e.hasCommittedMutations;return new gr(null,new Ik(o,u),null,c,t,r)}if(e.isUnknownDocument()){const o=e.key.path.toArray(),u=Bp(e.version);return new gr(new Ck(o,u),null,null,!0,t,r)}return ut()}function gS(n){const e=n.toTimestamp();return[e.seconds,e.nanoseconds]}function mS(n){const e=new di(n[0],n[1]);return yt.fromTimestamp(e)}function Bp(n){const e=n.toTimestamp();return new wk(e.seconds,e.nanoseconds)}function Up(n){const e=new di(n.seconds,n.nanoseconds);return yt.fromTimestamp(e)}function B_(n,e){const t=(e.baseMutations||[]).map(u=>cS(n.Ht,u));for(let u=0;u<e.mutations.length-1;++u){const c=e.mutations[u];u+1<e.mutations.length&&void 0!==e.mutations[u+1].transform&&(c.updateTransforms=e.mutations[u+1].transform.fieldTransforms,e.mutations.splice(u+1,1),++u)}const r=e.mutations.map(u=>cS(n.Ht,u)),o=di.fromMillis(e.localWriteTimeMs);return new hS(e.batchId,o,t,r)}function p0(n){const e=Up(n.readTime),t=void 0!==n.lastLimboFreeSnapshotVersion?Up(n.lastLimboFreeSnapshotVersion):yt.min();let r;var o;return void 0!==n.query.documents?(It(1===(o=n.query).documents.length),r=ma(M_(nR(o.documents[0])))):r=ma(uR(n.query)),new Dh(r,n.targetId,0,n.lastListenSequenceNumber,e,t,Jr.fromBase64String(n.resumeToken))}function wR(n,e){const t=Bp(e.snapshotVersion),r=Bp(e.lastLimboFreeSnapshotVersion);let o;o=iD(e.target)?oR(n.Ht,e.target):aR(n.Ht,e.target);const u=e.resumeToken.toBase64();return new Qs(e.targetId,t0(e.target),t,u,e.sequenceNumber,r,o)}function _S(n){const e=uR({parent:n.parent,structuredQuery:n.structuredQuery});return"LAST"===n.limitType?MN(e,e.limit,"L"):e}function yS(n,e){return new pS(e.largestBatchId,cS(n.Ht,e.overlayMutation))}function IR(n,e){const t=e.path.lastSegment();return[n,pi(e.path.popLast()),t]}class Ak{getBundleMetadata(e,t){return CR(e).get(t).next(r=>{if(r)return{id:(o=r).bundleId,createTime:Up(o.createTime),version:o.version};var o})}saveBundleMetadata(e,t){return CR(e).put({bundleId:(r=t).id,createTime:Bp(fi(r.createTime)),version:r.version});var r}getNamedQuery(e,t){return DR(e).get(t).next(r=>{if(r)return{name:(o=r).name,query:_S(o.bundledQuery),readTime:Up(o.readTime)};var o})}saveNamedQuery(e,t){return DR(e).put({name:(r=t).name,readTime:Bp(fi(r.readTime)),bundledQuery:r.bundledQuery});var r}}function CR(n){return mi(n,L_.store)}function DR(n){return mi(n,V_.store)}class vS{constructor(e,t){this.O=e,this.userId=t}static Jt(e,t){return new vS(e,t.uid||"")}getOverlay(e,t){return g0(e).get(IR(this.userId,t)).next(r=>r?yS(this.O,r):null)}saveOverlays(e,t,r){const o=[];return r.forEach(u=>{const c=new pS(t,u);o.push(this.Yt(e,c))}),fe.waitFor(o)}removeOverlaysForBatchId(e,t,r){const o=new Set;t.forEach(c=>o.add(pi(c.getCollectionPath())));const u=[];return o.forEach(c=>{const g=IDBKeyRange.bound([this.userId,c,r],[this.userId,c,r+1],!1,!0);u.push(g0(e).Gt(gi.collectionPathOverlayIndex,g))}),fe.waitFor(u)}getOverlaysForCollection(e,t,r){const o=new Map,u=pi(t),c=IDBKeyRange.bound([this.userId,u,r],[this.userId,u,Number.POSITIVE_INFINITY],!0);return g0(e).qt(gi.collectionPathOverlayIndex,c).next(g=>{for(const E of g){const I=yS(this.O,E);o.set(I.getKey(),I)}return o})}getOverlaysForCollectionGroup(e,t,r,o){const u=new Map;let c;const g=IDBKeyRange.bound([this.userId,t,r],[this.userId,t,Number.POSITIVE_INFINITY],!0);return g0(e).Qt({index:gi.collectionGroupOverlayIndex,range:g},(E,I,S)=>{const M=yS(this.O,I);u.size<o||M.largestBatchId===c?(u.set(M.getKey(),M),c=M.largestBatchId):S.done()}).next(()=>u)}Yt(e,t){return g0(e).put(function(r,o,u){const[c,g,E]=IR(o,u.mutation.key);return new gi(o,g,E,u.mutation.key.getCollectionGroup(),u.largestBatchId,h0(r.Ht,u.mutation))}(this.O,this.userId,t))}}function g0(n){return mi(n,gi.store)}class pD{constructor(){}Xt(e,t){this.Zt(e,t),t.te()}Zt(e,t){if("nullValue"in e)this.ee(t,5);else if("booleanValue"in e)this.ee(t,10),t.ne(e.booleanValue?1:0);else if("integerValue"in e)this.ee(t,15),t.ne(pr(e.integerValue));else if("doubleValue"in e){const r=pr(e.doubleValue);isNaN(r)?this.ee(t,13):(this.ee(t,15),QE(r)?t.ne(0):t.ne(r))}else if("timestampValue"in e){const r=e.timestampValue;this.ee(t,20),"string"==typeof r?t.se(r):(t.se(`${r.seconds||""}`),t.ne(r.nanos||0))}else if("stringValue"in e)this.ie(e.stringValue,t),this.re(t);else if("bytesValue"in e)this.ee(t,30),t.oe(xp(e.bytesValue)),this.re(t);else if("referenceValue"in e)this.ce(e.referenceValue,t);else if("geoPointValue"in e){const r=e.geoPointValue;this.ee(t,45),t.ne(r.latitude||0),t.ne(r.longitude||0)}else"mapValue"in e?fu(e,FO)?this.ee(t,Number.MAX_SAFE_INTEGER):(this.ue(e.mapValue,t),this.re(t)):"arrayValue"in e?(this.ae(e.arrayValue,t),this.re(t)):ut()}ie(e,t){this.ee(t,25),this.he(e,t)}he(e,t){t.se(e)}ue(e,t){const r=e.fields||{};this.ee(t,55);for(const o of Object.keys(r))this.ie(o,t),this.Zt(r[o],t)}ae(e,t){const r=e.values||[];this.ee(t,50);for(const o of r)this.Zt(o,t)}ce(e,t){this.ee(t,37),Je.fromName(e).path.forEach(r=>{this.ee(t,60),this.he(r,t)})}ee(e,t){e.ne(t)}re(e){e.ne(2)}}function Sk(n){if(0===n)return 8;let e=0;return n>>4==0&&(e+=4,n<<=4),n>>6==0&&(e+=2,n<<=2),n>>7==0&&(e+=1),e}function bR(n){const e=64-function(t){let r=0;for(let o=0;o<8;++o){const u=Sk(255&t[o]);if(r+=u,8!==u)break}return r}(n);return Math.ceil(e/8)}pD.le=new pD;class xk{constructor(){this.buffer=new Uint8Array(1024),this.position=0}fe(e){const t=e[Symbol.iterator]();let r=t.next();for(;!r.done;)this.de(r.value),r=t.next();this._e()}we(e){const t=e[Symbol.iterator]();let r=t.next();for(;!r.done;)this.me(r.value),r=t.next();this.ge()}ye(e){for(const t of e){const r=t.charCodeAt(0);if(r<128)this.de(r);else if(r<2048)this.de(960|r>>>6),this.de(128|63&r);else if(t<"\ud800"||"\udbff"<t)this.de(480|r>>>12),this.de(128|63&r>>>6),this.de(128|63&r);else{const o=t.codePointAt(0);this.de(240|o>>>18),this.de(128|63&o>>>12),this.de(128|63&o>>>6),this.de(128|63&o)}}this._e()}pe(e){for(const t of e){const r=t.charCodeAt(0);if(r<128)this.me(r);else if(r<2048)this.me(960|r>>>6),this.me(128|63&r);else if(t<"\ud800"||"\udbff"<t)this.me(480|r>>>12),this.me(128|63&r>>>6),this.me(128|63&r);else{const o=t.codePointAt(0);this.me(240|o>>>18),this.me(128|63&o>>>12),this.me(128|63&o>>>6),this.me(128|63&o)}}this.ge()}Ie(e){const t=this.Ee(e),r=bR(t);this.Te(1+r),this.buffer[this.position++]=255&r;for(let o=t.length-r;o<t.length;++o)this.buffer[this.position++]=255&t[o]}Ae(e){const t=this.Ee(e),r=bR(t);this.Te(1+r),this.buffer[this.position++]=~(255&r);for(let o=t.length-r;o<t.length;++o)this.buffer[this.position++]=~(255&t[o])}Re(){this.Pe(255),this.Pe(255)}be(){this.ve(255),this.ve(255)}reset(){this.position=0}seed(e){this.Te(e.length),this.buffer.set(e,this.position),this.position+=e.length}Ve(){return this.buffer.slice(0,this.position)}Ee(e){const t=function(o){const u=new DataView(new ArrayBuffer(8));return u.setFloat64(0,o,!1),new Uint8Array(u.buffer)}(e),r=0!=(128&t[0]);t[0]^=r?255:128;for(let o=1;o<t.length;++o)t[o]^=r?255:0;return t}de(e){const t=255&e;0===t?(this.Pe(0),this.Pe(255)):255===t?(this.Pe(255),this.Pe(0)):this.Pe(t)}me(e){const t=255&e;0===t?(this.ve(0),this.ve(255)):255===t?(this.ve(255),this.ve(0)):this.ve(e)}_e(){this.Pe(0),this.Pe(1)}ge(){this.ve(0),this.ve(1)}Pe(e){this.Te(1),this.buffer[this.position++]=e}ve(e){this.Te(1),this.buffer[this.position++]=~e}Te(e){const t=e+this.position;if(t<=this.buffer.length)return;let r=2*this.buffer.length;r<t&&(r=t);const o=new Uint8Array(r);o.set(this.buffer),this.buffer=o}}class Mk{constructor(e){this.Se=e}oe(e){this.Se.fe(e)}se(e){this.Se.ye(e)}ne(e){this.Se.Ie(e)}te(){this.Se.Re()}}class Nk{constructor(e){this.Se=e}oe(e){this.Se.we(e)}se(e){this.Se.pe(e)}ne(e){this.Se.Ae(e)}te(){this.Se.be()}}class TR{constructor(){this.Se=new xk,this.De=new Mk(this.Se),this.Ce=new Nk(this.Se)}seed(e){this.Se.seed(e)}Ne(e){return 0===e?this.De:this.Ce}Ve(){return this.Se.Ve()}reset(){this.Se.reset()}}class ES{constructor(e,t,r,o){this.indexId=e,this.documentKey=t,this.arrayValue=r,this.directionalValue=o}}function wS(n,e){let t=n.indexId-e.indexId;return 0!==t?t:(t=Je.comparator(n.documentKey,e.documentKey),0!==t?t:(t=AR(n.arrayValue,e.arrayValue),0!==t?t:AR(n.directionalValue,e.directionalValue)))}function AR(n,e){for(let t=0;t<n.length&&t<e.length;++t){const r=n[t]-e[t];if(0!==r)return r}return n.length-e.length}class Rk{constructor(){this.xe=new IS}addToCollectionParentIndex(e,t){return this.xe.add(t),fe.resolve()}getCollectionParents(e,t){return fe.resolve(this.xe.getEntries(t))}addFieldIndex(e,t){return fe.resolve()}deleteFieldIndex(e,t){return fe.resolve()}getDocumentsMatchingTarget(e,t,r){return fe.resolve(hn())}getFieldIndex(e,t){return fe.resolve(null)}getFieldIndexes(e,t){return fe.resolve([])}getNextCollectionGroupToUpdate(e){return fe.resolve(null)}updateCollectionGroup(e,t,r){return fe.resolve()}updateIndexEntries(e,t){return fe.resolve()}}class IS{constructor(){this.index={}}add(e){const t=e.lastSegment(),r=e.popLast(),o=this.index[t]||new Zn(rn.comparator),u=!o.has(r);return this.index[t]=o.add(r),u}has(e){const t=e.lastSegment(),r=e.popLast(),o=this.index[t];return o&&o.has(r)}getEntries(e){return(this.index[e]||new Zn(rn.comparator)).toArray()}}class Pk{constructor(e){this.user=e,this.ke=new IS,this.uid=e.uid||""}addToCollectionParentIndex(e,t){if(!this.ke.has(t)){const r=t.lastSegment(),o=t.popLast();e.addOnCommittedListener(()=>{this.ke.add(t)});const u={collectionId:r,parent:pi(o)};return SR(e).put(u)}return fe.resolve()}getCollectionParents(e,t){const r=[],o=IDBKeyRange.bound([t,""],[mN(t),""],!1,!0);return SR(e).qt(o).next(u=>{for(const c of u){if(c.collectionId!==t)break;r.push(fl(c.parent))}return r})}addFieldIndex(e,t){const r=mD(e),o=new Oo((u=t).indexId,u.collectionGroup,u.fields.map(c=>[c.fieldPath.canonicalString(),c.kind]));var u;return delete o.indexId,r.add(o).next()}deleteFieldIndex(e,t){const r=mD(e),o=_D(e),u=gD(e);return r.delete(t.indexId).next(()=>o.delete(IDBKeyRange.bound([t.indexId],[t.indexId+1],!1,!0))).next(()=>u.delete(IDBKeyRange.bound([t.indexId],[t.indexId+1],!1,!0)))}getDocumentsMatchingTarget(e,t,r){return fe.resolve(hn())}getFieldIndex(e,t){return fe.resolve(null)}Oe(e,t){const r=new TR;for(const o of e.fields.filter(c=>2!==c.kind)){const u=t.data.field(o.fieldPath);if(null==u)return null;const c=r.Ne(o.kind);pD.le.Xt(u,c)}return r.Ve()}Me(e){const t=new TR;return pD.le.Xt(e,t.Ne(0)),t.Ve()}getFieldIndexes(e,t){const r=mD(e),o=_D(e);return(t?r.qt(Oo.collectionGroupIndex,IDBKeyRange.bound(t,t)):r.qt()).next(u=>{const c=[];return fe.forEach(u,g=>o.get([g.indexId,this.uid]).next(E=>{c.push(function(I,S){const M=S?new e0(S.sequenceNumber,new nD(Up(S.readTime),new Je(fl(S.documentKey)),S.largestBatchId)):e0.empty(),F=I.fields.map(([W,Y])=>new tD(hi.fromServerFormat(W),Y));return new XA(I.indexId,I.collectionGroup,F,M)}(g,E))})).next(()=>c)})}getNextCollectionGroupToUpdate(e){return this.getFieldIndexes(e).next(t=>0===t.length?null:(t.sort((r,o)=>r.indexState.sequenceNumber-o.indexState.sequenceNumber),t[0].collectionGroup))}updateCollectionGroup(e,t,r){const o=mD(e),u=_D(e);return this.$e(e).next(c=>o.qt(Oo.collectionGroupIndex,IDBKeyRange.bound(t,t)).next(g=>fe.forEach(g,E=>{return u.put(new ya(E.indexId,this.user.uid||"",c,Bp((F=r).readTime),pi(F.documentKey.path),F.largestBatchId));var F})))}updateIndexEntries(e,t){const r=new Map;return fe.forEach(t,(o,u)=>{const c=r.get(o.collectionGroup);return(c?fe.resolve(c):this.getFieldIndexes(e,o.collectionGroup)).next(g=>(r.set(o.collectionGroup,g),fe.forEach(g,E=>this.Fe(e,o,E).next(I=>{const S=this.Be(u,E);return I.isEqual(S)?fe.resolve():this.Le(e,u,I,S)}))))})}Ue(e,t,r){return gD(e).put(new va(r.indexId,this.uid,r.arrayValue,r.directionalValue,pi(t.key.path)))}qe(e,t,r){return gD(e).delete([r.indexId,this.uid,r.arrayValue,r.directionalValue,pi(t.key.path)])}Fe(e,t,r){const o=gD(e);let u=new Zn(wS);return o.Qt({index:va.documentKeyIndex,range:IDBKeyRange.only([r.indexId,this.uid,pi(t.path)])},(c,g)=>{u=u.add(new ES(r.indexId,t,g.arrayValue,g.directionalValue))}).next(()=>u)}Be(e,t){let r=new Zn(wS);const o=this.Oe(t,e);if(null==o)return r;const u=t.fields.find(g=>2===g.kind);if(null!=u){const c=e.data.field(u.fieldPath);if(XC(c))for(const g of c.arrayValue.values||[])r=r.add(new ES(t.indexId,e.key,this.Me(g),o))}else r=r.add(new ES(t.indexId,e.key,new Uint8Array,o));return r}Le(e,t,r,o){Le("IndexedDbIndexManager","Updating index entries for document '%s'",t.key);const u=[];return function(c,g,E,I,S){const M=c.getIterator(),F=g.getIterator();let W=O_(M),Y=O_(F);for(;W||Y;){let xe=!1,qe=!1;if(W&&Y){const Pt=E(W,Y);Pt<0?qe=!0:Pt>0&&(xe=!0)}else null!=W?qe=!0:xe=!0;xe?(I(Y),Y=O_(F)):qe?(S(W),W=O_(M)):(W=O_(M),Y=O_(F))}}(r,o,wS,c=>{u.push(this.Ue(e,t,c))},c=>{u.push(this.qe(e,t,c))}),fe.waitFor(u)}$e(e){let t=1;return _D(e).Qt({index:ya.sequenceNumberIndex,reverse:!0,range:IDBKeyRange.upperBound([this.uid,Number.MAX_SAFE_INTEGER])},(r,o,u)=>{u.done(),t=o.sequenceNumber+1}).next(()=>t)}}function SR(n){return mi(n,Fp.store)}function gD(n){return mi(n,va.store)}function mD(n){return mi(n,Oo.store)}function _D(n){return mi(n,ya.store)}const xR={didRun:!1,sequenceNumbersCollected:0,targetsRemoved:0,documentsRemoved:0};class Js{constructor(e,t,r){this.cacheSizeCollectionThreshold=e,this.percentileToCollect=t,this.maximumSequenceNumbersToCollect=r}static withCacheSize(e){return new Js(e,Js.DEFAULT_COLLECTION_PERCENTILE,Js.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT)}}function MR(n,e,t){const r=n.store(kn.store),o=n.store(is.store),u=[],c=IDBKeyRange.only(t.batchId);let g=0;const E=r.Qt({range:c},(S,M,F)=>(g++,F.delete()));u.push(E.next(()=>{It(1===g)}));const I=[];for(const S of t.mutations){const M=is.key(e,S.key.path,t.batchId);u.push(o.delete(M)),I.push(S.key)}return fe.waitFor(u).next(()=>I)}function yD(n){if(!n)return 0;let e;if(n.document)e=n.document;else if(n.unknownDocument)e=n.unknownDocument;else{if(!n.noDocument)throw ut();e=n.noDocument}return JSON.stringify(e).length}Js.DEFAULT_COLLECTION_PERCENTILE=10,Js.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT=1e3,Js.DEFAULT=new Js(41943040,Js.DEFAULT_COLLECTION_PERCENTILE,Js.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT),Js.DISABLED=new Js(-1,0,0);class CS{constructor(e,t,r,o){this.userId=e,this.O=t,this.indexManager=r,this.referenceDelegate=o,this.Ke={}}static Jt(e,t,r,o){It(""!==e.uid);const u=e.isAuthenticated()?e.uid:"";return new CS(u,t,r,o)}checkEmpty(e){let t=!0;const r=IDBKeyRange.bound([this.userId,Number.NEGATIVE_INFINITY],[this.userId,Number.POSITIVE_INFINITY]);return bh(e).Qt({index:kn.userMutationsIndex,range:r},(o,u,c)=>{t=!1,c.done()}).next(()=>t)}addMutationBatch(e,t,r,o){const u=U_(e),c=bh(e);return c.add({}).next(g=>{It("number"==typeof g);const E=new hS(g,t,r,o),I=function(F,W,Y){const xe=Y.baseMutations.map(Pt=>h0(F.Ht,Pt)),qe=Y.mutations.map(Pt=>h0(F.Ht,Pt));return new kn(W,Y.batchId,Y.localWriteTime.toMillis(),xe,qe)}(this.O,this.userId,E),S=[];let M=new Zn((F,W)=>Gt(F.canonicalString(),W.canonicalString()));for(const F of o){const W=is.key(this.userId,F.key.path,g);M=M.add(F.key.path.popLast()),S.push(c.put(I)),S.push(u.put(W,is.PLACEHOLDER))}return M.forEach(F=>{S.push(this.indexManager.addToCollectionParentIndex(e,F))}),e.addOnCommittedListener(()=>{this.Ke[g]=E.keys()}),fe.waitFor(S).next(()=>E)})}lookupMutationBatch(e,t){return bh(e).get(t).next(r=>r?(It(r.userId===this.userId),B_(this.O,r)):null)}Ge(e,t){return this.Ke[t]?fe.resolve(this.Ke[t]):this.lookupMutationBatch(e,t).next(r=>{if(r){const o=r.keys();return this.Ke[t]=o,o}return null})}getNextMutationBatchAfterBatchId(e,t){const r=t+1,o=IDBKeyRange.lowerBound([this.userId,r]);let u=null;return bh(e).Qt({index:kn.userMutationsIndex,range:o},(c,g,E)=>{g.userId===this.userId&&(It(g.batchId>=r),u=B_(this.O,g)),E.done()}).next(()=>u)}getHighestUnacknowledgedBatchId(e){const t=IDBKeyRange.upperBound([this.userId,Number.POSITIVE_INFINITY]);let r=-1;return bh(e).Qt({index:kn.userMutationsIndex,range:t,reverse:!0},(o,u,c)=>{r=u.batchId,c.done()}).next(()=>r)}getAllMutationBatches(e){const t=IDBKeyRange.bound([this.userId,-1],[this.userId,Number.POSITIVE_INFINITY]);return bh(e).qt(kn.userMutationsIndex,t).next(r=>r.map(o=>B_(this.O,o)))}getAllMutationBatchesAffectingDocumentKey(e,t){const r=is.prefixForPath(this.userId,t.path),o=IDBKeyRange.lowerBound(r),u=[];return U_(e).Qt({range:o},(c,g,E)=>{const[I,S,M]=c,F=fl(S);if(I===this.userId&&t.path.isEqual(F))return bh(e).get(M).next(W=>{if(!W)throw ut();It(W.userId===this.userId),u.push(B_(this.O,W))});E.done()}).next(()=>u)}getAllMutationBatchesAffectingDocumentKeys(e,t){let r=new Zn(Gt);const o=[];return t.forEach(u=>{const c=is.prefixForPath(this.userId,u.path),g=IDBKeyRange.lowerBound(c),E=U_(e).Qt({range:g},(I,S,M)=>{const[F,W,Y]=I,xe=fl(W);F===this.userId&&u.path.isEqual(xe)?r=r.add(Y):M.done()});o.push(E)}),fe.waitFor(o).next(()=>this.je(e,r))}getAllMutationBatchesAffectingQuery(e,t){const r=t.path,o=r.length+1,u=is.prefixForPath(this.userId,r),c=IDBKeyRange.lowerBound(u);let g=new Zn(Gt);return U_(e).Qt({range:c},(E,I,S)=>{const[M,F,W]=E,Y=fl(F);M===this.userId&&r.isPrefixOf(Y)?Y.length===o&&(g=g.add(W)):S.done()}).next(()=>this.je(e,g))}je(e,t){const r=[],o=[];return t.forEach(u=>{o.push(bh(e).get(u).next(c=>{if(null===c)throw ut();It(c.userId===this.userId),r.push(B_(this.O,c))}))}),fe.waitFor(o).next(()=>r)}removeMutationBatch(e,t){return MR(e.zt,this.userId,t).next(r=>(e.addOnCommittedListener(()=>{this.Qe(t.batchId)}),fe.forEach(r,o=>this.referenceDelegate.markPotentiallyOrphaned(e,o))))}Qe(e){delete this.Ke[e]}performConsistencyCheck(e){return this.checkEmpty(e).next(t=>{if(!t)return fe.resolve();const r=IDBKeyRange.lowerBound(is.prefixForUser(this.userId)),o=[];return U_(e).Qt({range:r},(u,c,g)=>{if(u[0]===this.userId){const E=fl(u[1]);o.push(E)}else g.done()}).next(()=>{It(0===o.length)})})}containsKey(e,t){return NR(e,this.userId,t)}We(e){return RR(e).get(this.userId).next(t=>t||new Ch(this.userId,-1,""))}}function NR(n,e,t){const r=is.prefixForPath(e,t.path),o=r[1],u=IDBKeyRange.lowerBound(r);let c=!1;return U_(n).Qt({range:u,jt:!0},(g,E,I)=>{const[S,M,F]=g;S===e&&M===o&&(c=!0),I.done()}).next(()=>c)}function bh(n){return mi(n,kn.store)}function U_(n){return mi(n,is.store)}function RR(n){return mi(n,Ch.store)}class jp{constructor(e){this.ze=e}next(){return this.ze+=2,this.ze}static He(){return new jp(0)}static Je(){return new jp(-1)}}class Ok{constructor(e,t){this.referenceDelegate=e,this.O=t}allocateTargetId(e){return this.Ye(e).next(t=>{const r=new jp(t.highestTargetId);return t.highestTargetId=r.next(),this.Xe(e,t).next(()=>t.highestTargetId)})}getLastRemoteSnapshotVersion(e){return this.Ye(e).next(t=>yt.fromTimestamp(new di(t.lastRemoteSnapshotVersion.seconds,t.lastRemoteSnapshotVersion.nanoseconds)))}getHighestSequenceNumber(e){return this.Ye(e).next(t=>t.highestListenSequenceNumber)}setTargetsMetadata(e,t,r){return this.Ye(e).next(o=>(o.highestListenSequenceNumber=t,r&&(o.lastRemoteSnapshotVersion=r.toTimestamp()),t>o.highestListenSequenceNumber&&(o.highestListenSequenceNumber=t),this.Xe(e,o)))}addTargetData(e,t){return this.Ze(e,t).next(()=>this.Ye(e).next(r=>(r.targetCount+=1,this.tn(t,r),this.Xe(e,r))))}updateTargetData(e,t){return this.Ze(e,t)}removeTargetData(e,t){return this.removeMatchingKeysForTargetId(e,t.targetId).next(()=>j_(e).delete(t.targetId)).next(()=>this.Ye(e)).next(r=>(It(r.targetCount>0),r.targetCount-=1,this.Xe(e,r)))}removeTargets(e,t,r){let o=0;const u=[];return j_(e).Qt((c,g)=>{const E=p0(g);E.sequenceNumber<=t&&null===r.get(E.targetId)&&(o++,u.push(this.removeTargetData(e,E)))}).next(()=>fe.waitFor(u)).next(()=>o)}forEachTarget(e,t){return j_(e).Qt((r,o)=>{const u=p0(o);t(u)})}Ye(e){return PR(e).get(Po.key).next(t=>(It(null!==t),t))}Xe(e,t){return PR(e).put(Po.key,t)}Ze(e,t){return j_(e).put(wR(this.O,t))}tn(e,t){let r=!1;return e.targetId>t.highestTargetId&&(t.highestTargetId=e.targetId,r=!0),e.sequenceNumber>t.highestListenSequenceNumber&&(t.highestListenSequenceNumber=e.sequenceNumber,r=!0),r}getTargetCount(e){return this.Ye(e).next(t=>t.targetCount)}getTargetData(e,t){const r=t0(t),o=IDBKeyRange.bound([r,Number.NEGATIVE_INFINITY],[r,Number.POSITIVE_INFINITY]);let u=null;return j_(e).Qt({range:o,index:Qs.queryTargetsIndexName},(c,g,E)=>{const I=p0(g);rD(t,I.target)&&(u=I,E.done())}).next(()=>u)}addMatchingKeys(e,t,r){const o=[],u=Th(e);return t.forEach(c=>{const g=pi(c.path);o.push(u.put(new Li(r,g))),o.push(this.referenceDelegate.addReference(e,r,c))}),fe.waitFor(o)}removeMatchingKeys(e,t,r){const o=Th(e);return fe.forEach(t,u=>{const c=pi(u.path);return fe.waitFor([o.delete([r,c]),this.referenceDelegate.removeReference(e,r,u)])})}removeMatchingKeysForTargetId(e,t){const r=Th(e),o=IDBKeyRange.bound([t],[t+1],!1,!0);return r.delete(o)}getMatchingKeysForTargetId(e,t){const r=IDBKeyRange.bound([t],[t+1],!1,!0),o=Th(e);let u=hn();return o.Qt({range:r,jt:!0},(c,g,E)=>{const I=fl(c[1]),S=new Je(I);u=u.add(S)}).next(()=>u)}containsKey(e,t){const r=pi(t.path),o=IDBKeyRange.bound([r],[mN(r)],!1,!0);let u=0;return Th(e).Qt({index:Li.documentTargetsIndex,jt:!0,range:o},([c,g],E,I)=>{0!==c&&(u++,I.done())}).next(()=>u>0)}Tt(e,t){return j_(e).get(t).next(r=>r?p0(r):null)}}function j_(n){return mi(n,Qs.store)}function PR(n){return mi(n,Po.store)}function Th(n){return mi(n,Li.store)}function Hp(n){return DS.apply(this,arguments)}function DS(){return DS=(0,pe.Z)(function*(n){if(n.code!==ue.FAILED_PRECONDITION||n.message!==pR)throw n;Le("LocalStore","Unexpectedly lost primary lease")}),DS.apply(this,arguments)}function OR([n,e],[t,r]){const o=Gt(n,t);return 0===o?Gt(e,r):o}class kk{constructor(e){this.en=e,this.buffer=new Zn(OR),this.nn=0}sn(){return++this.nn}rn(e){const t=[e,this.sn()];if(this.buffer.size<this.en)this.buffer=this.buffer.add(t);else{const r=this.buffer.last();OR(t,r)<0&&(this.buffer=this.buffer.delete(r).add(t))}}get maxValue(){return this.buffer.last()[0]}}class Fk{constructor(e,t){this.garbageCollector=e,this.asyncQueue=t,this.on=!1,this.cn=null}start(e){-1!==this.garbageCollector.params.cacheSizeCollectionThreshold&&this.un(e)}stop(){this.cn&&(this.cn.cancel(),this.cn=null)}get started(){return null!==this.cn}un(e){var t=this;const r=this.on?3e5:6e4;Le("LruGarbageCollector",`Garbage collection scheduled in ${r}ms`),this.cn=this.asyncQueue.enqueueAfterDelay("lru_garbage_collection",r,(0,pe.Z)(function*(){t.cn=null,t.on=!0;try{yield e.collectGarbage(t.garbageCollector)}catch(o){Lp(o)?Le("LruGarbageCollector","Ignoring IndexedDB error during garbage collection: ",o):yield Hp(o)}yield t.un(e)}))}}class Lk{constructor(e,t){this.an=e,this.params=t}calculateTargetCount(e,t){return this.an.hn(e).next(r=>Math.floor(t/100*r))}nthSequenceNumber(e,t){if(0===t)return fe.resolve(No.A);const r=new kk(t);return this.an.forEachTarget(e,o=>r.rn(o.sequenceNumber)).next(()=>this.an.ln(e,o=>r.rn(o))).next(()=>r.maxValue)}removeTargets(e,t,r){return this.an.removeTargets(e,t,r)}removeOrphanedDocuments(e,t){return this.an.removeOrphanedDocuments(e,t)}collect(e,t){return-1===this.params.cacheSizeCollectionThreshold?(Le("LruGarbageCollector","Garbage collection skipped; disabled"),fe.resolve(xR)):this.getCacheSize(e).next(r=>r<this.params.cacheSizeCollectionThreshold?(Le("LruGarbageCollector",`Garbage collection skipped; Cache size ${r} is lower than threshold ${this.params.cacheSizeCollectionThreshold}`),xR):this.fn(e,t))}getCacheSize(e){return this.an.getCacheSize(e)}fn(e,t){let r,o,u,c,g,E,I;const S=Date.now();return this.calculateTargetCount(e,this.params.percentileToCollect).next(M=>(M>this.params.maximumSequenceNumbersToCollect?(Le("LruGarbageCollector",`Capping sequence numbers to collect down to the maximum of ${this.params.maximumSequenceNumbersToCollect} from ${M}`),o=this.params.maximumSequenceNumbersToCollect):o=M,c=Date.now(),this.nthSequenceNumber(e,o))).next(M=>(r=M,g=Date.now(),this.removeTargets(e,r,t))).next(M=>(u=M,E=Date.now(),this.removeOrphanedDocuments(e,r))).next(M=>(I=Date.now(),KA()<=vs.in.DEBUG&&Le("LruGarbageCollector",`LRU Garbage Collection\n\tCounted targets in ${c-S}ms\n\tDetermined least recently used ${o} in `+(g-c)+`ms\n\tRemoved ${u} targets in `+(E-g)+`ms\n\tRemoved ${M} documents in `+(I-E)+`ms\nTotal Duration: ${I-S}ms`),fe.resolve({didRun:!0,sequenceNumbersCollected:o,targetsRemoved:u,documentsRemoved:M})))}}class Vk{constructor(e,t){this.db=e,this.garbageCollector=new Lk(this,t)}hn(e){const t=this.dn(e);return this.db.getTargetCache().getTargetCount(e).next(r=>t.next(o=>r+o))}dn(e){let t=0;return this.ln(e,r=>{t++}).next(()=>t)}forEachTarget(e,t){return this.db.getTargetCache().forEachTarget(e,t)}ln(e,t){return this._n(e,(r,o)=>t(o))}addReference(e,t,r){return vD(e,r)}removeReference(e,t,r){return vD(e,r)}removeTargets(e,t,r){return this.db.getTargetCache().removeTargets(e,t,r)}markPotentiallyOrphaned(e,t){return vD(e,t)}wn(e,t){return function(r,o){let u=!1;return RR(r).Wt(c=>NR(r,c,o).next(g=>(g&&(u=!0),fe.resolve(!g)))).next(()=>u)}(e,t)}removeOrphanedDocuments(e,t){const r=this.db.getRemoteDocumentCache().newChangeBuffer(),o=[];let u=0;return this._n(e,(c,g)=>{if(g<=t){const E=this.wn(e,c).next(I=>{if(!I)return u++,r.getEntry(e,c).next(()=>(r.removeEntry(c,yt.min()),Th(e).delete([0,pi(c.path)])))});o.push(E)}}).next(()=>fe.waitFor(o)).next(()=>r.apply(e)).next(()=>u)}removeTarget(e,t){const r=t.withSequenceNumber(e.currentSequenceNumber);return this.db.getTargetCache().updateTargetData(e,r)}updateLimboDocument(e,t){return vD(e,t)}_n(e,t){const r=Th(e);let o,u=No.A;return r.Qt({index:Li.documentTargetsIndex},([c,g],{path:E,sequenceNumber:I})=>{0===c?(u!==No.A&&t(new Je(fl(o)),u),u=I,o=E):u=No.A}).next(()=>{u!==No.A&&t(new Je(fl(o)),u)})}getCacheSize(e){return this.db.getRemoteDocumentCache().getSize(e)}}function vD(n,e){return Th(n).put((r=n.currentSequenceNumber,new Li(0,pi(e.path),r)));var r}class H_{constructor(e,t){this.mapKeyFn=e,this.equalsFn=t,this.inner={}}get(e){const t=this.mapKeyFn(e),r=this.inner[t];if(void 0!==r)for(const[o,u]of r)if(this.equalsFn(o,e))return u}has(e){return void 0!==this.get(e)}set(e,t){const r=this.mapKeyFn(e),o=this.inner[r];if(void 0!==o){for(let u=0;u<o.length;u++)if(this.equalsFn(o[u][0],e))return void(o[u]=[e,t]);o.push([e,t])}else this.inner[r]=[[e,t]]}delete(e){const t=this.mapKeyFn(e),r=this.inner[t];if(void 0===r)return!1;for(let o=0;o<r.length;o++)if(this.equalsFn(r[o][0],e))return 1===r.length?delete this.inner[t]:r.splice(o,1),!0;return!1}forEach(e){Sp(this.inner,(t,r)=>{for(const[o,u]of r)e(o,u)})}isEmpty(){return yN(this.inner)}}class kR{constructor(){this.changes=new H_(e=>e.toString(),(e,t)=>e.isEqual(t)),this.changesApplied=!1}addEntry(e){this.assertNotApplied(),this.changes.set(e.key,e)}removeEntry(e,t){this.assertNotApplied(),this.changes.set(e,sr.newInvalidDocument(e).setReadTime(t))}getEntry(e,t){this.assertNotApplied();const r=this.changes.get(t);return void 0!==r?fe.resolve(r):this.getFromCache(e,t)}getEntries(e,t){return this.getAllFromCache(e,t)}apply(e){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(e)}assertNotApplied(){}}class Bk{constructor(e){this.O=e}setIndexManager(e){this.indexManager=e}addEntry(e,t,r){return Ah(e).put(ED(t),r)}removeEntry(e,t){const r=Ah(e),o=ED(t);return r.delete(o)}updateMetadata(e,t){return this.getMetadata(e).next(r=>(r.byteSize+=t,this.mn(e,r)))}getEntry(e,t){return Ah(e).get(ED(t)).next(r=>this.gn(t,r))}yn(e,t){return Ah(e).get(ED(t)).next(r=>({document:this.gn(t,r),size:yD(r)}))}getEntries(e,t){let r=_a();return this.pn(e,t,(o,u)=>{const c=this.gn(o,u);r=r.insert(o,c)}).next(()=>r)}In(e,t){let r=_a(),o=new Er(Je.comparator);return this.pn(e,t,(u,c)=>{const g=this.gn(u,c);r=r.insert(u,g),o=o.insert(u,yD(c))}).next(()=>({documents:r,En:o}))}pn(e,t,r){if(t.isEmpty())return fe.resolve();const o=IDBKeyRange.bound(t.first().path.toArray(),t.last().path.toArray()),u=t.getIterator();let c=u.getNext();return Ah(e).Qt({range:o},(g,E,I)=>{const S=Je.fromSegments(g);for(;c&&Je.comparator(c,S)<0;)r(c,null),c=u.getNext();c&&c.isEqual(S)&&(r(c,E),c=u.hasNext()?u.getNext():null),c?I.Ut(c.path.toArray()):I.done()}).next(()=>{for(;c;)r(c,null),c=u.hasNext()?u.getNext():null})}getAll(e,t,r){let o=_a();const u=t.length+1,c={};if(r.isEqual(yt.min())){const g=t.toArray();c.range=IDBKeyRange.lowerBound(g)}else{const g=t.toArray(),E=gS(r);c.range=IDBKeyRange.lowerBound([g,E],!0),c.index=gr.collectionReadTimeIndex}return Ah(e).Qt(c,(g,E,I)=>{if(g.length!==u)return;const S=this.gn(Je.fromSegments(g),E);t.isPrefixOf(S.key.path)?o=o.insert(S.key,S):I.done()}).next(()=>o)}newChangeBuffer(e){return new Uk(this,!!e&&e.trackRemovals)}getSize(e){return this.getMetadata(e).next(t=>t.byteSize)}getMetadata(e){return FR(e).get(pl.key).next(t=>(It(!!t),t))}mn(e,t){return FR(e).put(pl.key,t)}gn(e,t){if(t){const r=vR(this.O,t);if(!r.isNoDocument()||!r.version.isEqual(yt.min()))return r}return sr.newInvalidDocument(e)}}class Uk extends kR{constructor(e,t){super(),this.Tn=e,this.trackRemovals=t,this.An=new H_(r=>r.toString(),(r,o)=>r.isEqual(o))}applyChanges(e){const t=[];let r=0,o=new Zn((u,c)=>Gt(u.canonicalString(),c.canonicalString()));return this.changes.forEach((u,c)=>{const g=this.An.get(u);if(c.isValidDocument()){const E=ER(this.Tn.O,c);o=o.add(u.path.popLast()),r+=yD(E)-g,t.push(this.Tn.addEntry(e,u,E))}else if(r-=g,this.trackRemovals){const E=ER(this.Tn.O,c.convertToNoDocument(yt.min()));t.push(this.Tn.addEntry(e,u,E))}else t.push(this.Tn.removeEntry(e,u))}),o.forEach(u=>{t.push(this.Tn.indexManager.addToCollectionParentIndex(e,u))}),t.push(this.Tn.updateMetadata(e,r)),fe.waitFor(t)}getFromCache(e,t){return this.Tn.yn(e,t).next(r=>(this.An.set(t,r.size),r.document))}getAllFromCache(e,t){return this.Tn.In(e,t).next(({documents:r,En:o})=>(o.forEach((u,c)=>{this.An.set(u,c)}),r))}}function FR(n){return mi(n,pl.store)}function Ah(n){return mi(n,gr.store)}function ED(n){return n.path.toArray()}class jk{constructor(e){this.O=e}kt(e,t,r,o){const u=new fD("createOrUpgrade",t);var g;r<1&&o>=1&&(e.createObjectStore(Ro.store),(g=e).createObjectStore(Ch.store,{keyPath:Ch.keyPath}),g.createObjectStore(kn.store,{keyPath:kn.keyPath,autoIncrement:!0}).createIndex(kn.userMutationsIndex,kn.userMutationsKeyPath,{unique:!0}),g.createObjectStore(is.store),LR(e),function(g){g.createObjectStore(gr.store)}(e));let c=fe.resolve();return r<3&&o>=3&&(0!==r&&(function(g){g.deleteObjectStore(Li.store),g.deleteObjectStore(Qs.store),g.deleteObjectStore(Po.store)}(e),LR(e)),c=c.next(()=>function(g){const E=g.store(Po.store),I=new Po(0,0,yt.min().toTimestamp(),0);return E.put(Po.key,I)}(u))),r<4&&o>=4&&(0!==r&&(c=c.next(()=>function(g,E){return E.store(kn.store).qt().next(I=>{g.deleteObjectStore(kn.store),g.createObjectStore(kn.store,{keyPath:kn.keyPath,autoIncrement:!0}).createIndex(kn.userMutationsIndex,kn.userMutationsKeyPath,{unique:!0});const S=E.store(kn.store),M=I.map(F=>S.put(F));return fe.waitFor(M)})}(e,u))),c=c.next(()=>{!function(g){g.createObjectStore(Pc.store,{keyPath:Pc.keyPath})}(e)})),r<5&&o>=5&&(c=c.next(()=>this.Rn(u))),r<6&&o>=6&&(c=c.next(()=>(function(g){g.createObjectStore(pl.store)}(e),this.Pn(u)))),r<7&&o>=7&&(c=c.next(()=>this.bn(u))),r<8&&o>=8&&(c=c.next(()=>this.vn(e,u))),r<9&&o>=9&&(c=c.next(()=>{(function(g){g.objectStoreNames.contains("remoteDocumentChanges")&&g.deleteObjectStore("remoteDocumentChanges")})(e),function(g){const E=g.objectStore(gr.store);E.createIndex(gr.readTimeIndex,gr.readTimeIndexPath,{unique:!1}),E.createIndex(gr.collectionReadTimeIndex,gr.collectionReadTimeIndexPath,{unique:!1})}(t)})),r<10&&o>=10&&(c=c.next(()=>this.Vn(u))),r<11&&o>=11&&(c=c.next(()=>{(function(g){g.createObjectStore(L_.store,{keyPath:L_.keyPath})})(e),function(g){g.createObjectStore(V_.store,{keyPath:V_.keyPath})}(e)})),r<12&&o>=12&&(c=c.next(()=>{!function(g){const E=g.createObjectStore(gi.store,{keyPath:gi.keyPath});E.createIndex(gi.collectionPathOverlayIndex,gi.collectionPathOverlayIndexPath,{unique:!1}),E.createIndex(gi.collectionGroupOverlayIndex,gi.collectionGroupOverlayIndexPath,{unique:!1})}(e)})),r<13&&o>=13&&(c=c.next(()=>{!function(g){g.createObjectStore(Oo.store,{keyPath:Oo.keyPath,autoIncrement:!0}).createIndex(Oo.collectionGroupIndex,Oo.collectionGroupIndexPath,{unique:!1}),g.createObjectStore(ya.store,{keyPath:ya.keyPath}).createIndex(ya.sequenceNumberIndex,ya.sequenceNumberIndexPath,{unique:!1}),g.createObjectStore(va.store,{keyPath:va.keyPath}).createIndex(va.documentKeyIndex,va.documentKeyIndexPath,{unique:!1})}(e)})),c}Pn(e){let t=0;return e.store(gr.store).Qt((r,o)=>{t+=yD(o)}).next(()=>{const r=new pl(t);return e.store(pl.store).put(pl.key,r)})}Rn(e){const t=e.store(Ch.store),r=e.store(kn.store);return t.qt().next(o=>fe.forEach(o,u=>{const c=IDBKeyRange.bound([u.userId,-1],[u.userId,u.lastAcknowledgedBatchId]);return r.qt(kn.userMutationsIndex,c).next(g=>fe.forEach(g,E=>{It(E.userId===u.userId);const I=B_(this.O,E);return MR(e,u.userId,I).next(()=>{})}))}))}bn(e){const t=e.store(Li.store),r=e.store(gr.store);return e.store(Po.store).get(Po.key).next(o=>{const u=[];return r.Qt((c,g)=>{const E=new rn(c),I=[0,pi(E)];u.push(t.get(I).next(S=>S?fe.resolve():t.put(new Li(0,pi(E),o.highestListenSequenceNumber))))}).next(()=>fe.waitFor(u))})}vn(e,t){e.createObjectStore(Fp.store,{keyPath:Fp.keyPath});const r=t.store(Fp.store),o=new IS,u=c=>{if(o.add(c)){const g=c.lastSegment(),E=c.popLast();return r.put({collectionId:g,parent:pi(E)})}};return t.store(gr.store).Qt({jt:!0},(c,g)=>{const E=new rn(c);return u(E.popLast())}).next(()=>t.store(is.store).Qt({jt:!0},([c,g,E],I)=>{const S=fl(g);return u(S.popLast())}))}Vn(e){const t=e.store(Qs.store);return t.Qt((r,o)=>{const u=p0(o),c=wR(this.O,u);return t.put(c)})}}function LR(n){n.createObjectStore(Li.store,{keyPath:Li.keyPath}).createIndex(Li.documentTargetsIndex,Li.documentTargetsKeyPath,{unique:!0}),n.createObjectStore(Qs.store,{keyPath:Qs.keyPath}).createIndex(Qs.queryTargetsIndexName,Qs.queryTargetsKeyPath,{unique:!0}),n.createObjectStore(Po.store)}const bS="Failed to obtain exclusive access to the persistence layer. To allow shared access, multi-tab synchronization has to be enabled in all tabs. If you are using `experimentalForceOwningTab:true`, make sure that only one tab has persistence enabled at any given time.";class TS{constructor(e,t,r,o,u,c,g,E,I,S,M=12){if(this.allowTabSynchronization=e,this.persistenceKey=t,this.clientId=r,this.Sn=u,this.window=c,this.document=g,this.Dn=I,this.Cn=S,this.schemaVersion=M,this.Nn=null,this.xn=!1,this.isPrimary=!1,this.networkEnabled=!0,this.kn=null,this.inForeground=!1,this.On=null,this.Mn=null,this.$n=Number.NEGATIVE_INFINITY,this.Fn=F=>Promise.resolve(),!TS.Vt())throw new Me(ue.UNIMPLEMENTED,"This platform is either missing IndexedDB or is known to have an incomplete implementation. Offline persistence has been disabled.");this.referenceDelegate=new Vk(this,o),this.Bn=t+"main",this.O=new yR(E),this.Ln=new pu(this.Bn,this.schemaVersion,new jk(this.O)),this.Un=new Ok(this.referenceDelegate,this.O),this.qn=new Bk(this.O),this.Kn=new Ak,this.window&&this.window.localStorage?this.Gn=this.window.localStorage:(this.Gn=null,!1===S&&Fr("IndexedDbPersistence","LocalStorage is unavailable. As a result, persistence may not work reliably. In particular enablePersistence() could fail immediately after refreshing the page."))}start(){return this.jn().then(()=>{if(!this.isPrimary&&!this.allowTabSynchronization)throw new Me(ue.FAILED_PRECONDITION,bS);return this.Qn(),this.Wn(),this.zn(),this.runTransaction("getHighestListenSequenceNumber","readonly",e=>this.Un.getHighestSequenceNumber(e))}).then(e=>{this.Nn=new No(e,this.Dn)}).then(()=>{this.xn=!0}).catch(e=>(this.Ln&&this.Ln.close(),Promise.reject(e)))}Hn(e){var t=this;return this.Fn=function(){var r=(0,pe.Z)(function*(o){if(t.started)return e(o)});return function(o){return r.apply(this,arguments)}}(),e(this.isPrimary)}setDatabaseDeletedListener(e){this.Ln.Mt(function(){var t=(0,pe.Z)(function*(r){null===r.newVersion&&(yield e())});return function(r){return t.apply(this,arguments)}}())}setNetworkEnabled(e){var t=this;this.networkEnabled!==e&&(this.networkEnabled=e,this.Sn.enqueueAndForget((0,pe.Z)(function*(){t.started&&(yield t.jn())})))}jn(){return this.runTransaction("updateClientMetadataAndTryBecomePrimary","readwrite",e=>wD(e).put(new Pc(this.clientId,Date.now(),this.networkEnabled,this.inForeground)).next(()=>{if(this.isPrimary)return this.Jn(e).next(t=>{t||(this.isPrimary=!1,this.Sn.enqueueRetryable(()=>this.Fn(!1)))})}).next(()=>this.Yn(e)).next(t=>this.isPrimary&&!t?this.Xn(e).next(()=>!1):!!t&&this.Zn(e).next(()=>!0))).catch(e=>{if(Lp(e))return Le("IndexedDbPersistence","Failed to extend owner lease: ",e),this.isPrimary;if(!this.allowTabSynchronization)throw e;return Le("IndexedDbPersistence","Releasing owner lease after error during lease refresh",e),!1}).then(e=>{this.isPrimary!==e&&this.Sn.enqueueRetryable(()=>this.Fn(e)),this.isPrimary=e})}Jn(e){return m0(e).get(Ro.key).next(t=>fe.resolve(this.ts(t)))}es(e){return wD(e).delete(this.clientId)}ns(){var e=this;return(0,pe.Z)(function*(){if(e.isPrimary&&!e.ss(e.$n,18e5)){e.$n=Date.now();const t=yield e.runTransaction("maybeGarbageCollectMultiClientState","readwrite-primary",r=>{const o=mi(r,Pc.store);return o.qt().next(u=>{const c=e.rs(u,18e5),g=u.filter(E=>-1===c.indexOf(E));return fe.forEach(g,E=>o.delete(E.clientId)).next(()=>g)})}).catch(()=>[]);if(e.Gn)for(const r of t)e.Gn.removeItem(e.os(r.clientId))}})()}zn(){this.Mn=this.Sn.enqueueAfterDelay("client_metadata_refresh",4e3,()=>this.jn().then(()=>this.ns()).then(()=>this.zn()))}ts(e){return!!e&&e.ownerId===this.clientId}Yn(e){return this.Cn?fe.resolve(!0):m0(e).get(Ro.key).next(t=>{if(null!==t&&this.ss(t.leaseTimestampMs,5e3)&&!this.cs(t.ownerId)){if(this.ts(t)&&this.networkEnabled)return!0;if(!this.ts(t)){if(!t.allowTabSynchronization)throw new Me(ue.FAILED_PRECONDITION,bS);return!1}}return!(!this.networkEnabled||!this.inForeground)||wD(e).qt().next(r=>void 0===this.rs(r,5e3).find(o=>{if(this.clientId!==o.clientId){const c=!this.inForeground&&o.inForeground,g=this.networkEnabled===o.networkEnabled;if(!this.networkEnabled&&o.networkEnabled||c&&g)return!0}return!1}))}).next(t=>(this.isPrimary!==t&&Le("IndexedDbPersistence",`Client ${t?"is":"is not"} eligible for a primary lease.`),t))}shutdown(){var e=this;return(0,pe.Z)(function*(){e.xn=!1,e.us(),e.Mn&&(e.Mn.cancel(),e.Mn=null),e.hs(),e.ls(),yield e.Ln.runTransaction("shutdown","readwrite",[Ro.store,Pc.store],t=>{const r=new _R(t,No.A);return e.Xn(r).next(()=>e.es(r))}),e.Ln.close(),e.fs()})()}rs(e,t){return e.filter(r=>this.ss(r.updateTimeMs,t)&&!this.cs(r.clientId))}ds(){return this.runTransaction("getActiveClients","readonly",e=>wD(e).qt().next(t=>this.rs(t,18e5).map(r=>r.clientId)))}get started(){return this.xn}getMutationQueue(e,t){return CS.Jt(e,this.O,t,this.referenceDelegate)}getTargetCache(){return this.Un}getRemoteDocumentCache(){return this.qn}getIndexManager(e){return new Pk(e)}getDocumentOverlayCache(e){return vS.Jt(this.O,e)}getBundleCache(){return this.Kn}runTransaction(e,t,r){Le("IndexedDbPersistence","Starting transaction:",e);const o="readonly"===t?"readonly":"readwrite",u=13===(c=this.schemaVersion)?Dk:12===c?fR:11===c?hR:void ut();var c;let g;return this.Ln.runTransaction(e,o,u,E=>(g=new _R(E,this.Nn?this.Nn.next():No.A),"readwrite-primary"===t?this.Jn(g).next(I=>!!I||this.Yn(g)).next(I=>{if(!I)throw Fr(`Failed to obtain primary lease for action '${e}'.`),this.isPrimary=!1,this.Sn.enqueueRetryable(()=>this.Fn(!1)),new Me(ue.FAILED_PRECONDITION,pR);return r(g)}).next(I=>this.Zn(g).next(()=>I)):this._s(g).next(()=>r(g)))).then(E=>(g.raiseOnCommittedEvent(),E))}_s(e){return m0(e).get(Ro.key).next(t=>{if(null!==t&&this.ss(t.leaseTimestampMs,5e3)&&!this.cs(t.ownerId)&&!this.ts(t)&&!(this.Cn||this.allowTabSynchronization&&t.allowTabSynchronization))throw new Me(ue.FAILED_PRECONDITION,bS)})}Zn(e){const t=new Ro(this.clientId,this.allowTabSynchronization,Date.now());return m0(e).put(Ro.key,t)}static Vt(){return pu.Vt()}Xn(e){const t=m0(e);return t.get(Ro.key).next(r=>this.ts(r)?(Le("IndexedDbPersistence","Releasing primary lease."),t.delete(Ro.key)):fe.resolve())}ss(e,t){const r=Date.now();return!(e<r-t||e>r&&(Fr(`Detected an update time that is in the future: ${e} > ${r}`),1))}Qn(){null!==this.document&&"function"==typeof this.document.addEventListener&&(this.On=()=>{this.Sn.enqueueAndForget(()=>(this.inForeground="visible"===this.document.visibilityState,this.jn()))},this.document.addEventListener("visibilitychange",this.On),this.inForeground="visible"===this.document.visibilityState)}hs(){this.On&&(this.document.removeEventListener("visibilitychange",this.On),this.On=null)}Wn(){var e;"function"==typeof(null===(e=this.window)||void 0===e?void 0:e.addEventListener)&&(this.kn=()=>{this.us(),(0,P.G6)()&&navigator.appVersion.match(/Version\/1[45]/)&&this.Sn.enterRestrictedMode(!0),this.Sn.enqueueAndForget(()=>this.shutdown())},this.window.addEventListener("pagehide",this.kn))}ls(){this.kn&&(this.window.removeEventListener("pagehide",this.kn),this.kn=null)}cs(e){var t;try{const r=null!==(null===(t=this.Gn)||void 0===t?void 0:t.getItem(this.os(e)));return Le("IndexedDbPersistence",`Client '${e}' ${r?"is":"is not"} zombied in LocalStorage`),r}catch(r){return Fr("IndexedDbPersistence","Failed to get zombied client id.",r),!1}}us(){if(this.Gn)try{this.Gn.setItem(this.os(this.clientId),String(Date.now()))}catch(e){Fr("Failed to set zombie client id.",e)}}fs(){if(this.Gn)try{this.Gn.removeItem(this.os(this.clientId))}catch(e){}}os(e){return`firestore_zombie_${this.persistenceKey}_${e}`}}function m0(n){return mi(n,Ro.store)}function wD(n){return mi(n,Pc.store)}function AS(n,e){let t=n.projectId;return n.isDefaultDatabase||(t+="."+n.database),"firestore/"+e+"/"+t+"/"}class Hk{constructor(e,t){this.progress=e,this.ws=t}}class Gk{constructor(e,t,r){this.qn=e,this.gs=t,this.indexManager=r}ys(e,t){return this.gs.getAllMutationBatchesAffectingDocumentKey(e,t).next(r=>this.ps(e,t,r))}ps(e,t,r){return this.qn.getEntry(e,t).next(o=>{for(const u of r)u.applyToLocalView(o);return o})}Is(e,t){e.forEach((r,o)=>{for(const u of t)u.applyToLocalView(o)})}Es(e,t){return this.qn.getEntries(e,t).next(r=>this.Ts(e,r).next(()=>r))}Ts(e,t){return this.gs.getAllMutationBatchesAffectingDocumentKeys(e,t).next(r=>this.Is(t,r))}As(e,t,r){return Je.isDocumentKey((o=t).path)&&null===o.collectionGroup&&0===o.filters.length?this.Rs(e,t.path):nS(t)?this.Ps(e,t,r):this.bs(e,t,r);var o}Rs(e,t){return this.ys(e,new Je(t)).next(r=>{let o=aS();return r.isFoundDocument()&&(o=o.insert(r.key,r)),o})}Ps(e,t,r){const o=t.collectionGroup;let u=aS();return this.indexManager.getCollectionParents(e,o).next(c=>fe.forEach(c,g=>{const E=(I=t,S=g.child(o),new Rc(S,null,I.explicitOrderBy.slice(),I.filters.slice(),I.limit,I.limitType,I.startAt,I.endAt));var I,S;return this.bs(e,E,r).next(I=>{I.forEach((S,M)=>{u=u.insert(S,M)})})}).next(()=>u))}bs(e,t,r){let o;return this.qn.getAll(e,t.path,r).next(u=>(o=u,this.gs.getAllMutationBatchesAffectingQuery(e,t))).next(u=>{for(const c of u)for(const g of c.mutations){const E=g.key;let I=o.get(E);null==I&&(I=sr.newInvalidDocument(E),o=o.insert(E,I)),sS(g,I,c.localWriteTime),I.isFoundDocument()||(o=o.remove(E))}}).next(()=>(o.forEach((u,c)=>{iS(t,c)||(o=o.remove(u))}),o))}}class SS{constructor(e,t,r,o){this.targetId=e,this.fromCache=t,this.vs=r,this.Vs=o}static Ss(e,t){let r=hn(),o=hn();for(const u of t.docChanges)switch(u.type){case 0:r=r.add(u.doc.key);break;case 1:o=o.add(u.doc.key)}return new SS(e,t.fromCache,r,o)}}class VR{Ds(e){this.Cs=e}As(e,t,r,o){return 0===(u=t).filters.length&&null===u.limit&&null==u.startAt&&null==u.endAt&&(0===u.explicitOrderBy.length||1===u.explicitOrderBy.length&&u.explicitOrderBy[0].field.isKeyField())||r.isEqual(yt.min())?this.Ns(e,t):this.Cs.Es(e,o).next(u=>{const c=this.xs(t,u);return(sD(t)||oD(t))&&this.ks(t.limitType,c,o,r)?this.Ns(e,t):(KA()<=vs.in.DEBUG&&Le("QueryEngine","Re-using previous result from %s to execute query: %s",r.toString(),rS(t)),this.Cs.As(e,t,r).next(g=>(c.forEach(E=>{g=g.insert(E.key,E)}),g)))});var u}xs(e,t){let r=new Zn(RN(e));return t.forEach((o,u)=>{iS(e,u)&&(r=r.add(u))}),r}ks(e,t,r,o){if(r.size!==t.size)return!0;const u="F"===e?t.last():t.first();return!!u&&(u.hasPendingWrites||u.version.compareTo(o)>0)}Ns(e,t){return KA()<=vs.in.DEBUG&&Le("QueryEngine","Using full collection scan to execute query:",rS(t)),this.Cs.As(e,t,yt.min())}}class $k{constructor(e,t,r,o){this.persistence=e,this.Os=t,this.O=o,this.Ms=new Er(Gt),this.$s=new H_(u=>t0(u),rD),this.Fs=yt.min(),this.Bs=e.getRemoteDocumentCache(),this.Un=e.getTargetCache(),this.Kn=e.getBundleCache(),this.Ls(r)}Ls(e){this.indexManager=this.persistence.getIndexManager(e),this.gs=this.persistence.getMutationQueue(e,this.indexManager),this.Us=new Gk(this.Bs,this.gs,this.indexManager),this.Bs.setIndexManager(this.indexManager),this.Os.Ds(this.Us)}collectGarbage(e){return this.persistence.runTransaction("Collect garbage","readwrite-primary",t=>e.collect(t,this.Ms))}}function BR(n,e,t,r){return new $k(n,e,t,r)}function UR(n,e){return xS.apply(this,arguments)}function xS(){return xS=(0,pe.Z)(function*(n,e){const t=We(n);return yield t.persistence.runTransaction("Handle user change","readonly",r=>{let o;return t.gs.getAllMutationBatches(r).next(u=>(o=u,t.Ls(e),t.gs.getAllMutationBatches(r))).next(u=>{const c=[],g=[];let E=hn();for(const I of o){c.push(I.batchId);for(const S of I.mutations)E=E.add(S.key)}for(const I of u){g.push(I.batchId);for(const S of I.mutations)E=E.add(S.key)}return t.Us.Es(r,E).next(I=>({qs:I,removedBatchIds:c,addedBatchIds:g}))})})}),xS.apply(this,arguments)}function Wk(n,e){const t=We(n);return t.persistence.runTransaction("Acknowledge batch","readwrite-primary",r=>{const o=e.batch.keys(),u=t.Bs.newChangeBuffer({trackRemovals:!0});return function(c,g,E,I){const S=E.batch,M=S.keys();let F=fe.resolve();return M.forEach(W=>{F=F.next(()=>I.getEntry(g,W)).next(Y=>{const xe=E.docVersions.get(W);It(null!==xe),Y.version.compareTo(xe)<0&&(S.applyToRemoteDocument(Y,E),Y.isValidDocument()&&(Y.setReadTime(E.commitVersion),I.addEntry(Y)))})}),F.next(()=>c.gs.removeMutationBatch(g,S))}(t,r,e,u).next(()=>u.apply(r)).next(()=>t.gs.performConsistencyCheck(r)).next(()=>t.Us.Es(r,o))})}function jR(n){const e=We(n);return e.persistence.runTransaction("Get last remote snapshot version","readonly",t=>e.Un.getLastRemoteSnapshotVersion(t))}function qk(n,e){const t=We(n),r=e.snapshotVersion;let o=t.Ms;return t.persistence.runTransaction("Apply remote event","readwrite-primary",u=>{const c=t.Bs.newChangeBuffer({trackRemovals:!0});o=t.Ms;const g=[];e.targetChanges.forEach((I,S)=>{const M=o.get(S);if(!M)return;g.push(t.Un.removeMatchingKeys(u,I.removedDocuments,S).next(()=>t.Un.addMatchingKeys(u,I.addedDocuments,S)));let F=M.withSequenceNumber(u.currentSequenceNumber);var W,Y,xe;e.targetMismatches.has(S)?F=F.withResumeToken(Jr.EMPTY_BYTE_STRING,yt.min()).withLastLimboFreeSnapshotVersion(yt.min()):I.resumeToken.approximateByteSize()>0&&(F=F.withResumeToken(I.resumeToken,r)),o=o.insert(S,F),Y=F,xe=I,(0===(W=M).resumeToken.approximateByteSize()||Y.snapshotVersion.toMicroseconds()-W.snapshotVersion.toMicroseconds()>=3e8||xe.addedDocuments.size+xe.modifiedDocuments.size+xe.removedDocuments.size>0)&&g.push(t.Un.updateTargetData(u,F))});let E=_a();if(e.documentUpdates.forEach(I=>{e.resolvedLimboDocuments.has(I)&&g.push(t.persistence.referenceDelegate.updateLimboDocument(u,I))}),g.push(HR(u,c,e.documentUpdates).next(I=>{E=I})),!r.isEqual(yt.min())){const I=t.Un.getLastRemoteSnapshotVersion(u).next(S=>t.Un.setTargetsMetadata(u,u.currentSequenceNumber,r));g.push(I)}return fe.waitFor(g).next(()=>c.apply(u)).next(()=>t.Us.Ts(u,E)).next(()=>E)}).then(u=>(t.Ms=o,u))}function HR(n,e,t){let r=hn();return t.forEach(o=>r=r.add(o)),e.getEntries(n,r).next(o=>{let u=_a();return t.forEach((c,g)=>{const E=o.get(c);g.isNoDocument()&&g.version.isEqual(yt.min())?(e.removeEntry(c,g.readTime),u=u.insert(c,g)):!E.isValidDocument()||g.version.compareTo(E.version)>0||0===g.version.compareTo(E.version)&&E.hasPendingWrites?(e.addEntry(g),u=u.insert(c,g)):Le("LocalStore","Ignoring outdated watch update for ",c,". Current version:",E.version," Watch version:",g.version)}),u})}function zk(n,e){const t=We(n);return t.persistence.runTransaction("Get next mutation batch","readonly",r=>(void 0===e&&(e=-1),t.gs.getNextMutationBatchAfterBatchId(r,e)))}function G_(n,e){const t=We(n);return t.persistence.runTransaction("Allocate target","readwrite",r=>{let o;return t.Un.getTargetData(r,e).next(u=>u?(o=u,fe.resolve(o)):t.Un.allocateTargetId(r).next(c=>(o=new Dh(e,c,0,r.currentSequenceNumber),t.Un.addTargetData(r,o).next(()=>o))))}).then(r=>{const o=t.Ms.get(r.targetId);return(null===o||r.snapshotVersion.compareTo(o.snapshotVersion)>0)&&(t.Ms=t.Ms.insert(r.targetId,r),t.$s.set(e,r.targetId)),r})}function $_(n,e,t){return MS.apply(this,arguments)}function MS(){return MS=(0,pe.Z)(function*(n,e,t){const r=We(n),o=r.Ms.get(e),u=t?"readwrite":"readwrite-primary";try{t||(yield r.persistence.runTransaction("Release target",u,c=>r.persistence.referenceDelegate.removeTarget(c,o)))}catch(c){if(!Lp(c))throw c;Le("LocalStore",`Failed to update sequence numbers for target ${e}: ${c}`)}r.Ms=r.Ms.remove(e),r.$s.delete(o.target)}),MS.apply(this,arguments)}function ID(n,e,t){const r=We(n);let o=yt.min(),u=hn();return r.persistence.runTransaction("Execute query","readonly",c=>function(g,E,I){const S=We(g),M=S.$s.get(I);return void 0!==M?fe.resolve(S.Ms.get(M)):S.Un.getTargetData(E,I)}(r,c,ma(e)).next(g=>{if(g)return o=g.lastLimboFreeSnapshotVersion,r.Un.getMatchingKeysForTargetId(c,g.targetId).next(E=>{u=E})}).next(()=>r.Os.As(c,e,t?o:yt.min(),t?u:hn())).next(g=>({documents:g,Ks:u})))}function GR(n,e){const t=We(n),r=We(t.Un),o=t.Ms.get(e);return o?Promise.resolve(o.target):t.persistence.runTransaction("Get target data","readonly",u=>r.Tt(u,e).next(c=>c?c.target:null))}function $R(n){const e=We(n);return e.persistence.runTransaction("Get new document changes","readonly",t=>function(r,o,u){const c=We(r);let g=_a(),E=gS(u);const I=Ah(o),S=IDBKeyRange.lowerBound(E,!0);return I.Qt({index:gr.readTimeIndex,range:S},(M,F)=>{const W=vR(c.O,F);g=g.insert(W.key,W),E=F.readTime}).next(()=>({ws:g,readTime:mS(E)}))}(e.Bs,t,e.Fs)).then(({ws:t,readTime:r})=>(e.Fs=r,t))}function NS(){return NS=(0,pe.Z)(function*(n){const e=We(n);return e.persistence.runTransaction("Synchronize last document change read time","readonly",t=>function(r){const o=Ah(r);let u=yt.min();return o.Qt({index:gr.readTimeIndex,reverse:!0},(c,g,E)=>{g.readTime&&(u=mS(g.readTime)),E.done()}).next(()=>u)}(t)).then(t=>{e.Fs=t})}),NS.apply(this,arguments)}function RS(){return RS=(0,pe.Z)(function*(n,e,t,r){const o=We(n);let u=hn(),c=_a();for(const I of t){const S=e.Gs(I.metadata.name);I.document&&(u=u.add(S));const M=e.js(I);M.setReadTime(e.Qs(I.metadata.readTime)),c=c.insert(S,M)}const g=o.Bs.newChangeBuffer({trackRemovals:!0}),E=yield G_(o,(I=r,ma(M_(rn.fromString(`__bundle__/docs/${I}`)))));var I;return o.persistence.runTransaction("Apply bundle documents","readwrite",I=>HR(I,g,c).next(S=>(g.apply(I),S)).next(S=>o.Un.removeMatchingKeysForTargetId(I,E.targetId).next(()=>o.Un.addMatchingKeys(I,u,E.targetId)).next(()=>o.Us.Ts(I,S)).next(()=>S)))}),RS.apply(this,arguments)}function Yk(n,e){return PS.apply(this,arguments)}function PS(){return PS=(0,pe.Z)(function*(n,e,t=hn()){const r=yield G_(n,ma(_S(e.bundledQuery))),o=We(n);return o.persistence.runTransaction("Save named query","readwrite",u=>{const c=fi(e.readTime);if(r.snapshotVersion.compareTo(c)>=0)return o.Kn.saveNamedQuery(u,e);const g=r.withResumeToken(Jr.EMPTY_BYTE_STRING,c);return o.Ms=o.Ms.insert(g.targetId,g),o.Un.updateTargetData(u,g).next(()=>o.Un.removeMatchingKeysForTargetId(u,r.targetId)).next(()=>o.Un.addMatchingKeys(u,t,r.targetId)).next(()=>o.Kn.saveNamedQuery(u,e))})}),PS.apply(this,arguments)}class Qk{constructor(e){this.O=e,this.Ws=new Map,this.zs=new Map}getBundleMetadata(e,t){return fe.resolve(this.Ws.get(t))}saveBundleMetadata(e,t){var r;return this.Ws.set(t.id,{id:(r=t).id,version:r.version,createTime:fi(r.createTime)}),fe.resolve()}getNamedQuery(e,t){return fe.resolve(this.zs.get(t))}saveNamedQuery(e,t){return this.zs.set(t.name,{name:(r=t).name,query:_S(r.bundledQuery),readTime:fi(r.readTime)}),fe.resolve();var r}}class Jk{constructor(){this.overlays=new Er(Je.comparator),this.Hs=new Map}getOverlay(e,t){return fe.resolve(this.overlays.get(t))}saveOverlays(e,t,r){return r.forEach(o=>{this.Yt(e,t,o)}),fe.resolve()}removeOverlaysForBatchId(e,t,r){const o=this.Hs.get(r);return void 0!==o&&(o.forEach(u=>this.overlays=this.overlays.remove(u)),this.Hs.delete(r)),fe.resolve()}getOverlaysForCollection(e,t,r){const o=new Map,u=t.length+1,c=new Je(t.child("")),g=this.overlays.getIteratorFrom(c);for(;g.hasNext();){const E=g.getNext().value,I=E.getKey();if(!t.isPrefixOf(I.path))break;I.path.length===u&&E.largestBatchId>r&&o.set(E.getKey(),E)}return fe.resolve(o)}getOverlaysForCollectionGroup(e,t,r,o){let u=new Er((I,S)=>I-S);const c=this.overlays.getIterator();for(;c.hasNext();){const I=c.getNext().value;if(I.getKey().getCollectionGroup()===t&&I.largestBatchId>r){let S=u.get(I.largestBatchId);null===S&&(S=new Map,u=u.insert(I.largestBatchId,S)),S.set(I.getKey(),I)}}const g=new Map,E=u.getIterator();for(;E.hasNext()&&(E.getNext().value.forEach((I,S)=>g.set(S,I)),!(g.size>=o)););return fe.resolve(g)}Yt(e,t,r){if(null===r)return;const o=this.overlays.get(r.key);null!==o&&this.Hs.get(o.largestBatchId).delete(r.key),this.overlays=this.overlays.insert(r.key,new pS(t,r));let u=this.Hs.get(t);void 0===u&&(u=new Set,this.Hs.set(t,u)),u.add(r.key)}}class OS{constructor(){this.Js=new Zn(_i.Ys),this.Xs=new Zn(_i.Zs)}isEmpty(){return this.Js.isEmpty()}addReference(e,t){const r=new _i(e,t);this.Js=this.Js.add(r),this.Xs=this.Xs.add(r)}ti(e,t){e.forEach(r=>this.addReference(r,t))}removeReference(e,t){this.ei(new _i(e,t))}ni(e,t){e.forEach(r=>this.removeReference(r,t))}si(e){const t=new Je(new rn([])),r=new _i(t,e),o=new _i(t,e+1),u=[];return this.Xs.forEachInRange([r,o],c=>{this.ei(c),u.push(c.key)}),u}ii(){this.Js.forEach(e=>this.ei(e))}ei(e){this.Js=this.Js.delete(e),this.Xs=this.Xs.delete(e)}ri(e){const t=new Je(new rn([])),r=new _i(t,e),o=new _i(t,e+1);let u=hn();return this.Xs.forEachInRange([r,o],c=>{u=u.add(c.key)}),u}containsKey(e){const t=new _i(e,0),r=this.Js.firstAfterOrEqual(t);return null!==r&&e.isEqual(r.key)}}class _i{constructor(e,t){this.key=e,this.oi=t}static Ys(e,t){return Je.comparator(e.key,t.key)||Gt(e.oi,t.oi)}static Zs(e,t){return Gt(e.oi,t.oi)||Je.comparator(e.key,t.key)}}class Xk{constructor(e,t){this.indexManager=e,this.referenceDelegate=t,this.gs=[],this.ci=1,this.ui=new Zn(_i.Ys)}checkEmpty(e){return fe.resolve(0===this.gs.length)}addMutationBatch(e,t,r,o){const u=this.ci;this.ci++;const c=new hS(u,t,r,o);this.gs.push(c);for(const g of o)this.ui=this.ui.add(new _i(g.key,u)),this.indexManager.addToCollectionParentIndex(e,g.key.path.popLast());return fe.resolve(c)}lookupMutationBatch(e,t){return fe.resolve(this.ai(t))}getNextMutationBatchAfterBatchId(e,t){const o=this.hi(t+1),u=o<0?0:o;return fe.resolve(this.gs.length>u?this.gs[u]:null)}getHighestUnacknowledgedBatchId(){return fe.resolve(0===this.gs.length?-1:this.ci-1)}getAllMutationBatches(e){return fe.resolve(this.gs.slice())}getAllMutationBatchesAffectingDocumentKey(e,t){const r=new _i(t,0),o=new _i(t,Number.POSITIVE_INFINITY),u=[];return this.ui.forEachInRange([r,o],c=>{const g=this.ai(c.oi);u.push(g)}),fe.resolve(u)}getAllMutationBatchesAffectingDocumentKeys(e,t){let r=new Zn(Gt);return t.forEach(o=>{const u=new _i(o,0),c=new _i(o,Number.POSITIVE_INFINITY);this.ui.forEachInRange([u,c],g=>{r=r.add(g.oi)})}),fe.resolve(this.li(r))}getAllMutationBatchesAffectingQuery(e,t){const r=t.path,o=r.length+1;let u=r;Je.isDocumentKey(u)||(u=u.child(""));const c=new _i(new Je(u),0);let g=new Zn(Gt);return this.ui.forEachWhile(E=>{const I=E.key.path;return!!r.isPrefixOf(I)&&(I.length===o&&(g=g.add(E.oi)),!0)},c),fe.resolve(this.li(g))}li(e){const t=[];return e.forEach(r=>{const o=this.ai(r);null!==o&&t.push(o)}),t}removeMutationBatch(e,t){It(0===this.fi(t.batchId,"removed")),this.gs.shift();let r=this.ui;return fe.forEach(t.mutations,o=>{const u=new _i(o.key,t.batchId);return r=r.delete(u),this.referenceDelegate.markPotentiallyOrphaned(e,o.key)}).next(()=>{this.ui=r})}Qe(e){}containsKey(e,t){const r=new _i(t,0),o=this.ui.firstAfterOrEqual(r);return fe.resolve(t.isEqual(o&&o.key))}performConsistencyCheck(e){return fe.resolve()}fi(e,t){return this.hi(e)}hi(e){return 0===this.gs.length?0:e-this.gs[0].batchId}ai(e){const t=this.hi(e);return t<0||t>=this.gs.length?null:this.gs[t]}}class e1{constructor(e){this.di=e,this.docs=new Er(Je.comparator),this.size=0}setIndexManager(e){this.indexManager=e}addEntry(e,t){const r=t.key,o=this.docs.get(r),u=o?o.size:0,c=this.di(t);return this.docs=this.docs.insert(r,{document:t.mutableCopy(),size:c}),this.size+=c-u,this.indexManager.addToCollectionParentIndex(e,r.path.popLast())}removeEntry(e){const t=this.docs.get(e);t&&(this.docs=this.docs.remove(e),this.size-=t.size)}getEntry(e,t){const r=this.docs.get(t);return fe.resolve(r?r.document.mutableCopy():sr.newInvalidDocument(t))}getEntries(e,t){let r=_a();return t.forEach(o=>{const u=this.docs.get(o);r=r.insert(o,u?u.document.mutableCopy():sr.newInvalidDocument(o))}),fe.resolve(r)}getAll(e,t,r){let o=_a();const u=new Je(t.child("")),c=this.docs.getIteratorFrom(u);for(;c.hasNext();){const{key:g,value:{document:E}}=c.getNext();if(!t.isPrefixOf(g.path))break;g.path.length>t.length+1||E.readTime.compareTo(r)<=0||(o=o.insert(E.key,E.mutableCopy()))}return fe.resolve(o)}_i(e,t){return fe.forEach(this.docs,r=>t(r))}newChangeBuffer(e){return new t1(this)}getSize(e){return fe.resolve(this.size)}}class t1 extends kR{constructor(e){super(),this.Tn=e}applyChanges(e){const t=[];return this.changes.forEach((r,o)=>{o.isValidDocument()?t.push(this.Tn.addEntry(e,o)):this.Tn.removeEntry(r)}),fe.waitFor(t)}getFromCache(e,t){return this.Tn.getEntry(e,t)}getAllFromCache(e,t){return this.Tn.getEntries(e,t)}}class n1{constructor(e){this.persistence=e,this.wi=new H_(t=>t0(t),rD),this.lastRemoteSnapshotVersion=yt.min(),this.highestTargetId=0,this.mi=0,this.gi=new OS,this.targetCount=0,this.yi=jp.He()}forEachTarget(e,t){return this.wi.forEach((r,o)=>t(o)),fe.resolve()}getLastRemoteSnapshotVersion(e){return fe.resolve(this.lastRemoteSnapshotVersion)}getHighestSequenceNumber(e){return fe.resolve(this.mi)}allocateTargetId(e){return this.highestTargetId=this.yi.next(),fe.resolve(this.highestTargetId)}setTargetsMetadata(e,t,r){return r&&(this.lastRemoteSnapshotVersion=r),t>this.mi&&(this.mi=t),fe.resolve()}Ze(e){this.wi.set(e.target,e);const t=e.targetId;t>this.highestTargetId&&(this.yi=new jp(t),this.highestTargetId=t),e.sequenceNumber>this.mi&&(this.mi=e.sequenceNumber)}addTargetData(e,t){return this.Ze(t),this.targetCount+=1,fe.resolve()}updateTargetData(e,t){return this.Ze(t),fe.resolve()}removeTargetData(e,t){return this.wi.delete(t.target),this.gi.si(t.targetId),this.targetCount-=1,fe.resolve()}removeTargets(e,t,r){let o=0;const u=[];return this.wi.forEach((c,g)=>{g.sequenceNumber<=t&&null===r.get(g.targetId)&&(this.wi.delete(c),u.push(this.removeMatchingKeysForTargetId(e,g.targetId)),o++)}),fe.waitFor(u).next(()=>o)}getTargetCount(e){return fe.resolve(this.targetCount)}getTargetData(e,t){const r=this.wi.get(t)||null;return fe.resolve(r)}addMatchingKeys(e,t,r){return this.gi.ti(t,r),fe.resolve()}removeMatchingKeys(e,t,r){this.gi.ni(t,r);const o=this.persistence.referenceDelegate,u=[];return o&&t.forEach(c=>{u.push(o.markPotentiallyOrphaned(e,c))}),fe.waitFor(u)}removeMatchingKeysForTargetId(e,t){return this.gi.si(t),fe.resolve()}getMatchingKeysForTargetId(e,t){const r=this.gi.ri(t);return fe.resolve(r)}containsKey(e,t){return fe.resolve(this.gi.containsKey(t))}}class r1{constructor(e,t){this.pi={},this.overlays={},this.Nn=new No(0),this.xn=!1,this.xn=!0,this.referenceDelegate=e(this),this.Un=new n1(this),this.indexManager=new Rk,this.qn=new e1(r=>this.referenceDelegate.Ii(r)),this.O=new yR(t),this.Kn=new Qk(this.O)}start(){return Promise.resolve()}shutdown(){return this.xn=!1,Promise.resolve()}get started(){return this.xn}setDatabaseDeletedListener(){}setNetworkEnabled(){}getIndexManager(e){return this.indexManager}getDocumentOverlayCache(e){let t=this.overlays[e.toKey()];return t||(t=new Jk,this.overlays[e.toKey()]=t),t}getMutationQueue(e,t){let r=this.pi[e.toKey()];return r||(r=new Xk(t,this.referenceDelegate),this.pi[e.toKey()]=r),r}getTargetCache(){return this.Un}getRemoteDocumentCache(){return this.qn}getBundleCache(){return this.Kn}runTransaction(e,t,r){Le("MemoryPersistence","Starting transaction:",e);const o=new i1(this.Nn.next());return this.referenceDelegate.Ei(),r(o).next(u=>this.referenceDelegate.Ti(o).next(()=>u)).toPromise().then(u=>(o.raiseOnCommittedEvent(),u))}Ai(e,t){return fe.or(Object.values(this.pi).map(r=>()=>r.containsKey(e,t)))}}class i1 extends gR{constructor(e){super(),this.currentSequenceNumber=e}}class kS{constructor(e){this.persistence=e,this.Ri=new OS,this.Pi=null}static bi(e){return new kS(e)}get vi(){if(this.Pi)return this.Pi;throw ut()}addReference(e,t,r){return this.Ri.addReference(r,t),this.vi.delete(r.toString()),fe.resolve()}removeReference(e,t,r){return this.Ri.removeReference(r,t),this.vi.add(r.toString()),fe.resolve()}markPotentiallyOrphaned(e,t){return this.vi.add(t.toString()),fe.resolve()}removeTarget(e,t){this.Ri.si(t.targetId).forEach(o=>this.vi.add(o.toString()));const r=this.persistence.getTargetCache();return r.getMatchingKeysForTargetId(e,t.targetId).next(o=>{o.forEach(u=>this.vi.add(u.toString()))}).next(()=>r.removeTargetData(e,t))}Ei(){this.Pi=new Set}Ti(e){const t=this.persistence.getRemoteDocumentCache().newChangeBuffer();return fe.forEach(this.vi,r=>{const o=Je.fromPath(r);return this.Vi(e,o).next(u=>{u||t.removeEntry(o,yt.min())})}).next(()=>(this.Pi=null,t.apply(e)))}updateLimboDocument(e,t){return this.Vi(e,t).next(r=>{r?this.vi.delete(t.toString()):this.vi.add(t.toString())})}Ii(e){return 0}Vi(e,t){return fe.or([()=>fe.resolve(this.Ri.containsKey(t)),()=>this.persistence.getTargetCache().containsKey(e,t),()=>this.persistence.Ai(e,t)])}}function WR(n,e){return`firestore_clients_${n}_${e}`}function qR(n,e,t){let r=`firestore_mutations_${n}_${t}`;return e.isAuthenticated()&&(r+=`_${e.uid}`),r}function FS(n,e){return`firestore_targets_${n}_${e}`}class CD{constructor(e,t,r,o){this.user=e,this.batchId=t,this.state=r,this.error=o}static Si(e,t,r){const o=JSON.parse(r);let u,c="object"==typeof o&&-1!==["pending","acknowledged","rejected"].indexOf(o.state)&&(void 0===o.error||"object"==typeof o.error);return c&&o.error&&(c="string"==typeof o.error.message&&"string"==typeof o.error.code,c&&(u=new Me(o.error.code,o.error.message))),c?new CD(e,t,o.state,u):(Fr("SharedClientState",`Failed to parse mutation state for ID '${t}': ${r}`),null)}Di(){const e={state:this.state,updateTimeMs:Date.now()};return this.error&&(e.error={code:this.error.code,message:this.error.message}),JSON.stringify(e)}}class _0{constructor(e,t,r){this.targetId=e,this.state=t,this.error=r}static Si(e,t){const r=JSON.parse(t);let o,u="object"==typeof r&&-1!==["not-current","current","rejected"].indexOf(r.state)&&(void 0===r.error||"object"==typeof r.error);return u&&r.error&&(u="string"==typeof r.error.message&&"string"==typeof r.error.code,u&&(o=new Me(r.error.code,r.error.message))),u?new _0(e,r.state,o):(Fr("SharedClientState",`Failed to parse target state for ID '${e}': ${t}`),null)}Di(){const e={state:this.state,updateTimeMs:Date.now()};return this.error&&(e.error={code:this.error.code,message:this.error.message}),JSON.stringify(e)}}class DD{constructor(e,t){this.clientId=e,this.activeTargetIds=t}static Si(e,t){const r=JSON.parse(t);let o="object"==typeof r&&r.activeTargetIds instanceof Array,u=dD();for(let c=0;o&&c<r.activeTargetIds.length;++c)o=EN(r.activeTargetIds[c]),u=u.add(r.activeTargetIds[c]);return o?new DD(e,u):(Fr("SharedClientState",`Failed to parse client data for instance '${e}': ${t}`),null)}}class LS{constructor(e,t){this.clientId=e,this.onlineState=t}static Si(e){const t=JSON.parse(e);return"object"==typeof t&&-1!==["Unknown","Online","Offline"].indexOf(t.onlineState)&&"string"==typeof t.clientId?new LS(t.clientId,t.onlineState):(Fr("SharedClientState",`Failed to parse online state: ${e}`),null)}}class VS{constructor(){this.activeTargetIds=dD()}Ci(e){this.activeTargetIds=this.activeTargetIds.add(e)}Ni(e){this.activeTargetIds=this.activeTargetIds.delete(e)}Di(){const e={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(e)}}class BS{constructor(e,t,r,o,u){this.window=e,this.Sn=t,this.persistenceKey=r,this.xi=o,this.syncEngine=null,this.onlineStateHandler=null,this.sequenceNumberHandler=null,this.ki=this.Oi.bind(this),this.Mi=new Er(Gt),this.started=!1,this.$i=[];const c=r.replace(/[.*+?^${}()|[\]\\]/g,"\\$&");this.storage=this.window.localStorage,this.currentUser=u,this.Fi=WR(this.persistenceKey,this.xi),this.Bi=`firestore_sequence_number_${this.persistenceKey}`,this.Mi=this.Mi.insert(this.xi,new VS),this.Li=new RegExp(`^firestore_clients_${c}_([^_]*)$`),this.Ui=new RegExp(`^firestore_mutations_${c}_(\\d+)(?:_(.*))?$`),this.qi=new RegExp(`^firestore_targets_${c}_(\\d+)$`),this.Ki=`firestore_online_state_${this.persistenceKey}`,this.Gi=function(g){return`firestore_bundle_loaded_${g}`}(this.persistenceKey),this.window.addEventListener("storage",this.ki)}static Vt(e){return!(!e||!e.localStorage)}start(){var e=this;return(0,pe.Z)(function*(){const t=yield e.syncEngine.ds();for(const o of t){if(o===e.xi)continue;const u=e.getItem(WR(e.persistenceKey,o));if(u){const c=DD.Si(o,u);c&&(e.Mi=e.Mi.insert(c.clientId,c))}}e.ji();const r=e.storage.getItem(e.Ki);if(r){const o=e.Qi(r);o&&e.Wi(o)}for(const o of e.$i)e.Oi(o);e.$i=[],e.window.addEventListener("pagehide",()=>e.shutdown()),e.started=!0})()}writeSequenceNumber(e){this.setItem(this.Bi,JSON.stringify(e))}getAllActiveQueryTargets(){return this.zi(this.Mi)}isActiveQueryTarget(e){let t=!1;return this.Mi.forEach((r,o)=>{o.activeTargetIds.has(e)&&(t=!0)}),t}addPendingMutation(e){this.Hi(e,"pending")}updateMutationState(e,t,r){this.Hi(e,t,r),this.Ji(e)}addLocalQueryTarget(e){let t="not-current";if(this.isActiveQueryTarget(e)){const r=this.storage.getItem(FS(this.persistenceKey,e));if(r){const o=_0.Si(e,r);o&&(t=o.state)}}return this.Yi.Ci(e),this.ji(),t}removeLocalQueryTarget(e){this.Yi.Ni(e),this.ji()}isLocalQueryTarget(e){return this.Yi.activeTargetIds.has(e)}clearQueryState(e){this.removeItem(FS(this.persistenceKey,e))}updateQueryState(e,t,r){this.Xi(e,t,r)}handleUserChange(e,t,r){t.forEach(o=>{this.Ji(o)}),this.currentUser=e,r.forEach(o=>{this.addPendingMutation(o)})}setOnlineState(e){this.Zi(e)}notifyBundleLoaded(){this.tr()}shutdown(){this.started&&(this.window.removeEventListener("storage",this.ki),this.removeItem(this.Fi),this.started=!1)}getItem(e){const t=this.storage.getItem(e);return Le("SharedClientState","READ",e,t),t}setItem(e,t){Le("SharedClientState","SET",e,t),this.storage.setItem(e,t)}removeItem(e){Le("SharedClientState","REMOVE",e),this.storage.removeItem(e)}Oi(e){var t=this;const r=e;if(r.storageArea===this.storage){if(Le("SharedClientState","EVENT",r.key,r.newValue),r.key===this.Fi)return void Fr("Received WebStorage notification for local change. Another client might have garbage-collected our state");this.Sn.enqueueRetryable((0,pe.Z)(function*(){if(t.started){if(null!==r.key)if(t.Li.test(r.key)){if(null==r.newValue){const o=t.er(r.key);return t.nr(o,null)}{const o=t.sr(r.key,r.newValue);if(o)return t.nr(o.clientId,o)}}else if(t.Ui.test(r.key)){if(null!==r.newValue){const o=t.ir(r.key,r.newValue);if(o)return t.rr(o)}}else if(t.qi.test(r.key)){if(null!==r.newValue){const o=t.cr(r.key,r.newValue);if(o)return t.ur(o)}}else if(r.key===t.Ki){if(null!==r.newValue){const o=t.Qi(r.newValue);if(o)return t.Wi(o)}}else if(r.key===t.Bi){const o=function(u){let c=No.A;if(null!=u)try{const g=JSON.parse(u);It("number"==typeof g),c=g}catch(g){Fr("SharedClientState","Failed to read sequence number from WebStorage",g)}return c}(r.newValue);o!==No.A&&t.sequenceNumberHandler(o)}else if(r.key===t.Gi)return t.syncEngine.ar()}else t.$i.push(r)}))}}get Yi(){return this.Mi.get(this.xi)}ji(){this.setItem(this.Fi,this.Yi.Di())}Hi(e,t,r){const o=new CD(this.currentUser,e,t,r),u=qR(this.persistenceKey,this.currentUser,e);this.setItem(u,o.Di())}Ji(e){const t=qR(this.persistenceKey,this.currentUser,e);this.removeItem(t)}Zi(e){this.storage.setItem(this.Ki,JSON.stringify({clientId:this.xi,onlineState:e}))}Xi(e,t,r){const o=FS(this.persistenceKey,e),u=new _0(e,t,r);this.setItem(o,u.Di())}tr(){this.setItem(this.Gi,"value-not-used")}er(e){const t=this.Li.exec(e);return t?t[1]:null}sr(e,t){const r=this.er(e);return DD.Si(r,t)}ir(e,t){const r=this.Ui.exec(e),o=Number(r[1]);return CD.Si(new ki(void 0!==r[2]?r[2]:null),o,t)}cr(e,t){const r=this.qi.exec(e),o=Number(r[1]);return _0.Si(o,t)}Qi(e){return LS.Si(e)}rr(e){var t=this;return(0,pe.Z)(function*(){if(e.user.uid===t.currentUser.uid)return t.syncEngine.hr(e.batchId,e.state,e.error);Le("SharedClientState",`Ignoring mutation for non-active user ${e.user.uid}`)})()}ur(e){return this.syncEngine.lr(e.targetId,e.state,e.error)}nr(e,t){const r=t?this.Mi.insert(e,t):this.Mi.remove(e),o=this.zi(this.Mi),u=this.zi(r),c=[],g=[];return u.forEach(E=>{o.has(E)||c.push(E)}),o.forEach(E=>{u.has(E)||g.push(E)}),this.syncEngine.dr(c,g).then(()=>{this.Mi=r})}Wi(e){this.Mi.get(e.clientId)&&this.onlineStateHandler(e.onlineState)}zi(e){let t=dD();return e.forEach((r,o)=>{t=t.unionWith(o.activeTargetIds)}),t}}class zR{constructor(){this._r=new VS,this.wr={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}addPendingMutation(e){}updateMutationState(e,t,r){}addLocalQueryTarget(e){return this._r.Ci(e),this.wr[e]||"not-current"}updateQueryState(e,t,r){this.wr[e]=t}removeLocalQueryTarget(e){this._r.Ni(e)}isLocalQueryTarget(e){return this._r.activeTargetIds.has(e)}clearQueryState(e){delete this.wr[e]}getAllActiveQueryTargets(){return this._r.activeTargetIds}isActiveQueryTarget(e){return this._r.activeTargetIds.has(e)}start(){return this._r=new VS,Promise.resolve()}handleUserChange(e,t,r){}setOnlineState(e){}shutdown(){}writeSequenceNumber(e){}notifyBundleLoaded(){}}class s1{mr(e){}shutdown(){}}class KR{constructor(){this.gr=()=>this.yr(),this.pr=()=>this.Ir(),this.Er=[],this.Tr()}mr(e){this.Er.push(e)}shutdown(){window.removeEventListener("online",this.gr),window.removeEventListener("offline",this.pr)}Tr(){window.addEventListener("online",this.gr),window.addEventListener("offline",this.pr)}yr(){Le("ConnectivityMonitor","Network connectivity changed: AVAILABLE");for(const e of this.Er)e(0)}Ir(){Le("ConnectivityMonitor","Network connectivity changed: UNAVAILABLE");for(const e of this.Er)e(1)}static Vt(){return"undefined"!=typeof window&&void 0!==window.addEventListener&&void 0!==window.removeEventListener}}const o1={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery"};class a1{constructor(e){this.Ar=e.Ar,this.Rr=e.Rr}Pr(e){this.br=e}vr(e){this.Vr=e}onMessage(e){this.Sr=e}close(){this.Rr()}send(e){this.Ar(e)}Dr(){this.br()}Cr(e){this.Vr(e)}Nr(e){this.Sr(e)}}class u1 extends class{constructor(e){this.databaseInfo=e,this.databaseId=e.databaseId,this.kr=(e.ssl?"https":"http")+"://"+e.host,this.Or="projects/"+this.databaseId.projectId+"/databases/"+this.databaseId.database+"/documents"}Mr(e,t,r,o,u){const c=this.$r(e,t);Le("RestConnection","Sending: ",c,r);const g={};return this.Fr(g,o,u),this.Br(e,c,g,r).then(E=>(Le("RestConnection","Received: ",E),E),E=>{throw KE("RestConnection",`${e} failed with error: `,E,"url: ",c,"request:",r),E})}Lr(e,t,r,o,u){return this.Mr(e,t,r,o,u)}Fr(e,t,r){e["X-Goog-Api-Client"]="gl-js/ fire/"+C_,e["Content-Type"]="text/plain",this.databaseInfo.appId&&(e["X-Firebase-GMPID"]=this.databaseInfo.appId),t&&t.headers.forEach((o,u)=>e[u]=o),r&&r.headers.forEach((o,u)=>e[u]=o)}$r(e,t){return`${this.kr}/v1/${t}:${o1[e]}`}}{constructor(e){super(e),this.forceLongPolling=e.forceLongPolling,this.autoDetectLongPolling=e.autoDetectLongPolling,this.useFetchStreams=e.useFetchStreams}Br(e,t,r,o){return new Promise((u,c)=>{const g=new IO;g.listenOnce(vO.COMPLETE,()=>{try{switch(g.getLastErrorCode()){case zA.NO_ERROR:const I=g.getResponseJson();Le("Connection","XHR received:",JSON.stringify(I)),u(I);break;case zA.TIMEOUT:Le("Connection",'RPC "'+e+'" timed out'),c(new Me(ue.DEADLINE_EXCEEDED,"Request time out"));break;case zA.HTTP_ERROR:const S=g.getStatus();if(Le("Connection",'RPC "'+e+'" failed with status:',S,"response text:",g.getResponseText()),S>0){const M=g.getResponseJson().error;if(M&&M.status&&M.message){const F=function(W){const Y=W.toLowerCase().replace(/_/g,"-");return Object.values(ue).indexOf(Y)>=0?Y:ue.UNKNOWN}(M.status);c(new Me(F,M.message))}else c(new Me(ue.UNKNOWN,"Server responded with status "+g.getStatus()))}else c(new Me(ue.UNAVAILABLE,"Connection failed."));break;default:ut()}}finally{Le("Connection",'RPC "'+e+'" completed.')}});const E=JSON.stringify(o);g.send(t,"POST",E,r,15)})}Ur(e,t,r){const o=[this.kr,"/","google.firestore.v1.Firestore","/",e,"/channel"],u=_O(),c=yO(),g={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:`projects/${this.databaseId.projectId}/databases/${this.databaseId.database}`},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling};this.useFetchStreams&&(g.xmlHttpFactory=new wO({})),this.Fr(g.initMessageHeaders,t,r),(0,P.uI)()||(0,P.b$)()||(0,P.d)()||(0,P.w1)()||(0,P.Mn)()||(0,P.ru)()||(g.httpHeadersOverwriteParam="$httpHeaders");const E=o.join("");Le("Connection","Creating WebChannel: "+E,g);const I=u.createWebChannel(E,g);let S=!1,M=!1;const F=new a1({Ar:Y=>{M?Le("Connection","Not sending because WebChannel is closed:",Y):(S||(Le("Connection","Opening WebChannel transport."),I.open(),S=!0),Le("Connection","WebChannel sending:",Y),I.send(Y))},Rr:()=>I.close()}),W=(Y,xe,qe)=>{Y.listen(xe,Pt=>{try{qe(Pt)}catch(Bt){setTimeout(()=>{throw Bt},0)}})};return W(I,QC.EventType.OPEN,()=>{M||Le("Connection","WebChannel transport opened.")}),W(I,QC.EventType.CLOSE,()=>{M||(M=!0,Le("Connection","WebChannel transport closed"),F.Cr())}),W(I,QC.EventType.ERROR,Y=>{M||(M=!0,KE("Connection","WebChannel transport errored:",Y),F.Cr(new Me(ue.UNAVAILABLE,"The operation could not be completed")))}),W(I,QC.EventType.MESSAGE,Y=>{var xe;if(!M){const qe=Y.data[0];It(!!qe);const Pt=qe,Bt=Pt.error||(null===(xe=Pt[0])||void 0===xe?void 0:xe.error);if(Bt){Le("Connection","WebChannel received error:",Bt);const or=Bt.status;let zt=function(gu){const jD=Vr[gu];if(void 0!==jD)return zN(jD)}(or),ar=Bt.message;void 0===zt&&(zt=ue.INTERNAL,ar="Unknown error status: "+or+" with message "+Bt.message),M=!0,F.Cr(new Me(zt,ar)),I.close()}else Le("Connection","WebChannel received:",qe),F.Nr(qe)}}),W(c,EO.STAT_EVENT,Y=>{Y.stat===dN.PROXY?Le("Connection","Detected buffering proxy"):Y.stat===dN.NOPROXY&&Le("Connection","Detected no buffering proxy")}),setTimeout(()=>{F.Dr()},0),F}}function ZR(){return"undefined"!=typeof window?window:null}function bD(){return"undefined"!=typeof document?document:null}function y0(n){return new lk(n,!0)}class US{constructor(e,t,r=1e3,o=1.5,u=6e4){this.Sn=e,this.timerId=t,this.qr=r,this.Kr=o,this.Gr=u,this.jr=0,this.Qr=null,this.Wr=Date.now(),this.reset()}reset(){this.jr=0}zr(){this.jr=this.Gr}Hr(e){this.cancel();const t=Math.floor(this.jr+this.Jr()),r=Math.max(0,Date.now()-this.Wr),o=Math.max(0,t-r);o>0&&Le("ExponentialBackoff",`Backing off for ${o} ms (base delay: ${this.jr} ms, delay with jitter: ${t} ms, last attempt: ${r} ms ago)`),this.Qr=this.Sn.enqueueAfterDelay(this.timerId,o,()=>(this.Wr=Date.now(),e())),this.jr*=this.Kr,this.jr<this.qr&&(this.jr=this.qr),this.jr>this.Gr&&(this.jr=this.Gr)}Yr(){null!==this.Qr&&(this.Qr.skipDelay(),this.Qr=null)}cancel(){null!==this.Qr&&(this.Qr.cancel(),this.Qr=null)}Jr(){return(Math.random()-.5)*this.jr}}class YR{constructor(e,t,r,o,u,c,g,E){this.Sn=e,this.Xr=r,this.Zr=o,this.eo=u,this.authCredentialsProvider=c,this.appCheckCredentialsProvider=g,this.listener=E,this.state=0,this.no=0,this.so=null,this.io=null,this.stream=null,this.ro=new US(e,t)}oo(){return 1===this.state||5===this.state||this.co()}co(){return 2===this.state||3===this.state}start(){4!==this.state?this.auth():this.uo()}stop(){var e=this;return(0,pe.Z)(function*(){e.oo()&&(yield e.close(0))})()}ao(){this.state=0,this.ro.reset()}ho(){this.co()&&null===this.so&&(this.so=this.Sn.enqueueAfterDelay(this.Xr,6e4,()=>this.lo()))}fo(e){this._o(),this.stream.send(e)}lo(){var e=this;return(0,pe.Z)(function*(){if(e.co())return e.close(0)})()}_o(){this.so&&(this.so.cancel(),this.so=null)}wo(){this.io&&(this.io.cancel(),this.io=null)}close(e,t){var r=this;return(0,pe.Z)(function*(){r._o(),r.wo(),r.ro.cancel(),r.no++,4!==e?r.ro.reset():t&&t.code===ue.RESOURCE_EXHAUSTED?(Fr(t.toString()),Fr("Using maximum backoff delay to prevent overloading the backend."),r.ro.zr()):t&&t.code===ue.UNAUTHENTICATED&&3!==r.state&&(r.authCredentialsProvider.invalidateToken(),r.appCheckCredentialsProvider.invalidateToken()),null!==r.stream&&(r.mo(),r.stream.close(),r.stream=null),r.state=e,yield r.listener.vr(t)})()}mo(){}auth(){this.state=1;const e=this.yo(this.no),t=this.no;Promise.all([this.authCredentialsProvider.getToken(),this.appCheckCredentialsProvider.getToken()]).then(([r,o])=>{this.no===t&&this.po(r,o)},r=>{e(()=>{const o=new Me(ue.UNKNOWN,"Fetching auth token failed: "+r.message);return this.Io(o)})})}po(e,t){const r=this.yo(this.no);this.stream=this.Eo(e,t),this.stream.Pr(()=>{r(()=>(this.state=2,this.io=this.Sn.enqueueAfterDelay(this.Zr,1e4,()=>(this.co()&&(this.state=3),Promise.resolve())),this.listener.Pr()))}),this.stream.vr(o=>{r(()=>this.Io(o))}),this.stream.onMessage(o=>{r(()=>this.onMessage(o))})}uo(){var e=this;this.state=5,this.ro.Hr((0,pe.Z)(function*(){e.state=0,e.start()}))}Io(e){return Le("PersistentStream",`close with error: ${e}`),this.stream=null,this.close(4,e)}yo(e){return t=>{this.Sn.enqueueAndForget(()=>this.no===e?t():(Le("PersistentStream","stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve()))}}}class l1 extends YR{constructor(e,t,r,o,u,c){super(e,"listen_stream_connection_backoff","listen_stream_idle","health_check_timeout",t,r,o,c),this.O=u}Eo(e,t){return this.eo.Ur("Listen",e,t)}onMessage(e){this.ro.reset();const t=function hk(n,e){let t;if("targetChange"in e){const r="NO_CHANGE"===(E=e.targetChange.targetChangeType||"NO_CHANGE")?0:"ADD"===E?1:"REMOVE"===E?2:"CURRENT"===E?3:"RESET"===E?4:ut(),o=e.targetChange.targetIds||[],u=function(E,I){return E.N?(It(void 0===I||"string"==typeof I),Jr.fromBase64String(I||"")):(It(void 0===I||I instanceof Uint8Array),Jr.fromUint8Array(I||new Uint8Array))}(n,e.targetChange.resumeToken),c=e.targetChange.cause,g=c&&function(E){const I=void 0===E.code?ue.UNKNOWN:zN(E.code);return new Me(I,E.message||"")}(c);t=new YN(r,o,u,g||null)}else if("documentChange"in e){const r=e.documentChange,o=hl(n,r.document.name),u=fi(r.document.updateTime),c=new rs({mapValue:{fields:r.document.fields}}),g=sr.newFoundDocument(o,u,c);t=new hD(r.targetIds||[],r.removedTargetIds||[],g.key,g)}else if("documentDelete"in e){const r=e.documentDelete,o=hl(n,r.document),u=r.readTime?fi(r.readTime):yt.min(),c=sr.newNoDocument(o,u);t=new hD([],r.removedTargetIds||[],c.key,c)}else if("documentRemove"in e){const r=e.documentRemove,o=hl(n,r.document);t=new hD([],r.removedTargetIds||[],o,null)}else{if(!("filter"in e))return ut();{const r=e.filter,u=new ek(r.count||0);t=new ZN(r.targetId,u)}}var E;return t}(this.O,e),r=function(o){if(!("targetChange"in o))return yt.min();const u=o.targetChange;return u.targetIds&&u.targetIds.length?yt.min():u.readTime?fi(u.readTime):yt.min()}(e);return this.listener.To(t,r)}Ao(e){const t={};t.database=d0(this.O),t.addTarget=function(o,u){let c;const g=u.target;return c=iD(g)?{documents:oR(o,g)}:{query:aR(o,g)},c.targetId=u.targetId,u.resumeToken.approximateByteSize()>0?c.resumeToken=eR(o,u.resumeToken):u.snapshotVersion.compareTo(yt.min())>0&&(c.readTime=l0(o,u.snapshotVersion.toTimestamp())),c}(this.O,e);const r=function pk(n,e){const t=function(r,o){switch(o){case 0:return null;case 1:return"existence-filter-mismatch";case 2:return"limbo-document";default:return ut()}}(0,e.purpose);return null==t?null:{"goog-listen-tags":t}}(0,e);r&&(t.labels=r),this.fo(t)}Ro(e){const t={};t.database=d0(this.O),t.removeTarget=e,this.fo(t)}}class c1 extends YR{constructor(e,t,r,o,u,c){super(e,"write_stream_connection_backoff","write_stream_idle","health_check_timeout",t,r,o,c),this.O=u,this.Po=!1}get bo(){return this.Po}start(){this.Po=!1,this.lastStreamToken=void 0,super.start()}mo(){this.Po&&this.vo([])}Eo(e,t){return this.eo.Ur("Write",e,t)}onMessage(e){if(It(!!e.streamToken),this.lastStreamToken=e.streamToken,this.Po){this.ro.reset();const t=function fk(n,e){return n&&n.length>0?(It(void 0!==e),n.map(t=>function(r,o){let u=fi(r.updateTime?r.updateTime:o);return u.isEqual(yt.min())&&(u=fi(o)),new QO(u,r.transformResults||[])}(t,e))):[]}(e.writeResults,e.commitTime),r=fi(e.commitTime);return this.listener.Vo(r,t)}return It(!e.writeResults||0===e.writeResults.length),this.Po=!0,this.listener.So()}Do(){const e={};e.database=d0(this.O),this.fo(e)}vo(e){const t={streamToken:this.lastStreamToken,writes:e.map(r=>h0(this.O,r))};this.fo(t)}}class d1 extends class{}{constructor(e,t,r,o){super(),this.authCredentials=e,this.appCheckCredentials=t,this.eo=r,this.O=o,this.Co=!1}No(){if(this.Co)throw new Me(ue.FAILED_PRECONDITION,"The client has already been terminated.")}Mr(e,t,r){return this.No(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([o,u])=>this.eo.Mr(e,t,r,o,u)).catch(o=>{throw"FirebaseError"===o.name?(o.code===ue.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),o):new Me(ue.UNKNOWN,o.toString())})}Lr(e,t,r){return this.No(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([o,u])=>this.eo.Lr(e,t,r,o,u)).catch(o=>{throw"FirebaseError"===o.name?(o.code===ue.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),o):new Me(ue.UNKNOWN,o.toString())})}terminate(){this.Co=!0}}class h1{constructor(e,t){this.asyncQueue=e,this.onlineStateHandler=t,this.state="Unknown",this.xo=0,this.ko=null,this.Oo=!0}Mo(){0===this.xo&&(this.$o("Unknown"),this.ko=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,()=>(this.ko=null,this.Fo("Backend didn't respond within 10 seconds."),this.$o("Offline"),Promise.resolve())))}Bo(e){"Online"===this.state?this.$o("Unknown"):(this.xo++,this.xo>=1&&(this.Lo(),this.Fo(`Connection failed 1 times. Most recent error: ${e.toString()}`),this.$o("Offline")))}set(e){this.Lo(),this.xo=0,"Online"===e&&(this.Oo=!1),this.$o(e)}$o(e){e!==this.state&&(this.state=e,this.onlineStateHandler(e))}Fo(e){const t=`Could not reach Cloud Firestore backend. ${e}\nThis typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.`;this.Oo?(Fr(t),this.Oo=!1):Le("OnlineStateTracker",t)}Lo(){null!==this.ko&&(this.ko.cancel(),this.ko=null)}}class f1{constructor(e,t,r,o,u){var c=this;this.localStore=e,this.datastore=t,this.asyncQueue=r,this.remoteSyncer={},this.Uo=[],this.qo=new Map,this.Ko=new Set,this.Go=[],this.jo=u,this.jo.mr(g=>{r.enqueueAndForget((0,pe.Z)(function*(){var E;Sh(c)&&(Le("RemoteStore","Restarting streams for network reachability change."),yield(E=(0,pe.Z)(function*(I){const S=We(I);S.Ko.add(4),yield W_(S),S.Qo.set("Unknown"),S.Ko.delete(4),yield v0(S)}),function(I){return E.apply(this,arguments)})(c))}))}),this.Qo=new h1(r,o)}}function v0(n){return jS.apply(this,arguments)}function jS(){return jS=(0,pe.Z)(function*(n){if(Sh(n))for(const e of n.Go)yield e(!0)}),jS.apply(this,arguments)}function W_(n){return HS.apply(this,arguments)}function HS(){return HS=(0,pe.Z)(function*(n){for(const e of n.Go)yield e(!1)}),HS.apply(this,arguments)}function TD(n,e){const t=We(n);t.qo.has(e.targetId)||(t.qo.set(e.targetId,e),WS(t)?$S(t):z_(t).co()&&GS(t,e))}function E0(n,e){const t=We(n),r=z_(t);t.qo.delete(e),r.co()&&QR(t,e),0===t.qo.size&&(r.co()?r.ho():Sh(t)&&t.Qo.set("Unknown"))}function GS(n,e){n.Wo.Z(e.targetId),z_(n).Ao(e)}function QR(n,e){n.Wo.Z(e),z_(n).Ro(e)}function $S(n){n.Wo=new ok({getRemoteKeysForTarget:e=>n.remoteSyncer.getRemoteKeysForTarget(e),Tt:e=>n.qo.get(e)||null}),z_(n).start(),n.Qo.Mo()}function WS(n){return Sh(n)&&!z_(n).oo()&&n.qo.size>0}function Sh(n){return 0===We(n).Ko.size}function JR(n){n.Wo=void 0}function p1(n){return qS.apply(this,arguments)}function qS(){return qS=(0,pe.Z)(function*(n){n.qo.forEach((e,t)=>{GS(n,e)})}),qS.apply(this,arguments)}function g1(n,e){return zS.apply(this,arguments)}function zS(){return zS=(0,pe.Z)(function*(n,e){JR(n),WS(n)?(n.Qo.Bo(e),$S(n)):n.Qo.set("Unknown")}),zS.apply(this,arguments)}function m1(n,e,t){return KS.apply(this,arguments)}function KS(){return KS=(0,pe.Z)(function*(n,e,t){if(n.Qo.set("Online"),e instanceof YN&&2===e.state&&e.cause)try{yield(r=(0,pe.Z)(function*(o,u){const c=u.cause;for(const g of u.targetIds)o.qo.has(g)&&(yield o.remoteSyncer.rejectListen(g,c),o.qo.delete(g),o.Wo.removeTarget(g))}),function(o,u){return r.apply(this,arguments)})(n,e)}catch(r){Le("RemoteStore","Failed to remove targets %s: %s ",e.targetIds.join(","),r),yield AD(n,r)}else if(e instanceof hD?n.Wo.ct(e):e instanceof ZN?n.Wo._t(e):n.Wo.ht(e),!t.isEqual(yt.min()))try{const r=yield jR(n.localStore);t.compareTo(r)>=0&&(yield function(o,u){const c=o.Wo.yt(u);return c.targetChanges.forEach((g,E)=>{if(g.resumeToken.approximateByteSize()>0){const I=o.qo.get(E);I&&o.qo.set(E,I.withResumeToken(g.resumeToken,u))}}),c.targetMismatches.forEach(g=>{const E=o.qo.get(g);if(!E)return;o.qo.set(g,E.withResumeToken(Jr.EMPTY_BYTE_STRING,E.snapshotVersion)),QR(o,g);const I=new Dh(E.target,g,1,E.sequenceNumber);GS(o,I)}),o.remoteSyncer.applyRemoteEvent(c)}(n,t))}catch(r){Le("RemoteStore","Failed to raise snapshot:",r),yield AD(n,r)}var r}),KS.apply(this,arguments)}function AD(n,e,t){return ZS.apply(this,arguments)}function ZS(){return ZS=(0,pe.Z)(function*(n,e,t){if(!Lp(e))throw e;n.Ko.add(1),yield W_(n),n.Qo.set("Offline"),t||(t=()=>jR(n.localStore)),n.asyncQueue.enqueueRetryable((0,pe.Z)(function*(){Le("RemoteStore","Retrying IndexedDB access"),yield t(),n.Ko.delete(1),yield v0(n)}))}),ZS.apply(this,arguments)}function XR(n,e){return e().catch(t=>AD(n,t,e))}function q_(n){return YS.apply(this,arguments)}function YS(){return YS=(0,pe.Z)(function*(n){const e=We(n),t=xh(e);let r=e.Uo.length>0?e.Uo[e.Uo.length-1].batchId:-1;for(;_1(e);)try{const o=yield zk(e.localStore,r);if(null===o){0===e.Uo.length&&t.ho();break}r=o.batchId,y1(e,o)}catch(o){yield AD(e,o)}eP(e)&&tP(e)}),YS.apply(this,arguments)}function _1(n){return Sh(n)&&n.Uo.length<10}function y1(n,e){n.Uo.push(e);const t=xh(n);t.co()&&t.bo&&t.vo(e.mutations)}function eP(n){return Sh(n)&&!xh(n).oo()&&n.Uo.length>0}function tP(n){xh(n).start()}function v1(n){return QS.apply(this,arguments)}function QS(){return QS=(0,pe.Z)(function*(n){xh(n).Do()}),QS.apply(this,arguments)}function E1(n){return JS.apply(this,arguments)}function JS(){return JS=(0,pe.Z)(function*(n){const e=xh(n);for(const t of n.Uo)e.vo(t.mutations)}),JS.apply(this,arguments)}function w1(n,e,t){return XS.apply(this,arguments)}function XS(){return XS=(0,pe.Z)(function*(n,e,t){const r=n.Uo.shift(),o=fS.from(r,e,t);yield XR(n,()=>n.remoteSyncer.applySuccessfulWrite(o)),yield q_(n)}),XS.apply(this,arguments)}function I1(n,e){return ex.apply(this,arguments)}function ex(){return ex=(0,pe.Z)(function*(n,e){var t;e&&xh(n).bo&&(yield(t=(0,pe.Z)(function*(r,o){if(qN(u=o.code)&&u!==ue.ABORTED){const c=r.Uo.shift();xh(r).ao(),yield XR(r,()=>r.remoteSyncer.rejectFailedWrite(c.batchId,o)),yield q_(r)}var u}),function(r,o){return t.apply(this,arguments)})(n,e)),eP(n)&&tP(n)}),ex.apply(this,arguments)}function nP(n,e){return tx.apply(this,arguments)}function tx(){return tx=(0,pe.Z)(function*(n,e){const t=We(n);t.asyncQueue.verifyOperationInProgress(),Le("RemoteStore","RemoteStore received new credentials");const r=Sh(t);t.Ko.add(3),yield W_(t),r&&t.Qo.set("Unknown"),yield t.remoteSyncer.handleCredentialChange(e),t.Ko.delete(3),yield v0(t)}),tx.apply(this,arguments)}function nx(n,e){return rx.apply(this,arguments)}function rx(){return rx=(0,pe.Z)(function*(n,e){const t=We(n);e?(t.Ko.delete(2),yield v0(t)):e||(t.Ko.add(2),yield W_(t),t.Qo.set("Unknown"))}),rx.apply(this,arguments)}function z_(n){return n.zo||(n.zo=function(e,t,r){const o=We(e);return o.No(),new l1(t,o.eo,o.authCredentials,o.appCheckCredentials,o.O,r)}(n.datastore,n.asyncQueue,{Pr:p1.bind(null,n),vr:g1.bind(null,n),To:m1.bind(null,n)}),n.Go.push(function(){var e=(0,pe.Z)(function*(t){t?(n.zo.ao(),WS(n)?$S(n):n.Qo.set("Unknown")):(yield n.zo.stop(),JR(n))});return function(t){return e.apply(this,arguments)}}())),n.zo}function xh(n){return n.Ho||(n.Ho=function(e,t,r){const o=We(e);return o.No(),new c1(t,o.eo,o.authCredentials,o.appCheckCredentials,o.O,r)}(n.datastore,n.asyncQueue,{Pr:v1.bind(null,n),vr:I1.bind(null,n),So:E1.bind(null,n),Vo:w1.bind(null,n)}),n.Go.push(function(){var e=(0,pe.Z)(function*(t){t?(n.Ho.ao(),yield q_(n)):(yield n.Ho.stop(),n.Uo.length>0&&(Le("RemoteStore",`Stopping write stream with ${n.Uo.length} pending writes`),n.Uo=[]))});return function(t){return e.apply(this,arguments)}}())),n.Ho}class ix{constructor(e,t,r,o,u){this.asyncQueue=e,this.timerId=t,this.targetTimeMs=r,this.op=o,this.removalCallback=u,this.deferred=new ci,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch(c=>{})}static createAndSchedule(e,t,r,o,u){const c=Date.now()+r,g=new ix(e,t,c,o,u);return g.start(r),g}start(e){this.timerHandle=setTimeout(()=>this.handleDelayElapsed(),e)}skipDelay(){return this.handleDelayElapsed()}cancel(e){null!==this.timerHandle&&(this.clearTimeout(),this.deferred.reject(new Me(ue.CANCELLED,"Operation cancelled"+(e?": "+e:""))))}handleDelayElapsed(){this.asyncQueue.enqueueAndForget(()=>null!==this.timerHandle?(this.clearTimeout(),this.op().then(e=>this.deferred.resolve(e))):Promise.resolve())}clearTimeout(){null!==this.timerHandle&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)}}function K_(n,e){if(Fr("AsyncQueue",`${e}: ${n}`),Lp(n))return new Me(ue.UNAVAILABLE,`${e}: ${n}`);throw n}class Z_{constructor(e){this.comparator=e?(t,r)=>e(t,r)||Je.comparator(t.key,r.key):(t,r)=>Je.comparator(t.key,r.key),this.keyedMap=aS(),this.sortedSet=new Er(this.comparator)}static emptySet(e){return new Z_(e.comparator)}has(e){return null!=this.keyedMap.get(e)}get(e){return this.keyedMap.get(e)}first(){return this.sortedSet.minKey()}last(){return this.sortedSet.maxKey()}isEmpty(){return this.sortedSet.isEmpty()}indexOf(e){const t=this.keyedMap.get(e);return t?this.sortedSet.indexOf(t):-1}get size(){return this.sortedSet.size}forEach(e){this.sortedSet.inorderTraversal((t,r)=>(e(t),!1))}add(e){const t=this.delete(e.key);return t.copy(t.keyedMap.insert(e.key,e),t.sortedSet.insert(e,null))}delete(e){const t=this.get(e);return t?this.copy(this.keyedMap.remove(e),this.sortedSet.remove(t)):this}isEqual(e){if(!(e instanceof Z_)||this.size!==e.size)return!1;const t=this.sortedSet.getIterator(),r=e.sortedSet.getIterator();for(;t.hasNext();){const o=t.getNext().key,u=r.getNext().key;if(!o.isEqual(u))return!1}return!0}toString(){const e=[];return this.forEach(t=>{e.push(t.toString())}),0===e.length?"DocumentSet ()":"DocumentSet (\n  "+e.join("  \n")+"\n)"}copy(e,t){const r=new Z_;return r.comparator=this.comparator,r.keyedMap=e,r.sortedSet=t,r}}class rP{constructor(){this.Jo=new Er(Je.comparator)}track(e){const t=e.doc.key,r=this.Jo.get(t);r?0!==e.type&&3===r.type?this.Jo=this.Jo.insert(t,e):3===e.type&&1!==r.type?this.Jo=this.Jo.insert(t,{type:r.type,doc:e.doc}):2===e.type&&2===r.type?this.Jo=this.Jo.insert(t,{type:2,doc:e.doc}):2===e.type&&0===r.type?this.Jo=this.Jo.insert(t,{type:0,doc:e.doc}):1===e.type&&0===r.type?this.Jo=this.Jo.remove(t):1===e.type&&2===r.type?this.Jo=this.Jo.insert(t,{type:1,doc:r.doc}):0===e.type&&1===r.type?this.Jo=this.Jo.insert(t,{type:2,doc:e.doc}):ut():this.Jo=this.Jo.insert(t,e)}Yo(){const e=[];return this.Jo.inorderTraversal((t,r)=>{e.push(r)}),e}}class Y_{constructor(e,t,r,o,u,c,g,E){this.query=e,this.docs=t,this.oldDocs=r,this.docChanges=o,this.mutatedKeys=u,this.fromCache=c,this.syncStateChanged=g,this.excludesMetadataChanges=E}static fromInitialDocuments(e,t,r,o){const u=[];return t.forEach(c=>{u.push({type:0,doc:c})}),new Y_(e,t,Z_.emptySet(t),u,r,o,!0,!1)}get hasPendingWrites(){return!this.mutatedKeys.isEmpty()}isEqual(e){if(!(this.fromCache===e.fromCache&&this.syncStateChanged===e.syncStateChanged&&this.mutatedKeys.isEqual(e.mutatedKeys)&&n0(this.query,e.query)&&this.docs.isEqual(e.docs)&&this.oldDocs.isEqual(e.oldDocs)))return!1;const t=this.docChanges,r=e.docChanges;if(t.length!==r.length)return!1;for(let o=0;o<t.length;o++)if(t[o].type!==r[o].type||!t[o].doc.isEqual(r[o].doc))return!1;return!0}}class C1{constructor(){this.Xo=void 0,this.listeners=[]}}class D1{constructor(){this.queries=new H_(e=>NN(e),n0),this.onlineState="Unknown",this.Zo=new Set}}function sx(n,e){return ox.apply(this,arguments)}function ox(){return ox=(0,pe.Z)(function*(n,e){const t=We(n),r=e.query;let o=!1,u=t.queries.get(r);if(u||(o=!0,u=new C1),o)try{u.Xo=yield t.onListen(r)}catch(c){const g=K_(c,`Initialization of query '${rS(e.query)}' failed`);return void e.onError(g)}t.queries.set(r,u),u.listeners.push(e),e.tc(t.onlineState),u.Xo&&e.ec(u.Xo)&&lx(t)}),ox.apply(this,arguments)}function ax(n,e){return ux.apply(this,arguments)}function ux(){return ux=(0,pe.Z)(function*(n,e){const t=We(n),r=e.query;let o=!1;const u=t.queries.get(r);if(u){const c=u.listeners.indexOf(e);c>=0&&(u.listeners.splice(c,1),o=0===u.listeners.length)}if(o)return t.queries.delete(r),t.onUnlisten(r)}),ux.apply(this,arguments)}function b1(n,e){const t=We(n);let r=!1;for(const o of e){const c=t.queries.get(o.query);if(c){for(const g of c.listeners)g.ec(o)&&(r=!0);c.Xo=o}}r&&lx(t)}function T1(n,e,t){const r=We(n),o=r.queries.get(e);if(o)for(const u of o.listeners)u.onError(t);r.queries.delete(e)}function lx(n){n.Zo.forEach(e=>{e.next()})}class cx{constructor(e,t,r){this.query=e,this.nc=t,this.sc=!1,this.ic=null,this.onlineState="Unknown",this.options=r||{}}ec(e){if(!this.options.includeMetadataChanges){const r=[];for(const o of e.docChanges)3!==o.type&&r.push(o);e=new Y_(e.query,e.docs,e.oldDocs,r,e.mutatedKeys,e.fromCache,e.syncStateChanged,!0)}let t=!1;return this.sc?this.rc(e)&&(this.nc.next(e),t=!0):this.oc(e,this.onlineState)&&(this.cc(e),t=!0),this.ic=e,t}onError(e){this.nc.error(e)}tc(e){this.onlineState=e;let t=!1;return this.ic&&!this.sc&&this.oc(this.ic,e)&&(this.cc(this.ic),t=!0),t}oc(e,t){return!e.fromCache||!(this.options.uc&&"Offline"!==t||e.docs.isEmpty()&&"Offline"!==t)}rc(e){return e.docChanges.length>0||!!(e.syncStateChanged||this.ic&&this.ic.hasPendingWrites!==e.hasPendingWrites)&&!0===this.options.includeMetadataChanges}cc(e){e=Y_.fromInitialDocuments(e.query,e.docs,e.mutatedKeys,e.fromCache),this.sc=!0,this.nc.next(e)}}class A1{constructor(e,t){this.payload=e,this.byteLength=t}ac(){return"metadata"in this.payload}}class iP{constructor(e){this.O=e}Gs(e){return hl(this.O,e)}js(e){return e.metadata.exists?sR(this.O,e.document,!1):sr.newNoDocument(this.Gs(e.metadata.name),this.Qs(e.metadata.readTime))}Qs(e){return fi(e)}}class S1{constructor(e,t,r){this.hc=e,this.localStore=t,this.O=r,this.queries=[],this.documents=[],this.progress=sP(e)}lc(e){this.progress.bytesLoaded+=e.byteLength;let t=this.progress.documentsLoaded;return e.payload.namedQuery?this.queries.push(e.payload.namedQuery):e.payload.documentMetadata?(this.documents.push({metadata:e.payload.documentMetadata}),e.payload.documentMetadata.exists||++t):e.payload.document&&(this.documents[this.documents.length-1].document=e.payload.document,++t),t!==this.progress.documentsLoaded?(this.progress.documentsLoaded=t,Object.assign({},this.progress)):null}fc(e){const t=new Map,r=new iP(this.O);for(const o of e)if(o.metadata.queries){const u=r.Gs(o.metadata.name);for(const c of o.metadata.queries){const g=(t.get(c)||hn()).add(u);t.set(c,g)}}return t}complete(){var e=this;return(0,pe.Z)(function*(){const t=yield function Zk(n,e,t,r){return RS.apply(this,arguments)}(e.localStore,new iP(e.O),e.documents,e.hc.id),r=e.fc(e.documents);for(const o of e.queries)yield Yk(e.localStore,o,r.get(o.name));return e.progress.taskState="Success",new Hk(Object.assign({},e.progress),t)})()}}function sP(n){return{taskState:"Running",documentsLoaded:0,bytesLoaded:0,totalDocuments:n.totalDocuments,totalBytes:n.totalBytes}}class oP{constructor(e){this.key=e}}class aP{constructor(e){this.key=e}}class uP{constructor(e,t){this.query=e,this.dc=t,this._c=null,this.current=!1,this.wc=hn(),this.mutatedKeys=hn(),this.mc=RN(e),this.gc=new Z_(this.mc)}get yc(){return this.dc}Ic(e,t){const r=t?t.Ec:new rP,o=t?t.gc:this.gc;let u=t?t.mutatedKeys:this.mutatedKeys,c=o,g=!1;const E=sD(this.query)&&o.size===this.query.limit?o.last():null,I=oD(this.query)&&o.size===this.query.limit?o.first():null;if(e.inorderTraversal((S,M)=>{const F=o.get(S),W=iS(this.query,M)?M:null,Y=!!F&&this.mutatedKeys.has(F.key),xe=!!W&&(W.hasLocalMutations||this.mutatedKeys.has(W.key)&&W.hasCommittedMutations);let qe=!1;F&&W?F.data.isEqual(W.data)?Y!==xe&&(r.track({type:3,doc:W}),qe=!0):this.Tc(F,W)||(r.track({type:2,doc:W}),qe=!0,(E&&this.mc(W,E)>0||I&&this.mc(W,I)<0)&&(g=!0)):!F&&W?(r.track({type:0,doc:W}),qe=!0):F&&!W&&(r.track({type:1,doc:F}),qe=!0,(E||I)&&(g=!0)),qe&&(W?(c=c.add(W),u=xe?u.add(S):u.delete(S)):(c=c.delete(S),u=u.delete(S)))}),sD(this.query)||oD(this.query))for(;c.size>this.query.limit;){const S=sD(this.query)?c.last():c.first();c=c.delete(S.key),u=u.delete(S.key),r.track({type:1,doc:S})}return{gc:c,Ec:r,ks:g,mutatedKeys:u}}Tc(e,t){return e.hasLocalMutations&&t.hasCommittedMutations&&!t.hasLocalMutations}applyChanges(e,t,r){const o=this.gc;this.gc=e.gc,this.mutatedKeys=e.mutatedKeys;const u=e.Ec.Yo();u.sort((I,S)=>function(M,F){const W=Y=>{switch(Y){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return ut()}};return W(M)-W(F)}(I.type,S.type)||this.mc(I.doc,S.doc)),this.Ac(r);const c=t?this.Rc():[],g=0===this.wc.size&&this.current?1:0,E=g!==this._c;return this._c=g,0!==u.length||E?{snapshot:new Y_(this.query,e.gc,o,u,e.mutatedKeys,0===g,E,!1),Pc:c}:{Pc:c}}tc(e){return this.current&&"Offline"===e?(this.current=!1,this.applyChanges({gc:this.gc,Ec:new rP,mutatedKeys:this.mutatedKeys,ks:!1},!1)):{Pc:[]}}bc(e){return!this.dc.has(e)&&!!this.gc.has(e)&&!this.gc.get(e).hasLocalMutations}Ac(e){e&&(e.addedDocuments.forEach(t=>this.dc=this.dc.add(t)),e.modifiedDocuments.forEach(t=>{}),e.removedDocuments.forEach(t=>this.dc=this.dc.delete(t)),this.current=e.current)}Rc(){if(!this.current)return[];const e=this.wc;this.wc=hn(),this.gc.forEach(r=>{this.bc(r.key)&&(this.wc=this.wc.add(r.key))});const t=[];return e.forEach(r=>{this.wc.has(r)||t.push(new aP(r))}),this.wc.forEach(r=>{e.has(r)||t.push(new oP(r))}),t}vc(e){this.dc=e.Ks,this.wc=hn();const t=this.Ic(e.documents);return this.applyChanges(t,!0)}Vc(){return Y_.fromInitialDocuments(this.query,this.gc,this.mutatedKeys,0===this._c)}}class x1{constructor(e,t,r){this.query=e,this.targetId=t,this.view=r}}class M1{constructor(e){this.key=e,this.Sc=!1}}class N1{constructor(e,t,r,o,u,c){this.localStore=e,this.remoteStore=t,this.eventManager=r,this.sharedClientState=o,this.currentUser=u,this.maxConcurrentLimboResolutions=c,this.Dc={},this.Cc=new H_(g=>NN(g),n0),this.Nc=new Map,this.xc=new Set,this.kc=new Er(Je.comparator),this.Oc=new Map,this.Mc=new OS,this.$c={},this.Fc=new Map,this.Bc=jp.Je(),this.onlineState="Unknown",this.Lc=void 0}get isPrimaryClient(){return!0===this.Lc}}function R1(n,e){return dx.apply(this,arguments)}function dx(){return dx=(0,pe.Z)(function*(n,e){const t=Ox(n);let r,o;const u=t.Cc.get(e);if(u)r=u.targetId,t.sharedClientState.addLocalQueryTarget(r),o=u.view.Vc();else{const c=yield G_(t.localStore,ma(e));t.isPrimaryClient&&TD(t.remoteStore,c);const g=t.sharedClientState.addLocalQueryTarget(c.targetId);r=c.targetId,o=yield hx(t,e,r,"current"===g)}return o}),dx.apply(this,arguments)}function hx(n,e,t,r){return fx.apply(this,arguments)}function fx(){return fx=(0,pe.Z)(function*(n,e,t,r){n.Uc=(S,M,F)=>{return(W=(0,pe.Z)(function*(Y,xe,qe,Pt){let Bt=xe.view.Ic(qe);Bt.ks&&(Bt=yield ID(Y.localStore,xe.query,!1).then(({documents:ar})=>xe.view.Ic(ar,Bt)));const or=Pt&&Pt.targetChanges.get(xe.targetId),zt=xe.view.applyChanges(Bt,Y.isPrimaryClient,or);return Cx(Y,xe.targetId,zt.Pc),zt.snapshot}),function(Y,xe,qe,Pt){return W.apply(this,arguments)})(n,S,M,F);var W};const o=yield ID(n.localStore,e,!0),u=new uP(e,o.Ks),c=u.Ic(o.documents),g=u0.createSynthesizedTargetChangeForCurrentChange(t,r&&"Offline"!==n.onlineState),E=u.applyChanges(c,n.isPrimaryClient,g);Cx(n,t,E.Pc);const I=new x1(e,t,u);return n.Cc.set(e,I),n.Nc.has(t)?n.Nc.get(t).push(e):n.Nc.set(t,[e]),E.snapshot}),fx.apply(this,arguments)}function P1(n,e){return px.apply(this,arguments)}function px(){return px=(0,pe.Z)(function*(n,e){const t=We(n),r=t.Cc.get(e),o=t.Nc.get(r.targetId);if(o.length>1)return t.Nc.set(r.targetId,o.filter(u=>!n0(u,e))),void t.Cc.delete(e);t.isPrimaryClient?(t.sharedClientState.removeLocalQueryTarget(r.targetId),t.sharedClientState.isActiveQueryTarget(r.targetId)||(yield $_(t.localStore,r.targetId,!1).then(()=>{t.sharedClientState.clearQueryState(r.targetId),E0(t.remoteStore,r.targetId),Q_(t,r.targetId)}).catch(Hp))):(Q_(t,r.targetId),yield $_(t.localStore,r.targetId,!0))}),px.apply(this,arguments)}function gx(){return gx=(0,pe.Z)(function*(n,e,t){const r=kx(n);try{const o=yield function(u,c){const g=We(u),E=di.now(),I=c.reduce((M,F)=>M.add(F.key),hn());let S;return g.persistence.runTransaction("Locally write mutations","readwrite",M=>g.Us.Es(M,I).next(F=>{S=F;const W=[];for(const Y of c){const xe=XO(Y,S.get(Y.key));null!=xe&&W.push(new kp(Y.key,xe,DN(xe.value.mapValue),Lr.exists(!0)))}return g.gs.addMutationBatch(M,E,W,c)})).then(M=>(M.applyToLocalDocumentSet(S),{batchId:M.batchId,changes:S}))}(r.localStore,e);r.sharedClientState.addPendingMutation(o.batchId),function(u,c,g){let E=u.$c[u.currentUser.toKey()];E||(E=new Er(Gt)),E=E.insert(c,g),u.$c[u.currentUser.toKey()]=E}(r,o.batchId,t),yield Oc(r,o.changes),yield q_(r.remoteStore)}catch(o){const u=K_(o,"Failed to persist write");t.reject(u)}}),gx.apply(this,arguments)}function lP(n,e){return mx.apply(this,arguments)}function mx(){return mx=(0,pe.Z)(function*(n,e){const t=We(n);try{const r=yield qk(t.localStore,e);e.targetChanges.forEach((o,u)=>{const c=t.Oc.get(u);c&&(It(o.addedDocuments.size+o.modifiedDocuments.size+o.removedDocuments.size<=1),o.addedDocuments.size>0?c.Sc=!0:o.modifiedDocuments.size>0?It(c.Sc):o.removedDocuments.size>0&&(It(c.Sc),c.Sc=!1))}),yield Oc(t,r,e)}catch(r){yield Hp(r)}}),mx.apply(this,arguments)}function cP(n,e,t){const r=We(n);if(r.isPrimaryClient&&0===t||!r.isPrimaryClient&&1===t){const o=[];r.Cc.forEach((u,c)=>{const g=c.view.tc(e);g.snapshot&&o.push(g.snapshot)}),function(u,c){const g=We(u);g.onlineState=c;let E=!1;g.queries.forEach((I,S)=>{for(const M of S.listeners)M.tc(c)&&(E=!0)}),E&&lx(g)}(r.eventManager,e),o.length&&r.Dc.To(o),r.onlineState=e,r.isPrimaryClient&&r.sharedClientState.setOnlineState(e)}}function k1(n,e,t){return _x.apply(this,arguments)}function _x(){return _x=(0,pe.Z)(function*(n,e,t){const r=We(n);r.sharedClientState.updateQueryState(e,"rejected",t);const o=r.Oc.get(e),u=o&&o.key;if(u){let c=new Er(Je.comparator);c=c.insert(u,sr.newNoDocument(u,yt.min()));const g=hn().add(u),E=new a0(yt.min(),new Map,new Zn(Gt),c,g);yield lP(r,E),r.kc=r.kc.remove(u),r.Oc.delete(e),Dx(r)}else yield $_(r.localStore,e,!1).then(()=>Q_(r,e,t)).catch(Hp)}),_x.apply(this,arguments)}function F1(n,e){return yx.apply(this,arguments)}function yx(){return yx=(0,pe.Z)(function*(n,e){const t=We(n),r=e.batch.batchId;try{const o=yield Wk(t.localStore,e);Ix(t,r,null),wx(t,r),t.sharedClientState.updateMutationState(r,"acknowledged"),yield Oc(t,o)}catch(o){yield Hp(o)}}),yx.apply(this,arguments)}function L1(n,e,t){return vx.apply(this,arguments)}function vx(){return vx=(0,pe.Z)(function*(n,e,t){const r=We(n);try{const o=yield function(u,c){const g=We(u);return g.persistence.runTransaction("Reject batch","readwrite-primary",E=>{let I;return g.gs.lookupMutationBatch(E,c).next(S=>(It(null!==S),I=S.keys(),g.gs.removeMutationBatch(E,S))).next(()=>g.gs.performConsistencyCheck(E)).next(()=>g.Us.Es(E,I))})}(r.localStore,e);Ix(r,e,t),wx(r,e),r.sharedClientState.updateMutationState(e,"rejected",t),yield Oc(r,o)}catch(o){yield Hp(o)}}),vx.apply(this,arguments)}function Ex(){return Ex=(0,pe.Z)(function*(n,e){const t=We(n);Sh(t.remoteStore)||Le("SyncEngine","The network is disabled. The task returned by 'awaitPendingWrites()' will not complete until the network is enabled.");try{const r=yield function(u){const c=We(u);return c.persistence.runTransaction("Get highest unacknowledged batch id","readonly",g=>c.gs.getHighestUnacknowledgedBatchId(g))}(t.localStore);if(-1===r)return void e.resolve();const o=t.Fc.get(r)||[];o.push(e),t.Fc.set(r,o)}catch(r){const o=K_(r,"Initialization of waitForPendingWrites() operation failed");e.reject(o)}}),Ex.apply(this,arguments)}function wx(n,e){(n.Fc.get(e)||[]).forEach(t=>{t.resolve()}),n.Fc.delete(e)}function Ix(n,e,t){const r=We(n);let o=r.$c[r.currentUser.toKey()];if(o){const u=o.get(e);u&&(t?u.reject(t):u.resolve(),o=o.remove(e)),r.$c[r.currentUser.toKey()]=o}}function Q_(n,e,t=null){n.sharedClientState.removeLocalQueryTarget(e);for(const r of n.Nc.get(e))n.Cc.delete(r),t&&n.Dc.qc(r,t);n.Nc.delete(e),n.isPrimaryClient&&n.Mc.si(e).forEach(r=>{n.Mc.containsKey(r)||dP(n,r)})}function dP(n,e){n.xc.delete(e.path.canonicalString());const t=n.kc.get(e);null!==t&&(E0(n.remoteStore,t),n.kc=n.kc.remove(e),n.Oc.delete(t),Dx(n))}function Cx(n,e,t){for(const r of t)r instanceof oP?(n.Mc.addReference(r.key,e),B1(n,r)):r instanceof aP?(Le("SyncEngine","Document no longer in limbo: "+r.key),n.Mc.removeReference(r.key,e),n.Mc.containsKey(r.key)||dP(n,r.key)):ut()}function B1(n,e){const t=e.key,r=t.path.canonicalString();n.kc.get(t)||n.xc.has(r)||(Le("SyncEngine","New document in limbo: "+t),n.xc.add(r),Dx(n))}function Dx(n){for(;n.xc.size>0&&n.kc.size<n.maxConcurrentLimboResolutions;){const e=n.xc.values().next().value;n.xc.delete(e);const t=new Je(rn.fromString(e)),r=n.Bc.next();n.Oc.set(r,new M1(t)),n.kc=n.kc.insert(t,r),TD(n.remoteStore,new Dh(ma(M_(t.path)),r,2,No.A))}}function Oc(n,e,t){return bx.apply(this,arguments)}function bx(){return bx=(0,pe.Z)(function*(n,e,t){const r=We(n),o=[],u=[],c=[];var g;r.Cc.isEmpty()||(r.Cc.forEach((g,E)=>{c.push(r.Uc(E,e,t).then(I=>{if(I){r.isPrimaryClient&&r.sharedClientState.updateQueryState(E.targetId,I.fromCache?"not-current":"current"),o.push(I);const S=SS.Ss(E.targetId,I);u.push(S)}}))}),yield Promise.all(c),r.Dc.To(o),yield(g=(0,pe.Z)(function*(E,I){const S=We(E);try{yield S.persistence.runTransaction("notifyLocalViewChanges","readwrite",M=>fe.forEach(I,F=>fe.forEach(F.vs,W=>S.persistence.referenceDelegate.addReference(M,F.targetId,W)).next(()=>fe.forEach(F.Vs,W=>S.persistence.referenceDelegate.removeReference(M,F.targetId,W)))))}catch(M){if(!Lp(M))throw M;Le("LocalStore","Failed to update sequence numbers: "+M)}for(const M of I){const F=M.targetId;if(!M.fromCache){const W=S.Ms.get(F),xe=W.withLastLimboFreeSnapshotVersion(W.snapshotVersion);S.Ms=S.Ms.insert(F,xe)}}}),function(E,I){return g.apply(this,arguments)})(r.localStore,u))}),bx.apply(this,arguments)}function U1(n,e){return Tx.apply(this,arguments)}function Tx(){return Tx=(0,pe.Z)(function*(n,e){const t=We(n);if(!t.currentUser.isEqual(e)){Le("SyncEngine","User change. New user:",e.toKey());const r=yield UR(t.localStore,e);t.currentUser=e,(o=t).Fc.forEach(c=>{c.forEach(g=>{g.reject(new Me(ue.CANCELLED,"'waitForPendingWrites' promise is rejected due to a user change."))})}),o.Fc.clear(),t.sharedClientState.handleUserChange(e,r.removedBatchIds,r.addedBatchIds),yield Oc(t,r.qs)}var o}),Tx.apply(this,arguments)}function j1(n,e){const t=We(n),r=t.Oc.get(e);if(r&&r.Sc)return hn().add(r.key);{let o=hn();const u=t.Nc.get(e);if(!u)return o;for(const c of u){const g=t.Cc.get(c);o=o.unionWith(g.view.yc)}return o}}function H1(n,e){return Ax.apply(this,arguments)}function Ax(){return Ax=(0,pe.Z)(function*(n,e){const t=We(n),r=yield ID(t.localStore,e.query,!0),o=e.view.vc(r);return t.isPrimaryClient&&Cx(t,e.targetId,o.Pc),o}),Ax.apply(this,arguments)}function G1(n){return Sx.apply(this,arguments)}function Sx(){return Sx=(0,pe.Z)(function*(n){const e=We(n);return $R(e.localStore).then(t=>Oc(e,t))}),Sx.apply(this,arguments)}function $1(n,e,t,r){return xx.apply(this,arguments)}function xx(){return xx=(0,pe.Z)(function*(n,e,t,r){const o=We(n),u=yield function(c,g){const E=We(c),I=We(E.gs);return E.persistence.runTransaction("Lookup mutation documents","readonly",S=>I.Ge(S,g).next(M=>M?E.Us.Es(S,M):fe.resolve(null)))}(o.localStore,e);var g;null!==u?("pending"===t?yield q_(o.remoteStore):"acknowledged"===t||"rejected"===t?(Ix(o,e,r||null),wx(o,e),g=e,We(We(o.localStore).gs).Qe(g)):ut(),yield Oc(o,u)):Le("SyncEngine","Cannot apply mutation batch with id: "+e)}),xx.apply(this,arguments)}function Mx(){return Mx=(0,pe.Z)(function*(n,e){const t=We(n);if(Ox(t),kx(t),!0===e&&!0!==t.Lc){const r=t.sharedClientState.getAllActiveQueryTargets(),o=yield hP(t,r.toArray());t.Lc=!0,yield nx(t.remoteStore,!0);for(const u of o)TD(t.remoteStore,u)}else if(!1===e&&!1!==t.Lc){const r=[];let o=Promise.resolve();t.Nc.forEach((u,c)=>{t.sharedClientState.isLocalQueryTarget(c)?r.push(c):o=o.then(()=>(Q_(t,c),$_(t.localStore,c,!0))),E0(t.remoteStore,c)}),yield o,yield hP(t,r),function(u){const c=We(u);c.Oc.forEach((g,E)=>{E0(c.remoteStore,E)}),c.Mc.ii(),c.Oc=new Map,c.kc=new Er(Je.comparator)}(t),t.Lc=!1,yield nx(t.remoteStore,!1)}}),Mx.apply(this,arguments)}function hP(n,e,t){return Nx.apply(this,arguments)}function Nx(){return Nx=(0,pe.Z)(function*(n,e,t){const r=We(n),o=[],u=[];for(const c of e){let g;const E=r.Nc.get(c);if(E&&0!==E.length){g=yield G_(r.localStore,ma(E[0]));for(const I of E){const S=r.Cc.get(I),M=yield H1(r,S);M.snapshot&&u.push(M.snapshot)}}else{const I=yield GR(r.localStore,c);g=yield G_(r.localStore,I),yield hx(r,fP(I),c,!1)}o.push(g)}return r.Dc.To(u),o}),Nx.apply(this,arguments)}function fP(n){return xN(n.path,n.collectionGroup,n.orderBy,n.filters,n.limit,"F",n.startAt,n.endAt)}function q1(n){const e=We(n);return We(We(e.localStore).persistence).ds()}function z1(n,e,t,r){return Rx.apply(this,arguments)}function Rx(){return Rx=(0,pe.Z)(function*(n,e,t,r){const o=We(n);if(o.Lc)Le("SyncEngine","Ignoring unexpected query state notification.");else if(o.Nc.has(e))switch(t){case"current":case"not-current":{const u=yield $R(o.localStore),c=a0.createSynthesizedRemoteEventForCurrentChange(e,"current"===t);yield Oc(o,u,c);break}case"rejected":yield $_(o.localStore,e,!0),Q_(o,e,r);break;default:ut()}}),Rx.apply(this,arguments)}function K1(n,e,t){return Px.apply(this,arguments)}function Px(){return Px=(0,pe.Z)(function*(n,e,t){const r=Ox(n);if(r.Lc){for(const o of e){if(r.Nc.has(o)){Le("SyncEngine","Adding an already active target "+o);continue}const u=yield GR(r.localStore,o),c=yield G_(r.localStore,u);yield hx(r,fP(u),c.targetId,!1),TD(r.remoteStore,c)}for(const o of t)r.Nc.has(o)&&(yield $_(r.localStore,o,!1).then(()=>{E0(r.remoteStore,o),Q_(r,o)}).catch(Hp))}}),Px.apply(this,arguments)}function Ox(n){const e=We(n);return e.remoteStore.remoteSyncer.applyRemoteEvent=lP.bind(null,e),e.remoteStore.remoteSyncer.getRemoteKeysForTarget=j1.bind(null,e),e.remoteStore.remoteSyncer.rejectListen=k1.bind(null,e),e.Dc.To=b1.bind(null,e.eventManager),e.Dc.qc=T1.bind(null,e.eventManager),e}function kx(n){const e=We(n);return e.remoteStore.remoteSyncer.applySuccessfulWrite=F1.bind(null,e),e.remoteStore.remoteSyncer.rejectFailedWrite=L1.bind(null,e),e}class pP{constructor(){this.synchronizeTabs=!1}initialize(e){var t=this;return(0,pe.Z)(function*(){t.O=y0(e.databaseInfo.databaseId),t.sharedClientState=t.Gc(e),t.persistence=t.jc(e),yield t.persistence.start(),t.gcScheduler=t.Qc(e),t.localStore=t.Wc(e)})()}Qc(e){return null}Wc(e){return BR(this.persistence,new VR,e.initialUser,this.O)}jc(e){return new r1(kS.bi,this.O)}Gc(e){return new zR}terminate(){var e=this;return(0,pe.Z)(function*(){e.gcScheduler&&e.gcScheduler.stop(),yield e.sharedClientState.shutdown(),yield e.persistence.shutdown()})()}}class gP extends pP{constructor(e,t,r){super(),this.zc=e,this.cacheSizeBytes=t,this.forceOwnership=r,this.synchronizeTabs=!1}initialize(e){var t=()=>super.initialize,r=this;return(0,pe.Z)(function*(){yield t().call(r,e),yield function Kk(n){return NS.apply(this,arguments)}(r.localStore),yield r.zc.initialize(r,e),yield kx(r.zc.syncEngine),yield q_(r.zc.remoteStore),yield r.persistence.Hn(()=>(r.gcScheduler&&!r.gcScheduler.started&&r.gcScheduler.start(r.localStore),Promise.resolve()))})()}Wc(e){return BR(this.persistence,new VR,e.initialUser,this.O)}Qc(e){return new Fk(this.persistence.referenceDelegate.garbageCollector,e.asyncQueue)}jc(e){const t=AS(e.databaseInfo.databaseId,e.databaseInfo.persistenceKey),r=void 0!==this.cacheSizeBytes?Js.withCacheSize(this.cacheSizeBytes):Js.DEFAULT;return new TS(this.synchronizeTabs,t,e.clientId,r,e.asyncQueue,ZR(),bD(),this.O,this.sharedClientState,!!this.forceOwnership)}Gc(e){return new zR}}class Y1 extends gP{constructor(e,t){super(e,t,!1),this.zc=e,this.cacheSizeBytes=t,this.synchronizeTabs=!0}initialize(e){var t=()=>super.initialize,r=this;return(0,pe.Z)(function*(){yield t().call(r,e);const o=r.zc.syncEngine;r.sharedClientState instanceof BS&&(r.sharedClientState.syncEngine={hr:$1.bind(null,o),lr:z1.bind(null,o),dr:K1.bind(null,o),ds:q1.bind(null,o),ar:G1.bind(null,o)},yield r.sharedClientState.start()),yield r.persistence.Hn(function(){var u=(0,pe.Z)(function*(c){yield function W1(n,e){return Mx.apply(this,arguments)}(r.zc.syncEngine,c),r.gcScheduler&&(c&&!r.gcScheduler.started?r.gcScheduler.start(r.localStore):c||r.gcScheduler.stop())});return function(c){return u.apply(this,arguments)}}())})()}Gc(e){const t=ZR();if(!BS.Vt(t))throw new Me(ue.UNIMPLEMENTED,"IndexedDB persistence is only available on platforms that support LocalStorage.");const r=AS(e.databaseInfo.databaseId,e.databaseInfo.persistenceKey);return new BS(t,e.asyncQueue,r,e.clientId,e.initialUser)}}class Fx{initialize(e,t){var r=this;return(0,pe.Z)(function*(){r.localStore||(r.localStore=e.localStore,r.sharedClientState=e.sharedClientState,r.datastore=r.createDatastore(t),r.remoteStore=r.createRemoteStore(t),r.eventManager=r.createEventManager(t),r.syncEngine=r.createSyncEngine(t,!e.synchronizeTabs),r.sharedClientState.onlineStateHandler=o=>cP(r.syncEngine,o,1),r.remoteStore.remoteSyncer.handleCredentialChange=U1.bind(null,r.syncEngine),yield nx(r.remoteStore,r.syncEngine.isPrimaryClient))})()}createEventManager(e){return new D1}createDatastore(e){const t=y0(e.databaseInfo.databaseId),r=new u1(e.databaseInfo);return new d1(e.authCredentials,e.appCheckCredentials,r,t)}createRemoteStore(e){return t=this.localStore,r=this.datastore,o=e.asyncQueue,u=g=>cP(this.syncEngine,g,0),c=KR.Vt()?new KR:new s1,new f1(t,r,o,u,c);var t,r,o,u,c}createSyncEngine(e,t){return function(r,o,u,c,g,E,I){const S=new N1(r,o,u,c,g,E);return I&&(S.Lc=!0),S}(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,e.initialUser,e.maxConcurrentLimboResolutions,t)}terminate(){return(e=(0,pe.Z)(function*(t){const r=We(t);Le("RemoteStore","RemoteStore shutting down."),r.Ko.add(5),yield W_(r),r.jo.shutdown(),r.Qo.set("Unknown")}),function(t){return e.apply(this,arguments)})(this.remoteStore);var e}}function mP(n,e=10240){let t=0;return{read:()=>(0,pe.Z)(function*(){if(t<n.byteLength){const r={value:n.slice(t,t+e),done:!1};return t+=e,r}return{done:!0}})(),cancel:()=>(0,pe.Z)(function*(){})(),releaseLock(){},closed:Promise.reject("unimplemented")}}class SD{constructor(e){this.observer=e,this.muted=!1}next(e){this.observer.next&&this.Hc(this.observer.next,e)}error(e){this.observer.error?this.Hc(this.observer.error,e):console.error("Uncaught Error in snapshot listener:",e)}Jc(){this.muted=!0}Hc(e,t){this.muted||setTimeout(()=>{this.muted||e(t)},0)}}class Q1{constructor(e,t){this.Yc=e,this.O=t,this.metadata=new ci,this.buffer=new Uint8Array,this.Xc=new TextDecoder("utf-8"),this.Zc().then(r=>{r&&r.ac()?this.metadata.resolve(r.payload.metadata):this.metadata.reject(new Error(`The first element of the bundle is not a metadata, it is\n             ${JSON.stringify(null==r?void 0:r.payload)}`))},r=>this.metadata.reject(r))}close(){return this.Yc.cancel()}getMetadata(){var e=this;return(0,pe.Z)(function*(){return e.metadata.promise})()}Kc(){var e=this;return(0,pe.Z)(function*(){return yield e.getMetadata(),e.Zc()})()}Zc(){var e=this;return(0,pe.Z)(function*(){const t=yield e.tu();if(null===t)return null;const r=e.Xc.decode(t),o=Number(r);isNaN(o)&&e.eu(`length string (${r}) is not valid number`);const u=yield e.nu(o);return new A1(JSON.parse(u),t.length+o)})()}su(){return this.buffer.findIndex(e=>e==="{".charCodeAt(0))}tu(){var e=this;return(0,pe.Z)(function*(){for(;e.su()<0&&!(yield e.iu()););if(0===e.buffer.length)return null;const t=e.su();t<0&&e.eu("Reached the end of bundle when a length string is expected.");const r=e.buffer.slice(0,t);return e.buffer=e.buffer.slice(t),r})()}nu(e){var t=this;return(0,pe.Z)(function*(){for(;t.buffer.length<e;)(yield t.iu())&&t.eu("Reached the end of bundle when more is expected.");const r=t.Xc.decode(t.buffer.slice(0,e));return t.buffer=t.buffer.slice(e),r})()}eu(e){throw this.Yc.cancel(),new Error(`Invalid bundle format: ${e}`)}iu(){var e=this;return(0,pe.Z)(function*(){const t=yield e.Yc.read();if(!t.done){const r=new Uint8Array(e.buffer.length+t.value.length);r.set(e.buffer),r.set(t.value,e.buffer.length),e.buffer=r}return t.done})()}}class J1{constructor(e){this.datastore=e,this.readVersions=new Map,this.mutations=[],this.committed=!1,this.lastWriteError=null,this.writtenDocs=new Set}lookup(e){var t=this;return(0,pe.Z)(function*(){if(t.ensureCommitNotCalled(),t.mutations.length>0)throw new Me(ue.INVALID_ARGUMENT,"Firestore transactions require all reads to be executed before all writes.");const r=yield(o=(0,pe.Z)(function*(u,c){const g=We(u),E=d0(g.O)+"/documents",I={documents:c.map(W=>c0(g.O,W))},S=yield g.Lr("BatchGetDocuments",E,I),M=new Map;S.forEach(W=>{const Y=function dk(n,e){return"found"in e?function(t,r){It(!!r.found);const o=hl(t,r.found.name),u=fi(r.found.updateTime),c=new rs({mapValue:{fields:r.found.fields}});return sr.newFoundDocument(o,u,c)}(n,e):"missing"in e?function(t,r){It(!!r.missing),It(!!r.readTime);const o=hl(t,r.missing),u=fi(r.readTime);return sr.newNoDocument(o,u)}(n,e):ut()}(g.O,W);M.set(Y.key.toString(),Y)});const F=[];return c.forEach(W=>{const Y=M.get(W.toString());It(!!Y),F.push(Y)}),F}),function(u,c){return o.apply(this,arguments)})(t.datastore,e);var o;return r.forEach(o=>t.recordVersion(o)),r})()}set(e,t){this.write(t.toMutation(e,this.precondition(e))),this.writtenDocs.add(e.toString())}update(e,t){try{this.write(t.toMutation(e,this.preconditionForUpdate(e)))}catch(r){this.lastWriteError=r}this.writtenDocs.add(e.toString())}delete(e){this.write(new o0(e,this.precondition(e))),this.writtenDocs.add(e.toString())}commit(){var e=this;return(0,pe.Z)(function*(){if(e.ensureCommitNotCalled(),e.lastWriteError)throw e.lastWriteError;const t=e.readVersions;var r;e.mutations.forEach(r=>{t.delete(r.key.toString())}),t.forEach((r,o)=>{const u=Je.fromPath(o);e.mutations.push(new oS(u,e.precondition(u)))}),yield(r=(0,pe.Z)(function*(o,u){const c=We(o),g=d0(c.O)+"/documents",E={writes:u.map(I=>h0(c.O,I))};yield c.Mr("Commit",g,E)}),function(o,u){return r.apply(this,arguments)})(e.datastore,e.mutations),e.committed=!0})()}recordVersion(e){let t;if(e.isFoundDocument())t=e.version;else{if(!e.isNoDocument())throw ut();t=yt.min()}const r=this.readVersions.get(e.key.toString());if(r){if(!t.isEqual(r))throw new Me(ue.ABORTED,"Document version changed between two reads.")}else this.readVersions.set(e.key.toString(),t)}precondition(e){const t=this.readVersions.get(e.toString());return!this.writtenDocs.has(e.toString())&&t?Lr.updateTime(t):Lr.none()}preconditionForUpdate(e){const t=this.readVersions.get(e.toString());if(!this.writtenDocs.has(e.toString())&&t){if(t.isEqual(yt.min()))throw new Me(ue.INVALID_ARGUMENT,"Can't update a document that doesn't exist.");return Lr.updateTime(t)}return Lr.exists(!0)}write(e){this.ensureCommitNotCalled(),this.mutations.push(e)}ensureCommitNotCalled(){}}class X1{constructor(e,t,r,o){this.asyncQueue=e,this.datastore=t,this.updateFunction=r,this.deferred=o,this.ru=5,this.ro=new US(this.asyncQueue,"transaction_retry")}run(){this.ru-=1,this.ou()}ou(){var e=this;this.ro.Hr((0,pe.Z)(function*(){const t=new J1(e.datastore),r=e.cu(t);r&&r.then(o=>{e.asyncQueue.enqueueAndForget(()=>t.commit().then(()=>{e.deferred.resolve(o)}).catch(u=>{e.uu(u)}))}).catch(o=>{e.uu(o)})}))}cu(e){try{const t=this.updateFunction(e);return!Np(t)&&t.catch&&t.then?t:(this.deferred.reject(Error("Transaction callback must return a Promise")),null)}catch(t){return this.deferred.reject(t),null}}uu(e){this.ru>0&&this.au(e)?(this.ru-=1,this.asyncQueue.enqueueAndForget(()=>(this.ou(),Promise.resolve()))):this.deferred.reject(e)}au(e){if("FirebaseError"===e.name){const t=e.code;return"aborted"===t||"failed-precondition"===t||!qN(t)}return!1}}class eF{constructor(e,t,r,o){var u=this;this.authCredentials=e,this.appCheckCredentials=t,this.asyncQueue=r,this.databaseInfo=o,this.user=ki.UNAUTHENTICATED,this.clientId=gN.R(),this.authCredentialListener=()=>Promise.resolve(),this.appCheckCredentialListener=()=>Promise.resolve(),this.authCredentials.start(r,function(){var c=(0,pe.Z)(function*(g){Le("FirestoreClient","Received user=",g.uid),yield u.authCredentialListener(g),u.user=g});return function(g){return c.apply(this,arguments)}}()),this.appCheckCredentials.start(r,c=>(Le("FirestoreClient","Received new app check token=",c),this.appCheckCredentialListener(c,this.user)))}getConfiguration(){var e=this;return(0,pe.Z)(function*(){return{asyncQueue:e.asyncQueue,databaseInfo:e.databaseInfo,clientId:e.clientId,authCredentials:e.authCredentials,appCheckCredentials:e.appCheckCredentials,initialUser:e.user,maxConcurrentLimboResolutions:100}})()}setCredentialChangeListener(e){this.authCredentialListener=e}setAppCheckTokenChangeListener(e){this.appCheckCredentialListener=e}verifyNotTerminated(){if(this.asyncQueue.isShuttingDown)throw new Me(ue.FAILED_PRECONDITION,"The client has already been terminated.")}terminate(){var e=this;this.asyncQueue.enterRestrictedMode();const t=new ci;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted((0,pe.Z)(function*(){try{e.onlineComponents&&(yield e.onlineComponents.terminate()),e.offlineComponents&&(yield e.offlineComponents.terminate()),e.authCredentials.shutdown(),e.appCheckCredentials.shutdown(),t.resolve()}catch(r){const o=K_(r,"Failed to shutdown persistence");t.reject(o)}})),t.promise}}function _P(n,e){return Lx.apply(this,arguments)}function Lx(){return Lx=(0,pe.Z)(function*(n,e){n.asyncQueue.verifyOperationInProgress(),Le("FirestoreClient","Initializing OfflineComponentProvider");const t=yield n.getConfiguration();yield e.initialize(t);let r=t.initialUser;n.setCredentialChangeListener(function(){var o=(0,pe.Z)(function*(u){r.isEqual(u)||(yield UR(e.localStore,u),r=u)});return function(u){return o.apply(this,arguments)}}()),e.persistence.setDatabaseDeletedListener(()=>n.terminate()),n.offlineComponents=e}),Lx.apply(this,arguments)}function yP(n,e){return Vx.apply(this,arguments)}function Vx(){return Vx=(0,pe.Z)(function*(n,e){n.asyncQueue.verifyOperationInProgress();const t=yield Bx(n);Le("FirestoreClient","Initializing OnlineComponentProvider");const r=yield n.getConfiguration();yield e.initialize(t,r),n.setCredentialChangeListener(o=>nP(e.remoteStore,o)),n.setAppCheckTokenChangeListener((o,u)=>nP(e.remoteStore,u)),n.onlineComponents=e}),Vx.apply(this,arguments)}function Bx(n){return Ux.apply(this,arguments)}function Ux(){return Ux=(0,pe.Z)(function*(n){return n.offlineComponents||(Le("FirestoreClient","Using default OfflineComponentProvider"),yield _P(n,new pP)),n.offlineComponents}),Ux.apply(this,arguments)}function xD(n){return jx.apply(this,arguments)}function jx(){return jx=(0,pe.Z)(function*(n){return n.onlineComponents||(Le("FirestoreClient","Using default OnlineComponentProvider"),yield yP(n,new Fx)),n.onlineComponents}),jx.apply(this,arguments)}function vP(n){return Bx(n).then(e=>e.persistence)}function Hx(n){return Bx(n).then(e=>e.localStore)}function EP(n){return xD(n).then(e=>e.remoteStore)}function Gx(n){return xD(n).then(e=>e.syncEngine)}function J_(n){return $x.apply(this,arguments)}function $x(){return $x=(0,pe.Z)(function*(n){const e=yield xD(n),t=e.eventManager;return t.onListen=R1.bind(null,e.syncEngine),t.onUnlisten=P1.bind(null,e.syncEngine),t}),$x.apply(this,arguments)}function wP(n,e,t={}){const r=new ci;return n.asyncQueue.enqueueAndForget((0,pe.Z)(function*(){return function(o,u,c,g,E){const I=new SD({next:M=>{u.enqueueAndForget(()=>ax(o,S));const F=M.docs.has(c);!F&&M.fromCache?E.reject(new Me(ue.UNAVAILABLE,"Failed to get document because the client is offline.")):F&&M.fromCache&&g&&"server"===g.source?E.reject(new Me(ue.UNAVAILABLE,'Failed to get document from server. (However, this document does exist in the local cache. Run again without setting source to "server" to retrieve the cached document.)')):E.resolve(M)},error:M=>E.reject(M)}),S=new cx(M_(c.path),I,{includeMetadataChanges:!0,uc:!0});return sx(o,S)}(yield J_(n),n.asyncQueue,e,t,r)})),r.promise}function IP(n,e,t={}){const r=new ci;return n.asyncQueue.enqueueAndForget((0,pe.Z)(function*(){return function(o,u,c,g,E){const I=new SD({next:M=>{u.enqueueAndForget(()=>ax(o,S)),M.fromCache&&"server"===g.source?E.reject(new Me(ue.UNAVAILABLE,'Failed to get documents from server. (However, these documents may exist in the local cache. Run again without setting source to "server" to retrieve the cached documents.)')):E.resolve(M)},error:M=>E.reject(M)}),S=new cx(c,I,{includeMetadataChanges:!0,uc:!0});return sx(o,S)}(yield J_(n),n.asyncQueue,e,t,r)})),r.promise}const CP=new Map;function Wx(n,e,t){if(!t)throw new Me(ue.INVALID_ARGUMENT,`Function ${n}() cannot be called with an empty ${e}.`)}function DP(n,e,t,r){if(!0===e&&!0===r)throw new Me(ue.INVALID_ARGUMENT,`${n} and ${t} cannot be used together.`)}function bP(n){if(!Je.isDocumentKey(n))throw new Me(ue.INVALID_ARGUMENT,`Invalid document reference. Document references must have an even number of segments, but ${n} has ${n.length}.`)}function TP(n){if(Je.isDocumentKey(n))throw new Me(ue.INVALID_ARGUMENT,`Invalid collection reference. Collection references must have an odd number of segments, but ${n} has ${n.length}.`)}function MD(n){if(void 0===n)return"undefined";if(null===n)return"null";if("string"==typeof n)return n.length>20&&(n=`${n.substring(0,20)}...`),JSON.stringify(n);if("number"==typeof n||"boolean"==typeof n)return""+n;if("object"==typeof n){if(n instanceof Array)return"an array";{const e=(t=n).constructor?t.constructor.name:null;return e?`a custom ${e} object`:"an object"}}var t;return"function"==typeof n?"a function":ut()}function qt(n,e){if("_delegate"in n&&(n=n._delegate),!(n instanceof e)){if(e.name===n.constructor.name)throw new Me(ue.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");{const t=MD(n);throw new Me(ue.INVALID_ARGUMENT,`Expected type '${e.name}', but it was: ${t}`)}}return n}function AP(n,e){if(e<=0)throw new Me(ue.INVALID_ARGUMENT,`Function ${n}() requires a positive number, but it was: ${e}.`)}class SP{constructor(e){var t;if(void 0===e.host){if(void 0!==e.ssl)throw new Me(ue.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host="firestore.googleapis.com",this.ssl=!0}else this.host=e.host,this.ssl=null===(t=e.ssl)||void 0===t||t;if(this.credentials=e.credentials,this.ignoreUndefinedProperties=!!e.ignoreUndefinedProperties,void 0===e.cacheSizeBytes)this.cacheSizeBytes=41943040;else{if(-1!==e.cacheSizeBytes&&e.cacheSizeBytes<1048576)throw new Me(ue.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=e.cacheSizeBytes}this.experimentalForceLongPolling=!!e.experimentalForceLongPolling,this.experimentalAutoDetectLongPolling=!!e.experimentalAutoDetectLongPolling,this.useFetchStreams=!!e.useFetchStreams,DP("experimentalForceLongPolling",e.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",e.experimentalAutoDetectLongPolling)}isEqual(e){return this.host===e.host&&this.ssl===e.ssl&&this.credentials===e.credentials&&this.cacheSizeBytes===e.cacheSizeBytes&&this.experimentalForceLongPolling===e.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===e.experimentalAutoDetectLongPolling&&this.ignoreUndefinedProperties===e.ignoreUndefinedProperties&&this.useFetchStreams===e.useFetchStreams}}class w0{constructor(e,t,r){this._authCredentials=t,this._appCheckCredentials=r,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new SP({}),this._settingsFrozen=!1,e instanceof Mp?this._databaseId=e:(this._app=e,this._databaseId=function(o){if(!Object.prototype.hasOwnProperty.apply(o.options,["projectId"]))throw new Me(ue.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new Mp(o.options.projectId)}(e))}get app(){if(!this._app)throw new Me(ue.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}get _initialized(){return this._settingsFrozen}get _terminated(){return void 0!==this._terminateTask}_setSettings(e){if(this._settingsFrozen)throw new Me(ue.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new SP(e),void 0!==e.credentials&&(this._authCredentials=function(t){if(!t)return new bO;switch(t.type){case"gapi":const r=t.client;return It(!("object"!=typeof r||null===r||!r.auth||!r.auth.getAuthHeaderValueForFirstParty)),new xO(r,t.sessionIndex||"0",t.iamToken||null);case"provider":return t.client;default:throw new Me(ue.INVALID_ARGUMENT,"makeAuthCredentialsProvider failed due to invalid credential type")}}(e.credentials))}_getSettings(){return this._settings}_freezeSettings(){return this._settingsFrozen=!0,this._settings}_delete(){return this._terminateTask||(this._terminateTask=this._terminate()),this._terminateTask}toJSON(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}_terminate(){return function(e){const t=CP.get(e);t&&(Le("ComponentProvider","Removing Datastore"),CP.delete(e),t.terminate())}(this),Promise.resolve()}}class Fn{constructor(e,t,r){this.converter=t,this._key=r,this.type="document",this.firestore=e}get _path(){return this._key.path}get id(){return this._key.path.lastSegment()}get path(){return this._key.path.canonicalString()}get parent(){return new gl(this.firestore,this.converter,this._key.path.popLast())}withConverter(e){return new Fn(this.firestore,e,this._key)}}class ss{constructor(e,t,r){this.converter=t,this._query=r,this.type="query",this.firestore=e}withConverter(e){return new ss(this.firestore,e,this._query)}}class gl extends ss{constructor(e,t,r){super(e,t,M_(r)),this._path=r,this.type="collection"}get id(){return this._query.path.lastSegment()}get path(){return this._query.path.canonicalString()}get parent(){const e=this._path.popLast();return e.isEmpty()?null:new Fn(this.firestore,null,new Je(e))}withConverter(e){return new gl(this.firestore,e,this._path)}}function xP(n,e,...t){if(n=(0,P.m9)(n),Wx("collection","path",e),n instanceof w0){const r=rn.fromString(e,...t);return TP(r),new gl(n,null,r)}{if(!(n instanceof Fn||n instanceof gl))throw new Me(ue.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const r=n._path.child(rn.fromString(e,...t));return TP(r),new gl(n.firestore,null,r)}}function ND(n,e,...t){if(n=(0,P.m9)(n),1===arguments.length&&(e=gN.R()),Wx("doc","path",e),n instanceof w0){const r=rn.fromString(e,...t);return bP(r),new Fn(n,null,new Je(r))}{if(!(n instanceof Fn||n instanceof gl))throw new Me(ue.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const r=n._path.child(rn.fromString(e,...t));return bP(r),new Fn(n.firestore,n instanceof gl?n.converter:null,new Je(r))}}function MP(n,e){return n=(0,P.m9)(n),e=(0,P.m9)(e),(n instanceof Fn||n instanceof gl)&&(e instanceof Fn||e instanceof gl)&&n.firestore===e.firestore&&n.path===e.path&&n.converter===e.converter}function NP(n,e){return n=(0,P.m9)(n),e=(0,P.m9)(e),n instanceof ss&&e instanceof ss&&n.firestore===e.firestore&&n0(n._query,e._query)&&n.converter===e.converter}class dF{constructor(){this.hu=Promise.resolve(),this.lu=[],this.fu=!1,this.du=[],this._u=null,this.wu=!1,this.mu=!1,this.gu=[],this.ro=new US(this,"async_queue_retry"),this.yu=()=>{const t=bD();t&&Le("AsyncQueue","Visibility state changed to "+t.visibilityState),this.ro.Yr()};const e=bD();e&&"function"==typeof e.addEventListener&&e.addEventListener("visibilitychange",this.yu)}get isShuttingDown(){return this.fu}enqueueAndForget(e){this.enqueue(e)}enqueueAndForgetEvenWhileRestricted(e){this.pu(),this.Iu(e)}enterRestrictedMode(e){if(!this.fu){this.fu=!0,this.mu=e||!1;const t=bD();t&&"function"==typeof t.removeEventListener&&t.removeEventListener("visibilitychange",this.yu)}}enqueue(e){if(this.pu(),this.fu)return new Promise(()=>{});const t=new ci;return this.Iu(()=>this.fu&&this.mu?Promise.resolve():(e().then(t.resolve,t.reject),t.promise)).then(()=>t.promise)}enqueueRetryable(e){this.enqueueAndForget(()=>(this.lu.push(e),this.Eu()))}Eu(){var e=this;return(0,pe.Z)(function*(){if(0!==e.lu.length){try{yield e.lu[0](),e.lu.shift(),e.ro.reset()}catch(t){if(!Lp(t))throw t;Le("AsyncQueue","Operation failed with retryable error: "+t)}e.lu.length>0&&e.ro.Hr(()=>e.Eu())}})()}Iu(e){const t=this.hu.then(()=>(this.wu=!0,e().catch(r=>{throw this._u=r,this.wu=!1,Fr("INTERNAL UNHANDLED ERROR: ",function(u){let c=u.message||"";return u.stack&&(c=u.stack.includes(u.message)?u.stack:u.message+"\n"+u.stack),c}(r)),r}).then(r=>(this.wu=!1,r))));return this.hu=t,t}enqueueAfterDelay(e,t,r){this.pu(),this.gu.indexOf(e)>-1&&(t=0);const o=ix.createAndSchedule(this,e,t,r,u=>this.Tu(u));return this.du.push(o),o}pu(){this._u&&ut()}verifyOperationInProgress(){}Au(){var e=this;return(0,pe.Z)(function*(){let t;do{t=e.hu,yield t}while(t!==e.hu)})()}Ru(e){for(const t of this.du)if(t.timerId===e)return!0;return!1}Pu(e){return this.Au().then(()=>{this.du.sort((t,r)=>t.targetTimeMs-r.targetTimeMs);for(const t of this.du)if(t.skipDelay(),"all"!==e&&t.timerId===e)break;return this.Au()})}bu(e){this.gu.push(e)}Tu(e){const t=this.du.indexOf(e);this.du.splice(t,1)}}function qx(n){return function(e,t){if("object"!=typeof e||null===e)return!1;const r=e;for(const o of["next","error","complete"])if(o in r&&"function"==typeof r[o])return!0;return!1}(n)}class hF{constructor(){this._progressObserver={},this._taskCompletionResolver=new ci,this._lastProgress={taskState:"Running",totalBytes:0,totalDocuments:0,bytesLoaded:0,documentsLoaded:0}}onProgress(e,t,r){this._progressObserver={next:e,error:t,complete:r}}catch(e){return this._taskCompletionResolver.promise.catch(e)}then(e,t){return this._taskCompletionResolver.promise.then(e,t)}_completeWith(e){this._updateProgress(e),this._progressObserver.complete&&this._progressObserver.complete(),this._taskCompletionResolver.resolve(e)}_failWith(e){this._lastProgress.taskState="Error",this._progressObserver.next&&this._progressObserver.next(this._lastProgress),this._progressObserver.error&&this._progressObserver.error(e),this._taskCompletionResolver.reject(e)}_updateProgress(e){this._lastProgress=e,this._progressObserver.next&&this._progressObserver.next(e)}}class Yn extends w0{constructor(e,t,r){super(e,t,r),this.type="firestore",this._queue=new dF,this._persistenceKey="name"in e?e.name:"[DEFAULT]"}_terminate(){return this._firestoreClient||RP(this),this._firestoreClient.terminate()}}function Br(n){return n._firestoreClient||RP(n),n._firestoreClient.verifyNotTerminated(),n._firestoreClient}function RP(n){var e;const t=n._freezeSettings(),r=(u=(null===(e=n._app)||void 0===e?void 0:e.options.appId)||"",new kO(n._databaseId,u,n._persistenceKey,(g=t).host,g.ssl,g.experimentalForceLongPolling,g.experimentalAutoDetectLongPolling,g.useFetchStreams));var u,g;n._firestoreClient=new eF(n._authCredentials,n._appCheckCredentials,n._queue,r)}function PP(n,e,t){const r=new ci;return n.asyncQueue.enqueue((0,pe.Z)(function*(){try{yield _P(n,t),yield yP(n,e),r.resolve()}catch(o){if(!("FirebaseError"===(u=o).name?u.code===ue.FAILED_PRECONDITION||u.code===ue.UNIMPLEMENTED:!("undefined"!=typeof DOMException&&u instanceof DOMException)||22===u.code||20===u.code||11===u.code))throw o;console.warn("Error enabling offline persistence. Falling back to persistence disabled: "+o),r.reject(o)}var u})).then(()=>r.promise)}function OP(n){if(n._initialized||n._terminated)throw new Me(ue.FAILED_PRECONDITION,"Firestore has already been started and persistence can no longer be enabled. You can only enable persistence before calling any other methods on a Firestore object.")}class kc{constructor(...e){for(let t=0;t<e.length;++t)if(0===e[t].length)throw new Me(ue.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new hi(e)}isEqual(e){return this._internalPath.isEqual(e._internalPath)}}class ml{constructor(e){this._byteString=e}static fromBase64String(e){try{return new ml(Jr.fromBase64String(e))}catch(t){throw new Me(ue.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+t)}}static fromUint8Array(e){return new ml(Jr.fromUint8Array(e))}toBase64(){return this._byteString.toBase64()}toUint8Array(){return this._byteString.toUint8Array()}toString(){return"Bytes(base64: "+this.toBase64()+")"}isEqual(e){return this._byteString.isEqual(e._byteString)}}class Gp{constructor(e){this._methodName=e}}class RD{constructor(e,t){if(!isFinite(e)||e<-90||e>90)throw new Me(ue.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+e);if(!isFinite(t)||t<-180||t>180)throw new Me(ue.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+t);this._lat=e,this._long=t}get latitude(){return this._lat}get longitude(){return this._long}isEqual(e){return this._lat===e._lat&&this._long===e._long}toJSON(){return{latitude:this._lat,longitude:this._long}}_compareTo(e){return Gt(this._lat,e._lat)||Gt(this._long,e._long)}}const IF=/^__.*__$/;class CF{constructor(e,t,r){this.data=e,this.fieldMask=t,this.fieldTransforms=r}toMutation(e,t){return null!==this.fieldMask?new kp(e,this.data,this.fieldMask,t,this.fieldTransforms):new s0(e,this.data,t,this.fieldTransforms)}}class kP{constructor(e,t,r){this.data=e,this.fieldMask=t,this.fieldTransforms=r}toMutation(e,t){return new kp(e,this.data,this.fieldMask,t,this.fieldTransforms)}}function FP(n){switch(n){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw ut()}}class PD{constructor(e,t,r,o,u,c){this.settings=e,this.databaseId=t,this.O=r,this.ignoreUndefinedProperties=o,void 0===u&&this.vu(),this.fieldTransforms=u||[],this.fieldMask=c||[]}get path(){return this.settings.path}get Vu(){return this.settings.Vu}Su(e){return new PD(Object.assign(Object.assign({},this.settings),e),this.databaseId,this.O,this.ignoreUndefinedProperties,this.fieldTransforms,this.fieldMask)}Du(e){var t;const r=null===(t=this.path)||void 0===t?void 0:t.child(e),o=this.Su({path:r,Cu:!1});return o.Nu(e),o}xu(e){var t;const r=null===(t=this.path)||void 0===t?void 0:t.child(e),o=this.Su({path:r,Cu:!1});return o.vu(),o}ku(e){return this.Su({path:void 0,Cu:!0})}Ou(e){return FD(e,this.settings.methodName,this.settings.Mu||!1,this.path,this.settings.$u)}contains(e){return void 0!==this.fieldMask.find(t=>e.isPrefixOf(t))||void 0!==this.fieldTransforms.find(t=>e.isPrefixOf(t.field))}vu(){if(this.path)for(let e=0;e<this.path.length;e++)this.Nu(this.path.get(e))}Nu(e){if(0===e.length)throw this.Ou("Document fields must not be empty");if(FP(this.Vu)&&IF.test(e))throw this.Ou('Document fields cannot begin and end with "__"')}}class DF{constructor(e,t,r){this.databaseId=e,this.ignoreUndefinedProperties=t,this.O=r||y0(e)}Fu(e,t,r,o=!1){return new PD({Vu:e,methodName:t,$u:r,path:hi.emptyPath(),Cu:!1,Mu:o},this.databaseId,this.O,this.ignoreUndefinedProperties)}}function $p(n){const e=n._freezeSettings(),t=y0(n._databaseId);return new DF(n._databaseId,!!e.ignoreUndefinedProperties,t)}function OD(n,e,t,r,o,u={}){const c=n.Fu(u.merge||u.mergeFields?2:0,e,t,o);Yx("Data must be an object, but it was:",c,r);const g=BP(r,c);let E,I;if(u.merge)E=new b_(c.fieldMask),I=c.fieldTransforms;else if(u.mergeFields){const S=[];for(const M of u.mergeFields){const F=Qx(e,M,t);if(!c.contains(F))throw new Me(ue.INVALID_ARGUMENT,`Field '${F}' is specified in your field mask but missing from your input data.`);jP(S,F)||S.push(F)}E=new b_(S),I=c.fieldTransforms.filter(M=>E.covers(M.field))}else E=null,I=c.fieldTransforms;return new CF(new rs(g),E,I)}class I0 extends Gp{_toFieldTransform(e){if(2!==e.Vu)throw e.Ou(1===e.Vu?`${this._methodName}() can only appear at the top level of your update data`:`${this._methodName}() cannot be used with set() unless you pass {merge:true}`);return e.fieldMask.push(e.path),null}isEqual(e){return e instanceof I0}}function LP(n,e,t){return new PD({Vu:3,$u:e.settings.$u,methodName:n._methodName,Cu:t},e.databaseId,e.O,e.ignoreUndefinedProperties)}class zx extends Gp{_toFieldTransform(e){return new r0(e.path,new R_)}isEqual(e){return e instanceof zx}}class bF extends Gp{constructor(e,t){super(e),this.Bu=t}_toFieldTransform(e){const t=LP(this,e,!0),r=this.Bu.map(u=>Wp(u,t)),o=new Pp(r);return new r0(e.path,o)}isEqual(e){return this===e}}class TF extends Gp{constructor(e,t){super(e),this.Bu=t}_toFieldTransform(e){const t=LP(this,e,!0),r=this.Bu.map(u=>Wp(u,t)),o=new Op(r);return new r0(e.path,o)}isEqual(e){return this===e}}class AF extends Gp{constructor(e,t){super(e),this.Lu=t}_toFieldTransform(e){const t=new P_(e.O,kN(e.O,this.Lu));return new r0(e.path,t)}isEqual(e){return this===e}}function Kx(n,e,t,r){const o=n.Fu(1,e,t);Yx("Data must be an object, but it was:",o,r);const u=[],c=rs.empty();Sp(r,(E,I)=>{const S=kD(e,E,t);I=(0,P.m9)(I);const M=o.xu(S);if(I instanceof I0)u.push(S);else{const F=Wp(I,M);null!=F&&(u.push(S),c.set(S,F))}});const g=new b_(u);return new kP(c,g,o.fieldTransforms)}function Zx(n,e,t,r,o,u){const c=n.Fu(1,e,t),g=[Qx(e,r,t)],E=[o];if(u.length%2!=0)throw new Me(ue.INVALID_ARGUMENT,`Function ${e}() needs to be called with an even number of arguments that alternate between field names and values.`);for(let F=0;F<u.length;F+=2)g.push(Qx(e,u[F])),E.push(u[F+1]);const I=[],S=rs.empty();for(let F=g.length-1;F>=0;--F)if(!jP(I,g[F])){const W=g[F];let Y=E[F];Y=(0,P.m9)(Y);const xe=c.xu(W);if(Y instanceof I0)I.push(W);else{const qe=Wp(Y,xe);null!=qe&&(I.push(W),S.set(W,qe))}}const M=new b_(I);return new kP(S,M,c.fieldTransforms)}function VP(n,e,t,r=!1){return Wp(t,n.Fu(r?4:3,e))}function Wp(n,e){if(UP(n=(0,P.m9)(n)))return Yx("Unsupported field value:",e,n),BP(n,e);if(n instanceof Gp)return function(t,r){if(!FP(r.Vu))throw r.Ou(`${t._methodName}() can only be used with update() and set()`);if(!r.path)throw r.Ou(`${t._methodName}() is not currently supported inside arrays`);const o=t._toFieldTransform(r);o&&r.fieldTransforms.push(o)}(n,e),null;if(void 0===n&&e.ignoreUndefinedProperties)return null;if(e.path&&e.fieldMask.push(e.path),n instanceof Array){if(e.settings.Cu&&4!==e.Vu)throw e.Ou("Nested arrays are not supported");return function(t,r){const o=[];let u=0;for(const c of t){let g=Wp(c,r.ku(u));null==g&&(g={nullValue:"NULL_VALUE"}),o.push(g),u++}return{arrayValue:{values:o}}}(n,e)}return function(t,r){if(null===(t=(0,P.m9)(t)))return{nullValue:"NULL_VALUE"};if("number"==typeof t)return kN(r.O,t);if("boolean"==typeof t)return{booleanValue:t};if("string"==typeof t)return{stringValue:t};if(t instanceof Date){const o=di.fromDate(t);return{timestampValue:l0(r.O,o)}}if(t instanceof di){const o=new di(t.seconds,1e3*Math.floor(t.nanoseconds/1e3));return{timestampValue:l0(r.O,o)}}if(t instanceof RD)return{geoPointValue:{latitude:t.latitude,longitude:t.longitude}};if(t instanceof ml)return{bytesValue:eR(r.O,t._byteString)};if(t instanceof Fn){const o=r.databaseId,u=t.firestore._databaseId;if(!u.isEqual(o))throw r.Ou(`Document reference is for database ${u.projectId}/${u.database} but should be for database ${o.projectId}/${o.database}`);return{referenceValue:uS(t.firestore._databaseId||r.databaseId,t._key.path)}}throw r.Ou(`Unsupported field value: ${MD(t)}`)}(n,e)}function BP(n,e){const t={};return yN(n)?e.path&&e.path.length>0&&e.fieldMask.push(e.path):Sp(n,(r,o)=>{const u=Wp(o,e.Du(r));null!=u&&(t[r]=u)}),{mapValue:{fields:t}}}function UP(n){return!("object"!=typeof n||null===n||n instanceof Array||n instanceof Date||n instanceof di||n instanceof RD||n instanceof ml||n instanceof Fn||n instanceof Gp)}function Yx(n,e,t){if(!UP(t)||"object"!=typeof(r=t)||null===r||Object.getPrototypeOf(r)!==Object.prototype&&null!==Object.getPrototypeOf(r)){const r=MD(t);throw e.Ou("an object"===r?n+" a custom object":n+" "+r)}var r}function Qx(n,e,t){if((e=(0,P.m9)(e))instanceof kc)return e._internalPath;if("string"==typeof e)return kD(n,e);throw FD("Field path arguments must be of type string or ",n,!1,void 0,t)}const SF=new RegExp("[~\\*/\\[\\]]");function kD(n,e,t){if(e.search(SF)>=0)throw FD(`Invalid field path (${e}). Paths must not contain '~', '*', '/', '[', or ']'`,n,!1,void 0,t);try{return new kc(...e.split("."))._internalPath}catch(r){throw FD(`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`,n,!1,void 0,t)}}function FD(n,e,t,r,o){const u=r&&!r.isEmpty(),c=void 0!==o;let g=`Function ${e}() called with invalid data`;t&&(g+=" (via `toFirestore()`)"),g+=". ";let E="";return(u||c)&&(E+=" (found",u&&(E+=` in field ${r}`),c&&(E+=` in document ${o}`),E+=")"),new Me(ue.INVALID_ARGUMENT,g+n+E)}function jP(n,e){return n.some(t=>t.isEqual(e))}class C0{constructor(e,t,r,o,u){this._firestore=e,this._userDataWriter=t,this._key=r,this._document=o,this._converter=u}get id(){return this._key.path.lastSegment()}get ref(){return new Fn(this._firestore,this._converter,this._key)}exists(){return null!==this._document}data(){if(this._document){if(this._converter){const e=new xF(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(e)}return this._userDataWriter.convertValue(this._document.data.value)}}get(e){if(this._document){const t=this._document.data.field(LD("DocumentSnapshot.get",e));if(null!==t)return this._userDataWriter.convertValue(t)}}}class xF extends C0{data(){return super.data()}}function LD(n,e){return"string"==typeof e?kD(n,e):e instanceof kc?e._internalPath:e._delegate._internalPath}class qp{constructor(e,t){this.hasPendingWrites=e,this.fromCache=t}isEqual(e){return this.hasPendingWrites===e.hasPendingWrites&&this.fromCache===e.fromCache}}class Fc extends C0{constructor(e,t,r,o,u,c){super(e,t,r,o,c),this._firestore=e,this._firestoreImpl=e,this.metadata=u}exists(){return super.exists()}data(e={}){if(this._document){if(this._converter){const t=new D0(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(t,e)}return this._userDataWriter.convertValue(this._document.data.value,e.serverTimestamps)}}get(e,t={}){if(this._document){const r=this._document.data.field(LD("DocumentSnapshot.get",e));if(null!==r)return this._userDataWriter.convertValue(r,t.serverTimestamps)}}}class D0 extends Fc{data(e={}){return super.data(e)}}class Mh{constructor(e,t,r,o){this._firestore=e,this._userDataWriter=t,this._snapshot=o,this.metadata=new qp(o.hasPendingWrites,o.fromCache),this.query=r}get docs(){const e=[];return this.forEach(t=>e.push(t)),e}get size(){return this._snapshot.docs.size}get empty(){return 0===this.size}forEach(e,t){this._snapshot.docs.forEach(r=>{e.call(t,new D0(this._firestore,this._userDataWriter,r.key,r,new qp(this._snapshot.mutatedKeys.has(r.key),this._snapshot.fromCache),this.query.converter))})}docChanges(e={}){const t=!!e.includeMetadataChanges;if(t&&this._snapshot.excludesMetadataChanges)throw new Me(ue.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===t||(this._cachedChanges=function(r,o){if(r._snapshot.oldDocs.isEmpty()){let u=0;return r._snapshot.docChanges.map(c=>({type:"added",doc:new D0(r._firestore,r._userDataWriter,c.doc.key,c.doc,new qp(r._snapshot.mutatedKeys.has(c.doc.key),r._snapshot.fromCache),r.query.converter),oldIndex:-1,newIndex:u++}))}{let u=r._snapshot.oldDocs;return r._snapshot.docChanges.filter(c=>o||3!==c.type).map(c=>{const g=new D0(r._firestore,r._userDataWriter,c.doc.key,c.doc,new qp(r._snapshot.mutatedKeys.has(c.doc.key),r._snapshot.fromCache),r.query.converter);let E=-1,I=-1;return 0!==c.type&&(E=u.indexOf(c.doc.key),u=u.delete(c.doc.key)),1!==c.type&&(u=u.add(c.doc),I=u.indexOf(c.doc.key)),{type:MF(c.type),doc:g,oldIndex:E,newIndex:I}})}}(this,t),this._cachedChangesIncludeMetadataChanges=t),this._cachedChanges}}function MF(n){switch(n){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return ut()}}function HP(n,e){return n instanceof Fc&&e instanceof Fc?n._firestore===e._firestore&&n._key.isEqual(e._key)&&(null===n._document?null===e._document:n._document.isEqual(e._document))&&n._converter===e._converter:n instanceof Mh&&e instanceof Mh&&n._firestore===e._firestore&&NP(n.query,e.query)&&n.metadata.isEqual(e.metadata)&&n._snapshot.isEqual(e._snapshot)}function GP(n){if(oD(n)&&0===n.explicitOrderBy.length)throw new Me(ue.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}class b0{}function Nh(n,...e){for(const t of e)n=t._apply(n);return n}class NF extends b0{constructor(e,t,r){super(),this.Uu=e,this.qu=t,this.Ku=r,this.type="where"}_apply(e){const t=$p(e.firestore),r=function(o,u,c,g,E,I,S){let M;if(E.isKeyField()){if("array-contains"===I||"array-contains-any"===I)throw new Me(ue.INVALID_ARGUMENT,`Invalid Query. You can't perform '${I}' queries on documentId().`);if("in"===I||"not-in"===I){ZP(S,I);const W=[];for(const Y of S)W.push(KP(g,o,Y));M={arrayValue:{values:W}}}else M=KP(g,o,S)}else"in"!==I&&"not-in"!==I&&"array-contains-any"!==I||ZP(S,I),M=VP(c,"where",S,"in"===I||"not-in"===I);const F=xs.create(E,I,M);return function(W,Y){if(Y.S()){const qe=tS(W);if(null!==qe&&!qe.isEqual(Y.field))throw new Me(ue.INVALID_ARGUMENT,`Invalid query. All where filters with an inequality (<, <=, !=, not-in, >, or >=) must be on the same field. But you have inequality filters on '${qe.toString()}' and '${Y.field.toString()}'`);const Pt=eS(W);null!==Pt&&YP(0,Y.field,Pt)}const xe=function(qe,Pt){for(const Bt of qe.filters)if(Pt.indexOf(Bt.op)>=0)return Bt.op;return null}(W,function(qe){switch(qe){case"!=":return["!=","not-in"];case"array-contains":return["array-contains","array-contains-any","not-in"];case"in":return["array-contains-any","in","not-in"];case"array-contains-any":return["array-contains","array-contains-any","in","not-in"];case"not-in":return["array-contains","array-contains-any","in","not-in","!="];default:return[]}}(Y.op));if(null!==xe)throw new Me(ue.INVALID_ARGUMENT,xe===Y.op?`Invalid query. You cannot use more than one '${Y.op.toString()}' filter.`:`Invalid query. You cannot use '${Y.op.toString()}' filters with '${xe.toString()}' filters.`)}(o,F),F}(e._query,0,t,e.firestore._databaseId,this.Uu,this.qu,this.Ku);return new ss(e.firestore,e.converter,function(o,u){const c=o.filters.concat([u]);return new Rc(o.path,o.collectionGroup,o.explicitOrderBy.slice(),c,o.limit,o.limitType,o.startAt,o.endAt)}(e._query,r))}}class PF extends b0{constructor(e,t){super(),this.Uu=e,this.Gu=t,this.type="orderBy"}_apply(e){const t=function(r,o,u){if(null!==r.startAt)throw new Me(ue.INVALID_ARGUMENT,"Invalid query. You must not call startAt() or startAfter() before calling orderBy().");if(null!==r.endAt)throw new Me(ue.INVALID_ARGUMENT,"Invalid query. You must not call endAt() or endBefore() before calling orderBy().");const c=new x_(o,u);return function(g,E){if(null===eS(g)){const I=tS(g);null!==I&&YP(0,I,E.field)}}(r,c),c}(e._query,this.Uu,this.Gu);return new ss(e.firestore,e.converter,function(r,o){const u=r.explicitOrderBy.concat([o]);return new Rc(r.path,r.collectionGroup,u,r.filters.slice(),r.limit,r.limitType,r.startAt,r.endAt)}(e._query,t))}}class $P extends b0{constructor(e,t,r){super(),this.type=e,this.ju=t,this.Qu=r}_apply(e){return new ss(e.firestore,e.converter,MN(e._query,this.ju,this.Qu))}}class WP extends b0{constructor(e,t,r){super(),this.type=e,this.Wu=t,this.zu=r}_apply(e){const t=zP(e,this.type,this.Wu,this.zu);return new ss(e.firestore,e.converter,(o=t,new Rc((r=e._query).path,r.collectionGroup,r.explicitOrderBy.slice(),r.filters.slice(),r.limit,r.limitType,o,r.endAt)));var r,o}}class qP extends b0{constructor(e,t,r){super(),this.type=e,this.Wu=t,this.zu=r}_apply(e){const t=zP(e,this.type,this.Wu,this.zu);return new ss(e.firestore,e.converter,(o=t,new Rc((r=e._query).path,r.collectionGroup,r.explicitOrderBy.slice(),r.filters.slice(),r.limit,r.limitType,r.startAt,o)));var r,o}}function zP(n,e,t,r){if(t[0]=(0,P.m9)(t[0]),t[0]instanceof C0)return function(o,u,c,g,E){if(!g)throw new Me(ue.NOT_FOUND,`Can't use a DocumentSnapshot that doesn't exist for ${c}().`);const I=[];for(const S of N_(o))if(S.field.isKeyField())I.push(JC(u,g.key));else{const M=g.data.field(S.field);if(YA(M))throw new Me(ue.INVALID_ARGUMENT,'Invalid query. You are trying to start or end a query using a document for which the field "'+S.field+'" is an uncommitted server timestamp. (Since the value of this field is unknown, you cannot start/end a query with it.)');if(null===M){const F=S.field.canonicalString();throw new Me(ue.INVALID_ARGUMENT,`Invalid query. You are trying to start or end a query using a document for which the field '${F}' (used as the orderBy) does not exist.`)}I.push(M)}return new S_(I,E)}(n._query,n.firestore._databaseId,e,t[0]._document,r);{const o=$p(n.firestore);return function(u,c,g,E,I,S){const M=u.explicitOrderBy;if(I.length>M.length)throw new Me(ue.INVALID_ARGUMENT,`Too many arguments provided to ${E}(). The number of arguments must be less than or equal to the number of orderBy() clauses`);const F=[];for(let W=0;W<I.length;W++){const Y=I[W];if(M[W].field.isKeyField()){if("string"!=typeof Y)throw new Me(ue.INVALID_ARGUMENT,`Invalid query. Expected a string for document ID in ${E}(), but got a ${typeof Y}`);if(!nS(u)&&-1!==Y.indexOf("/"))throw new Me(ue.INVALID_ARGUMENT,`Invalid query. When querying a collection and ordering by documentId(), the value passed to ${E}() must be a plain document ID, but '${Y}' contains a slash.`);const xe=u.path.child(rn.fromString(Y));if(!Je.isDocumentKey(xe))throw new Me(ue.INVALID_ARGUMENT,`Invalid query. When querying a collection group and ordering by documentId(), the value passed to ${E}() must result in a valid document path, but '${xe}' is not because it contains an odd number of segments.`);const qe=new Je(xe);F.push(JC(c,qe))}else{const xe=VP(g,E,Y);F.push(xe)}}return new S_(F,S)}(n._query,n.firestore._databaseId,o,e,t,r)}}function KP(n,e,t){if("string"==typeof(t=(0,P.m9)(t))){if(""===t)throw new Me(ue.INVALID_ARGUMENT,"Invalid query. When querying with documentId(), you must provide a valid document ID, but it was an empty string.");if(!nS(e)&&-1!==t.indexOf("/"))throw new Me(ue.INVALID_ARGUMENT,`Invalid query. When querying a collection by documentId(), you must provide a plain document ID, but '${t}' contains a '/' character.`);const r=e.path.child(rn.fromString(t));if(!Je.isDocumentKey(r))throw new Me(ue.INVALID_ARGUMENT,`Invalid query. When querying a collection group by documentId(), the value provided must result in a valid document path, but '${r}' is not because it has an odd number of segments (${r.length}).`);return JC(n,new Je(r))}if(t instanceof Fn)return JC(n,t._key);throw new Me(ue.INVALID_ARGUMENT,`Invalid query. When querying with documentId(), you must provide a valid string or a DocumentReference, but it was: ${MD(t)}.`)}function ZP(n,e){if(!Array.isArray(n)||0===n.length)throw new Me(ue.INVALID_ARGUMENT,`Invalid Query. A non-empty array is required for '${e.toString()}' filters.`);if(n.length>10)throw new Me(ue.INVALID_ARGUMENT,`Invalid Query. '${e.toString()}' filters support a maximum of 10 elements in the value array.`)}function YP(n,e,t){if(!t.isEqual(e))throw new Me(ue.INVALID_ARGUMENT,`Invalid query. You have a where filter with an inequality (<, <=, !=, not-in, >, or >=) on field '${e.toString()}' and so you must also use '${e.toString()}' as your first argument to orderBy(), but your first orderBy() is on field '${t.toString()}' instead.`)}class Jx{convertValue(e,t="none"){switch(Rp(e)){case 0:return null;case 1:return e.booleanValue;case 2:return pr(e.integerValue||e.doubleValue);case 3:return this.convertTimestamp(e.timestampValue);case 4:return this.convertServerTimestamp(e,t);case 5:return e.stringValue;case 6:return this.convertBytes(xp(e.bytesValue));case 7:return this.convertReference(e.referenceValue);case 8:return this.convertGeoPoint(e.geoPointValue);case 9:return this.convertArray(e.arrayValue,t);case 10:return this.convertObject(e.mapValue,t);default:throw ut()}}convertObject(e,t){const r={};return Sp(e.fields,(o,u)=>{r[o]=this.convertValue(u,t)}),r}convertGeoPoint(e){return new RD(pr(e.latitude),pr(e.longitude))}convertArray(e,t){return(e.values||[]).map(r=>this.convertValue(r,t))}convertServerTimestamp(e,t){switch(t){case"previous":const r=vN(e);return null==r?null:this.convertValue(r,t);case"estimate":return this.convertTimestamp(YE(e));default:return null}}convertTimestamp(e){const t=Ih(e);return new di(t.seconds,t.nanos)}convertDocumentKey(e,t){const r=rn.fromString(e);It(cR(r));const o=new Mp(r.get(1),r.get(3)),u=new Je(r.popFirst(5));return o.isEqual(t)||Fr(`Document ${u} contains a document reference within a different database (${o.projectId}/${o.database}) which is not supported. It will be treated as a reference in the current database (${t.projectId}/${t.database}) instead.`),u}}function VD(n,e,t){let r;return r=n?t&&(t.merge||t.mergeFields)?n.toFirestore(e,t):n.toFirestore(e):e,r}class jF extends Jx{constructor(e){super(),this.firestore=e}convertBytes(e){return new ml(e)}convertReference(e){const t=this.convertDocumentKey(e,this.firestore._databaseId);return new Fn(this.firestore,null,t)}}class QP{constructor(e,t){this._firestore=e,this._commitHandler=t,this._mutations=[],this._committed=!1,this._dataReader=$p(e)}set(e,t,r){this._verifyNotCommitted();const o=Rh(e,this._firestore),u=VD(o.converter,t,r),c=OD(this._dataReader,"WriteBatch.set",o._key,u,null!==o.converter,r);return this._mutations.push(c.toMutation(o._key,Lr.none())),this}update(e,t,r,...o){this._verifyNotCommitted();const u=Rh(e,this._firestore);let c;return c="string"==typeof(t=(0,P.m9)(t))||t instanceof kc?Zx(this._dataReader,"WriteBatch.update",u._key,t,r,o):Kx(this._dataReader,"WriteBatch.update",u._key,t),this._mutations.push(c.toMutation(u._key,Lr.exists(!0))),this}delete(e){this._verifyNotCommitted();const t=Rh(e,this._firestore);return this._mutations=this._mutations.concat(new o0(t._key,Lr.none())),this}commit(){return this._verifyNotCommitted(),this._committed=!0,this._mutations.length>0?this._commitHandler(this._mutations):Promise.resolve()}_verifyNotCommitted(){if(this._committed)throw new Me(ue.FAILED_PRECONDITION,"A write batch can no longer be used after commit() has been called.")}}function Rh(n,e){if((n=(0,P.m9)(n)).firestore!==e)throw new Me(ue.INVALID_ARGUMENT,"Provided document reference is from a different Firestore instance.");return n}class zp extends Jx{constructor(e){super(),this.firestore=e}convertBytes(e){return new ml(e)}convertReference(e){const t=this.convertDocumentKey(e,this.firestore._databaseId);return new Fn(this.firestore,null,t)}}function JP(n,e,t){n=qt(n,Fn);const r=qt(n.firestore,Yn),o=VD(n.converter,e,t);return X_(r,[OD($p(r),"setDoc",n._key,o,null!==n.converter,t).toMutation(n._key,Lr.none())])}function XP(n,e,t,...r){n=qt(n,Fn);const o=qt(n.firestore,Yn),u=$p(o);let c;return c="string"==typeof(e=(0,P.m9)(e))||e instanceof kc?Zx(u,"updateDoc",n._key,e,t,r):Kx(u,"updateDoc",n._key,e),X_(o,[c.toMutation(n._key,Lr.exists(!0))])}function eO(n,...e){var t,r,o;n=(0,P.m9)(n);let u={includeMetadataChanges:!1},c=0;"object"!=typeof e[c]||qx(e[c])||(u=e[c],c++);const g={includeMetadataChanges:u.includeMetadataChanges};if(qx(e[c])){const M=e[c];e[c]=null===(t=M.next)||void 0===t?void 0:t.bind(M),e[c+1]=null===(r=M.error)||void 0===r?void 0:r.bind(M),e[c+2]=null===(o=M.complete)||void 0===o?void 0:o.bind(M)}let E,I,S;if(n instanceof Fn)I=qt(n.firestore,Yn),S=M_(n._key.path),E={next:M=>{e[c]&&e[c](Xx(I,n,M))},error:e[c+1],complete:e[c+2]};else{const M=qt(n,ss);I=qt(M.firestore,Yn),S=M._query;const F=new zp(I);E={next:W=>{e[c]&&e[c](new Mh(I,F,M,W))},error:e[c+1],complete:e[c+2]},GP(n._query)}return function(M,F,W,Y){const xe=new SD(Y),qe=new cx(F,xe,W);return M.asyncQueue.enqueueAndForget((0,pe.Z)(function*(){return sx(yield J_(M),qe)})),()=>{xe.Jc(),M.asyncQueue.enqueueAndForget((0,pe.Z)(function*(){return ax(yield J_(M),qe)}))}}(Br(I),S,g,E)}function X_(n,e){return function(t,r){const o=new ci;return t.asyncQueue.enqueueAndForget((0,pe.Z)(function*(){return function O1(n,e,t){return gx.apply(this,arguments)}(yield Gx(t),r,o)})),o.promise}(Br(n),e)}function Xx(n,e,t){const r=t.docs.get(e._key),o=new zp(n);return new Fc(n,o,e._key,r,new qp(t.hasPendingWrites,t.fromCache),e.converter)}class QF extends class{constructor(e,t){this._firestore=e,this._transaction=t,this._dataReader=$p(e)}get(e){const t=Rh(e,this._firestore),r=new jF(this._firestore);return this._transaction.lookup([t._key]).then(o=>{if(!o||1!==o.length)return ut();const u=o[0];if(u.isFoundDocument())return new C0(this._firestore,r,u.key,u,t.converter);if(u.isNoDocument())return new C0(this._firestore,r,t._key,null,t.converter);throw ut()})}set(e,t,r){const o=Rh(e,this._firestore),u=VD(o.converter,t,r),c=OD(this._dataReader,"Transaction.set",o._key,u,null!==o.converter,r);return this._transaction.set(o._key,c),this}update(e,t,r,...o){const u=Rh(e,this._firestore);let c;return c="string"==typeof(t=(0,P.m9)(t))||t instanceof kc?Zx(this._dataReader,"Transaction.update",u._key,t,r,o):Kx(this._dataReader,"Transaction.update",u._key,t),this._transaction.update(u._key,c),this}delete(e){const t=Rh(e,this._firestore);return this._transaction.delete(t._key),this}}{constructor(e,t){super(e,t),this._firestore=e}get(e){const t=Rh(e,this._firestore),r=new zp(this._firestore);return super.get(e).then(o=>new Fc(this._firestore,r,t._key,o._document,new qp(!1,!1),t.converter))}}function eM(n,e){if(void 0===e)return{merge:!1};if(void 0!==e.mergeFields&&void 0!==e.merge)throw new Me("invalid-argument",`Invalid options passed to function ${n}(): You cannot specify both "merge" and "mergeFields".`);return e}function nO(){if("undefined"==typeof Uint8Array)throw new Me("unimplemented","Uint8Arrays are not available in this environment.")}function rO(){if(!function PO(){return"undefined"!=typeof atob}())throw new Me("unimplemented","Blobs are unavailable in Firestore in this environment.")}!function(n,e=!0){C_=ys.SDK_VERSION,(0,ys._registerComponent)(new Ws.wA("firestore",(t,{options:r})=>{const o=t.getProvider("app").getImmediate(),u=new Yn(o,new AO(t.getProvider("auth-internal")),new MO(t.getProvider("app-check-internal")));return r=Object.assign({useFetchStreams:e},r),u._setSettings(r),u},"PUBLIC")),(0,ys.registerVersion)(hN,"3.4.5",n),(0,ys.registerVersion)(hN,"3.4.5","esm2017")}();class T0{constructor(e){this._delegate=e}static fromBase64String(e){return rO(),new T0(ml.fromBase64String(e))}static fromUint8Array(e){return nO(),new T0(ml.fromUint8Array(e))}toBase64(){return rO(),this._delegate.toBase64()}toUint8Array(){return nO(),this._delegate.toUint8Array()}isEqual(e){return this._delegate.isEqual(e._delegate)}toString(){return"Blob(base64: "+this.toBase64()+")"}}function tM(n){return function oL(n,e){if("object"!=typeof n||null===n)return!1;const t=n;for(const r of e)if(r in t&&"function"==typeof t[r])return!0;return!1}(n,["next","error","complete"])}class aL{enableIndexedDbPersistence(e,t){return function pF(n,e){OP(n=qt(n,Yn));const t=Br(n),r=n._freezeSettings(),o=new Fx;return PP(t,o,new gP(o,r.cacheSizeBytes,null==e?void 0:e.forceOwnership))}(e._delegate,{forceOwnership:t})}enableMultiTabIndexedDbPersistence(e){return function gF(n){OP(n=qt(n,Yn));const e=Br(n),t=n._freezeSettings(),r=new Fx;return PP(e,r,new Y1(r,t.cacheSizeBytes))}(e._delegate)}clearIndexedDbPersistence(e){return function mF(n){if(n._initialized&&!n._terminated)throw new Me(ue.FAILED_PRECONDITION,"Persistence can only be cleared before a Firestore instance is initialized or after it is terminated.");const e=new ci;return n._queue.enqueueAndForgetEvenWhileRestricted((0,pe.Z)(function*(){try{yield(t=(0,pe.Z)(function*(r){if(!pu.Vt())return Promise.resolve();const o=r+"main";yield pu.delete(o)}),function(r){return t.apply(this,arguments)})(AS(n._databaseId,n._persistenceKey)),e.resolve()}catch(t){e.reject(t)}var t})),e.promise}(e._delegate)}}class iO{constructor(e,t,r){this._delegate=t,this._persistenceProvider=r,this.INTERNAL={delete:()=>this.terminate()},e instanceof Mp||(this._appCompat=e)}get _databaseId(){return this._delegate._databaseId}settings(e){const t=this._delegate._getSettings();!e.merge&&t.host!==e.host&&KE("You are overriding the original host. If you did not intend to override your settings, use {merge: true}."),e.merge&&delete(e=Object.assign(Object.assign({},t),e)).merge,this._delegate._setSettings(e)}useEmulator(e,t,r={}){!function lF(n,e,t,r={}){var o;const u=(n=qt(n,w0))._getSettings();if("firestore.googleapis.com"!==u.host&&u.host!==e&&KE("Host has been set in both settings() and useEmulator(), emulator host will be used"),n._setSettings(Object.assign(Object.assign({},u),{host:`${e}:${t}`,ssl:!1})),r.mockUserToken){let c,g;if("string"==typeof r.mockUserToken)c=r.mockUserToken,g=ki.MOCK_USER;else{c=(0,P.Sg)(r.mockUserToken,null===(o=n._app)||void 0===o?void 0:o.options.projectId);const E=r.mockUserToken.sub||r.mockUserToken.user_id;if(!E)throw new Me(ue.INVALID_ARGUMENT,"mockUserToken must contain 'sub' or 'user_id' field!");g=new ki(E)}n._authCredentials=new TO(new fN(c,g))}}(this._delegate,e,t,r)}enableNetwork(){return function yF(n){return function tF(n){return n.asyncQueue.enqueue((0,pe.Z)(function*(){const e=yield vP(n),t=yield EP(n);return e.setNetworkEnabled(!0),function(r){const o=We(r);return o.Ko.delete(0),v0(o)}(t)}))}(Br(n=qt(n,Yn)))}(this._delegate)}disableNetwork(){return function vF(n){return function nF(n){return n.asyncQueue.enqueue((0,pe.Z)(function*(){const e=yield vP(n),t=yield EP(n);return e.setNetworkEnabled(!1),(r=(0,pe.Z)(function*(o){const u=We(o);u.Ko.add(0),yield W_(u),u.Qo.set("Offline")}),function(o){return r.apply(this,arguments)})(t);var r}))}(Br(n=qt(n,Yn)))}(this._delegate)}enablePersistence(e){let t=!1,r=!1;return e&&(t=!!e.synchronizeTabs,r=!!e.experimentalForceOwningTab,DP("synchronizeTabs",t,"experimentalForceOwningTab",r)),t?this._persistenceProvider.enableMultiTabIndexedDbPersistence(this):this._persistenceProvider.enableIndexedDbPersistence(this,r)}clearPersistence(){return this._persistenceProvider.clearIndexedDbPersistence(this)}terminate(){return this._appCompat&&(this._appCompat._removeServiceInstance("firestore-compat"),this._appCompat._removeServiceInstance("firestore")),this._delegate._delete()}waitForPendingWrites(){return function _F(n){return function(e){const t=new ci;return e.asyncQueue.enqueueAndForget((0,pe.Z)(function*(){return function V1(n,e){return Ex.apply(this,arguments)}(yield Gx(e),t)})),t.promise}(Br(n=qt(n,Yn)))}(this._delegate)}onSnapshotsInSync(e){return function YF(n,e){return function sF(n,e){const t=new SD(e);return n.asyncQueue.enqueueAndForget((0,pe.Z)(function*(){return r=yield J_(n),o=t,We(r).Zo.add(o),void o.next();var r,o})),()=>{t.Jc(),n.asyncQueue.enqueueAndForget((0,pe.Z)(function*(){return r=yield J_(n),o=t,void We(r).Zo.delete(o);var r,o}))}}(Br(n=qt(n,Yn)),qx(e)?e:{next:e})}(this._delegate,e)}get app(){if(!this._appCompat)throw new Me("failed-precondition","Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._appCompat}collection(e){try{return new ey(this,xP(this._delegate,e))}catch(t){throw Ms(t,"collection()","Firestore.collection()")}}doc(e){try{return new Ea(this,ND(this._delegate,e))}catch(t){throw Ms(t,"doc()","Firestore.doc()")}}collectionGroup(e){try{return new Ns(this,function cF(n,e){if(n=qt(n,w0),Wx("collectionGroup","collection id",e),e.indexOf("/")>=0)throw new Me(ue.INVALID_ARGUMENT,`Invalid collection ID '${e}' passed to function collectionGroup(). Collection IDs must not contain '/'.`);return new ss(n,null,(t=e,new Rc(rn.emptyPath(),t)));var t}(this._delegate,e))}catch(t){throw Ms(t,"collectionGroup()","Firestore.collectionGroup()")}}runTransaction(e){return function JF(n,e){return function oF(n,e){const t=new ci;return n.asyncQueue.enqueueAndForget((0,pe.Z)(function*(){const r=yield(o=n,xD(o).then(u=>u.datastore));var o;new X1(n.asyncQueue,r,e,t).run()})),t.promise}(Br(n=qt(n,Yn)),t=>e(new QF(n,t)))}(this._delegate,t=>e(new sO(this,t)))}batch(){return Br(this._delegate),new oO(new QP(this._delegate,e=>X_(this._delegate,e)))}loadBundle(e){return function EF(n,e){const t=Br(n=qt(n,Yn)),r=new hF;return function aF(n,e,t,r){const o=function(u,c){let g;return g="string"==typeof u?(new TextEncoder).encode(u):u,E=function(E,I){if(E instanceof Uint8Array)return mP(E,I);if(E instanceof ArrayBuffer)return mP(new Uint8Array(E),I);if(E instanceof ReadableStream)return E.getReader();throw new Error("Source of `toByteStreamReader` has to be a ArrayBuffer or ReadableStream")}(g),new Q1(E,c);var E}(t,y0(e));n.asyncQueue.enqueueAndForget((0,pe.Z)(function*(){!function Z1(n,e,t){const r=We(n);var o;(o=(0,pe.Z)(function*(u,c,g){try{const E=yield c.getMetadata();if(yield function(F,W){const Y=We(F),xe=fi(W.createTime);return Y.persistence.runTransaction("hasNewerBundle","readonly",qe=>Y.Kn.getBundleMetadata(qe,W.id)).then(qe=>!!qe&&qe.createTime.compareTo(xe)>=0)}(u.localStore,E))return yield c.close(),void g._completeWith((F=E,{taskState:"Success",documentsLoaded:F.totalDocuments,bytesLoaded:F.totalBytes,totalDocuments:F.totalDocuments,totalBytes:F.totalBytes}));g._updateProgress(sP(E));const I=new S1(E,u.localStore,c.O);let S=yield c.Kc();for(;S;){const F=yield I.lc(S);F&&g._updateProgress(F),S=yield c.Kc()}const M=yield I.complete();yield Oc(u,M.ws,void 0),yield function(F,W){const Y=We(F);return Y.persistence.runTransaction("Save bundle","readwrite",xe=>Y.Kn.saveBundleMetadata(xe,W))}(u.localStore,E),g._completeWith(M.progress)}catch(E){KE("SyncEngine",`Loading bundle failed with ${E}`),g._failWith(E)}var F}),function(u,c,g){return o.apply(this,arguments)})(r,e,t).then(()=>{r.sharedClientState.notifyBundleLoaded()})}(yield Gx(n),o,r)}))}(t,n._databaseId,e,r),r}(this._delegate,e)}namedQuery(e){return function wF(n,e){return function uF(n,e){return n.asyncQueue.enqueue((0,pe.Z)(function*(){return function(t,r){const o=We(t);return o.persistence.runTransaction("Get named query","readonly",u=>o.Kn.getNamedQuery(u,r))}(yield Hx(n),e)}))}(Br(n=qt(n,Yn)),e).then(t=>t?new ss(n,null,t.query):null)}(this._delegate,e).then(t=>t?new Ns(this,t):null)}}class BD extends Jx{constructor(e){super(),this.firestore=e}convertBytes(e){return new T0(new ml(e))}convertReference(e){const t=this.convertDocumentKey(e,this.firestore._databaseId);return Ea.forKey(t,this.firestore,null)}}class sO{constructor(e,t){this._firestore=e,this._delegate=t,this._userDataWriter=new BD(e)}get(e){const t=Zp(e);return this._delegate.get(t).then(r=>new A0(this._firestore,new Fc(this._firestore._delegate,this._userDataWriter,r._key,r._document,r.metadata,t.converter)))}set(e,t,r){const o=Zp(e);return r?(eM("Transaction.set",r),this._delegate.set(o,t,r)):this._delegate.set(o,t),this}update(e,t,r,...o){const u=Zp(e);return 2===arguments.length?this._delegate.update(u,t):this._delegate.update(u,t,r,...o),this}delete(e){const t=Zp(e);return this._delegate.delete(t),this}}class oO{constructor(e){this._delegate=e}set(e,t,r){const o=Zp(e);return r?(eM("WriteBatch.set",r),this._delegate.set(o,t,r)):this._delegate.set(o,t),this}update(e,t,r,...o){const u=Zp(e);return 2===arguments.length?this._delegate.update(u,t):this._delegate.update(u,t,r,...o),this}delete(e){const t=Zp(e);return this._delegate.delete(t),this}commit(){return this._delegate.commit()}}class Kp{constructor(e,t,r){this._firestore=e,this._userDataWriter=t,this._delegate=r}fromFirestore(e,t){const r=new D0(this._firestore._delegate,this._userDataWriter,e._key,e._document,e.metadata,null);return this._delegate.fromFirestore(new S0(this._firestore,r),null!=t?t:{})}toFirestore(e,t){return t?this._delegate.toFirestore(e,t):this._delegate.toFirestore(e)}static getInstance(e,t){const r=Kp.INSTANCES;let o=r.get(e);o||(o=new WeakMap,r.set(e,o));let u=o.get(t);return u||(u=new Kp(e,new BD(e),t),o.set(t,u)),u}}Kp.INSTANCES=new WeakMap;class Ea{constructor(e,t){this.firestore=e,this._delegate=t,this._userDataWriter=new BD(e)}static forPath(e,t,r){if(e.length%2!=0)throw new Me("invalid-argument",`Invalid document reference. Document references must have an even number of segments, but ${e.canonicalString()} has ${e.length}`);return new Ea(t,new Fn(t._delegate,r,new Je(e)))}static forKey(e,t,r){return new Ea(t,new Fn(t._delegate,r,e))}get id(){return this._delegate.id}get parent(){return new ey(this.firestore,this._delegate.parent)}get path(){return this._delegate.path}collection(e){try{return new ey(this.firestore,xP(this._delegate,e))}catch(t){throw Ms(t,"collection()","DocumentReference.collection()")}}isEqual(e){return(e=(0,P.m9)(e))instanceof Fn&&MP(this._delegate,e)}set(e,t){t=eM("DocumentReference.set",t);try{return t?JP(this._delegate,e,t):JP(this._delegate,e)}catch(r){throw Ms(r,"setDoc()","DocumentReference.set()")}}update(e,t,...r){try{return 1===arguments.length?XP(this._delegate,e):XP(this._delegate,e,t,...r)}catch(o){throw Ms(o,"updateDoc()","DocumentReference.update()")}}delete(){return function KF(n){return X_(qt(n.firestore,Yn),[new o0(n._key,Lr.none())])}(this._delegate)}onSnapshot(...e){const t=aO(e),r=uO(e,o=>new A0(this.firestore,new Fc(this.firestore._delegate,this._userDataWriter,o._key,o._document,o.metadata,this._delegate.converter)));return eO(this._delegate,t,r)}get(e){let t;return t="cache"===(null==e?void 0:e.source)?function GF(n){n=qt(n,Fn);const e=qt(n.firestore,Yn),t=Br(e),r=new zp(e);return function rF(n,e){const t=new ci;return n.asyncQueue.enqueueAndForget((0,pe.Z)(function*(){return(r=(0,pe.Z)(function*(o,u,c){try{const g=yield function(E,I){const S=We(E);return S.persistence.runTransaction("read document","readonly",M=>S.Us.ys(M,I))}(o,u);g.isFoundDocument()?c.resolve(g):g.isNoDocument()?c.resolve(null):c.reject(new Me(ue.UNAVAILABLE,"Failed to get document from cache. (However, this document may exist on the server. Run again without setting 'source' in the GetOptions to attempt to retrieve the document from the server.)"))}catch(g){const E=K_(g,`Failed to get document '${u} from cache`);c.reject(E)}}),function(o,u,c){return r.apply(this,arguments)})(yield Hx(n),e,t);var r})),t.promise}(t,n._key).then(o=>new Fc(e,r,n._key,o,new qp(null!==o&&o.hasLocalMutations,!0),n.converter))}(this._delegate):"server"===(null==e?void 0:e.source)?function $F(n){n=qt(n,Fn);const e=qt(n.firestore,Yn);return wP(Br(e),n._key,{source:"server"}).then(t=>Xx(e,n,t))}(this._delegate):function HF(n){n=qt(n,Fn);const e=qt(n.firestore,Yn);return wP(Br(e),n._key).then(t=>Xx(e,n,t))}(this._delegate),t.then(r=>new A0(this.firestore,new Fc(this.firestore._delegate,this._userDataWriter,r._key,r._document,r.metadata,this._delegate.converter)))}withConverter(e){return new Ea(this.firestore,this._delegate.withConverter(e?Kp.getInstance(this.firestore,e):null))}}function Ms(n,e,t){return n.message=n.message.replace(e,t),n}function aO(n){for(const e of n)if("object"==typeof e&&!tM(e))return e;return{}}function uO(n,e){var t,r;let o;return o=tM(n[0])?n[0]:tM(n[1])?n[1]:"function"==typeof n[0]?{next:n[0],error:n[1],complete:n[2]}:{next:n[1],error:n[2],complete:n[3]},{next:u=>{o.next&&o.next(e(u))},error:null===(t=o.error)||void 0===t?void 0:t.bind(o),complete:null===(r=o.complete)||void 0===r?void 0:r.bind(o)}}class A0{constructor(e,t){this._firestore=e,this._delegate=t}get ref(){return new Ea(this._firestore,this._delegate.ref)}get id(){return this._delegate.id}get metadata(){return this._delegate.metadata}get exists(){return this._delegate.exists()}data(e){return this._delegate.data(e)}get(e,t){return this._delegate.get(e,t)}isEqual(e){return HP(this._delegate,e._delegate)}}class S0 extends A0{data(e){const t=this._delegate.data(e);return function DO(n,e){n||ut()}(void 0!==t),t}}class Ns{constructor(e,t){this.firestore=e,this._delegate=t,this._userDataWriter=new BD(e)}where(e,t,r){try{return new Ns(this.firestore,Nh(this._delegate,function RF(n,e,t){const r=e,o=LD("where",n);return new NF(o,r,t)}(e,t,r)))}catch(o){throw Ms(o,/(orderBy|where)\(\)/,"Query.$1()")}}orderBy(e,t){try{return new Ns(this.firestore,Nh(this._delegate,function OF(n,e="asc"){const t=e,r=LD("orderBy",n);return new PF(r,t)}(e,t)))}catch(r){throw Ms(r,/(orderBy|where)\(\)/,"Query.$1()")}}limit(e){try{return new Ns(this.firestore,Nh(this._delegate,function kF(n){return AP("limit",n),new $P("limit",n,"F")}(e)))}catch(t){throw Ms(t,"limit()","Query.limit()")}}limitToLast(e){try{return new Ns(this.firestore,Nh(this._delegate,function FF(n){return AP("limitToLast",n),new $P("limitToLast",n,"L")}(e)))}catch(t){throw Ms(t,"limitToLast()","Query.limitToLast()")}}startAt(...e){try{return new Ns(this.firestore,Nh(this._delegate,function LF(...n){return new WP("startAt",n,!0)}(...e)))}catch(t){throw Ms(t,"startAt()","Query.startAt()")}}startAfter(...e){try{return new Ns(this.firestore,Nh(this._delegate,function VF(...n){return new WP("startAfter",n,!1)}(...e)))}catch(t){throw Ms(t,"startAfter()","Query.startAfter()")}}endBefore(...e){try{return new Ns(this.firestore,Nh(this._delegate,function BF(...n){return new qP("endBefore",n,!1)}(...e)))}catch(t){throw Ms(t,"endBefore()","Query.endBefore()")}}endAt(...e){try{return new Ns(this.firestore,Nh(this._delegate,function UF(...n){return new qP("endAt",n,!0)}(...e)))}catch(t){throw Ms(t,"endAt()","Query.endAt()")}}isEqual(e){return NP(this._delegate,e._delegate)}get(e){let t;return t="cache"===(null==e?void 0:e.source)?function qF(n){n=qt(n,ss);const e=qt(n.firestore,Yn),t=Br(e),r=new zp(e);return function iF(n,e){const t=new ci;return n.asyncQueue.enqueueAndForget((0,pe.Z)(function*(){return(r=(0,pe.Z)(function*(o,u,c){try{const g=yield ID(o,u,!0),E=new uP(u,g.Ks),I=E.Ic(g.documents),S=E.applyChanges(I,!1);c.resolve(S.snapshot)}catch(g){const E=K_(g,`Failed to execute query '${u} against cache`);c.reject(E)}}),function(o,u,c){return r.apply(this,arguments)})(yield Hx(n),e,t);var r})),t.promise}(t,n._query).then(o=>new Mh(e,r,n,o))}(this._delegate):"server"===(null==e?void 0:e.source)?function zF(n){n=qt(n,ss);const e=qt(n.firestore,Yn),t=Br(e),r=new zp(e);return IP(t,n._query,{source:"server"}).then(o=>new Mh(e,r,n,o))}(this._delegate):function WF(n){n=qt(n,ss);const e=qt(n.firestore,Yn),t=Br(e),r=new zp(e);return GP(n._query),IP(t,n._query).then(o=>new Mh(e,r,n,o))}(this._delegate),t.then(r=>new nM(this.firestore,new Mh(this.firestore._delegate,this._userDataWriter,this._delegate,r._snapshot)))}onSnapshot(...e){const t=aO(e),r=uO(e,o=>new nM(this.firestore,new Mh(this.firestore._delegate,this._userDataWriter,this._delegate,o._snapshot)));return eO(this._delegate,t,r)}withConverter(e){return new Ns(this.firestore,this._delegate.withConverter(e?Kp.getInstance(this.firestore,e):null))}}class lL{constructor(e,t){this._firestore=e,this._delegate=t}get type(){return this._delegate.type}get doc(){return new S0(this._firestore,this._delegate.doc)}get oldIndex(){return this._delegate.oldIndex}get newIndex(){return this._delegate.newIndex}}class nM{constructor(e,t){this._firestore=e,this._delegate=t}get query(){return new Ns(this._firestore,this._delegate.query)}get metadata(){return this._delegate.metadata}get size(){return this._delegate.size}get empty(){return this._delegate.empty}get docs(){return this._delegate.docs.map(e=>new S0(this._firestore,e))}docChanges(e){return this._delegate.docChanges(e).map(t=>new lL(this._firestore,t))}forEach(e,t){this._delegate.forEach(r=>{e.call(t,new S0(this._firestore,r))})}isEqual(e){return HP(this._delegate,e._delegate)}}class ey extends Ns{constructor(e,t){super(e,t),this.firestore=e,this._delegate=t}get id(){return this._delegate.id}get path(){return this._delegate.path}get parent(){const e=this._delegate.parent;return e?new Ea(this.firestore,e):null}doc(e){try{return new Ea(this.firestore,void 0===e?ND(this._delegate):ND(this._delegate,e))}catch(t){throw Ms(t,"doc()","CollectionReference.doc()")}}add(e){return function ZF(n,e){const t=qt(n.firestore,Yn),r=ND(n),o=VD(n.converter,e);return X_(t,[OD($p(n.firestore),"addDoc",r._key,o,null!==n.converter,{}).toMutation(r._key,Lr.exists(!1))]).then(()=>r)}(this._delegate,e).then(t=>new Ea(this.firestore,t))}isEqual(e){return MP(this._delegate,e._delegate)}withConverter(e){return new ey(this.firestore,this._delegate.withConverter(e?Kp.getInstance(this.firestore,e):null))}}function Zp(n){return qt(n,Fn)}class rM{constructor(...e){this._delegate=new kc(...e)}static documentId(){return new rM(hi.keyField().canonicalString())}isEqual(e){return(e=(0,P.m9)(e))instanceof kc&&this._delegate._internalPath.isEqual(e._internalPath)}}class Yp{constructor(e){this._delegate=e}static serverTimestamp(){const e=function eL(){return new zx("serverTimestamp")}();return e._methodName="FieldValue.serverTimestamp",new Yp(e)}static delete(){const e=function XF(){return new I0("deleteField")}();return e._methodName="FieldValue.delete",new Yp(e)}static arrayUnion(...e){const t=function tL(...n){return new bF("arrayUnion",n)}(...e);return t._methodName="FieldValue.arrayUnion",new Yp(t)}static arrayRemove(...e){const t=function nL(...n){return new TF("arrayRemove",n)}(...e);return t._methodName="FieldValue.arrayRemove",new Yp(t)}static increment(e){const t=function rL(n){return new AF("increment",n)}(e);return t._methodName="FieldValue.increment",new Yp(t)}isEqual(e){return this._delegate.isEqual(e._delegate)}}const cL={Firestore:iO,GeoPoint:RD,Timestamp:di,Blob:T0,Transaction:sO,WriteBatch:oO,DocumentReference:Ea,DocumentSnapshot:A0,Query:Ns,QueryDocumentSnapshot:S0,QuerySnapshot:nM,CollectionReference:ey,FieldPath:rM,FieldValue:Yp,setLogLevel:function uL(n){!function CO(n){wh.setLogLevel(n)}(n)},CACHE_SIZE_UNLIMITED:-1};function lO(n,e){return function fL(n,e=bd.z){return new uo.y(t=>{let r;return null!=e?e.schedule(()=>{r=n.onSnapshot({includeMetadataChanges:!0},t)}):r=n.onSnapshot({includeMetadataChanges:!0},t),()=>{null!=r&&r()}})}(n,e)}function iM(n,e){return lO(n,e).pipe((0,Ht.U)(t=>({payload:t,type:"query"})))}function UD(n,e){return iM(n,e).pipe(vE(void 0),dC(),(0,Ht.U)(([t,r])=>{const o=r.payload.docChanges(),u=o.map(c=>({type:c.type,payload:c}));return t&&JSON.stringify(t.payload.metadata)!==JSON.stringify(r.payload.metadata)&&r.payload.docs.forEach((c,g)=>{const E=o.find(S=>S.doc.ref.isEqual(c.ref)),I=null==t?void 0:t.payload.docs.find(S=>S.ref.isEqual(c.ref));E&&JSON.stringify(E.doc.metadata)===JSON.stringify(c.metadata)||!E&&I&&JSON.stringify(I.metadata)===JSON.stringify(c.metadata)||u.push({type:"modified",payload:{oldIndex:g,newIndex:g,type:"modified",doc:c}})}),u}))}function cO(n,e,t){return UD(n,t).pipe(Fu((r,o)=>function gL(n,e,t){return e.forEach(r=>{t.indexOf(r.type)>-1&&(n=function mL(n,e){switch(e.type){case"added":if(!n[e.newIndex]||!n[e.newIndex].doc.ref.isEqual(e.doc.ref))return sM(n,e.newIndex,0,e);break;case"modified":if(null==n[e.oldIndex]||n[e.oldIndex].doc.ref.isEqual(e.doc.ref)){if(e.oldIndex!==e.newIndex){const t=n.slice();return t.splice(e.oldIndex,1),t.splice(e.newIndex,0,e),t}return sM(n,e.newIndex,1,e)}break;case"removed":if(n[e.oldIndex]&&n[e.oldIndex].doc.ref.isEqual(e.doc.ref))return sM(n,e.oldIndex,1)}return n}(n,r))}),n}(r,o.map(u=>u.payload),e),[]),bg(),(0,Ht.U)(r=>r.map(o=>({type:o.type,payload:o}))))}function sM(n,e,t,...r){const o=n.slice();return o.splice(e,t,...r),o}function dO(n){return(!n||0===n.length)&&(n=["added","removed","modified"]),n}!function hL(n){(function dL(n,e){n.INTERNAL.registerComponent(new Ws.wA("firestore-compat",t=>{const r=t.getProvider("app-compat").getImmediate(),o=t.getProvider("firestore").getImmediate();return e(r,o)},"PUBLIC").setServiceProps(Object.assign({},cL)))})(n,(e,t)=>new iO(e,t,new aL)),n.registerVersion("@firebase/firestore-compat","0.1.14")}(Lu.Z);class hO{constructor(e,t,r){this.ref=e,this.query=t,this.afs=r}stateChanges(e){let t=UD(this.query,this.afs.schedulers.outsideAngular);return e&&e.length>0&&(t=t.pipe((0,Ht.U)(r=>r.filter(o=>e.indexOf(o.type)>-1)))),t.pipe(vE(void 0),dC(),rp(([r,o])=>o.length>0||!r),(0,Ht.U)(([r,o])=>o),vn.iC)}auditTrail(e){return this.stateChanges(e).pipe(Fu((t,r)=>[...t,...r],[]))}snapshotChanges(e){const t=dO(e);return cO(this.query,t,this.afs.schedulers.outsideAngular).pipe(vn.iC)}valueChanges(e={}){return iM(this.query,this.afs.schedulers.outsideAngular).pipe((0,Ht.U)(t=>t.payload.docs.map(r=>e.idField?Object.assign(Object.assign({},r.data()),{[e.idField]:r.id}):r.data())),vn.iC)}get(e){return(0,Wi.D)(this.query.get(e)).pipe(vn.iC)}add(e){return this.ref.add(e)}doc(e){return new fO(this.ref.doc(e),this.afs)}}class fO{constructor(e,t){this.ref=e,this.afs=t}set(e,t){return this.ref.set(e,t)}update(e){return this.ref.update(e)}delete(){return this.ref.delete()}collection(e,t){const r=this.ref.collection(e),{ref:o,query:u}=pO(r,t);return new hO(o,u,this.afs)}snapshotChanges(){return function pL(n,e){return lO(n,e).pipe(vE(void 0),dC(),(0,Ht.U)(([t,r])=>r.exists?(null==t?void 0:t.exists)?{payload:r,type:"modified"}:{payload:r,type:"added"}:{payload:r,type:"removed"}))}(this.ref,this.afs.schedulers.outsideAngular).pipe(vn.iC)}valueChanges(e={}){return this.snapshotChanges().pipe((0,Ht.U)(({payload:t})=>e.idField?Object.assign(Object.assign({},t.data()),{[e.idField]:t.id}):t.data()))}get(e){return(0,Wi.D)(this.ref.get(e)).pipe(vn.iC)}}class _L{constructor(e,t){this.query=e,this.afs=t}stateChanges(e){return e&&0!==e.length?UD(this.query,this.afs.schedulers.outsideAngular).pipe((0,Ht.U)(t=>t.filter(r=>e.indexOf(r.type)>-1)),rp(t=>t.length>0),vn.iC):UD(this.query,this.afs.schedulers.outsideAngular).pipe(vn.iC)}auditTrail(e){return this.stateChanges(e).pipe(Fu((t,r)=>[...t,...r],[]))}snapshotChanges(e){const t=dO(e);return cO(this.query,t,this.afs.schedulers.outsideAngular).pipe(vn.iC)}valueChanges(e={}){return iM(this.query,this.afs.schedulers.outsideAngular).pipe((0,Ht.U)(r=>r.payload.docs.map(o=>e.idField?Object.assign({[e.idField]:o.id},o.data()):o.data())),vn.iC)}get(e){return(0,Wi.D)(this.query.get(e)).pipe(vn.iC)}}const yL=new _.OlP("angularfire2.enableFirestorePersistence"),vL=new _.OlP("angularfire2.firestore.persistenceSettings"),EL=new _.OlP("angularfire2.firestore.settings"),wL=new _.OlP("angularfire2.firestore.use-emulator");function pO(n,e=(t=>t)){return{query:e(n),ref:n}}let IL=(()=>{class n{constructor(t,r,o,u,c,g,E,I,S,M,F,W,Y,xe,qe,Pt,Bt){this.schedulers=E;const or=(0,Pn.on)(t,g,r),zt=S;M&&cE(or,g,F,Y,xe,qe,W,Pt),[this.firestore,this.persistenceEnabled$]=(0,Pn.cc)(`${or.name}.firestore`,"AngularFirestore",or.name,()=>{const ar=g.runOutsideAngular(()=>or.firestore());if(u&&ar.settings(u),zt&&ar.useEmulator(...zt),o&&!xa(c)){const gu=()=>{try{return(0,Wi.D)(ar.enablePersistence(I||void 0).then(()=>!0,()=>!1))}catch(jD){return"undefined"!=typeof console&&console.warn(jD),eu(!1)}};return[ar,g.runOutsideAngular(gu)]}return[ar,eu(!1)]},[u,zt,o])}collection(t,r){let o;o="string"==typeof t?this.firestore.collection(t):t;const{ref:u,query:c}=pO(o,r),g=this.schedulers.ngZone.run(()=>u);return new hO(g,c,this)}collectionGroup(t,r){const o=r||(c=>c),u=this.firestore.collectionGroup(t);return new _L(o(u),this)}doc(t){let r;r="string"==typeof t?this.firestore.doc(t):t;const o=this.schedulers.ngZone.run(()=>r);return new fO(o,this)}createId(){return this.firestore.collection("_").doc().id}}return n.\u0275fac=function(t){return new(t||n)(_.LFG(Pn.Dh),_.LFG(Pn.xv,8),_.LFG(yL,8),_.LFG(EL,8),_.LFG(_.Lbi),_.LFG(_.R0b),_.LFG(vn.HU),_.LFG(vL,8),_.LFG(wL,8),_.LFG(dE,8),_.LFG(Ac,8),_.LFG(aE,8),_.LFG(uE,8),_.LFG(lE,8),_.LFG(ah,8),_.LFG(uh,8),_.LFG(lp,8))},n.\u0275prov=_.Yz7({token:n,factory:n.\u0275fac,providedIn:"any"}),n})(),gO=(()=>{class n{constructor(t){this.firestore=t}getTiendabd(){return this.firestore.collection("tiendas").snapshotChanges()}createTiendabd(t){return this.firestore.collection("tiendas").add(Object.assign({},t))}updateTiendabd(t){this.firestore.doc("tiendas/"+t.id).update(t)}deleteTiendabd(t){this.firestore.doc("tiendas/"+t).delete()}}return n.\u0275fac=function(t){return new(t||n)(_.LFG(IL))},n.\u0275prov=_.Yz7({token:n,factory:n.\u0275fac,providedIn:"root"}),n})();function CL(n,e){if(1&n){const t=_.EpF();_.TgZ(0,"tr",8),_.NdJ("click",function(){const u=_.CHM(t).$implicit;return _.oxw().selectTiendaBD(u)}),_.TgZ(1,"td"),_._uU(2),_.qZA(),_.TgZ(3,"td"),_._uU(4),_.qZA(),_.TgZ(5,"td"),_._uU(6),_.qZA(),_.TgZ(7,"td"),_._uU(8),_.qZA(),_.qZA()}if(2&n){const t=e.$implicit;_.xp6(2),_.Oqu(t.nombreTienda),_.xp6(2),_.Oqu(t.dueno),_.xp6(2),_.Oqu(t.direccion),_.xp6(2),_.Oqu(t.tiempoVentas)}}let DL=(()=>{class n{constructor(t){this.tiendabdService=t,this.tiendas=[],this.tienda=new Um}ngOnInit(){this.tiendabdService.getTiendabd().subscribe(t=>{this.tiendas=t.map(r=>Object.assign(Object.assign({},r.payload.doc.data()),{id:r.payload.doc.id}))})}agregarTiendaBD(){this.tiendabdService.createTiendabd(this.tienda),this.tienda=new Um}selectTiendaBD(t){this.tienda=t}updateTiendaBD(){this.tiendabdService.updateTiendabd(this.tienda),this.tienda=new Um}deleteTiendaBD(t){this.tiendabdService.deleteTiendabd(t),this.tienda=new Um}}return n.\u0275fac=function(t){return new(t||n)(_.Y36(gO))},n.\u0275cmp=_.Xpm({type:n,selectors:[["app-tiendasbd"]],decls:47,vars:5,consts:[[1,"table"],[3,"click",4,"ngFor","ngForOf"],[1,"col-sm-4"],["type","text",1,"form-control",3,"ngModel","ngModelChange"],["type","number",1,"form-control",3,"ngModel","ngModelChange"],["type","button",1,"btn","btn-primary",3,"click"],["type","button",1,"btn","btn-warning",3,"click"],["type","button",1,"btn","btn-danger",3,"click"],[3,"click"]],template:function(t,r){1&t&&(_.TgZ(0,"h2"),_._uU(1,"Tiendas de Comics en M\xe9xico 2022"),_.qZA(),_.TgZ(2,"table",0),_.TgZ(3,"thead"),_.TgZ(4,"th"),_._uU(5,"Nombre de la tienda: "),_.qZA(),_.TgZ(6,"th"),_._uU(7,"Due\xf1o de la tienda: "),_.qZA(),_.TgZ(8,"th"),_._uU(9,"Direcci\xf3n de la tienda: "),_.qZA(),_.TgZ(10,"th"),_._uU(11,"A\xf1os de ventas: "),_.qZA(),_.qZA(),_.TgZ(12,"tbody"),_.YNc(13,CL,9,4,"tr",1),_.qZA(),_.qZA(),_._UZ(14,"br"),_._UZ(15,"br"),_._UZ(16,"br"),_.TgZ(17,"h4"),_._uU(18,"Da de alta una tienda que has visitado"),_.qZA(),_.TgZ(19,"div",2),_.TgZ(20,"p"),_.TgZ(21,"label"),_._uU(22,"Nombre de la tienda que visitaste"),_.qZA(),_.TgZ(23,"input",3),_.NdJ("ngModelChange",function(u){return r.tienda.nombreTienda=u}),_.qZA(),_.qZA(),_.TgZ(24,"p"),_.TgZ(25,"label"),_._uU(26,"\xbfQui\xe9n era el due\xf1o de la tienda?"),_.qZA(),_.TgZ(27,"input",3),_.NdJ("ngModelChange",function(u){return r.tienda.dueno=u}),_.qZA(),_.qZA(),_.TgZ(28,"p"),_.TgZ(29,"label"),_._uU(30,"\xbfCu\xe1l era la direcci\xf3n de la tienda?"),_.qZA(),_.TgZ(31,"input",3),_.NdJ("ngModelChange",function(u){return r.tienda.direccion=u}),_.qZA(),_.qZA(),_.TgZ(32,"p"),_.TgZ(33,"label"),_._uU(34,"\xbfCu\xe1ntos a\xf1os vendiendo lleva esta tienda?"),_.qZA(),_.TgZ(35,"input",4),_.NdJ("ngModelChange",function(u){return r.tienda.tiempoVentas=u}),_.qZA(),_.qZA(),_.TgZ(36,"table"),_.TgZ(37,"tr"),_.TgZ(38,"td"),_.TgZ(39,"button",5),_.NdJ("click",function(){return r.agregarTiendaBD()}),_._uU(40," Registrar tienda visitada "),_.qZA(),_.qZA(),_.TgZ(41,"td"),_.TgZ(42,"button",6),_.NdJ("click",function(){return r.updateTiendaBD()}),_._uU(43," Actualizar tienda "),_.qZA(),_.qZA(),_.TgZ(44,"td"),_.TgZ(45,"button",7),_.NdJ("click",function(){return r.deleteTiendaBD(r.tienda.id)}),_._uU(46," Eliminar tienda "),_.qZA(),_.qZA(),_.qZA(),_.qZA(),_.qZA()),2&t&&(_.xp6(13),_.Q6J("ngForOf",r.tiendas),_.xp6(10),_.Q6J("ngModel",r.tienda.nombreTienda),_.xp6(4),_.Q6J("ngModel",r.tienda.dueno),_.xp6(4),_.Q6J("ngModel",r.tienda.direccion),_.xp6(4),_.Q6J("ngModel",r.tienda.tiempoVentas))},directives:[Gn,Qo,jl,nf,sf],styles:[""]}),n})(),bL=(()=>{class n{constructor(){this.title="TiendaComics"}}return n.\u0275fac=function(t){return new(t||n)},n.\u0275cmp=_.Xpm({type:n,selectors:[["app-root"]],decls:3,vars:0,template:function(t,r){1&t&&(_.TgZ(0,"h1"),_._uU(1,"Tiendas de comics por Alain Link"),_.qZA(),_._UZ(2,"app-tiendasbd"))},directives:[DL],styles:[""]}),n})(),TL=(()=>{class n{constructor(){this.tiendacomics=[],this.tiposcomics=[{id:0,descripcion:"Sin definir"},{id:1,descripcion:"De primera edici\xf3n"},{id:2,descripcion:"De colecci\xf3n de ORO"},{id:3,descripcion:"De segunda mano pero con alto valor"}]}getTiendaComic(){return this.tiendacomics}getTiposComics(){return this.tiposcomics}agregarTiendaComic(t){this.tiendacomics.push(t)}nuevoTiendaComic(){return{id:this.tiendacomics.length+1,nombre:"",domicilio:"",dueno:"",tipo:0}}}return n.\u0275fac=function(t){return new(t||n)},n.\u0275prov=_.Yz7({token:n,factory:n.\u0275fac,providedIn:"root"}),n})(),AL=(()=>{class n{}return n.\u0275fac=function(t){return new(t||n)},n.\u0275mod=_.oAB({type:n,bootstrap:[bL]}),n.\u0275inj=_.cJS({providers:[TL,gO],imports:[[Tl,ec,Sa,Pn.hO.initializeApp(hr_firebaseConfig),lC]]}),n})();(0,_.G48)(),ka().bootstrapModule(AL).catch(n=>console.error(n))},5867:(it,be,L)=>{"use strict";L.d(be,{Mq:()=>_.getApp,C6:()=>_.getApps});var _=L(9681);(0,_.registerVersion)("firebase","9.6.7","app")},127:(it,be,L)=>{"use strict";L.d(be,{Z:()=>_.Z});var _=L(3942);_.Z.registerVersion("firebase","9.6.7","app-compat")},2438:(it,be,L)=>{"use strict";L.r(be);var _=L(5861),J=L(3942),k=L(2090),le=L(9681);function de(m,h){var f={};for(var v in m)Object.prototype.hasOwnProperty.call(m,v)&&h.indexOf(v)<0&&(f[v]=m[v]);if(null!=m&&"function"==typeof Object.getOwnPropertySymbols){var b=0;for(v=Object.getOwnPropertySymbols(m);b<v.length;b++)h.indexOf(v[b])<0&&Object.prototype.propertyIsEnumerable.call(m,v[b])&&(f[v[b]]=m[v[b]])}return f}var Re=L(1877),ce=L(4859);const mr=function wr(){return{"admin-restricted-operation":"This operation is restricted to administrators only.","argument-error":"","app-not-authorized":"This app, identified by the domain where it's hosted, is not authorized to use Firebase Authentication with the provided API key. Review your key configuration in the Google API console.","app-not-installed":"The requested mobile application corresponding to the identifier (Android package name or iOS bundle ID) provided is not installed on this device.","captcha-check-failed":"The reCAPTCHA response token provided is either invalid, expired, already used or the domain associated with it does not match the list of whitelisted domains.","code-expired":"The SMS code has expired. Please re-send the verification code to try again.","cordova-not-ready":"Cordova framework is not ready.","cors-unsupported":"This browser is not supported.","credential-already-in-use":"This credential is already associated with a different user account.","custom-token-mismatch":"The custom token corresponds to a different audience.","requires-recent-login":"This operation is sensitive and requires recent authentication. Log in again before retrying this request.","dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK.","dynamic-link-not-activated":"Please activate Dynamic Links in the Firebase Console and agree to the terms and conditions.","email-change-needs-verification":"Multi-factor users must always have a verified email.","email-already-in-use":"The email address is already in use by another account.","emulator-config-failed":'Auth instance has already been used to make a network call. Auth can no longer be configured to use the emulator. Try calling "connectAuthEmulator()" sooner.',"expired-action-code":"The action code has expired.","cancelled-popup-request":"This operation has been cancelled due to another conflicting popup being opened.","internal-error":"An internal AuthError has occurred.","invalid-app-credential":"The phone verification request contains an invalid application verifier. The reCAPTCHA token response is either invalid or expired.","invalid-app-id":"The mobile app identifier is not registed for the current project.","invalid-user-token":"This user's credential isn't valid for this project. This can happen if the user's token has been tampered with, or if the user isn't for the project associated with this API key.","invalid-auth-event":"An internal AuthError has occurred.","invalid-verification-code":"The SMS verification code used to create the phone auth credential is invalid. Please resend the verification code sms and be sure to use the verification code provided by the user.","invalid-continue-uri":"The continue URL provided in the request is invalid.","invalid-cordova-configuration":"The following Cordova plugins must be installed to enable OAuth sign-in: cordova-plugin-buildinfo, cordova-universal-links-plugin, cordova-plugin-browsertab, cordova-plugin-inappbrowser and cordova-plugin-customurlscheme.","invalid-custom-token":"The custom token format is incorrect. Please check the documentation.","invalid-dynamic-link-domain":"The provided dynamic link domain is not configured or authorized for the current project.","invalid-email":"The email address is badly formatted.","invalid-emulator-scheme":"Emulator URL must start with a valid scheme (http:// or https://).","invalid-api-key":"Your API key is invalid, please check you have copied it correctly.","invalid-cert-hash":"The SHA-1 certificate hash provided is invalid.","invalid-credential":"The supplied auth credential is malformed or has expired.","invalid-message-payload":"The email template corresponding to this action contains invalid characters in its message. Please fix by going to the Auth email templates section in the Firebase Console.","invalid-multi-factor-session":"The request does not contain a valid proof of first factor successful sign-in.","invalid-oauth-provider":"EmailAuthProvider is not supported for this operation. This operation only supports OAuth providers.","invalid-oauth-client-id":"The OAuth client ID provided is either invalid or does not match the specified API key.","unauthorized-domain":"This domain is not authorized for OAuth operations for your Firebase project. Edit the list of authorized domains from the Firebase console.","invalid-action-code":"The action code is invalid. This can happen if the code is malformed, expired, or has already been used.","wrong-password":"The password is invalid or the user does not have a password.","invalid-persistence-type":"The specified persistence type is invalid. It can only be local, session or none.","invalid-phone-number":"The format of the phone number provided is incorrect. Please enter the phone number in a format that can be parsed into E.164 format. E.164 phone numbers are written in the format [+][country code][subscriber number including area code].","invalid-provider-id":"The specified provider ID is invalid.","invalid-recipient-email":"The email corresponding to this action failed to send as the provided recipient email address is invalid.","invalid-sender":"The email template corresponding to this action contains an invalid sender email or name. Please fix by going to the Auth email templates section in the Firebase Console.","invalid-verification-id":"The verification ID used to create the phone auth credential is invalid.","invalid-tenant-id":"The Auth instance's tenant ID is invalid.","missing-android-pkg-name":"An Android Package Name must be provided if the Android App is required to be installed.","auth-domain-config-required":"Be sure to include authDomain when calling firebase.initializeApp(), by following the instructions in the Firebase console.","missing-app-credential":"The phone verification request is missing an application verifier assertion. A reCAPTCHA response token needs to be provided.","missing-verification-code":"The phone auth credential was created with an empty SMS verification code.","missing-continue-uri":"A continue URL must be provided in the request.","missing-iframe-start":"An internal AuthError has occurred.","missing-ios-bundle-id":"An iOS Bundle ID must be provided if an App Store ID is provided.","missing-or-invalid-nonce":"The request does not contain a valid nonce. This can occur if the SHA-256 hash of the provided raw nonce does not match the hashed nonce in the ID token payload.","missing-multi-factor-info":"No second factor identifier is provided.","missing-multi-factor-session":"The request is missing proof of first factor successful sign-in.","missing-phone-number":"To send verification codes, provide a phone number for the recipient.","missing-verification-id":"The phone auth credential was created with an empty verification ID.","app-deleted":"This instance of FirebaseApp has been deleted.","multi-factor-info-not-found":"The user does not have a second factor matching the identifier provided.","multi-factor-auth-required":"Proof of ownership of a second factor is required to complete sign-in.","account-exists-with-different-credential":"An account already exists with the same email address but different sign-in credentials. Sign in using a provider associated with this email address.","network-request-failed":"A network AuthError (such as timeout, interrupted connection or unreachable host) has occurred.","no-auth-event":"An internal AuthError has occurred.","no-such-provider":"User was not linked to an account with the given provider.","null-user":"A null user object was provided as the argument for an operation which requires a non-null user object.","operation-not-allowed":"The given sign-in provider is disabled for this Firebase project. Enable it in the Firebase console, under the sign-in method tab of the Auth section.","operation-not-supported-in-this-environment":'This operation is not supported in the environment this application is running on. "location.protocol" must be http, https or chrome-extension and web storage must be enabled.',"popup-blocked":"Unable to establish a connection with the popup. It may have been blocked by the browser.","popup-closed-by-user":"The popup has been closed by the user before finalizing the operation.","provider-already-linked":"User can only be linked to one identity for the given provider.","quota-exceeded":"The project's quota for this operation has been exceeded.","redirect-cancelled-by-user":"The redirect operation has been cancelled by the user before finalizing.","redirect-operation-pending":"A redirect sign-in operation is already pending.","rejected-credential":"The request contains malformed or mismatching credentials.","second-factor-already-in-use":"The second factor is already enrolled on this account.","maximum-second-factor-count-exceeded":"The maximum allowed number of second factors on a user has been exceeded.","tenant-id-mismatch":"The provided tenant ID does not match the Auth instance's tenant ID",timeout:"The operation has timed out.","user-token-expired":"The user's credential is no longer valid. The user must sign in again.","too-many-requests":"We have blocked all requests from this device due to unusual activity. Try again later.","unauthorized-continue-uri":"The domain of the continue URL is not whitelisted.  Please whitelist the domain in the Firebase console.","unsupported-first-factor":"Enrolling a second factor or signing in with a multi-factor account requires sign-in with a supported first factor.","unsupported-persistence-type":"The current environment does not support the specified persistence type.","unsupported-tenant-operation":"This operation is not supported in a multi-tenant context.","unverified-email":"The operation requires a verified email.","user-cancelled":"The user did not grant your application the permissions it requested.","user-not-found":"There is no user record corresponding to this identifier. The user may have been deleted.","user-disabled":"The user account has been disabled by an administrator.","user-mismatch":"The supplied credentials do not correspond to the previously signed in user.","user-signed-out":"","weak-password":"The password must be 6 characters long or more.","web-storage-unsupported":"This browser is not supported or 3rd party cookies and data may be disabled.","already-initialized":"initializeAuth() has already been called with different options. To avoid this error, call initializeAuth() with the same options as when it was originally called, or call getAuth() to return the already initialized instance."}},$t=function Jt(){return{"dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}},yi=new k.LL("auth","Firebase",{"dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}),Dn=new Re.Yd("@firebase/auth");function vi(m,...h){Dn.logLevel<=Re.in.ERROR&&Dn.error(`Auth (${le.SDK_VERSION}): ${m}`,...h)}function kt(m,...h){throw os(m,...h)}function gn(m,...h){return os(m,...h)}function Xs(m,h,f){const v=Object.assign(Object.assign({},$t()),{[h]:f});return new k.LL("auth","Firebase",v).create(h,{appName:m.name})}function Ur(m,h,f){if(!(h instanceof f))throw f.name!==h.constructor.name&&kt(m,"argument-error"),Xs(m,"argument-error",`Type of ${h.constructor.name} does not match expected instance.Did you pass a reference from a different Auth SDK?`)}function os(m,...h){if("string"!=typeof m){const f=h[0],v=[...h.slice(1)];return v[0]&&(v[0].appName=m.name),m._errorFactory.create(f,...v)}return yi.create(m,...h)}function Ae(m,h,...f){if(!m)throw os(h,...f)}function ur(m){const h="INTERNAL ASSERTION FAILED: "+m;throw vi(h),new Error(h)}function et(m,h){m||ur(h)}const Xr=new Map;function Ut(m){et(m instanceof Function,"Expected a class definition");let h=Xr.get(m);return h?(et(h instanceof m,"Instance stored in cache mismatched with class"),h):(h=new m,Xr.set(m,h),h)}function lt(){var m;return"undefined"!=typeof self&&(null===(m=self.location)||void 0===m?void 0:m.href)||""}function tt(){return"http:"===Dt()||"https:"===Dt()}function Dt(){var m;return"undefined"!=typeof self&&(null===(m=self.location)||void 0===m?void 0:m.protocol)||null}class bt{constructor(h,f){this.shortDelay=h,this.longDelay=f,et(f>h,"Short delay should be less than long delay!"),this.isMobile=(0,k.uI)()||(0,k.b$)()}get(){return function sn(){return!("undefined"!=typeof navigator&&navigator&&"onLine"in navigator&&"boolean"==typeof navigator.onLine&&(tt()||(0,k.ru)()||"connection"in navigator))||navigator.onLine}()?this.isMobile?this.longDelay:this.shortDelay:Math.min(5e3,this.shortDelay)}}function Xe(m,h){et(m.emulator,"Emulator should always be set here");const{url:f}=m.emulator;return h?`${f}${h.startsWith("/")?h.slice(1):h}`:f}class ot{static initialize(h,f,v){this.fetchImpl=h,f&&(this.headersImpl=f),v&&(this.responseImpl=v)}static fetch(){return this.fetchImpl?this.fetchImpl:"undefined"!=typeof self&&"fetch"in self?self.fetch:void ur("Could not find fetch implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static headers(){return this.headersImpl?this.headersImpl:"undefined"!=typeof self&&"Headers"in self?self.Headers:void ur("Could not find Headers implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static response(){return this.responseImpl?this.responseImpl:"undefined"!=typeof self&&"Response"in self?self.Response:void ur("Could not find Response implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}}const _l={CREDENTIAL_MISMATCH:"custom-token-mismatch",MISSING_CUSTOM_TOKEN:"internal-error",INVALID_IDENTIFIER:"invalid-email",MISSING_CONTINUE_URI:"internal-error",INVALID_PASSWORD:"wrong-password",MISSING_PASSWORD:"internal-error",EMAIL_EXISTS:"email-already-in-use",PASSWORD_LOGIN_DISABLED:"operation-not-allowed",INVALID_IDP_RESPONSE:"invalid-credential",INVALID_PENDING_TOKEN:"invalid-credential",FEDERATED_USER_ID_ALREADY_LINKED:"credential-already-in-use",MISSING_REQ_TYPE:"internal-error",EMAIL_NOT_FOUND:"user-not-found",RESET_PASSWORD_EXCEED_LIMIT:"too-many-requests",EXPIRED_OOB_CODE:"expired-action-code",INVALID_OOB_CODE:"invalid-action-code",MISSING_OOB_CODE:"internal-error",CREDENTIAL_TOO_OLD_LOGIN_AGAIN:"requires-recent-login",INVALID_ID_TOKEN:"invalid-user-token",TOKEN_EXPIRED:"user-token-expired",USER_NOT_FOUND:"user-token-expired",TOO_MANY_ATTEMPTS_TRY_LATER:"too-many-requests",INVALID_CODE:"invalid-verification-code",INVALID_SESSION_INFO:"invalid-verification-id",INVALID_TEMPORARY_PROOF:"invalid-credential",MISSING_SESSION_INFO:"missing-verification-id",SESSION_EXPIRED:"code-expired",MISSING_ANDROID_PACKAGE_NAME:"missing-android-pkg-name",UNAUTHORIZED_DOMAIN:"unauthorized-continue-uri",INVALID_OAUTH_CLIENT_ID:"invalid-oauth-client-id",ADMIN_ONLY_OPERATION:"admin-restricted-operation",INVALID_MFA_PENDING_CREDENTIAL:"invalid-multi-factor-session",MFA_ENROLLMENT_NOT_FOUND:"multi-factor-info-not-found",MISSING_MFA_ENROLLMENT_ID:"missing-multi-factor-info",MISSING_MFA_PENDING_CREDENTIAL:"missing-multi-factor-session",SECOND_FACTOR_EXISTS:"second-factor-already-in-use",SECOND_FACTOR_LIMIT_EXCEEDED:"maximum-second-factor-count-exceeded",BLOCKING_FUNCTION_ERROR_RESPONSE:"internal-error"},eo=new bt(3e4,6e4);function ct(m,h){return m.tenantId&&!h.tenantId?Object.assign(Object.assign({},h),{tenantId:m.tenantId}):h}function mn(m,h,f,v){return Cr.apply(this,arguments)}function Cr(){return(Cr=(0,_.Z)(function*(m,h,f,v,b={}){return as(m,b,(0,_.Z)(function*(){let x={},U={};v&&("GET"===h?U=v:x={body:JSON.stringify(v)});const te=(0,k.xO)(Object.assign({key:m.config.apiKey},U)).slice(1),Pe=yield m._getAdditionalHeaders();return Pe["Content-Type"]="application/json",m.languageCode&&(Pe["X-Firebase-Locale"]=m.languageCode),ot.fetch()(ve(m,m.config.apiHost,f,te),Object.assign({method:h,headers:Pe,referrerPolicy:"no-referrer"},x))}))})).apply(this,arguments)}function as(m,h,f){return B.apply(this,arguments)}function B(){return(B=(0,_.Z)(function*(m,h,f){m._canInitEmulator=!1;const v=Object.assign(Object.assign({},_l),h);try{const b=new ee(m),x=yield Promise.race([f(),b.promise]);b.clearNetworkTimeout();const U=yield x.json();if("needConfirmation"in U)throw je(m,"account-exists-with-different-credential",U);if(x.ok&&!("errorMessage"in U))return U;{const te=x.ok?U.errorMessage:U.error.message,[Pe,Se]=te.split(" : ");if("FEDERATED_USER_ID_ALREADY_LINKED"===Pe)throw je(m,"credential-already-in-use",U);if("EMAIL_EXISTS"===Pe)throw je(m,"email-already-in-use",U);const ze=v[Pe]||Pe.toLowerCase().replace(/[_\s]+/g,"-");if(Se)throw Xs(m,ze,Se);kt(m,ze)}}catch(b){if(b instanceof k.ZR)throw b;kt(m,"network-request-failed")}})).apply(this,arguments)}function G(m,h,f,v){return q.apply(this,arguments)}function q(){return(q=(0,_.Z)(function*(m,h,f,v,b={}){const x=yield mn(m,h,f,v,b);return"mfaPendingCredential"in x&&kt(m,"multi-factor-auth-required",{_serverResponse:x}),x})).apply(this,arguments)}function ve(m,h,f,v){const b=`${h}${f}?${v}`;return m.config.emulator?Xe(m.config,b):`${m.config.apiScheme}://${b}`}class ee{constructor(h){this.auth=h,this.timer=null,this.promise=new Promise((f,v)=>{this.timer=setTimeout(()=>v(gn(this.auth,"network-request-failed")),eo.get())})}clearNetworkTimeout(){clearTimeout(this.timer)}}function je(m,h,f){const v={appName:m.name};f.email&&(v.email=f.email),f.phoneNumber&&(v.phoneNumber=f.phoneNumber);const b=gn(m,h,v);return b.customData._tokenResponse=f,b}function on(){return(on=(0,_.Z)(function*(m,h){return mn(m,"POST","/v1/accounts:delete",h)})).apply(this,arguments)}function Bn(m,h){return bn.apply(this,arguments)}function bn(){return(bn=(0,_.Z)(function*(m,h){return mn(m,"POST","/v1/accounts:update",h)})).apply(this,arguments)}function Dr(m,h){return xt.apply(this,arguments)}function xt(){return(xt=(0,_.Z)(function*(m,h){return mn(m,"POST","/v1/accounts:lookup",h)})).apply(this,arguments)}function lr(m){if(m)try{const h=new Date(Number(m));if(!isNaN(h.getTime()))return h.toUTCString()}catch(h){}}function ko(){return(ko=(0,_.Z)(function*(m,h=!1){const f=(0,k.m9)(m),v=yield f.getIdToken(h),b=to(v);Ae(b&&b.exp&&b.auth_time&&b.iat,f.auth,"internal-error");const x="object"==typeof b.firebase?b.firebase:void 0,U=null==x?void 0:x.sign_in_provider;return{claims:b,token:v,authTime:lr(mu(b.auth_time)),issuedAtTime:lr(mu(b.iat)),expirationTime:lr(mu(b.exp)),signInProvider:U||null,signInSecondFactor:(null==x?void 0:x.sign_in_second_factor)||null}})).apply(this,arguments)}function mu(m){return 1e3*Number(m)}function to(m){const[h,f,v]=m.split(".");if(void 0===h||void 0===f||void 0===v)return vi("JWT malformed, contained fewer than 3 sections"),null;try{const b=(0,k.tV)(f);return b?JSON.parse(b):(vi("Failed to decode base64 JWT payload"),null)}catch(b){return vi("Caught error parsing JWT payload as JSON",b),null}}function Un(m,h){return Bi.apply(this,arguments)}function Bi(){return(Bi=(0,_.Z)(function*(m,h,f=!1){if(f)return h;try{return yield h}catch(v){throw v instanceof k.ZR&&Jn(v)&&m.auth.currentUser===m&&(yield m.auth.signOut()),v}})).apply(this,arguments)}function Jn({code:m}){return"auth/user-disabled"===m||"auth/user-token-expired"===m}class Os{constructor(h){this.user=h,this.isRunning=!1,this.timerId=null,this.errorBackoff=3e4}_start(){this.isRunning||(this.isRunning=!0,this.schedule())}_stop(){!this.isRunning||(this.isRunning=!1,null!==this.timerId&&clearTimeout(this.timerId))}getInterval(h){var f;if(h){const v=this.errorBackoff;return this.errorBackoff=Math.min(2*this.errorBackoff,96e4),v}{this.errorBackoff=3e4;const b=(null!==(f=this.user.stsTokenManager.expirationTime)&&void 0!==f?f:0)-Date.now()-3e5;return Math.max(0,b)}}schedule(h=!1){var f=this;if(!this.isRunning)return;const v=this.getInterval(h);this.timerId=setTimeout((0,_.Z)(function*(){yield f.iteration()}),v)}iteration(){var h=this;return(0,_.Z)(function*(){try{yield h.user.getIdToken(!0)}catch(f){return void("auth/network-request-failed"===f.code&&h.schedule(!0))}h.schedule()})()}}class vl{constructor(h,f){this.createdAt=h,this.lastLoginAt=f,this._initializeTime()}_initializeTime(){this.lastSignInTime=lr(this.lastLoginAt),this.creationTime=lr(this.createdAt)}_copy(h){this.createdAt=h.createdAt,this.lastLoginAt=h.lastLoginAt,this._initializeTime()}toJSON(){return{createdAt:this.createdAt,lastLoginAt:this.lastLoginAt}}}function Ei(m){return no.apply(this,arguments)}function no(){return(no=(0,_.Z)(function*(m){var h;const f=m.auth,v=yield m.getIdToken(),b=yield Un(m,Dr(f,{idToken:v}));Ae(null==b?void 0:b.users.length,f,"internal-error");const x=b.users[0];m._notifyReloadListener(x);const U=(null===(h=x.providerUserInfo)||void 0===h?void 0:h.length)?jr(x.providerUserInfo):[],te=wa(m.providerData,U),ze=!!m.isAnonymous&&!(m.email&&x.passwordHash||(null==te?void 0:te.length)),Ye={uid:x.localId,displayName:x.displayName||null,photoURL:x.photoUrl||null,email:x.email||null,emailVerified:x.emailVerified||!1,phoneNumber:x.phoneNumber||null,tenantId:x.tenantId||null,providerData:te,metadata:new vl(x.createdAt,x.lastLoginAt),isAnonymous:ze};Object.assign(m,Ye)})).apply(this,arguments)}function jn(){return(jn=(0,_.Z)(function*(m){const h=(0,k.m9)(m);yield Ei(h),yield h.auth._persistUserIfCurrent(h),h.auth._notifyListenersIfCurrent(h)})).apply(this,arguments)}function wa(m,h){return[...m.filter(v=>!h.some(b=>b.providerId===v.providerId)),...h]}function jr(m){return m.map(h=>{var{providerId:f}=h,v=de(h,["providerId"]);return{providerId:f,uid:v.rawId||"",displayName:v.displayName||null,email:v.email||null,phoneNumber:v.phoneNumber||null,photoURL:v.photoUrl||null}})}function Tt(){return(Tt=(0,_.Z)(function*(m,h){const f=yield as(m,{},(0,_.Z)(function*(){const v=(0,k.xO)({grant_type:"refresh_token",refresh_token:h}).slice(1),{tokenApiHost:b,apiKey:x}=m.config,U=ve(m,b,"/v1/token",`key=${x}`),te=yield m._getAdditionalHeaders();return te["Content-Type"]="application/x-www-form-urlencoded",ot.fetch()(U,{method:"POST",headers:te,body:v})}));return{accessToken:f.access_token,expiresIn:f.expires_in,refreshToken:f.refresh_token}})).apply(this,arguments)}class jt{constructor(){this.refreshToken=null,this.accessToken=null,this.expirationTime=null}get isExpired(){return!this.expirationTime||Date.now()>this.expirationTime-3e4}updateFromServerResponse(h){Ae(h.idToken,"internal-error"),Ae(void 0!==h.idToken,"internal-error"),Ae(void 0!==h.refreshToken,"internal-error");const f="expiresIn"in h&&void 0!==h.expiresIn?Number(h.expiresIn):function Qn(m){const h=to(m);return Ae(h,"internal-error"),Ae(void 0!==h.exp,"internal-error"),Ae(void 0!==h.iat,"internal-error"),Number(h.exp)-Number(h.iat)}(h.idToken);this.updateTokensAndExpiration(h.idToken,h.refreshToken,f)}getToken(h,f=!1){var v=this;return(0,_.Z)(function*(){return Ae(!v.accessToken||v.refreshToken,h,"user-token-expired"),f||!v.accessToken||v.isExpired?v.refreshToken?(yield v.refresh(h,v.refreshToken),v.accessToken):null:v.accessToken})()}clearRefreshToken(){this.refreshToken=null}refresh(h,f){var v=this;return(0,_.Z)(function*(){const{accessToken:b,refreshToken:x,expiresIn:U}=yield function He(m,h){return Tt.apply(this,arguments)}(h,f);v.updateTokensAndExpiration(b,x,Number(U))})()}updateTokensAndExpiration(h,f,v){this.refreshToken=f||null,this.accessToken=h||null,this.expirationTime=Date.now()+1e3*v}static fromJSON(h,f){const{refreshToken:v,accessToken:b,expirationTime:x}=f,U=new jt;return v&&(Ae("string"==typeof v,"internal-error",{appName:h}),U.refreshToken=v),b&&(Ae("string"==typeof b,"internal-error",{appName:h}),U.accessToken=b),x&&(Ae("number"==typeof x,"internal-error",{appName:h}),U.expirationTime=x),U}toJSON(){return{refreshToken:this.refreshToken,accessToken:this.accessToken,expirationTime:this.expirationTime}}_assign(h){this.accessToken=h.accessToken,this.refreshToken=h.refreshToken,this.expirationTime=h.expirationTime}_clone(){return Object.assign(new jt,this.toJSON())}_performRefresh(){return ur("not implemented")}}function Tn(m,h){Ae("string"==typeof m||void 0===m,"internal-error",{appName:h})}class _r{constructor(h){var{uid:f,auth:v,stsTokenManager:b}=h,x=de(h,["uid","auth","stsTokenManager"]);this.providerId="firebase",this.proactiveRefresh=new Os(this),this.reloadUserInfo=null,this.reloadListener=null,this.uid=f,this.auth=v,this.stsTokenManager=b,this.accessToken=b.accessToken,this.displayName=x.displayName||null,this.email=x.email||null,this.emailVerified=x.emailVerified||!1,this.phoneNumber=x.phoneNumber||null,this.photoURL=x.photoURL||null,this.isAnonymous=x.isAnonymous||!1,this.tenantId=x.tenantId||null,this.providerData=x.providerData?[...x.providerData]:[],this.metadata=new vl(x.createdAt||void 0,x.lastLoginAt||void 0)}getIdToken(h){var f=this;return(0,_.Z)(function*(){const v=yield Un(f,f.stsTokenManager.getToken(f.auth,h));return Ae(v,f.auth,"internal-error"),f.accessToken!==v&&(f.accessToken=v,yield f.auth._persistUserIfCurrent(f),f.auth._notifyListenersIfCurrent(f)),v})()}getIdTokenResult(h){return function yl(m){return ko.apply(this,arguments)}(this,h)}reload(){return function ro(m){return jn.apply(this,arguments)}(this)}_assign(h){this!==h&&(Ae(this.uid===h.uid,this.auth,"internal-error"),this.displayName=h.displayName,this.photoURL=h.photoURL,this.email=h.email,this.emailVerified=h.emailVerified,this.phoneNumber=h.phoneNumber,this.isAnonymous=h.isAnonymous,this.tenantId=h.tenantId,this.providerData=h.providerData.map(f=>Object.assign({},f)),this.metadata._copy(h.metadata),this.stsTokenManager._assign(h.stsTokenManager))}_clone(h){return new _r(Object.assign(Object.assign({},this),{auth:h,stsTokenManager:this.stsTokenManager._clone()}))}_onReload(h){Ae(!this.reloadListener,this.auth,"internal-error"),this.reloadListener=h,this.reloadUserInfo&&(this._notifyReloadListener(this.reloadUserInfo),this.reloadUserInfo=null)}_notifyReloadListener(h){this.reloadListener?this.reloadListener(h):this.reloadUserInfo=h}_startProactiveRefresh(){this.proactiveRefresh._start()}_stopProactiveRefresh(){this.proactiveRefresh._stop()}_updateTokensIfNecessary(h,f=!1){var v=this;return(0,_.Z)(function*(){let b=!1;h.idToken&&h.idToken!==v.stsTokenManager.accessToken&&(v.stsTokenManager.updateFromServerResponse(h),b=!0),f&&(yield Ei(v)),yield v.auth._persistUserIfCurrent(v),b&&v.auth._notifyListenersIfCurrent(v)})()}delete(){var h=this;return(0,_.Z)(function*(){const f=yield h.getIdToken();return yield Un(h,function gt(m,h){return on.apply(this,arguments)}(h.auth,{idToken:f})),h.stsTokenManager.clearRefreshToken(),h.auth.signOut()})()}toJSON(){return Object.assign(Object.assign({uid:this.uid,email:this.email||void 0,emailVerified:this.emailVerified,displayName:this.displayName||void 0,isAnonymous:this.isAnonymous,photoURL:this.photoURL||void 0,phoneNumber:this.phoneNumber||void 0,tenantId:this.tenantId||void 0,providerData:this.providerData.map(h=>Object.assign({},h)),stsTokenManager:this.stsTokenManager.toJSON(),_redirectEventId:this._redirectEventId},this.metadata.toJSON()),{apiKey:this.auth.config.apiKey,appName:this.auth.name})}get refreshToken(){return this.stsTokenManager.refreshToken||""}static _fromJSON(h,f){var v,b,x,U,te,Pe,Se,ze;const Ye=null!==(v=f.displayName)&&void 0!==v?v:void 0,St=null!==(b=f.email)&&void 0!==b?b:void 0,ir=null!==(x=f.phoneNumber)&&void 0!==x?x:void 0,es=null!==(U=f.photoURL)&&void 0!==U?U:void 0,oc=null!==(te=f.tenantId)&&void 0!==te?te:void 0,ac=null!==(Pe=f._redirectEventId)&&void 0!==Pe?Pe:void 0,Ef=null!==(Se=f.createdAt)&&void 0!==Se?Se:void 0,uc=null!==(ze=f.lastLoginAt)&&void 0!==ze?ze:void 0,{uid:Bu,emailVerified:Nd,isAnonymous:nu,providerData:Uu,stsTokenManager:Rd}=f;Ae(Bu&&Rd,h,"internal-error");const wf=jt.fromJSON(this.name,Rd);Ae("string"==typeof Bu,h,"internal-error"),Tn(Ye,h.name),Tn(St,h.name),Ae("boolean"==typeof Nd,h,"internal-error"),Ae("boolean"==typeof nu,h,"internal-error"),Tn(ir,h.name),Tn(es,h.name),Tn(oc,h.name),Tn(ac,h.name),Tn(Ef,h.name),Tn(uc,h.name);const ju=new _r({uid:Bu,auth:h,email:St,emailVerified:Nd,displayName:Ye,isAnonymous:nu,photoURL:es,phoneNumber:ir,tenantId:oc,stsTokenManager:wf,createdAt:Ef,lastLoginAt:uc});return Uu&&Array.isArray(Uu)&&(ju.providerData=Uu.map(lc=>Object.assign({},lc))),ac&&(ju._redirectEventId=ac),ju}static _fromIdTokenResponse(h,f,v=!1){return(0,_.Z)(function*(){const b=new jt;b.updateFromServerResponse(f);const x=new _r({uid:f.localId,auth:h,stsTokenManager:b,isAnonymous:v});return yield Ei(x),x})()}}const br=(()=>{class m{constructor(){this.type="NONE",this.storage={}}_isAvailable(){return(0,_.Z)(function*(){return!0})()}_set(f,v){var b=this;return(0,_.Z)(function*(){b.storage[f]=v})()}_get(f){var v=this;return(0,_.Z)(function*(){const b=v.storage[f];return void 0===b?null:b})()}_remove(f){var v=this;return(0,_.Z)(function*(){delete v.storage[f]})()}_addListener(f,v){}_removeListener(f,v){}}return m.type="NONE",m})();function Lt(m,h,f){return`firebase:${m}:${h}:${f}`}class wi{constructor(h,f,v){this.persistence=h,this.auth=f,this.userKey=v;const{config:b,name:x}=this.auth;this.fullUserKey=Lt(this.userKey,b.apiKey,x),this.fullPersistenceKey=Lt("persistence",b.apiKey,x),this.boundEventHandler=f._onStorageEvent.bind(f),this.persistence._addListener(this.fullUserKey,this.boundEventHandler)}setCurrentUser(h){return this.persistence._set(this.fullUserKey,h.toJSON())}getCurrentUser(){var h=this;return(0,_.Z)(function*(){const f=yield h.persistence._get(h.fullUserKey);return f?_r._fromJSON(h.auth,f):null})()}removeCurrentUser(){return this.persistence._remove(this.fullUserKey)}savePersistenceForRedirect(){return this.persistence._set(this.fullPersistenceKey,this.persistence.type)}setPersistence(h){var f=this;return(0,_.Z)(function*(){if(f.persistence===h)return;const v=yield f.getCurrentUser();return yield f.removeCurrentUser(),f.persistence=h,v?f.setCurrentUser(v):void 0})()}delete(){this.persistence._removeListener(this.fullUserKey,this.boundEventHandler)}static create(h,f,v="authUser"){return(0,_.Z)(function*(){if(!f.length)return new wi(Ut(br),h,v);const b=(yield Promise.all(f.map(function(){var Se=(0,_.Z)(function*(ze){if(yield ze._isAvailable())return ze});return function(ze){return Se.apply(this,arguments)}}()))).filter(Se=>Se);let x=b[0]||Ut(br);const U=Lt(v,h.config.apiKey,h.name);let te=null;for(const Se of f)try{const ze=yield Se._get(U);if(ze){const Ye=_r._fromJSON(h,ze);Se!==x&&(te=Ye),x=Se;break}}catch(ze){}const Pe=b.filter(Se=>Se._shouldAllowMigration);return x._shouldAllowMigration&&Pe.length?(x=Pe[0],te&&(yield x._set(U,te.toJSON())),yield Promise.all(f.map(function(){var Se=(0,_.Z)(function*(ze){if(ze!==x)try{yield ze._remove(U)}catch(Ye){}});return function(ze){return Se.apply(this,arguments)}}())),new wi(x,h,v)):new wi(x,h,v)})()}}function An(m){const h=m.toLowerCase();if(h.includes("opera/")||h.includes("opr/")||h.includes("opios/"))return"Opera";if(Ia(h))return"IEMobile";if(h.includes("msie")||h.includes("trident/"))return"IE";if(h.includes("edge/"))return"Edge";if(Et(h))return"Firefox";if(h.includes("silk/"))return"Silk";if(Gn(h))return"Blackberry";if(Lo(h))return"Webos";if(Fo(h))return"Safari";if((h.includes("chrome/")||io(h))&&!h.includes("edge/"))return"Chrome";if(Ui(h))return"Android";{const v=m.match(/([a-zA-Z\d\.]+)\/[a-zA-Z\d\.]*$/);if(2===(null==v?void 0:v.length))return v[1]}return"Other"}function Et(m=(0,k.z$)()){return/firefox\//i.test(m)}function Fo(m=(0,k.z$)()){const h=m.toLowerCase();return h.includes("safari/")&&!h.includes("chrome/")&&!h.includes("crios/")&&!h.includes("android")}function io(m=(0,k.z$)()){return/crios\//i.test(m)}function Ia(m=(0,k.z$)()){return/iemobile/i.test(m)}function Ui(m=(0,k.z$)()){return/android/i.test(m)}function Gn(m=(0,k.z$)()){return/blackberry/i.test(m)}function Lo(m=(0,k.z$)()){return/webos/i.test(m)}function ji(m=(0,k.z$)()){return/iphone|ipad|ipod/i.test(m)}function Vo(m=(0,k.z$)()){return ji(m)||Ui(m)||Lo(m)||Gn(m)||/windows phone/i.test(m)||Ia(m)}function Ci(m,h=[]){let f;switch(m){case"Browser":f=An((0,k.z$)());break;case"Worker":f=`${An((0,k.z$)())}-${m}`;break;default:f=m}const v=h.length?h.join(","):"FirebaseCore-web";return`${f}/JsCore/${le.SDK_VERSION}/${v}`}class Vc{constructor(h,f){this.app=h,this.config=f,this.currentUser=null,this.emulatorConfig=null,this.operations=Promise.resolve(),this.authStateSubscription=new us(this),this.idTokenSubscription=new us(this),this.redirectUser=null,this.isProactiveRefreshEnabled=!1,this._canInitEmulator=!0,this._isInitialized=!1,this._deleted=!1,this._initializationPromise=null,this._popupRedirectResolver=null,this._errorFactory=yi,this.lastNotifiedUid=void 0,this.languageCode=null,this.tenantId=null,this.settings={appVerificationDisabledForTesting:!1},this.frameworks=[],this.name=h.name,this.clientVersion=f.sdkClientVersion}_initializeWithPersistence(h,f){var v=this;return f&&(this._popupRedirectResolver=Ut(f)),this._initializationPromise=this.queue((0,_.Z)(function*(){var b,x;if(!v._deleted&&(v.persistenceManager=yield wi.create(v,h),!v._deleted)){if(null===(b=v._popupRedirectResolver)||void 0===b?void 0:b._shouldInitProactively)try{yield v._popupRedirectResolver._initialize(v)}catch(U){}yield v.initializeCurrentUser(f),v.lastNotifiedUid=(null===(x=v.currentUser)||void 0===x?void 0:x.uid)||null,!v._deleted&&(v._isInitialized=!0)}})),this._initializationPromise}_onStorageEvent(){var h=this;return(0,_.Z)(function*(){if(h._deleted)return;const f=yield h.assertedPersistence.getCurrentUser();if(h.currentUser||f){if(h.currentUser&&f&&h.currentUser.uid===f.uid)return h._currentUser._assign(f),void(yield h.currentUser.getIdToken());yield h._updateCurrentUser(f)}})()}initializeCurrentUser(h){var f=this;return(0,_.Z)(function*(){var v;let b=yield f.assertedPersistence.getCurrentUser();if(h&&f.config.authDomain){yield f.getOrInitRedirectPersistenceManager();const x=null===(v=f.redirectUser)||void 0===v?void 0:v._redirectEventId,U=null==b?void 0:b._redirectEventId,te=yield f.tryRedirectSignIn(h);(!x||x===U)&&(null==te?void 0:te.user)&&(b=te.user)}return b?b._redirectEventId?(Ae(f._popupRedirectResolver,f,"argument-error"),yield f.getOrInitRedirectPersistenceManager(),f.redirectUser&&f.redirectUser._redirectEventId===b._redirectEventId?f.directlySetCurrentUser(b):f.reloadAndSetCurrentUserOrClear(b)):f.reloadAndSetCurrentUserOrClear(b):f.directlySetCurrentUser(null)})()}tryRedirectSignIn(h){var f=this;return(0,_.Z)(function*(){let v=null;try{v=yield f._popupRedirectResolver._completeRedirectFn(f,h,!0)}catch(b){yield f._setRedirectUser(null)}return v})()}reloadAndSetCurrentUserOrClear(h){var f=this;return(0,_.Z)(function*(){try{yield Ei(h)}catch(v){if("auth/network-request-failed"!==v.code)return f.directlySetCurrentUser(null)}return f.directlySetCurrentUser(h)})()}useDeviceLanguage(){this.languageCode=function Ir(){if("undefined"==typeof navigator)return null;const m=navigator;return m.languages&&m.languages[0]||m.language||null}()}_delete(){var h=this;return(0,_.Z)(function*(){h._deleted=!0})()}updateCurrentUser(h){var f=this;return(0,_.Z)(function*(){const v=h?(0,k.m9)(h):null;return v&&Ae(v.auth.config.apiKey===f.config.apiKey,f,"invalid-user-token"),f._updateCurrentUser(v&&v._clone(f))})()}_updateCurrentUser(h){var f=this;return(0,_.Z)(function*(){if(!f._deleted)return h&&Ae(f.tenantId===h.tenantId,f,"tenant-id-mismatch"),f.queue((0,_.Z)(function*(){yield f.directlySetCurrentUser(h),f.notifyAuthListeners()}))})()}signOut(){var h=this;return(0,_.Z)(function*(){return(h.redirectPersistenceManager||h._popupRedirectResolver)&&(yield h._setRedirectUser(null)),h._updateCurrentUser(null)})()}setPersistence(h){var f=this;return this.queue((0,_.Z)(function*(){yield f.assertedPersistence.setPersistence(Ut(h))}))}_getPersistence(){return this.assertedPersistence.persistence.type}_updateErrorMap(h){this._errorFactory=new k.LL("auth","Firebase",h())}onAuthStateChanged(h,f,v){return this.registerStateListener(this.authStateSubscription,h,f,v)}onIdTokenChanged(h,f,v){return this.registerStateListener(this.idTokenSubscription,h,f,v)}toJSON(){var h;return{apiKey:this.config.apiKey,authDomain:this.config.authDomain,appName:this.name,currentUser:null===(h=this._currentUser)||void 0===h?void 0:h.toJSON()}}_setRedirectUser(h,f){var v=this;return(0,_.Z)(function*(){const b=yield v.getOrInitRedirectPersistenceManager(f);return null===h?b.removeCurrentUser():b.setCurrentUser(h)})()}getOrInitRedirectPersistenceManager(h){var f=this;return(0,_.Z)(function*(){if(!f.redirectPersistenceManager){const v=h&&Ut(h)||f._popupRedirectResolver;Ae(v,f,"argument-error"),f.redirectPersistenceManager=yield wi.create(f,[Ut(v._redirectPersistence)],"redirectUser"),f.redirectUser=yield f.redirectPersistenceManager.getCurrentUser()}return f.redirectPersistenceManager})()}_redirectUserForId(h){var f=this;return(0,_.Z)(function*(){var v,b;return f._isInitialized&&(yield f.queue((0,_.Z)(function*(){}))),(null===(v=f._currentUser)||void 0===v?void 0:v._redirectEventId)===h?f._currentUser:(null===(b=f.redirectUser)||void 0===b?void 0:b._redirectEventId)===h?f.redirectUser:null})()}_persistUserIfCurrent(h){var f=this;return(0,_.Z)(function*(){if(h===f.currentUser)return f.queue((0,_.Z)(function*(){return f.directlySetCurrentUser(h)}))})()}_notifyListenersIfCurrent(h){h===this.currentUser&&this.notifyAuthListeners()}_key(){return`${this.config.authDomain}:${this.config.apiKey}:${this.name}`}_startProactiveRefresh(){this.isProactiveRefreshEnabled=!0,this.currentUser&&this._currentUser._startProactiveRefresh()}_stopProactiveRefresh(){this.isProactiveRefreshEnabled=!1,this.currentUser&&this._currentUser._stopProactiveRefresh()}get _currentUser(){return this.currentUser}notifyAuthListeners(){var h,f;if(!this._isInitialized)return;this.idTokenSubscription.next(this.currentUser);const v=null!==(f=null===(h=this.currentUser)||void 0===h?void 0:h.uid)&&void 0!==f?f:null;this.lastNotifiedUid!==v&&(this.lastNotifiedUid=v,this.authStateSubscription.next(this.currentUser))}registerStateListener(h,f,v,b){if(this._deleted)return()=>{};const x="function"==typeof f?f:f.next.bind(f),U=this._isInitialized?Promise.resolve():this._initializationPromise;return Ae(U,this,"internal-error"),U.then(()=>x(this.currentUser)),"function"==typeof f?h.addObserver(f,v,b):h.addObserver(f)}directlySetCurrentUser(h){var f=this;return(0,_.Z)(function*(){f.currentUser&&f.currentUser!==h&&(f._currentUser._stopProactiveRefresh(),h&&f.isProactiveRefreshEnabled&&h._startProactiveRefresh()),f.currentUser=h,h?yield f.assertedPersistence.setCurrentUser(h):yield f.assertedPersistence.removeCurrentUser()})()}queue(h){return this.operations=this.operations.then(h,h),this.operations}get assertedPersistence(){return Ae(this.persistenceManager,this,"internal-error"),this.persistenceManager}_logFramework(h){!h||this.frameworks.includes(h)||(this.frameworks.push(h),this.frameworks.sort(),this.clientVersion=Ci(this.config.clientPlatform,this._getFrameworks()))}_getFrameworks(){return this.frameworks}_getAdditionalHeaders(){var h=this;return(0,_.Z)(function*(){const f={"X-Client-Version":h.clientVersion};return h.app.options.appId&&(f["X-Firebase-gmpid"]=h.app.options.appId),f})()}}function xn(m){return(0,k.m9)(m)}class us{constructor(h){this.auth=h,this.observer=null,this.addObserver=(0,k.ne)(f=>this.observer=f)}get next(){return Ae(this.observer,this.auth,"internal-error"),this.observer.next.bind(this.observer)}}function Bc(m){const h=m.indexOf(":");return h<0?"":m.substr(0,h+1)}function Ph(m){if(!m)return null;const h=Number(m);return isNaN(h)?null:h}class Ca{constructor(h,f){this.providerId=h,this.signInMethod=f}toJSON(){return ur("not implemented")}_getIdTokenResponse(h){return ur("not implemented")}_linkToIdToken(h,f){return ur("not implemented")}_getReauthenticationResolver(h){return ur("not implemented")}}function Oh(m,h){return Uc.apply(this,arguments)}function Uc(){return(Uc=(0,_.Z)(function*(m,h){return mn(m,"POST","/v1/accounts:resetPassword",ct(m,h))})).apply(this,arguments)}function kh(m,h){return jc.apply(this,arguments)}function jc(){return(jc=(0,_.Z)(function*(m,h){return mn(m,"POST","/v1/accounts:update",h)})).apply(this,arguments)}function Jp(m,h){return Da.apply(this,arguments)}function Da(){return(Da=(0,_.Z)(function*(m,h){return mn(m,"POST","/v1/accounts:update",ct(m,h))})).apply(this,arguments)}function Hc(){return(Hc=(0,_.Z)(function*(m,h){return G(m,"POST","/v1/accounts:signInWithPassword",ct(m,h))})).apply(this,arguments)}function El(m,h){return Gc.apply(this,arguments)}function Gc(){return(Gc=(0,_.Z)(function*(m,h){return mn(m,"POST","/v1/accounts:sendOobCode",ct(m,h))})).apply(this,arguments)}function Xp(m,h){return $c.apply(this,arguments)}function $c(){return($c=(0,_.Z)(function*(m,h){return El(m,h)})).apply(this,arguments)}function eg(m,h){return wl.apply(this,arguments)}function wl(){return(wl=(0,_.Z)(function*(m,h){return El(m,h)})).apply(this,arguments)}function ba(m,h){return Wc.apply(this,arguments)}function Wc(){return(Wc=(0,_.Z)(function*(m,h){return El(m,h)})).apply(this,arguments)}function Il(m,h){return qc.apply(this,arguments)}function qc(){return(qc=(0,_.Z)(function*(m,h){return El(m,h)})).apply(this,arguments)}function _u(){return(_u=(0,_.Z)(function*(m,h){return G(m,"POST","/v1/accounts:signInWithEmailLink",ct(m,h))})).apply(this,arguments)}function oo(){return(oo=(0,_.Z)(function*(m,h){return G(m,"POST","/v1/accounts:signInWithEmailLink",ct(m,h))})).apply(this,arguments)}class Aa extends Ca{constructor(h,f,v,b=null){super("password",v),this._email=h,this._password=f,this._tenantId=b}static _fromEmailAndPassword(h,f){return new Aa(h,f,"password")}static _fromEmailAndCode(h,f,v=null){return new Aa(h,f,"emailLink",v)}toJSON(){return{email:this._email,password:this._password,signInMethod:this.signInMethod,tenantId:this._tenantId}}static fromJSON(h){const f="string"==typeof h?JSON.parse(h):h;if((null==f?void 0:f.email)&&(null==f?void 0:f.password)){if("password"===f.signInMethod)return this._fromEmailAndPassword(f.email,f.password);if("emailLink"===f.signInMethod)return this._fromEmailAndCode(f.email,f.password,f.tenantId)}return null}_getIdTokenResponse(h){var f=this;return(0,_.Z)(function*(){switch(f.signInMethod){case"password":return function Bo(m,h){return Hc.apply(this,arguments)}(h,{returnSecureToken:!0,email:f._email,password:f._password});case"emailLink":return function so(m,h){return _u.apply(this,arguments)}(h,{email:f._email,oobCode:f._password});default:kt(h,"internal-error")}})()}_linkToIdToken(h,f){var v=this;return(0,_.Z)(function*(){switch(v.signInMethod){case"password":return kh(h,{idToken:f,returnSecureToken:!0,email:v._email,password:v._password});case"emailLink":return function Ta(m,h){return oo.apply(this,arguments)}(h,{idToken:f,email:v._email,oobCode:v._password});default:kt(h,"internal-error")}})()}_getReauthenticationResolver(h){return this._getIdTokenResponse(h)}}function ks(m,h){return Sa.apply(this,arguments)}function Sa(){return(Sa=(0,_.Z)(function*(m,h){return G(m,"POST","/v1/accounts:signInWithIdp",ct(m,h))})).apply(this,arguments)}class yr extends Ca{constructor(){super(...arguments),this.pendingToken=null}static _fromParams(h){const f=new yr(h.providerId,h.signInMethod);return h.idToken||h.accessToken?(h.idToken&&(f.idToken=h.idToken),h.accessToken&&(f.accessToken=h.accessToken),h.nonce&&!h.pendingToken&&(f.nonce=h.nonce),h.pendingToken&&(f.pendingToken=h.pendingToken)):h.oauthToken&&h.oauthTokenSecret?(f.accessToken=h.oauthToken,f.secret=h.oauthTokenSecret):kt("argument-error"),f}toJSON(){return{idToken:this.idToken,accessToken:this.accessToken,secret:this.secret,nonce:this.nonce,pendingToken:this.pendingToken,providerId:this.providerId,signInMethod:this.signInMethod}}static fromJSON(h){const f="string"==typeof h?JSON.parse(h):h,{providerId:v,signInMethod:b}=f,x=de(f,["providerId","signInMethod"]);if(!v||!b)return null;const U=new yr(v,b);return U.idToken=x.idToken||void 0,U.accessToken=x.accessToken||void 0,U.secret=x.secret,U.nonce=x.nonce,U.pendingToken=x.pendingToken||null,U}_getIdTokenResponse(h){return ks(h,this.buildRequest())}_linkToIdToken(h,f){const v=this.buildRequest();return v.idToken=f,ks(h,v)}_getReauthenticationResolver(h){const f=this.buildRequest();return f.autoCreate=!1,ks(h,f)}buildRequest(){const h={requestUri:"http://localhost",returnSecureToken:!0};if(this.pendingToken)h.pendingToken=this.pendingToken;else{const f={};this.idToken&&(f.id_token=this.idToken),this.accessToken&&(f.access_token=this.accessToken),this.secret&&(f.oauth_token_secret=this.secret),f.providerId=this.providerId,this.nonce&&!this.pendingToken&&(f.nonce=this.nonce),h.postBody=(0,k.xO)(f)}return h}}function bi(m,h){return Cl.apply(this,arguments)}function Cl(){return(Cl=(0,_.Z)(function*(m,h){return mn(m,"POST","/v1/accounts:sendVerificationCode",ct(m,h))})).apply(this,arguments)}function xa(){return(xa=(0,_.Z)(function*(m,h){return G(m,"POST","/v1/accounts:signInWithPhoneNumber",ct(m,h))})).apply(this,arguments)}function yu(){return(yu=(0,_.Z)(function*(m,h){const f=yield G(m,"POST","/v1/accounts:signInWithPhoneNumber",ct(m,h));if(f.temporaryProof)throw je(m,"account-exists-with-different-credential",f);return f})).apply(this,arguments)}const Zc={USER_NOT_FOUND:"user-not-found"};function Fh(){return(Fh=(0,_.Z)(function*(m,h){return G(m,"POST","/v1/accounts:signInWithPhoneNumber",ct(m,Object.assign(Object.assign({},h),{operation:"REAUTH"})),Zc)})).apply(this,arguments)}class Wt extends Ca{constructor(h){super("phone","phone"),this.params=h}static _fromVerification(h,f){return new Wt({verificationId:h,verificationCode:f})}static _fromTokenResponse(h,f){return new Wt({phoneNumber:h,temporaryProof:f})}_getIdTokenResponse(h){return function Gr(m,h){return xa.apply(this,arguments)}(h,this._makeVerificationRequest())}_linkToIdToken(h,f){return function Kc(m,h){return yu.apply(this,arguments)}(h,Object.assign({idToken:f},this._makeVerificationRequest()))}_getReauthenticationResolver(h){return function Yc(m,h){return Fh.apply(this,arguments)}(h,this._makeVerificationRequest())}_makeVerificationRequest(){const{temporaryProof:h,phoneNumber:f,verificationId:v,verificationCode:b}=this.params;return h&&f?{temporaryProof:h,phoneNumber:f}:{sessionInfo:v,code:b}}toJSON(){const h={providerId:this.providerId};return this.params.phoneNumber&&(h.phoneNumber=this.params.phoneNumber),this.params.temporaryProof&&(h.temporaryProof=this.params.temporaryProof),this.params.verificationCode&&(h.verificationCode=this.params.verificationCode),this.params.verificationId&&(h.verificationId=this.params.verificationId),h}static fromJSON(h){"string"==typeof h&&(h=JSON.parse(h));const{verificationId:f,verificationCode:v,phoneNumber:b,temporaryProof:x}=h;return v||f||b||x?new Wt({verificationId:f,verificationCode:v,phoneNumber:b,temporaryProof:x}):null}}class en{constructor(h){var f,v,b,x,U,te;const Pe=(0,k.zd)((0,k.pd)(h)),Se=null!==(f=Pe.apiKey)&&void 0!==f?f:null,ze=null!==(v=Pe.oobCode)&&void 0!==v?v:null,Ye=function Fs(m){switch(m){case"recoverEmail":return"RECOVER_EMAIL";case"resetPassword":return"PASSWORD_RESET";case"signIn":return"EMAIL_SIGNIN";case"verifyEmail":return"VERIFY_EMAIL";case"verifyAndChangeEmail":return"VERIFY_AND_CHANGE_EMAIL";case"revertSecondFactorAddition":return"REVERT_SECOND_FACTOR_ADDITION";default:return null}}(null!==(b=Pe.mode)&&void 0!==b?b:null);Ae(Se&&ze&&Ye,"argument-error"),this.apiKey=Se,this.operation=Ye,this.code=ze,this.continueUrl=null!==(x=Pe.continueUrl)&&void 0!==x?x:null,this.languageCode=null!==(U=Pe.languageCode)&&void 0!==U?U:null,this.tenantId=null!==(te=Pe.tenantId)&&void 0!==te?te:null}static parseLink(h){const f=function Qc(m){const h=(0,k.zd)((0,k.pd)(m)).link,f=h?(0,k.zd)((0,k.pd)(h)).deep_link_id:null,v=(0,k.zd)((0,k.pd)(m)).deep_link_id;return(v?(0,k.zd)((0,k.pd)(v)).link:null)||v||f||h||m}(h);try{return new en(f)}catch(v){return null}}}let Uo=(()=>{class m{constructor(){this.providerId=m.PROVIDER_ID}static credential(f,v){return Aa._fromEmailAndPassword(f,v)}static credentialWithLink(f,v){const b=en.parseLink(v);return Ae(b,"argument-error"),Aa._fromEmailAndCode(f,b.code,b.tenantId)}}return m.PROVIDER_ID="password",m.EMAIL_PASSWORD_SIGN_IN_METHOD="password",m.EMAIL_LINK_SIGN_IN_METHOD="emailLink",m})();class $n{constructor(h){this.providerId=h,this.defaultLanguageCode=null,this.customParameters={}}setDefaultLanguage(h){this.defaultLanguageCode=h}setCustomParameters(h){return this.customParameters=h,this}getCustomParameters(){return this.customParameters}}class Mn extends $n{constructor(){super(...arguments),this.scopes=[]}addScope(h){return this.scopes.includes(h)||this.scopes.push(h),this}getScopes(){return[...this.scopes]}}class ls extends Mn{static credentialFromJSON(h){const f="string"==typeof h?JSON.parse(h):h;return Ae("providerId"in f&&"signInMethod"in f,"argument-error"),yr._fromParams(f)}credential(h){return this._credential(Object.assign(Object.assign({},h),{nonce:h.rawNonce}))}_credential(h){return Ae(h.idToken||h.accessToken,"argument-error"),yr._fromParams(Object.assign(Object.assign({},h),{providerId:this.providerId,signInMethod:this.providerId}))}static credentialFromResult(h){return ls.oauthCredentialFromTaggedObject(h)}static credentialFromError(h){return ls.oauthCredentialFromTaggedObject(h.customData||{})}static oauthCredentialFromTaggedObject({_tokenResponse:h}){if(!h)return null;const{oauthIdToken:f,oauthAccessToken:v,oauthTokenSecret:b,pendingToken:x,nonce:U,providerId:te}=h;if(!v&&!b&&!f&&!x||!te)return null;try{return new ls(te)._credential({idToken:f,accessToken:v,nonce:U,pendingToken:x})}catch(Pe){return null}}}let jo=(()=>{class m extends Mn{constructor(){super("facebook.com")}static credential(f){return yr._fromParams({providerId:m.PROVIDER_ID,signInMethod:m.FACEBOOK_SIGN_IN_METHOD,accessToken:f})}static credentialFromResult(f){return m.credentialFromTaggedObject(f)}static credentialFromError(f){return m.credentialFromTaggedObject(f.customData||{})}static credentialFromTaggedObject({_tokenResponse:f}){if(!f||!("oauthAccessToken"in f)||!f.oauthAccessToken)return null;try{return m.credential(f.oauthAccessToken)}catch(v){return null}}}return m.FACEBOOK_SIGN_IN_METHOD="facebook.com",m.PROVIDER_ID="facebook.com",m})(),Gi=(()=>{class m extends Mn{constructor(){super("google.com"),this.addScope("profile")}static credential(f,v){return yr._fromParams({providerId:m.PROVIDER_ID,signInMethod:m.GOOGLE_SIGN_IN_METHOD,idToken:f,accessToken:v})}static credentialFromResult(f){return m.credentialFromTaggedObject(f)}static credentialFromError(f){return m.credentialFromTaggedObject(f.customData||{})}static credentialFromTaggedObject({_tokenResponse:f}){if(!f)return null;const{oauthIdToken:v,oauthAccessToken:b}=f;if(!v&&!b)return null;try{return m.credential(v,b)}catch(x){return null}}}return m.GOOGLE_SIGN_IN_METHOD="google.com",m.PROVIDER_ID="google.com",m})(),Tr=(()=>{class m extends Mn{constructor(){super("github.com")}static credential(f){return yr._fromParams({providerId:m.PROVIDER_ID,signInMethod:m.GITHUB_SIGN_IN_METHOD,accessToken:f})}static credentialFromResult(f){return m.credentialFromTaggedObject(f)}static credentialFromError(f){return m.credentialFromTaggedObject(f.customData||{})}static credentialFromTaggedObject({_tokenResponse:f}){if(!f||!("oauthAccessToken"in f)||!f.oauthAccessToken)return null;try{return m.credential(f.oauthAccessToken)}catch(v){return null}}}return m.GITHUB_SIGN_IN_METHOD="github.com",m.PROVIDER_ID="github.com",m})();class $i extends Ca{constructor(h,f){super(h,h),this.pendingToken=f}_getIdTokenResponse(h){return ks(h,this.buildRequest())}_linkToIdToken(h,f){const v=this.buildRequest();return v.idToken=f,ks(h,v)}_getReauthenticationResolver(h){const f=this.buildRequest();return f.autoCreate=!1,ks(h,f)}toJSON(){return{signInMethod:this.signInMethod,providerId:this.providerId,pendingToken:this.pendingToken}}static fromJSON(h){const f="string"==typeof h?JSON.parse(h):h,{providerId:v,signInMethod:b,pendingToken:x}=f;return v&&b&&x&&v===b?new $i(v,x):null}static _create(h,f){return new $i(h,f)}buildRequest(){return{requestUri:"http://localhost",returnSecureToken:!0,pendingToken:this.pendingToken}}}class Ar extends $n{constructor(h){Ae(h.startsWith("saml."),"argument-error"),super(h)}static credentialFromResult(h){return Ar.samlCredentialFromTaggedObject(h)}static credentialFromError(h){return Ar.samlCredentialFromTaggedObject(h.customData||{})}static credentialFromJSON(h){const f=$i.fromJSON(h);return Ae(f,"argument-error"),f}static samlCredentialFromTaggedObject({_tokenResponse:h}){if(!h)return null;const{pendingToken:f,providerId:v}=h;if(!f||!v)return null;try{return $i._create(v,f)}catch(b){return null}}}let Ls=(()=>{class m extends Mn{constructor(){super("twitter.com")}static credential(f,v){return yr._fromParams({providerId:m.PROVIDER_ID,signInMethod:m.TWITTER_SIGN_IN_METHOD,oauthToken:f,oauthTokenSecret:v})}static credentialFromResult(f){return m.credentialFromTaggedObject(f)}static credentialFromError(f){return m.credentialFromTaggedObject(f.customData||{})}static credentialFromTaggedObject({_tokenResponse:f}){if(!f)return null;const{oauthAccessToken:v,oauthTokenSecret:b}=f;if(!v||!b)return null;try{return m.credential(v,b)}catch(x){return null}}}return m.TWITTER_SIGN_IN_METHOD="twitter.com",m.PROVIDER_ID="twitter.com",m})();function Ho(m,h){return dt.apply(this,arguments)}function dt(){return(dt=(0,_.Z)(function*(m,h){return G(m,"POST","/v1/accounts:signUp",ct(m,h))})).apply(this,arguments)}class Xn{constructor(h){this.user=h.user,this.providerId=h.providerId,this._tokenResponse=h._tokenResponse,this.operationType=h.operationType}static _fromIdTokenResponse(h,f,v,b=!1){return(0,_.Z)(function*(){const x=yield _r._fromIdTokenResponse(h,v,b),U=Ma(v);return new Xn({user:x,providerId:U,_tokenResponse:v,operationType:f})})()}static _forOperation(h,f,v){return(0,_.Z)(function*(){yield h._updateTokensIfNecessary(v,!0);const b=Ma(v);return new Xn({user:h,providerId:b,_tokenResponse:v,operationType:f})})()}}function Ma(m){return m.providerId?m.providerId:"phoneNumber"in m?"phone":null}function Go(){return(Go=(0,_.Z)(function*(m){var h;const f=xn(m);if(yield f._initializationPromise,null===(h=f.currentUser)||void 0===h?void 0:h.isAnonymous)return new Xn({user:f.currentUser,providerId:null,operationType:"signIn"});const v=yield Ho(f,{returnSecureToken:!0}),b=yield Xn._fromIdTokenResponse(f,"signIn",v,!0);return yield f._updateCurrentUser(b.user),b})).apply(this,arguments)}class $o extends k.ZR{constructor(h,f,v,b){var x;super(f.code,f.message),this.operationType=v,this.user=b,Object.setPrototypeOf(this,$o.prototype),this.customData={appName:h.name,tenantId:null!==(x=h.tenantId)&&void 0!==x?x:void 0,_serverResponse:f.customData._serverResponse,operationType:v}}static _fromErrorAndOperation(h,f,v,b){return new $o(h,f,v,b)}}function bl(m,h,f,v){return("reauthenticate"===h?f._getReauthenticationResolver(m):f._getIdTokenResponse(m)).catch(x=>{throw"auth/multi-factor-auth-required"===x.code?$o._fromErrorAndOperation(m,x,h,v):x})}function vu(m){return new Set(m.map(({providerId:h})=>h).filter(h=>!!h))}function At(){return(At=(0,_.Z)(function*(m,h){const f=(0,k.m9)(m);yield ao(!0,f,h);const{providerUserInfo:v}=yield Bn(f.auth,{idToken:yield f.getIdToken(),deleteProvider:[h]}),b=vu(v||[]);return f.providerData=f.providerData.filter(x=>b.has(x.providerId)),b.has("phone")||(f.phoneNumber=null),yield f.auth._persistUserIfCurrent(f),f})).apply(this,arguments)}function Eu(m,h){return tn.apply(this,arguments)}function tn(){return(tn=(0,_.Z)(function*(m,h,f=!1){const v=yield Un(m,h._linkToIdToken(m.auth,yield m.getIdToken()),f);return Xn._forOperation(m,"link",v)})).apply(this,arguments)}function ao(m,h,f){return Vs.apply(this,arguments)}function Vs(){return(Vs=(0,_.Z)(function*(m,h,f){yield Ei(h);const b=!1===m?"provider-already-linked":"no-such-provider";Ae(vu(h.providerData).has(f)===m,h.auth,b)})).apply(this,arguments)}function $r(m,h){return cs.apply(this,arguments)}function cs(){return(cs=(0,_.Z)(function*(m,h,f=!1){const{auth:v}=m,b="reauthenticate";try{const x=yield Un(m,bl(v,b,h,m),f);Ae(x.idToken,v,"internal-error");const U=to(x.idToken);Ae(U,v,"internal-error");const{sub:te}=U;return Ae(m.uid===te,v,"user-mismatch"),Xn._forOperation(m,b,x)}catch(x){throw"auth/user-not-found"===(null==x?void 0:x.code)&&kt(v,"user-mismatch"),x}})).apply(this,arguments)}function wu(m,h){return Iu.apply(this,arguments)}function Iu(){return(Iu=(0,_.Z)(function*(m,h,f=!1){const v="signIn",b=yield bl(m,v,h),x=yield Xn._fromIdTokenResponse(m,v,b);return f||(yield m._updateCurrentUser(x.user)),x})).apply(this,arguments)}function Cu(m,h){return Wo.apply(this,arguments)}function Wo(){return(Wo=(0,_.Z)(function*(m,h){return wu(xn(m),h)})).apply(this,arguments)}function Ra(m,h){return qn.apply(this,arguments)}function qn(){return(qn=(0,_.Z)(function*(m,h){const f=(0,k.m9)(m);return yield ao(!1,f,h.providerId),Eu(f,h)})).apply(this,arguments)}function Ti(m,h){return Du.apply(this,arguments)}function Du(){return(Du=(0,_.Z)(function*(m,h){return $r((0,k.m9)(m),h)})).apply(this,arguments)}function ds(m,h){return Ai.apply(this,arguments)}function Ai(){return(Ai=(0,_.Z)(function*(m,h){return G(m,"POST","/v1/accounts:signInWithCustomToken",ct(m,h))})).apply(this,arguments)}function qo(){return(qo=(0,_.Z)(function*(m,h){const f=xn(m),v=yield ds(f,{token:h,returnSecureToken:!0}),b=yield Xn._fromIdTokenResponse(f,"signIn",v);return yield f._updateCurrentUser(b.user),b})).apply(this,arguments)}class bu{constructor(h,f){this.factorId=h,this.uid=f.mfaEnrollmentId,this.enrollmentTime=new Date(f.enrolledAt).toUTCString(),this.displayName=f.displayName}static _fromServerResponse(h,f){return"phoneInfo"in f?Pa._fromServerResponse(h,f):kt(h,"internal-error")}}class Pa extends bu{constructor(h){super("phone",h),this.phoneNumber=h.phoneInfo}static _fromServerResponse(h,f){return new Pa(f)}}function zo(m,h,f){var v;Ae((null===(v=f.url)||void 0===v?void 0:v.length)>0,m,"invalid-continue-uri"),Ae(void 0===f.dynamicLinkDomain||f.dynamicLinkDomain.length>0,m,"invalid-dynamic-link-domain"),h.continueUrl=f.url,h.dynamicLinkDomain=f.dynamicLinkDomain,h.canHandleCodeInApp=f.handleCodeInApp,f.iOS&&(Ae(f.iOS.bundleId.length>0,m,"missing-ios-bundle-id"),h.iOSBundleId=f.iOS.bundleId),f.android&&(Ae(f.android.packageName.length>0,m,"missing-android-pkg-name"),h.androidInstallApp=f.android.installApp,h.androidMinimumVersionCode=f.android.minimumVersion,h.androidPackageName=f.android.packageName)}function ka(){return(ka=(0,_.Z)(function*(m,h,f){const v=(0,k.m9)(m),b={requestType:"PASSWORD_RESET",email:h};f&&zo(v,b,f),yield eg(v,b)})).apply(this,arguments)}function Tl(){return(Tl=(0,_.Z)(function*(m,h,f){yield Oh((0,k.m9)(m),{oobCode:h,newPassword:f})})).apply(this,arguments)}function Ko(){return(Ko=(0,_.Z)(function*(m,h){yield Jp((0,k.m9)(m),{oobCode:h})})).apply(this,arguments)}function Xc(m,h){return La.apply(this,arguments)}function La(){return(La=(0,_.Z)(function*(m,h){const f=(0,k.m9)(m),v=yield Oh(f,{oobCode:h}),b=v.requestType;switch(Ae(b,f,"internal-error"),b){case"EMAIL_SIGNIN":break;case"VERIFY_AND_CHANGE_EMAIL":Ae(v.newEmail,f,"internal-error");break;case"REVERT_SECOND_FACTOR_ADDITION":Ae(v.mfaInfo,f,"internal-error");default:Ae(v.email,f,"internal-error")}let x=null;return v.mfaInfo&&(x=bu._fromServerResponse(xn(f),v.mfaInfo)),{data:{email:("VERIFY_AND_CHANGE_EMAIL"===v.requestType?v.newEmail:v.email)||null,previousEmail:("VERIFY_AND_CHANGE_EMAIL"===v.requestType?v.email:v.newEmail)||null,multiFactorInfo:x},operation:b}})).apply(this,arguments)}function Va(){return(Va=(0,_.Z)(function*(m,h){const{data:f}=yield Xc((0,k.m9)(m),h);return f.email})).apply(this,arguments)}function ed(){return(ed=(0,_.Z)(function*(m,h,f){const v=xn(m),b=yield Ho(v,{returnSecureToken:!0,email:h,password:f}),x=yield Xn._fromIdTokenResponse(v,"signIn",b);return yield v._updateCurrentUser(x.user),x})).apply(this,arguments)}function Nn(){return(Nn=(0,_.Z)(function*(m,h,f){const v=(0,k.m9)(m),b={requestType:"EMAIL_SIGNIN",email:h};Ae(f.handleCodeInApp,v,"argument-error"),f&&zo(v,b,f),yield ba(v,b)})).apply(this,arguments)}function Ba(){return(Ba=(0,_.Z)(function*(m,h,f){const v=(0,k.m9)(m),b=Uo.credentialWithLink(h,f||lt());return Ae(b._tenantId===(v.tenantId||null),v,"tenant-id-mismatch"),Cu(v,b)})).apply(this,arguments)}function Vh(m,h){return Bh.apply(this,arguments)}function Bh(){return(Bh=(0,_.Z)(function*(m,h){return mn(m,"POST","/v1/accounts:createAuthUri",ct(m,h))})).apply(this,arguments)}function Uh(){return(Uh=(0,_.Z)(function*(m,h){const v={identifier:h,continueUri:tt()?lt():"http://localhost"},{signinMethods:b}=yield Vh((0,k.m9)(m),v);return b||[]})).apply(this,arguments)}function Bs(){return(Bs=(0,_.Z)(function*(m,h){const f=(0,k.m9)(m),b={requestType:"VERIFY_EMAIL",idToken:yield m.getIdToken()};h&&zo(f.auth,b,h);const{email:x}=yield Xp(f.auth,b);x!==m.email&&(yield m.reload())})).apply(this,arguments)}function Su(){return(Su=(0,_.Z)(function*(m,h,f){const v=(0,k.m9)(m),x={requestType:"VERIFY_AND_CHANGE_EMAIL",idToken:yield m.getIdToken(),newEmail:h};f&&zo(v.auth,x,f);const{email:U}=yield Il(v.auth,x);U!==m.email&&(yield m.reload())})).apply(this,arguments)}function jh(m,h){return nd.apply(this,arguments)}function nd(){return(nd=(0,_.Z)(function*(m,h){return mn(m,"POST","/v1/accounts:update",h)})).apply(this,arguments)}function yn(){return(yn=(0,_.Z)(function*(m,{displayName:h,photoURL:f}){if(void 0===h&&void 0===f)return;const v=(0,k.m9)(m),x={idToken:yield v.getIdToken(),displayName:h,photoUrl:f,returnSecureToken:!0},U=yield Un(v,jh(v.auth,x));v.displayName=U.displayName||null,v.photoURL=U.photoUrl||null;const te=v.providerData.find(({providerId:Pe})=>"password"===Pe);te&&(te.displayName=v.displayName,te.photoURL=v.photoURL),yield v._updateTokensIfNecessary(U)})).apply(this,arguments)}function Ua(m,h,f){return xu.apply(this,arguments)}function xu(){return(xu=(0,_.Z)(function*(m,h,f){const{auth:v}=m,x={idToken:yield m.getIdToken(),returnSecureToken:!0};h&&(x.email=h),f&&(x.password=f);const U=yield Un(m,kh(v,x));yield m._updateTokensIfNecessary(U,!0)})).apply(this,arguments)}class ja{constructor(h,f,v={}){this.isNewUser=h,this.providerId=f,this.profile=v}}class id extends ja{constructor(h,f,v,b){super(h,f,v),this.username=b}}class rg extends ja{constructor(h,f){super(h,"facebook.com",f)}}class Nl extends id{constructor(h,f){super(h,"github.com",f,"string"==typeof(null==f?void 0:f.login)?null==f?void 0:f.login:null)}}class Wi extends ja{constructor(h,f){super(h,"google.com",f)}}class uo extends id{constructor(h,f,v){super(h,"twitter.com",f,v)}}function cr(m){const{user:h,_tokenResponse:f}=m;return h.isAnonymous&&!f?{providerId:null,isNewUser:!1,profile:null}:function rd(m){var h,f;if(!m)return null;const{providerId:v}=m,b=m.rawUserInfo?JSON.parse(m.rawUserInfo):{},x=m.isNewUser||"identitytoolkit#SignupNewUserResponse"===m.kind;if(!v&&(null==m?void 0:m.idToken)){const U=null===(f=null===(h=to(m.idToken))||void 0===h?void 0:h.firebase)||void 0===f?void 0:f.sign_in_provider;if(U)return new ja(x,"anonymous"!==U&&"custom"!==U?U:null)}if(!v)return null;switch(v){case"facebook.com":return new rg(x,b);case"github.com":return new Nl(x,b);case"google.com":return new Wi(x,b);case"twitter.com":return new uo(x,b,m.screenName||null);case"custom":case"anonymous":return new ja(x,null);default:return new ja(x,v,b)}}(f)}class Ht{constructor(h,f){this.type=h,this.credential=f}static _fromIdtoken(h){return new Ht("enroll",h)}static _fromMfaPendingCredential(h){return new Ht("signin",h)}toJSON(){return{multiFactorSession:{["enroll"===this.type?"idToken":"pendingCredential"]:this.credential}}}static fromJSON(h){var f,v;if(null==h?void 0:h.multiFactorSession){if(null===(f=h.multiFactorSession)||void 0===f?void 0:f.pendingCredential)return Ht._fromMfaPendingCredential(h.multiFactorSession.pendingCredential);if(null===(v=h.multiFactorSession)||void 0===v?void 0:v.idToken)return Ht._fromIdtoken(h.multiFactorSession.idToken)}return null}}class $a{constructor(h,f,v){this.session=h,this.hints=f,this.signInResolver=v}static _fromError(h,f){const v=xn(h),b=f.customData._serverResponse,x=(b.mfaInfo||[]).map(te=>bu._fromServerResponse(v,te));Ae(b.mfaPendingCredential,v,"internal-error");const U=Ht._fromMfaPendingCredential(b.mfaPendingCredential);return new $a(U,x,function(){var te=(0,_.Z)(function*(Pe){const Se=yield Pe._process(v,U);delete b.mfaInfo,delete b.mfaPendingCredential;const ze=Object.assign(Object.assign({},b),{idToken:Se.idToken,refreshToken:Se.refreshToken});switch(f.operationType){case"signIn":const Ye=yield Xn._fromIdTokenResponse(v,f.operationType,ze);return yield v._updateCurrentUser(Ye.user),Ye;case"reauthenticate":return Ae(f.user,v,"internal-error"),Xn._forOperation(f.user,f.operationType,ze);default:kt(v,"internal-error")}});return function(Pe){return te.apply(this,arguments)}}())}resolveSignIn(h){var f=this;return(0,_.Z)(function*(){return f.signInResolver(h)})()}}function qh(m,h){return mn(m,"POST","/v2/accounts/mfaEnrollment:start",ct(m,h))}class Zo{constructor(h){this.user=h,this.enrolledFactors=[],h._onReload(f=>{f.mfaInfo&&(this.enrolledFactors=f.mfaInfo.map(v=>bu._fromServerResponse(h.auth,v)))})}static _fromUser(h){return new Zo(h)}getSession(){var h=this;return(0,_.Z)(function*(){return Ht._fromIdtoken(yield h.user.getIdToken())})()}enroll(h,f){var v=this;return(0,_.Z)(function*(){const b=h,x=yield v.getSession(),U=yield Un(v.user,b._process(v.user.auth,x,f));return yield v.user._updateTokensIfNecessary(U),v.user.reload()})()}unenroll(h){var f=this;return(0,_.Z)(function*(){const v="string"==typeof h?h:h.uid,b=yield f.user.getIdToken(),x=yield Un(f.user,function Pl(m,h){return mn(m,"POST","/v2/accounts/mfaEnrollment:withdraw",ct(m,h))}(f.user.auth,{idToken:b,mfaEnrollmentId:v}));f.enrolledFactors=f.enrolledFactors.filter(({uid:U})=>U!==v),yield f.user._updateTokensIfNecessary(x);try{yield f.user.reload()}catch(U){if("auth/user-token-expired"!==U.code)throw U}})()}}const Sr=new WeakMap,Yo="__sak";class Nu{constructor(h,f){this.storageRetriever=h,this.type=f}_isAvailable(){try{return this.storage?(this.storage.setItem(Yo,"1"),this.storage.removeItem(Yo),Promise.resolve(!0)):Promise.resolve(!1)}catch(h){return Promise.resolve(!1)}}_set(h,f){return this.storage.setItem(h,JSON.stringify(f)),Promise.resolve()}_get(h){const f=this.storage.getItem(h);return Promise.resolve(f?JSON.parse(f):null)}_remove(h){return this.storage.removeItem(h),Promise.resolve()}get storage(){return this.storageRetriever()}}const ei=(()=>{class m extends Nu{constructor(){super(()=>window.localStorage,"LOCAL"),this.boundEventHandler=(f,v)=>this.onStorageEvent(f,v),this.listeners={},this.localCache={},this.pollTimer=null,this.safariLocalStorageNotSynced=function qi(){const m=(0,k.z$)();return Fo(m)||ji(m)}()&&function Ii(){try{return!(!window||window===window.top)}catch(m){return!1}}(),this.fallbackToPolling=Vo(),this._shouldAllowMigration=!0}forAllChangedKeys(f){for(const v of Object.keys(this.listeners)){const b=this.storage.getItem(v),x=this.localCache[v];b!==x&&f(v,x,b)}}onStorageEvent(f,v=!1){if(!f.key)return void this.forAllChangedKeys((te,Pe,Se)=>{this.notifyListeners(te,Se)});const b=f.key;if(v?this.detachListener():this.stopPolling(),this.safariLocalStorageNotSynced){const te=this.storage.getItem(b);if(f.newValue!==te)null!==f.newValue?this.storage.setItem(b,f.newValue):this.storage.removeItem(b);else if(this.localCache[b]===f.newValue&&!v)return}const x=()=>{const te=this.storage.getItem(b);!v&&this.localCache[b]===te||this.notifyListeners(b,te)},U=this.storage.getItem(b);!function Lc(){return(0,k.w1)()&&10===document.documentMode}()||U===f.newValue||f.newValue===f.oldValue?x():setTimeout(x,10)}notifyListeners(f,v){this.localCache[f]=v;const b=this.listeners[f];if(b)for(const x of Array.from(b))x(v&&JSON.parse(v))}startPolling(){this.stopPolling(),this.pollTimer=setInterval(()=>{this.forAllChangedKeys((f,v,b)=>{this.onStorageEvent(new StorageEvent("storage",{key:f,oldValue:v,newValue:b}),!0)})},1e3)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}attachListener(){window.addEventListener("storage",this.boundEventHandler)}detachListener(){window.removeEventListener("storage",this.boundEventHandler)}_addListener(f,v){0===Object.keys(this.listeners).length&&(this.fallbackToPolling?this.startPolling():this.attachListener()),this.listeners[f]||(this.listeners[f]=new Set,this.localCache[f]=this.storage.getItem(f)),this.listeners[f].add(v)}_removeListener(f,v){this.listeners[f]&&(this.listeners[f].delete(v),0===this.listeners[f].size&&delete this.listeners[f]),0===Object.keys(this.listeners).length&&(this.detachListener(),this.stopPolling())}_set(f,v){var b=()=>super._set,x=this;return(0,_.Z)(function*(){yield b().call(x,f,v),x.localCache[f]=JSON.stringify(v)})()}_get(f){var v=()=>super._get,b=this;return(0,_.Z)(function*(){const x=yield v().call(b,f);return b.localCache[f]=JSON.stringify(x),x})()}_remove(f){var v=()=>super._remove,b=this;return(0,_.Z)(function*(){yield v().call(b,f),delete b.localCache[f]})()}}return m.type="LOCAL",m})(),Vt=(()=>{class m extends Nu{constructor(){super(()=>window.sessionStorage,"SESSION")}_addListener(f,v){}_removeListener(f,v){}}return m.type="SESSION",m})();let zh=(()=>{class m{constructor(f){this.eventTarget=f,this.handlersMap={},this.boundEventHandler=this.handleEvent.bind(this)}static _getInstance(f){const v=this.receivers.find(x=>x.isListeningto(f));if(v)return v;const b=new m(f);return this.receivers.push(b),b}isListeningto(f){return this.eventTarget===f}handleEvent(f){var v=this;return(0,_.Z)(function*(){const b=f,{eventId:x,eventType:U,data:te}=b.data,Pe=v.handlersMap[U];if(!(null==Pe?void 0:Pe.size))return;b.ports[0].postMessage({status:"ack",eventId:x,eventType:U});const Se=Array.from(Pe).map(function(){var Ye=(0,_.Z)(function*(St){return St(b.origin,te)});return function(St){return Ye.apply(this,arguments)}}()),ze=yield function zi(m){return Promise.all(m.map(function(){var h=(0,_.Z)(function*(f){try{return{fulfilled:!0,value:yield f}}catch(v){return{fulfilled:!1,reason:v}}});return function(f){return h.apply(this,arguments)}}()))}(Se);b.ports[0].postMessage({status:"done",eventId:x,eventType:U,response:ze})})()}_subscribe(f,v){0===Object.keys(this.handlersMap).length&&this.eventTarget.addEventListener("message",this.boundEventHandler),this.handlersMap[f]||(this.handlersMap[f]=new Set),this.handlersMap[f].add(v)}_unsubscribe(f,v){this.handlersMap[f]&&v&&this.handlersMap[f].delete(v),(!v||0===this.handlersMap[f].size)&&delete this.handlersMap[f],0===Object.keys(this.handlersMap).length&&this.eventTarget.removeEventListener("message",this.boundEventHandler)}}return m.receivers=[],m})();function za(m="",h=10){let f="";for(let v=0;v<h;v++)f+=Math.floor(10*Math.random());return m+f}class lo{constructor(h){this.target=h,this.handlers=new Set}removeMessageHandler(h){h.messageChannel&&(h.messageChannel.port1.removeEventListener("message",h.onMessage),h.messageChannel.port1.close()),this.handlers.delete(h)}_send(h,f,v=50){var b=this;return(0,_.Z)(function*(){const x="undefined"!=typeof MessageChannel?new MessageChannel:null;if(!x)throw new Error("connection_unavailable");let U,te;return new Promise((Pe,Se)=>{const ze=za("",20);x.port1.start();const Ye=setTimeout(()=>{Se(new Error("unsupported_event"))},v);te={messageChannel:x,onMessage(St){const ir=St;if(ir.data.eventId===ze)switch(ir.data.status){case"ack":clearTimeout(Ye),U=setTimeout(()=>{Se(new Error("timeout"))},3e3);break;case"done":clearTimeout(U),Pe(ir.data.response);break;default:clearTimeout(Ye),clearTimeout(U),Se(new Error("invalid_response"))}}},b.handlers.add(te),x.port1.addEventListener("message",te.onMessage),b.target.postMessage({eventType:h,eventId:ze,data:f},[x.port2])}).finally(()=>{te&&b.removeMessageHandler(te)})})()}}function En(){return window}function Xo(){return void 0!==En().WorkerGlobalScope&&"function"==typeof En().importScripts}function gs(){return(gs=(0,_.Z)(function*(){if(!(null==navigator?void 0:navigator.serviceWorker))return null;try{return(yield navigator.serviceWorker.ready).active}catch(m){return null}})).apply(this,arguments)}const Ki="firebaseLocalStorageDb",ea="firebaseLocalStorage",sd="fbase_key";class Yt{constructor(h){this.request=h}toPromise(){return new Promise((h,f)=>{this.request.addEventListener("success",()=>{h(this.request.result)}),this.request.addEventListener("error",()=>{f(this.request.error)})})}}function Ll(m,h){return m.transaction([ea],h?"readwrite":"readonly").objectStore(ea)}function od(){const m=indexedDB.open(Ki,1);return new Promise((h,f)=>{m.addEventListener("error",()=>{f(m.error)}),m.addEventListener("upgradeneeded",()=>{const v=m.result;try{v.createObjectStore(ea,{keyPath:sd})}catch(b){f(b)}}),m.addEventListener("success",(0,_.Z)(function*(){const v=m.result;v.objectStoreNames.contains(ea)?h(v):(v.close(),yield function Vl(){const m=indexedDB.deleteDatabase(Ki);return new Yt(m).toPromise()}(),h(yield od()))}))})}function ad(m,h,f){return ud.apply(this,arguments)}function ud(){return(ud=(0,_.Z)(function*(m,h,f){const v=Ll(m,!0).put({[sd]:h,value:f});return new Yt(v).toPromise()})).apply(this,arguments)}function Bl(){return(Bl=(0,_.Z)(function*(m,h){const f=Ll(m,!1).get(h),v=yield new Yt(f).toPromise();return void 0===v?null:v.value})).apply(this,arguments)}function Us(m,h){const f=Ll(m,!0).delete(h);return new Yt(f).toPromise()}const Si=(()=>{class m{constructor(){this.type="LOCAL",this._shouldAllowMigration=!0,this.listeners={},this.localCache={},this.pollTimer=null,this.pendingWrites=0,this.receiver=null,this.sender=null,this.serviceWorkerReceiverAvailable=!1,this.activeServiceWorker=null,this._workerInitializationPromise=this.initializeServiceWorkerMessaging().then(()=>{},()=>{})}_openDb(){var f=this;return(0,_.Z)(function*(){return f.db||(f.db=yield od()),f.db})()}_withRetries(f){var v=this;return(0,_.Z)(function*(){let b=0;for(;;)try{const x=yield v._openDb();return yield f(x)}catch(x){if(b++>3)throw x;v.db&&(v.db.close(),v.db=void 0)}})()}initializeServiceWorkerMessaging(){var f=this;return(0,_.Z)(function*(){return Xo()?f.initializeReceiver():f.initializeSender()})()}initializeReceiver(){var f=this;return(0,_.Z)(function*(){f.receiver=zh._getInstance(function Fl(){return Xo()?self:null}()),f.receiver._subscribe("keyChanged",function(){var v=(0,_.Z)(function*(b,x){return{keyProcessed:(yield f._poll()).includes(x.key)}});return function(b,x){return v.apply(this,arguments)}}()),f.receiver._subscribe("ping",function(){var v=(0,_.Z)(function*(b,x){return["keyChanged"]});return function(b,x){return v.apply(this,arguments)}}())})()}initializeSender(){var f=this;return(0,_.Z)(function*(){var v,b;if(f.activeServiceWorker=yield function ps(){return gs.apply(this,arguments)}(),!f.activeServiceWorker)return;f.sender=new lo(f.activeServiceWorker);const x=yield f.sender._send("ping",{},800);!x||(null===(v=x[0])||void 0===v?void 0:v.fulfilled)&&(null===(b=x[0])||void 0===b?void 0:b.value.includes("keyChanged"))&&(f.serviceWorkerReceiverAvailable=!0)})()}notifyServiceWorker(f){var v=this;return(0,_.Z)(function*(){if(v.sender&&v.activeServiceWorker&&function ms(){var m;return(null===(m=null==navigator?void 0:navigator.serviceWorker)||void 0===m?void 0:m.controller)||null}()===v.activeServiceWorker)try{yield v.sender._send("keyChanged",{key:f},v.serviceWorkerReceiverAvailable?800:50)}catch(b){}})()}_isAvailable(){return(0,_.Z)(function*(){try{if(!indexedDB)return!1;const f=yield od();return yield ad(f,Yo,"1"),yield Us(f,Yo),!0}catch(f){}return!1})()}_withPendingWrite(f){var v=this;return(0,_.Z)(function*(){v.pendingWrites++;try{yield f()}finally{v.pendingWrites--}})()}_set(f,v){var b=this;return(0,_.Z)(function*(){return b._withPendingWrite((0,_.Z)(function*(){return yield b._withRetries(x=>ad(x,f,v)),b.localCache[f]=v,b.notifyServiceWorker(f)}))})()}_get(f){var v=this;return(0,_.Z)(function*(){const b=yield v._withRetries(x=>function Kh(m,h){return Bl.apply(this,arguments)}(x,f));return v.localCache[f]=b,b})()}_remove(f){var v=this;return(0,_.Z)(function*(){return v._withPendingWrite((0,_.Z)(function*(){return yield v._withRetries(b=>Us(b,f)),delete v.localCache[f],v.notifyServiceWorker(f)}))})()}_poll(){var f=this;return(0,_.Z)(function*(){const v=yield f._withRetries(U=>{const te=Ll(U,!1).getAll();return new Yt(te).toPromise()});if(!v)return[];if(0!==f.pendingWrites)return[];const b=[],x=new Set;for(const{fbase_key:U,value:te}of v)x.add(U),JSON.stringify(f.localCache[U])!==JSON.stringify(te)&&(f.notifyListeners(U,te),b.push(U));for(const U of Object.keys(f.localCache))f.localCache[U]&&!x.has(U)&&(f.notifyListeners(U,null),b.push(U));return b})()}notifyListeners(f,v){this.localCache[f]=v;const b=this.listeners[f];if(b)for(const x of Array.from(b))x(v)}startPolling(){var f=this;this.stopPolling(),this.pollTimer=setInterval((0,_.Z)(function*(){return f._poll()}),800)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}_addListener(f,v){0===Object.keys(this.listeners).length&&this.startPolling(),this.listeners[f]||(this.listeners[f]=new Set,this._get(f)),this.listeners[f].add(v)}_removeListener(f,v){this.listeners[f]&&(this.listeners[f].delete(v),0===this.listeners[f].size&&delete this.listeners[f]),0===Object.keys(this.listeners).length&&this.stopPolling()}}return m.type="LOCAL",m})();function Zh(m,h){return mn(m,"POST","/v2/accounts/mfaSignIn:start",ct(m,h))}function an(){return(an=(0,_.Z)(function*(m){return(yield mn(m,"GET","/v1/recaptchaParams")).recaptchaSiteKey||""})).apply(this,arguments)}function Ru(m){return new Promise((h,f)=>{const v=document.createElement("script");v.setAttribute("src",m),v.onload=h,v.onerror=b=>{const x=gn("internal-error");x.customData=b,f(x)},v.type="text/javascript",v.charset="UTF-8",function Ul(){var m,h;return null!==(h=null===(m=document.getElementsByTagName("head"))||void 0===m?void 0:m[0])&&void 0!==h?h:document}().appendChild(v)})}function Za(m){return`__${m}${Math.floor(1e6*Math.random())}`}const ta=1e12;class Hl{constructor(h){this.auth=h,this.counter=ta,this._widgets=new Map}render(h,f){const v=this.counter;return this._widgets.set(v,new ig(h,this.auth.name,f||{})),this.counter++,v}reset(h){var f;const v=h||ta;null===(f=this._widgets.get(v))||void 0===f||f.delete(),this._widgets.delete(v)}getResponse(h){var f;return(null===(f=this._widgets.get(h||ta))||void 0===f?void 0:f.getResponse())||""}execute(h){var f=this;return(0,_.Z)(function*(){var v;return null===(v=f._widgets.get(h||ta))||void 0===v||v.execute(),""})()}}class ig{constructor(h,f,v){this.params=v,this.timerId=null,this.deleted=!1,this.responseToken=null,this.clickHandler=()=>{this.execute()};const b="string"==typeof h?document.getElementById(h):h;Ae(b,"argument-error",{appName:f}),this.container=b,this.isVisible="invisible"!==this.params.size,this.isVisible?this.execute():this.container.addEventListener("click",this.clickHandler)}getResponse(){return this.checkIfDeleted(),this.responseToken}delete(){this.checkIfDeleted(),this.deleted=!0,this.timerId&&(clearTimeout(this.timerId),this.timerId=null),this.container.removeEventListener("click",this.clickHandler)}execute(){this.checkIfDeleted(),!this.timerId&&(this.timerId=window.setTimeout(()=>{this.responseToken=function Pu(m){const h=[],f="1234567890abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ";for(let v=0;v<m;v++)h.push(f.charAt(Math.floor(Math.random()*f.length)));return h.join("")}(50);const{callback:h,"expired-callback":f}=this.params;if(h)try{h(this.responseToken)}catch(v){}this.timerId=window.setTimeout(()=>{if(this.timerId=null,this.responseToken=null,f)try{f()}catch(v){}this.isVisible&&this.execute()},6e4)},500))}checkIfDeleted(){if(this.deleted)throw new Error("reCAPTCHA mock was already deleted!")}}const tr=Za("rcb"),Ou=new bt(3e4,6e4);class Qh{constructor(){this.hostLanguage="",this.counter=0,this.librarySeparatelyLoaded=!!En().grecaptcha}load(h,f=""){return Ae(function Gl(m){return m.length<=6&&/^\s*[a-zA-Z0-9\-]*\s*$/.test(m)}(f),h,"argument-error"),this.shouldResolveImmediately(f)?Promise.resolve(En().grecaptcha):new Promise((v,b)=>{const x=En().setTimeout(()=>{b(gn(h,"network-request-failed"))},Ou.get());En()[tr]=()=>{En().clearTimeout(x),delete En()[tr];const te=En().grecaptcha;if(!te)return void b(gn(h,"internal-error"));const Pe=te.render;te.render=(Se,ze)=>{const Ye=Pe(Se,ze);return this.counter++,Ye},this.hostLanguage=f,v(te)},Ru(`https://www.google.com/recaptcha/api.js??${(0,k.xO)({onload:tr,render:"explicit",hl:f})}`).catch(()=>{clearTimeout(x),b(gn(h,"internal-error"))})})}clearedOneInstance(){this.counter--}shouldResolveImmediately(h){return!!En().grecaptcha&&(h===this.hostLanguage||this.counter>0||this.librarySeparatelyLoaded)}}class dd{load(h){return(0,_.Z)(function*(){return new Hl(h)})()}clearedOneInstance(){}}const $l="recaptcha",sg={theme:"light",type:"image"};class Jh{constructor(h,f=Object.assign({},sg),v){this.parameters=f,this.type=$l,this.destroyed=!1,this.widgetId=null,this.tokenChangeListeners=new Set,this.renderPromise=null,this.recaptcha=null,this.auth=xn(v),this.isInvisible="invisible"===this.parameters.size,Ae("undefined"!=typeof document,this.auth,"operation-not-supported-in-this-environment");const b="string"==typeof h?document.getElementById(h):h;Ae(b,this.auth,"argument-error"),this.container=b,this.parameters.callback=this.makeTokenCallback(this.parameters.callback),this._recaptchaLoader=this.auth.settings.appVerificationDisabledForTesting?new dd:new Qh,this.validateStartingState()}verify(){var h=this;return(0,_.Z)(function*(){h.assertNotDestroyed();const f=yield h.render(),v=h.getAssertedRecaptcha();return v.getResponse(f)||new Promise(x=>{const U=te=>{!te||(h.tokenChangeListeners.delete(U),x(te))};h.tokenChangeListeners.add(U),h.isInvisible&&v.execute(f)})})()}render(){try{this.assertNotDestroyed()}catch(h){return Promise.reject(h)}return this.renderPromise||(this.renderPromise=this.makeRenderPromise().catch(h=>{throw this.renderPromise=null,h})),this.renderPromise}_reset(){this.assertNotDestroyed(),null!==this.widgetId&&this.getAssertedRecaptcha().reset(this.widgetId)}clear(){this.assertNotDestroyed(),this.destroyed=!0,this._recaptchaLoader.clearedOneInstance(),this.isInvisible||this.container.childNodes.forEach(h=>{this.container.removeChild(h)})}validateStartingState(){Ae(!this.parameters.sitekey,this.auth,"argument-error"),Ae(this.isInvisible||!this.container.hasChildNodes(),this.auth,"argument-error"),Ae("undefined"!=typeof document,this.auth,"operation-not-supported-in-this-environment")}makeTokenCallback(h){return f=>{if(this.tokenChangeListeners.forEach(v=>v(f)),"function"==typeof h)h(f);else if("string"==typeof h){const v=En()[h];"function"==typeof v&&v(f)}}}assertNotDestroyed(){Ae(!this.destroyed,this.auth,"internal-error")}makeRenderPromise(){var h=this;return(0,_.Z)(function*(){if(yield h.init(),!h.widgetId){let f=h.container;if(!h.isInvisible){const v=document.createElement("div");f.appendChild(v),f=v}h.widgetId=h.getAssertedRecaptcha().render(f,h.parameters)}return h.widgetId})()}init(){var h=this;return(0,_.Z)(function*(){Ae(tt()&&!Xo(),h.auth,"internal-error"),yield function og(){let m=null;return new Promise(h=>{"complete"!==document.readyState?(m=()=>h(),window.addEventListener("load",m)):h()}).catch(h=>{throw m&&window.removeEventListener("load",m),h})}(),h.recaptcha=yield h._recaptchaLoader.load(h.auth,h.auth.languageCode||void 0);const f=yield function Rn(m){return an.apply(this,arguments)}(h.auth);Ae(f,h.auth,"internal-error"),h.parameters.sitekey=f})()}getAssertedRecaptcha(){return Ae(this.recaptcha,this.auth,"internal-error"),this.recaptcha}}class ku{constructor(h,f){this.verificationId=h,this.onConfirmation=f}confirm(h){const f=Wt._fromVerification(this.verificationId,h);return this.onConfirmation(f)}}function xr(){return(xr=(0,_.Z)(function*(m,h,f){const v=xn(m),b=yield ra(v,h,(0,k.m9)(f));return new ku(b,x=>Cu(v,x))})).apply(this,arguments)}function Zi(){return(Zi=(0,_.Z)(function*(m,h,f){const v=(0,k.m9)(m);yield ao(!1,v,"phone");const b=yield ra(v.auth,h,(0,k.m9)(f));return new ku(b,x=>Ra(v,x))})).apply(this,arguments)}function ti(){return(ti=(0,_.Z)(function*(m,h,f){const v=(0,k.m9)(m),b=yield ra(v.auth,h,(0,k.m9)(f));return new ku(b,x=>Ti(v,x))})).apply(this,arguments)}function ra(m,h,f){return ni.apply(this,arguments)}function ni(){return(ni=(0,_.Z)(function*(m,h,f){var v;const b=yield f.verify();try{let x;if(Ae("string"==typeof b,m,"argument-error"),Ae(f.type===$l,m,"argument-error"),x="string"==typeof h?{phoneNumber:h}:h,"session"in x){const U=x.session;if("phoneNumber"in x)return Ae("enroll"===U.type,m,"internal-error"),(yield qh(m,{idToken:U.credential,phoneEnrollmentInfo:{phoneNumber:x.phoneNumber,recaptchaToken:b}})).phoneSessionInfo.sessionInfo;{Ae("signin"===U.type,m,"internal-error");const te=(null===(v=x.multiFactorHint)||void 0===v?void 0:v.uid)||x.multiFactorUid;return Ae(te,m,"missing-multi-factor-info"),(yield Zh(m,{mfaPendingCredential:U.credential,mfaEnrollmentId:te,phoneSignInInfo:{recaptchaToken:b}})).phoneResponseInfo.sessionInfo}}{const{sessionInfo:U}=yield bi(m,{phoneNumber:x.phoneNumber,recaptchaToken:b});return U}}finally{f._reset()}})).apply(this,arguments)}function ql(){return(ql=(0,_.Z)(function*(m,h){yield Eu((0,k.m9)(m),h)})).apply(this,arguments)}let fo=(()=>{class m{constructor(f){this.providerId=m.PROVIDER_ID,this.auth=xn(f)}verifyPhoneNumber(f,v){return ra(this.auth,f,(0,k.m9)(v))}static credential(f,v){return Wt._fromVerification(f,v)}static credentialFromResult(f){return m.credentialFromTaggedObject(f)}static credentialFromError(f){return m.credentialFromTaggedObject(f.customData||{})}static credentialFromTaggedObject({_tokenResponse:f}){if(!f)return null;const{phoneNumber:v,temporaryProof:b}=f;return v&&b?Wt._fromTokenResponse(v,b):null}}return m.PROVIDER_ID="phone",m.PHONE_SIGN_IN_METHOD="phone",m})();function xi(m,h){return h?Ut(h):(Ae(m._popupRedirectResolver,m,"argument-error"),m._popupRedirectResolver)}class Qa extends Ca{constructor(h){super("custom","custom"),this.params=h}_getIdTokenResponse(h){return ks(h,this._buildIdpRequest())}_linkToIdToken(h,f){return ks(h,this._buildIdpRequest(f))}_getReauthenticationResolver(h){return ks(h,this._buildIdpRequest())}_buildIdpRequest(h){const f={requestUri:this.params.requestUri,sessionId:this.params.sessionId,postBody:this.params.postBody,tenantId:this.params.tenantId,pendingToken:this.params.pendingToken,returnSecureToken:!0,returnIdpCredential:!0};return h&&(f.idToken=h),f}}function ug(m){return wu(m.auth,new Qa(m),m.bypassAuthState)}function D(m){const{auth:h,user:f}=m;return Ae(f,h,"internal-error"),$r(f,new Qa(m),m.bypassAuthState)}function T(m){return R.apply(this,arguments)}function R(){return(R=(0,_.Z)(function*(m){const{auth:h,user:f}=m;return Ae(f,h,"internal-error"),Eu(f,new Qa(m),m.bypassAuthState)})).apply(this,arguments)}class V{constructor(h,f,v,b,x=!1){this.auth=h,this.resolver=v,this.user=b,this.bypassAuthState=x,this.pendingPromise=null,this.eventManager=null,this.filter=Array.isArray(f)?f:[f]}execute(){var h=this;return new Promise(function(){var f=(0,_.Z)(function*(v,b){h.pendingPromise={resolve:v,reject:b};try{h.eventManager=yield h.resolver._initialize(h.auth),yield h.onExecution(),h.eventManager.registerConsumer(h)}catch(x){h.reject(x)}});return function(v,b){return f.apply(this,arguments)}}())}onAuthEvent(h){var f=this;return(0,_.Z)(function*(){const{urlResponse:v,sessionId:b,postBody:x,tenantId:U,error:te,type:Pe}=h;if(te)return void f.reject(te);const Se={auth:f.auth,requestUri:v,sessionId:b,tenantId:U||void 0,postBody:x||void 0,user:f.user,bypassAuthState:f.bypassAuthState};try{f.resolve(yield f.getIdpTask(Pe)(Se))}catch(ze){f.reject(ze)}})()}onError(h){this.reject(h)}getIdpTask(h){switch(h){case"signInViaPopup":case"signInViaRedirect":return ug;case"linkViaPopup":case"linkViaRedirect":return T;case"reauthViaPopup":case"reauthViaRedirect":return D;default:kt(this.auth,"internal-error")}}resolve(h){et(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.resolve(h),this.unregisterAndCleanUp()}reject(h){et(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.reject(h),this.unregisterAndCleanUp()}unregisterAndCleanUp(){this.eventManager&&this.eventManager.unregisterConsumer(this),this.pendingPromise=null,this.cleanUp()}}const z=new bt(2e3,1e4);function De(){return(De=(0,_.Z)(function*(m,h,f){const v=xn(m);Ur(m,h,$n);const b=xi(v,f);return new ln(v,"signInViaPopup",h,b).executeNotNull()})).apply(this,arguments)}function ke(){return(ke=(0,_.Z)(function*(m,h,f){const v=(0,k.m9)(m);Ur(v.auth,h,$n);const b=xi(v.auth,f);return new ln(v.auth,"reauthViaPopup",h,b,v).executeNotNull()})).apply(this,arguments)}function Ft(){return(Ft=(0,_.Z)(function*(m,h,f){const v=(0,k.m9)(m);Ur(v.auth,h,$n);const b=xi(v.auth,f);return new ln(v.auth,"linkViaPopup",h,b,v).executeNotNull()})).apply(this,arguments)}let ln=(()=>{class m extends V{constructor(f,v,b,x,U){super(f,v,x,U),this.provider=b,this.authWindow=null,this.pollId=null,m.currentPopupAction&&m.currentPopupAction.cancel(),m.currentPopupAction=this}executeNotNull(){var f=this;return(0,_.Z)(function*(){const v=yield f.execute();return Ae(v,f.auth,"internal-error"),v})()}onExecution(){var f=this;return(0,_.Z)(function*(){et(1===f.filter.length,"Popup operations only handle one event");const v=za();f.authWindow=yield f.resolver._openPopup(f.auth,f.provider,f.filter[0],v),f.authWindow.associatedEvent=v,f.resolver._originValidation(f.auth).catch(b=>{f.reject(b)}),f.resolver._isIframeWebStorageSupported(f.auth,b=>{b||f.reject(gn(f.auth,"web-storage-unsupported"))}),f.pollUserCancellation()})()}get eventId(){var f;return(null===(f=this.authWindow)||void 0===f?void 0:f.associatedEvent)||null}cancel(){this.reject(gn(this.auth,"cancelled-popup-request"))}cleanUp(){this.authWindow&&this.authWindow.close(),this.pollId&&window.clearTimeout(this.pollId),this.authWindow=null,this.pollId=null,m.currentPopupAction=null}pollUserCancellation(){const f=()=>{var v,b;this.pollId=(null===(b=null===(v=this.authWindow)||void 0===v?void 0:v.window)||void 0===b?void 0:b.closed)?window.setTimeout(()=>{this.pollId=null,this.reject(gn(this.auth,"popup-closed-by-user"))},2e3):window.setTimeout(f,z.get())};f()}}return m.currentPopupAction=null,m})();const In=new Map;class js extends V{constructor(h,f,v=!1){super(h,["signInViaRedirect","linkViaRedirect","reauthViaRedirect","unknown"],f,void 0,v),this.eventId=null}execute(){var h=()=>super.execute,f=this;return(0,_.Z)(function*(){let v=In.get(f.auth._key());if(!v){try{const x=(yield function po(m,h){return Yi.apply(this,arguments)}(f.resolver,f.auth))?yield h().call(f):null;v=()=>Promise.resolve(x)}catch(b){v=()=>Promise.reject(b)}In.set(f.auth._key(),v)}return f.bypassAuthState||In.set(f.auth._key(),()=>Promise.resolve(null)),v()})()}onAuthEvent(h){var f=()=>super.onAuthEvent,v=this;return(0,_.Z)(function*(){if("signInViaRedirect"===h.type)return f().call(v,h);if("unknown"!==h.type){if(h.eventId){const b=yield v.auth._redirectUserForId(h.eventId);if(b)return v.user=b,f().call(v,h);v.resolve(null)}}else v.resolve(null)})()}onExecution(){return(0,_.Z)(function*(){})()}cleanUp(){}}function Yi(){return(Yi=(0,_.Z)(function*(m,h){const f=lg(h),v=ia(m);if(!(yield v._isAvailable()))return!1;const b="true"===(yield v._get(f));return yield v._remove(f),b})).apply(this,arguments)}function Qi(m,h){return Ji.apply(this,arguments)}function Ji(){return(Ji=(0,_.Z)(function*(m,h){return ia(m)._set(lg(h),"true")})).apply(this,arguments)}function ia(m){return Ut(m._redirectPersistence)}function lg(m){return Lt("pendingRedirect",m.config.apiKey,m.name)}function hd(){return(hd=(0,_.Z)(function*(m,h,f){const v=xn(m);Ur(m,h,$n);const b=xi(v,f);return yield Qi(b,v),b._openRedirect(v,h,"signInViaRedirect")})).apply(this,arguments)}function zl(){return(zl=(0,_.Z)(function*(m,h,f){const v=(0,k.m9)(m);Ur(v.auth,h,$n);const b=xi(v.auth,f);yield Qi(b,v.auth);const x=yield gd(v);return b._openRedirect(v.auth,h,"reauthViaRedirect",x)})).apply(this,arguments)}function go(){return(go=(0,_.Z)(function*(m,h,f){const v=(0,k.m9)(m);Ur(v.auth,h,$n);const b=xi(v.auth,f);yield ao(!1,v,h.providerId),yield Qi(b,v.auth);const x=yield gd(v);return b._openRedirect(v.auth,h,"linkViaRedirect",x)})).apply(this,arguments)}function pd(){return(pd=(0,_.Z)(function*(m,h){return yield xn(m)._initializationPromise,ef(m,h,!1)})).apply(this,arguments)}function ef(m,h){return ry.apply(this,arguments)}function ry(){return(ry=(0,_.Z)(function*(m,h,f=!1){const v=xn(m),b=xi(v,h),U=yield new js(v,b,f).execute();return U&&!f&&(delete U.user._redirectEventId,yield v._persistUserIfCurrent(U.user),yield v._setRedirectUser(null,h)),U})).apply(this,arguments)}function gd(m){return md.apply(this,arguments)}function md(){return(md=(0,_.Z)(function*(m){const h=za(`${m.uid}:::`);return m._redirectEventId=h,yield m.auth._setRedirectUser(m),yield m.auth._persistUserIfCurrent(m),h})).apply(this,arguments)}class _d{constructor(h){this.auth=h,this.cachedEventUids=new Set,this.consumers=new Set,this.queuedRedirectEvent=null,this.hasHandledPotentialRedirect=!1,this.lastProcessedEventTime=Date.now()}registerConsumer(h){this.consumers.add(h),this.queuedRedirectEvent&&this.isEventForConsumer(this.queuedRedirectEvent,h)&&(this.sendToConsumer(this.queuedRedirectEvent,h),this.saveEventToCache(this.queuedRedirectEvent),this.queuedRedirectEvent=null)}unregisterConsumer(h){this.consumers.delete(h)}onEvent(h){if(this.hasEventBeenHandled(h))return!1;let f=!1;return this.consumers.forEach(v=>{this.isEventForConsumer(h,v)&&(f=!0,this.sendToConsumer(h,v),this.saveEventToCache(h))}),this.hasHandledPotentialRedirect||!function nf(m){switch(m.type){case"signInViaRedirect":case"linkViaRedirect":case"reauthViaRedirect":return!0;case"unknown":return yd(m);default:return!1}}(h)||(this.hasHandledPotentialRedirect=!0,f||(this.queuedRedirectEvent=h,f=!0)),f}sendToConsumer(h,f){var v;if(h.error&&!yd(h)){const b=(null===(v=h.error.code)||void 0===v?void 0:v.split("auth/")[1])||"internal-error";f.onError(gn(this.auth,b))}else f.onAuthEvent(h)}isEventForConsumer(h,f){const v=null===f.eventId||!!h.eventId&&h.eventId===f.eventId;return f.filter.includes(h.type)&&v}hasEventBeenHandled(h){return Date.now()-this.lastProcessedEventTime>=6e5&&this.cachedEventUids.clear(),this.cachedEventUids.has(tf(h))}saveEventToCache(h){this.cachedEventUids.add(tf(h)),this.lastProcessedEventTime=Date.now()}}function tf(m){return[m.type,m.eventId,m.sessionId,m.tenantId].filter(h=>h).join("-")}function yd({type:m,error:h}){return"unknown"===m&&"auth/no-auth-event"===(null==h?void 0:h.code)}function fg(m){return rf.apply(this,arguments)}function rf(){return(rf=(0,_.Z)(function*(m,h={}){return mn(m,"GET","/v1/projects",h)})).apply(this,arguments)}const sf=/^\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}$/,iy=/^https?/;function oa(){return(oa=(0,_.Z)(function*(m){if(m.config.emulator)return;const{authorizedDomains:h}=yield fg(m);for(const f of h)try{if(sy(f))return}catch(v){}kt(m,"unauthorized-domain")})).apply(this,arguments)}function sy(m){const h=lt(),{protocol:f,hostname:v}=new URL(h);if(m.startsWith("chrome-extension://")){const U=new URL(m);return""===U.hostname&&""===v?"chrome-extension:"===f&&m.replace("chrome-extension://","")===h.replace("chrome-extension://",""):"chrome-extension:"===f&&U.hostname===v}if(!iy.test(f))return!1;if(sf.test(m))return v===m;const b=m.replace(/\./g,"\\.");return new RegExp("^(.+\\."+b+"|"+b+")$","i").test(v)}const oy=new bt(3e4,6e4);function ay(){const m=En().___jsl;if(null==m?void 0:m.H)for(const h of Object.keys(m.H))if(m.H[h].r=m.H[h].r||[],m.H[h].L=m.H[h].L||[],m.H[h].r=[...m.H[h].L],m.CP)for(let f=0;f<m.CP.length;f++)m.CP[f]=null}let vd=null;function x0(m){return vd=vd||function uy(m){return new Promise((h,f)=>{var v,b,x;function U(){ay(),gapi.load("gapi.iframes",{callback:()=>{h(gapi.iframes.getContext())},ontimeout:()=>{ay(),f(gn(m,"network-request-failed"))},timeout:oy.get()})}if(null===(b=null===(v=En().gapi)||void 0===v?void 0:v.iframes)||void 0===b?void 0:b.Iframe)h(gapi.iframes.getContext());else{if(!(null===(x=En().gapi)||void 0===x?void 0:x.load)){const te=Za("iframefcb");return En()[te]=()=>{gapi.load?U():f(gn(m,"network-request-failed"))},Ru(`https://apis.google.com/js/api.js?onload=${te}`).catch(Pe=>f(Pe))}U()}}).catch(h=>{throw vd=null,h})}(m),vd}const of=new bt(5e3,15e3),cy={style:{position:"absolute",top:"-100px",width:"1px",height:"1px"},"aria-hidden":"true",tabindex:"-1"},uf=new Map([["identitytoolkit.googleapis.com","p"],["staging-identitytoolkit.sandbox.googleapis.com","s"],["test-identitytoolkit.sandbox.googleapis.com","t"]]);function M0(m){const h=m.config;Ae(h.authDomain,m,"auth-domain-config-required");const f=h.emulator?Xe(h,"emulator/auth/iframe"):`https://${m.config.authDomain}/__/auth/iframe`,v={apiKey:h.apiKey,appName:m.name,v:le.SDK_VERSION},b=uf.get(m.config.apiHost);b&&(v.eid=b);const x=m._getFrameworks();return x.length&&(v.fw=x.join(",")),`${f}?${(0,k.xO)(v).slice(1)}`}function Xa(){return Xa=(0,_.Z)(function*(m){const h=yield x0(m),f=En().gapi;return Ae(f,m,"internal-error"),h.open({where:document.body,url:M0(m),messageHandlersFilter:f.iframes.CROSS_ORIGIN_IFRAMES_FILTER,attributes:cy,dontclear:!0},v=>new Promise(function(){var b=(0,_.Z)(function*(x,U){yield v.restyle({setHideOnLeave:!1});const te=gn(m,"network-request-failed"),Pe=En().setTimeout(()=>{U(te)},of.get());function Se(){En().clearTimeout(Pe),x(v)}v.ping(Se).then(Se,()=>{U(te)})});return function(x,U){return b.apply(this,arguments)}}()))}),Xa.apply(this,arguments)}const pg={location:"yes",resizable:"yes",statusbar:"yes",toolbar:"no"};class Zl{constructor(h){this.window=h,this.associatedEvent=null}close(){if(this.window)try{this.window.close()}catch(h){}}}function Ed(m,h,f,v,b,x){Ae(m.config.authDomain,m,"auth-domain-config-required"),Ae(m.config.apiKey,m,"invalid-api-key");const U={apiKey:m.config.apiKey,appName:m.name,authType:f,redirectUrl:v,v:le.SDK_VERSION,eventId:b};if(h instanceof $n){h.setDefaultLanguage(m.languageCode),U.providerId=h.providerId||"",(0,k.xb)(h.getCustomParameters())||(U.customParameters=JSON.stringify(h.getCustomParameters()));for(const[Pe,Se]of Object.entries(x||{}))U[Pe]=Se}if(h instanceof Mn){const Pe=h.getScopes().filter(Se=>""!==Se);Pe.length>0&&(U.scopes=Pe.join(","))}m.tenantId&&(U.tid=m.tenantId);const te=U;for(const Pe of Object.keys(te))void 0===te[Pe]&&delete te[Pe];return`${function Yl({config:m}){return m.emulator?Xe(m,"emulator/auth/handler"):`https://${m.authDomain}/__/auth/handler`}(m)}?${(0,k.xO)(te).slice(1)}`}const mg="webStorageSupport";class hf extends class Ql{constructor(h){this.factorId=h}_process(h,f,v){switch(f.type){case"enroll":return this._finalizeEnroll(h,f.credential,v);case"signin":return this._finalizeSignIn(h,f.credential);default:return ur("unexpected MultiFactorSessionType")}}}{constructor(h){super("phone"),this.credential=h}static _fromCredential(h){return new hf(h)}_finalizeEnroll(h,f,v){return function Wa(m,h){return mn(m,"POST","/v2/accounts/mfaEnrollment:finalize",ct(m,h))}(h,{idToken:f,displayName:v,phoneVerificationInfo:this.credential._makeVerificationRequest()})}_finalizeSignIn(h,f){return function cd(m,h){return mn(m,"POST","/v2/accounts/mfaSignIn:finalize",ct(m,h))}(h,{mfaPendingCredential:f,phoneVerificationInfo:this.credential._makeVerificationRequest()})}}let _g=(()=>{class m{constructor(){}static assertion(f){return hf._fromCredential(f)}}return m.FACTOR_ID="phone",m})();var yg="@firebase/auth";class Cd{constructor(h){this.auth=h,this.internalListeners=new Map}getUid(){var h;return this.assertAuthConfigured(),(null===(h=this.auth.currentUser)||void 0===h?void 0:h.uid)||null}getToken(h){var f=this;return(0,_.Z)(function*(){return f.assertAuthConfigured(),yield f.auth._initializationPromise,f.auth.currentUser?{accessToken:yield f.auth.currentUser.getIdToken(h)}:null})()}addAuthTokenListener(h){if(this.assertAuthConfigured(),this.internalListeners.has(h))return;const f=this.auth.onIdTokenChanged(v=>{var b;h((null===(b=v)||void 0===b?void 0:b.stsTokenManager.accessToken)||null)});this.internalListeners.set(h,f),this.updateProactiveRefresh()}removeAuthTokenListener(h){this.assertAuthConfigured();const f=this.internalListeners.get(h);!f||(this.internalListeners.delete(h),f(),this.updateProactiveRefresh())}assertAuthConfigured(){Ae(this.auth._initializationPromise,"dependent-sdk-initialized-before-auth")}updateProactiveRefresh(){this.internalListeners.size>0?this.auth._startProactiveRefresh():this.auth._stopProactiveRefresh()}}function cn(){return window}function Xl(){return(Xl=(0,_.Z)(function*(m,h,f){var v;const{BuildInfo:b}=cn();et(h.sessionId,"AuthEvent did not contain a session ID");const x=yield HD(h.sessionId),U={};return ji()?U.ibi=b.packageName:Ui()?U.apn=b.packageName:kt(m,"operation-not-supported-in-this-environment"),b.displayName&&(U.appDisplayName=b.displayName),U.sessionId=x,Ed(m,f,h.type,void 0,null!==(v=h.eventId)&&void 0!==v?v:void 0,U)})).apply(this,arguments)}function Dd(){return(Dd=(0,_.Z)(function*(m){const{BuildInfo:h}=cn(),f={};ji()?f.iosBundleId=h.packageName:Ui()?f.androidPackageName=h.packageName:kt(m,"operation-not-supported-in-this-environment"),yield fg(m,f)})).apply(this,arguments)}function Ig(){return(Ig=(0,_.Z)(function*(m,h,f){const{cordova:v}=cn();let b=()=>{};try{yield new Promise((x,U)=>{let te=null;function Pe(){var Ye;x();const St=null===(Ye=v.plugins.browsertab)||void 0===Ye?void 0:Ye.close;"function"==typeof St&&St(),"function"==typeof(null==f?void 0:f.close)&&f.close()}function Se(){te||(te=window.setTimeout(()=>{U(gn(m,"redirect-cancelled-by-user"))},2e3))}function ze(){"visible"===(null==document?void 0:document.visibilityState)&&Se()}h.addPassiveListener(Pe),document.addEventListener("resume",Se,!1),Ui()&&document.addEventListener("visibilitychange",ze,!1),b=()=>{h.removePassiveListener(Pe),document.removeEventListener("resume",Se,!1),document.removeEventListener("visibilitychange",ze,!1),te&&window.clearTimeout(te)}})}finally{b()}})).apply(this,arguments)}function HD(m){return Cg.apply(this,arguments)}function Cg(){return(Cg=(0,_.Z)(function*(m){const h=ec(m),f=yield crypto.subtle.digest("SHA-256",h);return Array.from(new Uint8Array(f)).map(b=>b.toString(16).padStart(2,"0")).join("")})).apply(this,arguments)}function ec(m){if(et(/[0-9a-zA-Z]+/.test(m),"Can only convert alpha-numeric strings"),"undefined"!=typeof TextEncoder)return(new TextEncoder).encode(m);const h=new ArrayBuffer(m.length),f=new Uint8Array(h);for(let v=0;v<m.length;v++)f[v]=m.charCodeAt(v);return f}!function Jl(m){(0,le._registerComponent)(new ce.wA("auth",(h,{options:f})=>{const v=h.getProvider("app").getImmediate(),{apiKey:b,authDomain:x}=v.options;return(U=>{Ae(b&&!b.includes(":"),"invalid-api-key",{appName:U.name}),Ae(!(null==x?void 0:x.includes(":")),"argument-error",{appName:U.name});const te={apiKey:b,authDomain:x,clientPlatform:m,apiHost:"identitytoolkit.googleapis.com",tokenApiHost:"securetoken.googleapis.com",apiScheme:"https",sdkClientVersion:Ci(m)},Pe=new Vc(U,te);return function Rs(m,h){const f=(null==h?void 0:h.persistence)||[],v=(Array.isArray(f)?f:[f]).map(Ut);(null==h?void 0:h.errorMap)&&m._updateErrorMap(h.errorMap),m._initializeWithPersistence(v,null==h?void 0:h.popupRedirectResolver)}(Pe,f),Pe})(v)},"PUBLIC").setInstantiationMode("EXPLICIT").setInstanceCreatedCallback((h,f,v)=>{h.getProvider("auth-internal").initialize()})),(0,le._registerComponent)(new ce.wA("auth-internal",h=>{const f=xn(h.getProvider("auth").getImmediate());return new Cd(f)},"PRIVATE").setInstantiationMode("EXPLICIT")),(0,le.registerVersion)(yg,"0.19.9",function fy(m){switch(m){case"Node":return"node";case"ReactNative":return"rn";case"Worker":return"webworker";case"Cordova":return"cordova";default:return}}(m)),(0,le.registerVersion)(yg,"0.19.9","esm2017")}("Browser");class Dg extends _d{constructor(){super(...arguments),this.passiveListeners=new Set,this.initPromise=new Promise(h=>{this.resolveInialized=h})}addPassiveListener(h){this.passiveListeners.add(h)}removePassiveListener(h){this.passiveListeners.delete(h)}resetRedirect(){this.queuedRedirectEvent=null,this.hasHandledPotentialRedirect=!1}onEvent(h){return this.resolveInialized(),this.passiveListeners.forEach(f=>f(h)),super.onEvent(h)}initialized(){var h=this;return(0,_.Z)(function*(){yield h.initPromise})()}}function hr(m){return Pn.apply(this,arguments)}function Pn(){return(Pn=(0,_.Z)(function*(m){const h=yield tc()._get(nc(m));return h&&(yield tc()._remove(nc(m))),h})).apply(this,arguments)}function eu(){const m=[],h="1234567890abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ";for(let f=0;f<20;f++){const v=Math.floor(Math.random()*h.length);m.push(h.charAt(v))}return m.join("")}function tc(){return Ut(ei)}function nc(m){return Lt("authEvent",m.config.apiKey,m.name)}function Td(m){if(!(null==m?void 0:m.includes("?")))return{};const[h,...f]=m.split("?");return(0,k.zd)(f.join("?"))}function Ad(){return{type:"unknown",eventId:null,sessionId:null,urlResponse:null,postBody:null,tenantId:null,error:gn("no-auth-event")}}function gf(){var m;return(null===(m=null==self?void 0:self.location)||void 0===m?void 0:m.protocol)||null}function Ws(m=(0,k.z$)()){return!("file:"!==gf()&&"ionic:"!==gf()||!m.toLowerCase().match(/iphone|ipad|ipod|android/))}function Sd(){try{const m=self.localStorage,h=za();if(m)return m.setItem(h,"1"),m.removeItem(h),!function vs(m=(0,k.z$)()){return function ys(){return(0,k.w1)()&&11===(null==document?void 0:document.documentMode)}()||function P(m=(0,k.z$)()){return/Edge\/\d+/.test(m)}(m)}()||(0,k.hl)()}catch(m){return xd()&&(0,k.hl)()}return!1}function xd(){return"undefined"!=typeof global&&"WorkerGlobalScope"in global&&"importScripts"in global}function rc(){return(function Lu(){return"http:"===gf()||"https:"===gf()}()||(0,k.ru)()||Ws())&&!function pe(){return(0,k.b$)()||(0,k.UG)()}()&&Sd()&&!xd()}function mf(){return Ws()&&"undefined"!=typeof document}function Md(){return(Md=(0,_.Z)(function*(){return!!mf()&&new Promise(m=>{const h=setTimeout(()=>{m(!1)},1e3);document.addEventListener("deviceready",()=>{clearTimeout(h),m(!0)})})})).apply(this,arguments)}const nr={LOCAL:"local",NONE:"none",SESSION:"session"},tu=Ae,Xi="persistence";function _f(m){return Vu.apply(this,arguments)}function Vu(){return(Vu=(0,_.Z)(function*(m){yield m._initializationPromise;const h=Ag(),f=Lt(Xi,m.config.apiKey,m.name);h&&h.setItem(f,m._getPersistence())})).apply(this,arguments)}function Ag(){var m;try{return(null===(m=function Tg(){return"undefined"!=typeof window?window:null}())||void 0===m?void 0:m.sessionStorage)||null}catch(h){return null}}const ws=Ae;class un{constructor(){this.browserResolver=Ut(class hy{constructor(){this.eventManagers={},this.iframes={},this.originValidationPromises={},this._redirectPersistence=Vt,this._completeRedirectFn=ef}_openPopup(h,f,v,b){var x=this;return(0,_.Z)(function*(){var U;et(null===(U=x.eventManagers[h._key()])||void 0===U?void 0:U.manager,"_initialize() not called before _openPopup()");const te=Ed(h,f,v,lt(),b);return function N0(m,h,f,v=500,b=600){const x=Math.max((window.screen.availHeight-b)/2,0).toString(),U=Math.max((window.screen.availWidth-v)/2,0).toString();let te="";const Pe=Object.assign(Object.assign({},pg),{width:v.toString(),height:b.toString(),top:x,left:U}),Se=(0,k.z$)().toLowerCase();f&&(te=io(Se)?"_blank":f),Et(Se)&&(h=h||"http://localhost",Pe.scrollbars="yes");const ze=Object.entries(Pe).reduce((St,[ir,es])=>`${St}${ir}=${es},`,"");if(function Xt(m=(0,k.z$)()){var h;return ji(m)&&!!(null===(h=window.navigator)||void 0===h?void 0:h.standalone)}(Se)&&"_self"!==te)return function R0(m,h){const f=document.createElement("a");f.href=m,f.target=h;const v=document.createEvent("MouseEvent");v.initMouseEvent("click",!0,!0,window,1,0,0,0,0,!1,!1,!1,!1,1,null),f.dispatchEvent(v)}(h||"",te),new Zl(null);const Ye=window.open(h||"",te,ze);Ae(Ye,m,"popup-blocked");try{Ye.focus()}catch(St){}return new Zl(Ye)}(h,te,za())})()}_openRedirect(h,f,v,b){var x=this;return(0,_.Z)(function*(){return yield x._originValidation(h),function Jo(m){En().location.href=m}(Ed(h,f,v,lt(),b)),new Promise(()=>{})})()}_initialize(h){const f=h._key();if(this.eventManagers[f]){const{manager:b,promise:x}=this.eventManagers[f];return b?Promise.resolve(b):(et(x,"If manager is not set, promise should be"),x)}const v=this.initAndGetManager(h);return this.eventManagers[f]={promise:v},v.catch(()=>{delete this.eventManagers[f]}),v}initAndGetManager(h){var f=this;return(0,_.Z)(function*(){const v=yield function lf(m){return Xa.apply(this,arguments)}(h),b=new _d(h);return v.register("authEvent",x=>(Ae(null==x?void 0:x.authEvent,h,"invalid-auth-event"),{status:b.onEvent(x.authEvent)?"ACK":"ERROR"}),gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER),f.eventManagers[h._key()]={manager:b},f.iframes[h._key()]=v,b})()}_isIframeWebStorageSupported(h,f){this.iframes[h._key()].send(mg,{type:mg},b=>{var x;const U=null===(x=null==b?void 0:b[0])||void 0===x?void 0:x[mg];void 0!==U&&f(!!U),kt(h,"internal-error")},gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER)}_originValidation(h){const f=h._key();return this.originValidationPromises[f]||(this.originValidationPromises[f]=function Ja(m){return oa.apply(this,arguments)}(h)),this.originValidationPromises[f]}get _shouldInitProactively(){return Vo()||Fo()||ji()}}),this.cordovaResolver=Ut(class ff{constructor(){this._redirectPersistence=Vt,this._shouldInitProactively=!0,this.eventManagers=new Map,this.originValidationPromises={},this._completeRedirectFn=ef}_initialize(h){var f=this;return(0,_.Z)(function*(){const v=h._key();let b=f.eventManagers.get(v);return b||(b=new Dg(h),f.eventManagers.set(v,b),f.attachCallbackListeners(h,b)),b})()}_openPopup(h){kt(h,"operation-not-supported-in-this-environment")}_openRedirect(h,f,v,b){var x=this;return(0,_.Z)(function*(){!function P0(m){var h,f,v,b,x,U,te,Pe,Se,ze;const Ye=cn();Ae("function"==typeof(null===(h=null==Ye?void 0:Ye.universalLinks)||void 0===h?void 0:h.subscribe),m,"invalid-cordova-configuration",{missingPlugin:"cordova-universal-links-plugin-fix"}),Ae(void 0!==(null===(f=null==Ye?void 0:Ye.BuildInfo)||void 0===f?void 0:f.packageName),m,"invalid-cordova-configuration",{missingPlugin:"cordova-plugin-buildInfo"}),Ae("function"==typeof(null===(x=null===(b=null===(v=null==Ye?void 0:Ye.cordova)||void 0===v?void 0:v.plugins)||void 0===b?void 0:b.browsertab)||void 0===x?void 0:x.openUrl),m,"invalid-cordova-configuration",{missingPlugin:"cordova-plugin-browsertab"}),Ae("function"==typeof(null===(Pe=null===(te=null===(U=null==Ye?void 0:Ye.cordova)||void 0===U?void 0:U.plugins)||void 0===te?void 0:te.browsertab)||void 0===Pe?void 0:Pe.isAvailable),m,"invalid-cordova-configuration",{missingPlugin:"cordova-plugin-browsertab"}),Ae("function"==typeof(null===(ze=null===(Se=null==Ye?void 0:Ye.cordova)||void 0===Se?void 0:Se.InAppBrowser)||void 0===ze?void 0:ze.open),m,"invalid-cordova-configuration",{missingPlugin:"cordova-plugin-inappbrowser"})}(h);const U=yield x._initialize(h);yield U.initialized(),U.resetRedirect(),function Hs(){In.clear()}(),yield x._originValidation(h);const te=function _y(m,h,f=null){return{type:h,eventId:f,urlResponse:null,sessionId:eu(),postBody:null,tenantId:m.tenantId,error:gn(m,"no-auth-event")}}(h,v,b);yield function yy(m,h){return tc()._set(nc(m),h)}(h,te);const Pe=yield function gy(m,h,f){return Xl.apply(this,arguments)}(h,te,f),Se=yield function my(m){const{cordova:h}=cn();return new Promise(f=>{h.plugins.browsertab.isAvailable(v=>{let b=null;v?h.plugins.browsertab.openUrl(m):b=h.InAppBrowser.open(m,function Hr(m=(0,k.z$)()){return/(iPad|iPhone|iPod).*OS 7_\d/i.test(m)||/(iPad|iPhone|iPod).*OS 8_\d/i.test(m)}()?"_blank":"_system","location=yes"),f(b)})})}(Pe);return function wg(m,h,f){return Ig.apply(this,arguments)}(h,U,Se)})()}_isIframeWebStorageSupported(h,f){throw new Error("Method not implemented.")}_originValidation(h){const f=h._key();return this.originValidationPromises[f]||(this.originValidationPromises[f]=function Eg(m){return Dd.apply(this,arguments)}(h)),this.originValidationPromises[f]}attachCallbackListeners(h,f){const{universalLinks:v,handleOpenURL:b,BuildInfo:x}=cn(),U=setTimeout((0,_.Z)(function*(){yield hr(h),f.onEvent(Ad())}),500),te=function(){var ze=(0,_.Z)(function*(Ye){clearTimeout(U);const St=yield hr(h);let ir=null;St&&(null==Ye?void 0:Ye.url)&&(ir=function bd(m,h){var f,v;const b=function $s(m){const h=Td(m),f=h.link?decodeURIComponent(h.link):void 0,v=Td(f).link,b=h.deep_link_id?decodeURIComponent(h.deep_link_id):void 0;return Td(b).link||b||v||f||m}(h);if(b.includes("/__/auth/callback")){const x=Td(b),U=x.firebaseError?function Gs(m){try{return JSON.parse(m)}catch(h){return null}}(decodeURIComponent(x.firebaseError)):null,te=null===(v=null===(f=null==U?void 0:U.code)||void 0===f?void 0:f.split("auth/"))||void 0===v?void 0:v[1],Pe=te?gn(te):null;return Pe?{type:m.type,eventId:m.eventId,tenantId:m.tenantId,error:Pe,urlResponse:null,sessionId:null,postBody:null}:{type:m.type,eventId:m.eventId,tenantId:m.tenantId,sessionId:m.sessionId,urlResponse:b,postBody:null}}return null}(St,Ye.url)),f.onEvent(ir||Ad())});return function(St){return ze.apply(this,arguments)}}();void 0!==v&&"function"==typeof v.subscribe&&v.subscribe(null,te);const Pe=b,Se=`${x.packageName.toLowerCase()}://`;cn().handleOpenURL=function(){var ze=(0,_.Z)(function*(Ye){if(Ye.toLowerCase().startsWith(Se)&&te({url:Ye}),"function"==typeof Pe)try{Pe(Ye)}catch(St){console.error(St)}});return function(Ye){return ze.apply(this,arguments)}}()}}),this.underlyingResolver=null,this._redirectPersistence=Vt,this._completeRedirectFn=ef}_initialize(h){var f=this;return(0,_.Z)(function*(){return yield f.selectUnderlyingResolver(),f.assertedUnderlyingResolver._initialize(h)})()}_openPopup(h,f,v,b){var x=this;return(0,_.Z)(function*(){return yield x.selectUnderlyingResolver(),x.assertedUnderlyingResolver._openPopup(h,f,v,b)})()}_openRedirect(h,f,v,b){var x=this;return(0,_.Z)(function*(){return yield x.selectUnderlyingResolver(),x.assertedUnderlyingResolver._openRedirect(h,f,v,b)})()}_isIframeWebStorageSupported(h,f){this.assertedUnderlyingResolver._isIframeWebStorageSupported(h,f)}_originValidation(h){return this.assertedUnderlyingResolver._originValidation(h)}get _shouldInitProactively(){return mf()||this.browserResolver._shouldInitProactively}get assertedUnderlyingResolver(){return ws(this.underlyingResolver,"internal-error"),this.underlyingResolver}selectUnderlyingResolver(){var h=this;return(0,_.Z)(function*(){if(h.underlyingResolver)return;const f=yield function wy(){return Md.apply(this,arguments)}();h.underlyingResolver=f?h.cordovaResolver:h.browserResolver})()}}function ua(m){return m.unwrap()}function Is(m){return vf(m)}function vf(m){const{_tokenResponse:h}=m instanceof k.ZR?m.customData:m;if(!h)return null;if(!(m instanceof k.ZR)&&"temporaryProof"in h&&"phoneNumber"in h)return fo.credentialFromResult(m);const f=h.providerId;if(!f||"password"===f)return null;let v;switch(f){case"google.com":v=Gi;break;case"facebook.com":v=jo;break;case"github.com":v=Tr;break;case"twitter.com":v=Ls;break;default:const{oauthIdToken:b,oauthAccessToken:x,oauthTokenSecret:U,pendingToken:te,nonce:Pe}=h;return x||U||b||te?te?f.startsWith("saml.")?$i._create(f,te):yr._fromParams({providerId:f,signInMethod:f,pendingToken:te,idToken:b,accessToken:x}):new ls(f).credential({idToken:b,accessToken:x,rawNonce:Pe}):null}return m instanceof k.ZR?v.credentialFromError(m):v.credentialFromResult(m)}function fr(m,h){return h.catch(f=>{throw f instanceof k.ZR&&function rr(m,h){var f;const v=null===(f=h.customData)||void 0===f?void 0:f._tokenResponse;if("auth/multi-factor-auth-required"===h.code)h.resolver=new Cs(m,function Rl(m,h){var f;const v=(0,k.m9)(m),b=h;return Ae(h.customData.operationType,v,"argument-error"),Ae(null===(f=b.customData._serverResponse)||void 0===f?void 0:f.mfaPendingCredential,v,"argument-error"),$a._fromError(v,b)}(m,h));else if(v){const b=vf(h),x=h;b&&(x.credential=b,x.tenantId=v.tenantId||void 0,x.email=v.email||void 0,x.phoneNumber=v.phoneNumber||void 0)}}(m,f),f}).then(f=>{const b=f.user;return{operationType:f.operationType,credential:Is(f),additionalUserInfo:cr(f),user:ii.getOrCreate(b)}})}function ic(m,h){return Mi.apply(this,arguments)}function Mi(){return(Mi=(0,_.Z)(function*(m,h){const f=yield h;return{verificationId:f.verificationId,confirm:v=>fr(m,f.confirm(v))}})).apply(this,arguments)}class Cs{constructor(h,f){this.resolver=f,this.auth=function yf(m){return m.wrapped()}(h)}get session(){return this.resolver.session}get hints(){return this.resolver.hints}resolveSignIn(h){return fr(ua(this.auth),this.resolver.resolveSignIn(h))}}class ii{constructor(h){this._delegate=h,this.multiFactor=function qr(m){const h=(0,k.m9)(m);return Sr.has(h)||Sr.set(h,Zo._fromUser(h)),Sr.get(h)}(h)}static getOrCreate(h){return ii.USER_MAP.has(h)||ii.USER_MAP.set(h,new ii(h)),ii.USER_MAP.get(h)}delete(){return this._delegate.delete()}reload(){return this._delegate.reload()}toJSON(){return this._delegate.toJSON()}getIdTokenResult(h){return this._delegate.getIdTokenResult(h)}getIdToken(h){return this._delegate.getIdToken(h)}linkAndRetrieveDataWithCredential(h){return this.linkWithCredential(h)}linkWithCredential(h){var f=this;return(0,_.Z)(function*(){return fr(f.auth,Ra(f._delegate,h))})()}linkWithPhoneNumber(h,f){var v=this;return(0,_.Z)(function*(){return ic(v.auth,function Ya(m,h,f){return Zi.apply(this,arguments)}(v._delegate,h,f))})()}linkWithPopup(h){var f=this;return(0,_.Z)(function*(){return fr(f.auth,function at(m,h,f){return Ft.apply(this,arguments)}(f._delegate,h,un))})()}linkWithRedirect(h){var f=this;return(0,_.Z)(function*(){return yield _f(xn(f.auth)),function ny(m,h,f){return function fd(m,h,f){return go.apply(this,arguments)}(m,h,f)}(f._delegate,h,un)})()}reauthenticateAndRetrieveDataWithCredential(h){return this.reauthenticateWithCredential(h)}reauthenticateWithCredential(h){var f=this;return(0,_.Z)(function*(){return fr(f.auth,Ti(f._delegate,h))})()}reauthenticateWithPhoneNumber(h,f){return ic(this.auth,function na(m,h,f){return ti.apply(this,arguments)}(this._delegate,h,f))}reauthenticateWithPopup(h){return fr(this.auth,function $e(m,h,f){return ke.apply(this,arguments)}(this._delegate,h,un))}reauthenticateWithRedirect(h){var f=this;return(0,_.Z)(function*(){return yield _f(xn(f.auth)),function cg(m,h,f){return function dg(m,h,f){return zl.apply(this,arguments)}(m,h,f)}(f._delegate,h,un)})()}sendEmailVerification(h){return function Ml(m,h){return Bs.apply(this,arguments)}(this._delegate,h)}unlink(h){var f=this;return(0,_.Z)(function*(){return yield function Te(m,h){return At.apply(this,arguments)}(f._delegate,h),f})()}updateEmail(h){return function Hh(m,h){return Ua((0,k.m9)(m),h,null)}(this._delegate,h)}updatePassword(h){return function ng(m,h){return Ua((0,k.m9)(m),null,h)}(this._delegate,h)}updatePhoneNumber(h){return function ag(m,h){return ql.apply(this,arguments)}(this._delegate,h)}updateProfile(h){return function hs(m,h){return yn.apply(this,arguments)}(this._delegate,h)}verifyBeforeUpdateEmail(h,f){return function Au(m,h,f){return Su.apply(this,arguments)}(this._delegate,h,f)}get emailVerified(){return this._delegate.emailVerified}get isAnonymous(){return this._delegate.isAnonymous}get metadata(){return this._delegate.metadata}get phoneNumber(){return this._delegate.phoneNumber}get providerData(){return this._delegate.providerData}get refreshToken(){return this._delegate.refreshToken}get tenantId(){return this._delegate.tenantId}get displayName(){return this._delegate.displayName}get email(){return this._delegate.email}get photoURL(){return this._delegate.photoURL}get providerId(){return this._delegate.providerId}get uid(){return this._delegate.uid}get auth(){return this._delegate.auth}}ii.USER_MAP=new WeakMap;const qs=Ae;let la=(()=>{class m{constructor(f,v){if(this.app=f,v.isInitialized())return this._delegate=v.getImmediate(),void this.linkUnderlyingAuth();const{apiKey:b}=f.options;qs(b,"invalid-api-key",{appName:f.name}),qs(b,"invalid-api-key",{appName:f.name});const x="undefined"!=typeof window?un:void 0;this._delegate=v.initialize({options:{persistence:Sg(b,f.name),popupRedirectResolver:x}}),this._delegate._updateErrorMap(mr),this.linkUnderlyingAuth()}get emulatorConfig(){return this._delegate.emulatorConfig}get currentUser(){return this._delegate.currentUser?ii.getOrCreate(this._delegate.currentUser):null}get languageCode(){return this._delegate.languageCode}set languageCode(f){this._delegate.languageCode=f}get settings(){return this._delegate.settings}get tenantId(){return this._delegate.tenantId}set tenantId(f){this._delegate.tenantId=f}useDeviceLanguage(){this._delegate.useDeviceLanguage()}signOut(){return this._delegate.signOut()}useEmulator(f,v){!function Hi(m,h,f){const v=xn(m);Ae(v._canInitEmulator,v,"emulator-config-failed"),Ae(/^https?:\/\//.test(h),v,"invalid-emulator-scheme");const b=!!(null==f?void 0:f.disableWarnings),x=Bc(h),{host:U,port:te}=function Qp(m){const h=Bc(m),f=/(\/\/)?([^?#/]+)/.exec(m.substr(h.length));if(!f)return{host:"",port:null};const v=f[2].split("@").pop()||"",b=/^(\[[^\]]+\])(:|$)/.exec(v);if(b){const x=b[1];return{host:x,port:Ph(v.substr(x.length+1))}}{const[x,U]=v.split(":");return{host:x,port:Ph(U)}}}(h);v.config.emulator={url:`${x}//${U}${null===te?"":`:${te}`}/`},v.settings.appVerificationDisabledForTesting=!0,v.emulatorConfig=Object.freeze({host:U,port:te,protocol:x.replace(":",""),options:Object.freeze({disableWarnings:b})}),b||function Di(){function m(){const h=document.createElement("p"),f=h.style;h.innerText="Running in emulator mode. Do not use with production credentials.",f.position="fixed",f.width="100%",f.backgroundColor="#ffffff",f.border=".1em solid #000000",f.color="#b50000",f.bottom="0px",f.left="0px",f.margin="0px",f.zIndex="10000",f.textAlign="center",h.classList.add("firebase-emulator-warning"),document.body.appendChild(h)}"undefined"!=typeof console&&"function"==typeof console.info&&console.info("WARNING: You are using the Auth Emulator, which is intended for local testing only.  Do not use with production credentials."),"undefined"!=typeof window&&"undefined"!=typeof document&&("loading"===document.readyState?window.addEventListener("DOMContentLoaded",m):m())}()}(this._delegate,f,v)}applyActionCode(f){return function Al(m,h){return Ko.apply(this,arguments)}(this._delegate,f)}checkActionCode(f){return Xc(this._delegate,f)}confirmPasswordReset(f,v){return function Fa(m,h,f){return Tl.apply(this,arguments)}(this._delegate,f,v)}createUserWithEmailAndPassword(f,v){var b=this;return(0,_.Z)(function*(){return fr(b._delegate,function Tu(m,h,f){return ed.apply(this,arguments)}(b._delegate,f,v))})()}fetchProvidersForEmail(f){return this.fetchSignInMethodsForEmail(f)}fetchSignInMethodsForEmail(f){return function td(m,h){return Uh.apply(this,arguments)}(this._delegate,f)}isSignInWithEmailLink(f){return function _n(m,h){const f=en.parseLink(h);return"EMAIL_SIGNIN"===(null==f?void 0:f.operation)}(0,f)}getRedirectResult(){var f=this;return(0,_.Z)(function*(){qs(rc(),f._delegate,"operation-not-supported-in-this-environment");const v=yield function sa(m,h){return pd.apply(this,arguments)}(f._delegate,un);return v?fr(f._delegate,Promise.resolve(v)):{credential:null,user:null}})()}addFrameworkForLogging(f){!function vy(m,h){xn(m)._logFramework(h)}(this._delegate,f)}onAuthStateChanged(f,v,b){const{next:x,error:U,complete:te}=sc(f,v,b);return this._delegate.onAuthStateChanged(x,U,te)}onIdTokenChanged(f,v,b){const{next:x,error:U,complete:te}=sc(f,v,b);return this._delegate.onIdTokenChanged(x,U,te)}sendSignInLinkToEmail(f,v){return function er(m,h,f){return Nn.apply(this,arguments)}(this._delegate,f,v)}sendPasswordResetEmail(f,v){return function Oa(m,h,f){return ka.apply(this,arguments)}(this._delegate,f,v||void 0)}setPersistence(f){var v=this;return(0,_.Z)(function*(){let b;switch(function Es(m,h){tu(Object.values(nr).includes(h),m,"invalid-persistence-type"),(0,k.b$)()?tu(h!==nr.SESSION,m,"unsupported-persistence-type"):(0,k.UG)()?tu(h===nr.NONE,m,"unsupported-persistence-type"):xd()?tu(h===nr.NONE||h===nr.LOCAL&&(0,k.hl)(),m,"unsupported-persistence-type"):tu(h===nr.NONE||Sd(),m,"unsupported-persistence-type")}(v._delegate,f),f){case nr.SESSION:b=Vt;break;case nr.LOCAL:b=(yield Ut(Si)._isAvailable())?Si:ei;break;case nr.NONE:b=br;break;default:return kt("argument-error",{appName:v._delegate.name})}return v._delegate.setPersistence(b)})()}signInAndRetrieveDataWithCredential(f){return this.signInWithCredential(f)}signInAnonymously(){return fr(this._delegate,function Na(m){return Go.apply(this,arguments)}(this._delegate))}signInWithCredential(f){return fr(this._delegate,Cu(this._delegate,f))}signInWithCustomToken(f){return fr(this._delegate,function Jc(m,h){return qo.apply(this,arguments)}(this._delegate,f))}signInWithEmailAndPassword(f,v){return fr(this._delegate,function tg(m,h,f){return Cu((0,k.m9)(m),Uo.credential(h,f))}(this._delegate,f,v))}signInWithEmailLink(f,v){return fr(this._delegate,function xl(m,h,f){return Ba.apply(this,arguments)}(this._delegate,f,v))}signInWithPhoneNumber(f,v){return ic(this._delegate,function Wl(m,h,f){return xr.apply(this,arguments)}(this._delegate,f,v))}signInWithPopup(f){var v=this;return(0,_.Z)(function*(){return qs(rc(),v._delegate,"operation-not-supported-in-this-environment"),fr(v._delegate,function ne(m,h,f){return De.apply(this,arguments)}(v._delegate,f,un))})()}signInWithRedirect(f){var v=this;return(0,_.Z)(function*(){return qs(rc(),v._delegate,"operation-not-supported-in-this-environment"),yield _f(v._delegate),function ty(m,h,f){return function Xh(m,h,f){return hd.apply(this,arguments)}(m,h,f)}(v._delegate,f,un)})()}updateCurrentUser(f){return this._delegate.updateCurrentUser(f)}verifyPasswordResetCode(f){return function Sl(m,h){return Va.apply(this,arguments)}(this._delegate,f)}unwrap(){return this._delegate}_delete(){return this._delegate._delete()}linkUnderlyingAuth(){this._delegate.wrapped=()=>this}}return m.Persistence=nr,m})();function sc(m,h,f){let v=m;"function"!=typeof m&&({next:v,error:h,complete:f}=m);const b=v;return{next:U=>b(U&&ii.getOrCreate(U)),error:h,complete:f}}function Sg(m,h){const f=function aa(m,h){const f=Ag();if(!f)return[];const v=Lt(Xi,m,h);switch(f.getItem(v)){case nr.NONE:return[br];case nr.LOCAL:return[Si,Vt];case nr.SESSION:return[Vt];default:return[]}}(m,h);if("undefined"!=typeof self&&!f.includes(Si)&&f.push(Si),"undefined"!=typeof window)for(const v of[ei,Vt])f.includes(v)||f.push(v);return f.includes(br)||f.push(br),f}class Sn{constructor(){this.providerId="phone",this._delegate=new fo(ua(J.Z.auth()))}static credential(h,f){return fo.credential(h,f)}verifyPhoneNumber(h,f){return this._delegate.verifyPhoneNumber(h,f)}unwrap(){return this._delegate}}Sn.PHONE_SIGN_IN_METHOD=fo.PHONE_SIGN_IN_METHOD,Sn.PROVIDER_ID=fo.PROVIDER_ID;const xg=Ae;class Iy{constructor(h,f,v=J.Z.app()){var b;xg(null===(b=v.options)||void 0===b?void 0:b.apiKey,"invalid-api-key",{appName:v.name}),this._delegate=new Jh(h,f,v.auth()),this.type=this._delegate.type}clear(){this._delegate.clear()}render(){return this._delegate.render()}verify(){return this._delegate.verify()}}!function Dy(m){m.INTERNAL.registerComponent(new ce.wA("auth-compat",h=>{const f=h.getProvider("app-compat").getImmediate(),v=h.getProvider("auth");return new la(f,v)},"PUBLIC").setServiceProps({ActionCodeInfo:{Operation:{EMAIL_SIGNIN:"EMAIL_SIGNIN",PASSWORD_RESET:"PASSWORD_RESET",RECOVER_EMAIL:"RECOVER_EMAIL",REVERT_SECOND_FACTOR_ADDITION:"REVERT_SECOND_FACTOR_ADDITION",VERIFY_AND_CHANGE_EMAIL:"VERIFY_AND_CHANGE_EMAIL",VERIFY_EMAIL:"VERIFY_EMAIL"}},EmailAuthProvider:Uo,FacebookAuthProvider:jo,GithubAuthProvider:Tr,GoogleAuthProvider:Gi,OAuthProvider:ls,SAMLAuthProvider:Ar,PhoneAuthProvider:Sn,PhoneMultiFactorGenerator:_g,RecaptchaVerifier:Iy,TwitterAuthProvider:Ls,Auth:la,AuthCredential:Ca,Error:k.ZR}).setInstantiationMode("LAZY").setMultipleInstances(!1)),m.registerVersion("@firebase/auth-compat","0.2.9")}(J.Z)},2940:function(it,be){!function(L){"use strict";function _(K){return Array.prototype.slice.call(K)}function J(K){return new Promise(function(re,he){K.onsuccess=function(){re(K.result)},K.onerror=function(){he(K.error)}})}function k(K,re,he){var we,me=new Promise(function(Ue,Ce){J(we=K[re].apply(K,he)).then(Ue,Ce)});return me.request=we,me}function le(K,re,he){var we=k(K,re,he);return we.then(function(me){if(me)return new $(me,we.request)})}function ie(K,re,he){he.forEach(function(we){Object.defineProperty(K.prototype,we,{get:function(){return this[re][we]},set:function(me){this[re][we]=me}})})}function ge(K,re,he,we){we.forEach(function(me){me in he.prototype&&(K.prototype[me]=function(){return k(this[re],me,arguments)})})}function oe(K,re,he,we){we.forEach(function(me){me in he.prototype&&(K.prototype[me]=function(){return this[re][me].apply(this[re],arguments)})})}function de(K,re,he,we){we.forEach(function(me){me in he.prototype&&(K.prototype[me]=function(){return le(this[re],me,arguments)})})}function ye(K){this._index=K}function $(K,re){this._cursor=K,this._request=re}function H(K){this._store=K}function X(K){this._tx=K,this.complete=new Promise(function(re,he){K.oncomplete=function(){re()},K.onerror=function(){he(K.error)},K.onabort=function(){he(K.error)}})}function Ge(K,re,he){this._db=K,this.oldVersion=re,this.transaction=new X(he)}function Ne(K){this._db=K}ie(ye,"_index",["name","keyPath","multiEntry","unique"]),ge(ye,"_index",IDBIndex,["get","getKey","getAll","getAllKeys","count"]),de(ye,"_index",IDBIndex,["openCursor","openKeyCursor"]),ie($,"_cursor",["direction","key","primaryKey","value"]),ge($,"_cursor",IDBCursor,["update","delete"]),["advance","continue","continuePrimaryKey"].forEach(function(K){K in IDBCursor.prototype&&($.prototype[K]=function(){var re=this,he=arguments;return Promise.resolve().then(function(){return re._cursor[K].apply(re._cursor,he),J(re._request).then(function(we){if(we)return new $(we,re._request)})})})}),H.prototype.createIndex=function(){return new ye(this._store.createIndex.apply(this._store,arguments))},H.prototype.index=function(){return new ye(this._store.index.apply(this._store,arguments))},ie(H,"_store",["name","keyPath","indexNames","autoIncrement"]),ge(H,"_store",IDBObjectStore,["put","add","delete","clear","get","getAll","getKey","getAllKeys","count"]),de(H,"_store",IDBObjectStore,["openCursor","openKeyCursor"]),oe(H,"_store",IDBObjectStore,["deleteIndex"]),X.prototype.objectStore=function(){return new H(this._tx.objectStore.apply(this._tx,arguments))},ie(X,"_tx",["objectStoreNames","mode"]),oe(X,"_tx",IDBTransaction,["abort"]),Ge.prototype.createObjectStore=function(){return new H(this._db.createObjectStore.apply(this._db,arguments))},ie(Ge,"_db",["name","version","objectStoreNames"]),oe(Ge,"_db",IDBDatabase,["deleteObjectStore","close"]),Ne.prototype.transaction=function(){return new X(this._db.transaction.apply(this._db,arguments))},ie(Ne,"_db",["name","version","objectStoreNames"]),oe(Ne,"_db",IDBDatabase,["close"]),["openCursor","openKeyCursor"].forEach(function(K){[H,ye].forEach(function(re){K in re.prototype&&(re.prototype[K.replace("open","iterate")]=function(){var he=_(arguments),we=he[he.length-1],me=this._store||this._index,Ue=me[K].apply(me,he.slice(0,-1));Ue.onsuccess=function(){we(Ue.result)}})})}),[ye,H].forEach(function(K){K.prototype.getAll||(K.prototype.getAll=function(re,he){var we=this,me=[];return new Promise(function(Ue){we.iterateCursor(re,function(Ce){Ce?(me.push(Ce.value),void 0===he||me.length!=he?Ce.continue():Ue(me)):Ue(me)})})})}),L.openDb=function Fe(K,re,he){var we=k(indexedDB,"open",[K,re]),me=we.request;return me&&(me.onupgradeneeded=function(Ue){he&&he(new Ge(me.result,Ue.oldVersion,me.transaction))}),we.then(function(Ue){return new Ne(Ue)})},L.deleteDb=function Be(K){return k(indexedDB,"deleteDatabase",[K])},Object.defineProperty(L,"__esModule",{value:!0})}(be)},8306:(it,be,L)=>{"use strict";L.d(be,{y:()=>$});var _=L(930),J=L(727),k=L(8822),le=L(4671);var oe=L(2416),de=L(576),ye=L(2806);let $=(()=>{class Ne{constructor(Be){Be&&(this._subscribe=Be)}lift(Be){const K=new Ne;return K.source=this,K.operator=Be,K}subscribe(Be,K,re){const he=function Ge(Ne){return Ne&&Ne instanceof _.Lv||function X(Ne){return Ne&&(0,de.m)(Ne.next)&&(0,de.m)(Ne.error)&&(0,de.m)(Ne.complete)}(Ne)&&(0,J.Nn)(Ne)}(Be)?Be:new _.Hp(Be,K,re);return(0,ye.x)(()=>{const{operator:we,source:me}=this;he.add(we?we.call(he,me):me?this._subscribe(he):this._trySubscribe(he))}),he}_trySubscribe(Be){try{return this._subscribe(Be)}catch(K){Be.error(K)}}forEach(Be,K){return new(K=H(K))((re,he)=>{let we;we=this.subscribe(me=>{try{Be(me)}catch(Ue){he(Ue),null==we||we.unsubscribe()}},he,re)})}_subscribe(Be){var K;return null===(K=this.source)||void 0===K?void 0:K.subscribe(Be)}[k.L](){return this}pipe(...Be){return function ge(Ne){return 0===Ne.length?le.y:1===Ne.length?Ne[0]:function(Be){return Ne.reduce((K,re)=>re(K),Be)}}(Be)(this)}toPromise(Be){return new(Be=H(Be))((K,re)=>{let he;this.subscribe(we=>he=we,we=>re(we),()=>K(he))})}}return Ne.create=Fe=>new Ne(Fe),Ne})();function H(Ne){var Fe;return null!==(Fe=null!=Ne?Ne:oe.v.Promise)&&void 0!==Fe?Fe:Promise}},7579:(it,be,L)=>{"use strict";L.d(be,{x:()=>oe});var _=L(8306),J=L(727);const le=(0,L(3888).d)(ye=>function(){ye(this),this.name="ObjectUnsubscribedError",this.message="object unsubscribed"});var ie=L(8737),ge=L(2806);let oe=(()=>{class ye extends _.y{constructor(){super(),this.closed=!1,this.observers=[],this.isStopped=!1,this.hasError=!1,this.thrownError=null}lift(H){const X=new de(this,this);return X.operator=H,X}_throwIfClosed(){if(this.closed)throw new le}next(H){(0,ge.x)(()=>{if(this._throwIfClosed(),!this.isStopped){const X=this.observers.slice();for(const Ge of X)Ge.next(H)}})}error(H){(0,ge.x)(()=>{if(this._throwIfClosed(),!this.isStopped){this.hasError=this.isStopped=!0,this.thrownError=H;const{observers:X}=this;for(;X.length;)X.shift().error(H)}})}complete(){(0,ge.x)(()=>{if(this._throwIfClosed(),!this.isStopped){this.isStopped=!0;const{observers:H}=this;for(;H.length;)H.shift().complete()}})}unsubscribe(){this.isStopped=this.closed=!0,this.observers=null}get observed(){var H;return(null===(H=this.observers)||void 0===H?void 0:H.length)>0}_trySubscribe(H){return this._throwIfClosed(),super._trySubscribe(H)}_subscribe(H){return this._throwIfClosed(),this._checkFinalizedStatuses(H),this._innerSubscribe(H)}_innerSubscribe(H){const{hasError:X,isStopped:Ge,observers:Ne}=this;return X||Ge?J.Lc:(Ne.push(H),new J.w0(()=>(0,ie.P)(Ne,H)))}_checkFinalizedStatuses(H){const{hasError:X,thrownError:Ge,isStopped:Ne}=this;X?H.error(Ge):Ne&&H.complete()}asObservable(){const H=new _.y;return H.source=this,H}}return ye.create=($,H)=>new de($,H),ye})();class de extends oe{constructor($,H){super(),this.destination=$,this.source=H}next($){var H,X;null===(X=null===(H=this.destination)||void 0===H?void 0:H.next)||void 0===X||X.call(H,$)}error($){var H,X;null===(X=null===(H=this.destination)||void 0===H?void 0:H.error)||void 0===X||X.call(H,$)}complete(){var $,H;null===(H=null===($=this.destination)||void 0===$?void 0:$.complete)||void 0===H||H.call($)}_subscribe($){var H,X;return null!==(X=null===(H=this.source)||void 0===H?void 0:H.subscribe($))&&void 0!==X?X:J.Lc}}},930:(it,be,L)=>{"use strict";L.d(be,{Hp:()=>Ge,Lv:()=>X});var _=L(576),J=L(727),k=L(2416),le=L(7849),ie=L(5032);const ge=ye("C",void 0,void 0);function ye(re,he,we){return{kind:re,value:he,error:we}}var $=L(3410),H=L(2806);class X extends J.w0{constructor(he){super(),this.isStopped=!1,he?(this.destination=he,(0,J.Nn)(he)&&he.add(this)):this.destination=K}static create(he,we,me){return new Ge(he,we,me)}next(he){this.isStopped?Be(function de(re){return ye("N",re,void 0)}(he),this):this._next(he)}error(he){this.isStopped?Be(function oe(re){return ye("E",void 0,re)}(he),this):(this.isStopped=!0,this._error(he))}complete(){this.isStopped?Be(ge,this):(this.isStopped=!0,this._complete())}unsubscribe(){this.closed||(this.isStopped=!0,super.unsubscribe(),this.destination=null)}_next(he){this.destination.next(he)}_error(he){try{this.destination.error(he)}finally{this.unsubscribe()}}_complete(){try{this.destination.complete()}finally{this.unsubscribe()}}}class Ge extends X{constructor(he,we,me){let Ue;if(super(),(0,_.m)(he))Ue=he;else if(he){let Ce;({next:Ue,error:we,complete:me}=he),this&&k.v.useDeprecatedNextContext?(Ce=Object.create(he),Ce.unsubscribe=()=>this.unsubscribe()):Ce=he,Ue=null==Ue?void 0:Ue.bind(Ce),we=null==we?void 0:we.bind(Ce),me=null==me?void 0:me.bind(Ce)}this.destination={next:Ue?Ne(Ue):ie.Z,error:Ne(null!=we?we:Fe),complete:me?Ne(me):ie.Z}}}function Ne(re,he){return(...we)=>{try{re(...we)}catch(me){k.v.useDeprecatedSynchronousErrorHandling?(0,H.O)(me):(0,le.h)(me)}}}function Fe(re){throw re}function Be(re,he){const{onStoppedNotification:we}=k.v;we&&$.z.setTimeout(()=>we(re,he))}const K={closed:!0,next:ie.Z,error:Fe,complete:ie.Z}},727:(it,be,L)=>{"use strict";L.d(be,{Lc:()=>ge,w0:()=>ie,Nn:()=>oe});var _=L(576);const k=(0,L(3888).d)(ye=>function(H){ye(this),this.message=H?`${H.length} errors occurred during unsubscription:\n${H.map((X,Ge)=>`${Ge+1}) ${X.toString()}`).join("\n  ")}`:"",this.name="UnsubscriptionError",this.errors=H});var le=L(8737);class ie{constructor($){this.initialTeardown=$,this.closed=!1,this._parentage=null,this._teardowns=null}unsubscribe(){let $;if(!this.closed){this.closed=!0;const{_parentage:H}=this;if(H)if(this._parentage=null,Array.isArray(H))for(const Ne of H)Ne.remove(this);else H.remove(this);const{initialTeardown:X}=this;if((0,_.m)(X))try{X()}catch(Ne){$=Ne instanceof k?Ne.errors:[Ne]}const{_teardowns:Ge}=this;if(Ge){this._teardowns=null;for(const Ne of Ge)try{de(Ne)}catch(Fe){$=null!=$?$:[],Fe instanceof k?$=[...$,...Fe.errors]:$.push(Fe)}}if($)throw new k($)}}add($){var H;if($&&$!==this)if(this.closed)de($);else{if($ instanceof ie){if($.closed||$._hasParent(this))return;$._addParent(this)}(this._teardowns=null!==(H=this._teardowns)&&void 0!==H?H:[]).push($)}}_hasParent($){const{_parentage:H}=this;return H===$||Array.isArray(H)&&H.includes($)}_addParent($){const{_parentage:H}=this;this._parentage=Array.isArray(H)?(H.push($),H):H?[H,$]:$}_removeParent($){const{_parentage:H}=this;H===$?this._parentage=null:Array.isArray(H)&&(0,le.P)(H,$)}remove($){const{_teardowns:H}=this;H&&(0,le.P)(H,$),$ instanceof ie&&$._removeParent(this)}}ie.EMPTY=(()=>{const ye=new ie;return ye.closed=!0,ye})();const ge=ie.EMPTY;function oe(ye){return ye instanceof ie||ye&&"closed"in ye&&(0,_.m)(ye.remove)&&(0,_.m)(ye.add)&&(0,_.m)(ye.unsubscribe)}function de(ye){(0,_.m)(ye)?ye():ye.unsubscribe()}},2416:(it,be,L)=>{"use strict";L.d(be,{v:()=>_});const _={onUnhandledError:null,onStoppedNotification:null,Promise:void 0,useDeprecatedSynchronousErrorHandling:!1,useDeprecatedNextContext:!1}},515:(it,be,L)=>{"use strict";L.d(be,{E:()=>J});const J=new(L(8306).y)(ie=>ie.complete())},8996:(it,be,L)=>{"use strict";L.d(be,{D:()=>Ue});var _=L(8421),J=L(5363),k=L(9468),ge=L(8306),de=L(2202),ye=L(576),$=L(9672);function X(Ce,rt){if(!Ce)throw new Error("Iterable cannot be null");return new ge.y(Ke=>{(0,$.f)(Ke,rt,()=>{const pt=Ce[Symbol.asyncIterator]();(0,$.f)(Ke,rt,()=>{pt.next().then(Q=>{Q.done?Ke.complete():Ke.next(Q.value)})},0,!0)})})}var Ge=L(3670),Ne=L(8239),Fe=L(1144),Be=L(6495),K=L(2206),re=L(4532),he=L(3260);function Ue(Ce,rt){return rt?function me(Ce,rt){if(null!=Ce){if((0,Ge.c)(Ce))return function le(Ce,rt){return(0,_.Xf)(Ce).pipe((0,k.R)(rt),(0,J.Q)(rt))}(Ce,rt);if((0,Fe.z)(Ce))return function oe(Ce,rt){return new ge.y(Ke=>{let pt=0;return rt.schedule(function(){pt===Ce.length?Ke.complete():(Ke.next(Ce[pt++]),Ke.closed||this.schedule())})})}(Ce,rt);if((0,Ne.t)(Ce))return function ie(Ce,rt){return(0,_.Xf)(Ce).pipe((0,k.R)(rt),(0,J.Q)(rt))}(Ce,rt);if((0,K.D)(Ce))return X(Ce,rt);if((0,Be.T)(Ce))return function H(Ce,rt){return new ge.y(Ke=>{let pt;return(0,$.f)(Ke,rt,()=>{pt=Ce[de.h](),(0,$.f)(Ke,rt,()=>{let Q,ae;try{({value:Q,done:ae}=pt.next())}catch(_e){return void Ke.error(_e)}ae?Ke.complete():Ke.next(Q)},0,!0)}),()=>(0,ye.m)(null==pt?void 0:pt.return)&&pt.return()})}(Ce,rt);if((0,he.L)(Ce))return function we(Ce,rt){return X((0,he.Q)(Ce),rt)}(Ce,rt)}throw(0,re.z)(Ce)}(Ce,rt):(0,_.Xf)(Ce)}},8421:(it,be,L)=>{"use strict";L.d(be,{Xf:()=>Ge});var _=L(5987),J=L(1144),k=L(8239),le=L(8306),ie=L(3670),ge=L(2206),oe=L(4532),de=L(6495),ye=L(3260),$=L(576),H=L(7849),X=L(8822);function Ge(me){if(me instanceof le.y)return me;if(null!=me){if((0,ie.c)(me))return function Ne(me){return new le.y(Ue=>{const Ce=me[X.L]();if((0,$.m)(Ce.subscribe))return Ce.subscribe(Ue);throw new TypeError("Provided object does not correctly implement Symbol.observable")})}(me);if((0,J.z)(me))return function Fe(me){return new le.y(Ue=>{for(let Ce=0;Ce<me.length&&!Ue.closed;Ce++)Ue.next(me[Ce]);Ue.complete()})}(me);if((0,k.t)(me))return function Be(me){return new le.y(Ue=>{me.then(Ce=>{Ue.closed||(Ue.next(Ce),Ue.complete())},Ce=>Ue.error(Ce)).then(null,H.h)})}(me);if((0,ge.D)(me))return re(me);if((0,de.T)(me))return function K(me){return new le.y(Ue=>{for(const Ce of me)if(Ue.next(Ce),Ue.closed)return;Ue.complete()})}(me);if((0,ye.L)(me))return function he(me){return re((0,ye.Q)(me))}(me)}throw(0,oe.z)(me)}function re(me){return new le.y(Ue=>{(function we(me,Ue){var Ce,rt,Ke,pt;return(0,_.mG)(this,void 0,void 0,function*(){try{for(Ce=(0,_.KL)(me);!(rt=yield Ce.next()).done;)if(Ue.next(rt.value),Ue.closed)return}catch(Q){Ke={error:Q}}finally{try{rt&&!rt.done&&(pt=Ce.return)&&(yield pt.call(Ce))}finally{if(Ke)throw Ke.error}}Ue.complete()})})(me,Ue).catch(Ce=>Ue.error(Ce))})}},6451:(it,be,L)=>{"use strict";L.d(be,{T:()=>ge});var _=L(6131),J=L(8421),k=L(515),le=L(7669),ie=L(8996);function ge(...oe){const de=(0,le.yG)(oe),ye=(0,le._6)(oe,1/0),$=oe;return $.length?1===$.length?(0,J.Xf)($[0]):(0,_.J)(ye)((0,ie.D)($,de)):k.E}},5403:(it,be,L)=>{"use strict";L.d(be,{Q:()=>J});var _=L(930);class J extends _.Lv{constructor(le,ie,ge,oe,de){super(le),this.onFinalize=de,this._next=ie?function(ye){try{ie(ye)}catch($){le.error($)}}:super._next,this._error=oe?function(ye){try{oe(ye)}catch($){le.error($)}finally{this.unsubscribe()}}:super._error,this._complete=ge?function(){try{ge()}catch(ye){le.error(ye)}finally{this.unsubscribe()}}:super._complete}unsubscribe(){var le;const{closed:ie}=this;super.unsubscribe(),!ie&&(null===(le=this.onFinalize)||void 0===le||le.call(this))}}},4004:(it,be,L)=>{"use strict";L.d(be,{U:()=>k});var _=L(4482),J=L(5403);function k(le,ie){return(0,_.e)((ge,oe)=>{let de=0;ge.subscribe(new J.Q(oe,ye=>{oe.next(le.call(ie,ye,de++))}))})}},6131:(it,be,L)=>{"use strict";L.d(be,{J:()=>$});var _=L(4004),J=L(8421),k=L(4482),le=L(9672),ie=L(5403),oe=L(576);function de(H,X,Ge=1/0){return(0,oe.m)(X)?de((Ne,Fe)=>(0,_.U)((Be,K)=>X(Ne,Be,Fe,K))((0,J.Xf)(H(Ne,Fe))),Ge):("number"==typeof X&&(Ge=X),(0,k.e)((Ne,Fe)=>function ge(H,X,Ge,Ne,Fe,Be,K,re){const he=[];let we=0,me=0,Ue=!1;const Ce=()=>{Ue&&!he.length&&!we&&X.complete()},rt=pt=>we<Ne?Ke(pt):he.push(pt),Ke=pt=>{Be&&X.next(pt),we++;let Q=!1;(0,J.Xf)(Ge(pt,me++)).subscribe(new ie.Q(X,ae=>{null==Fe||Fe(ae),Be?rt(ae):X.next(ae)},()=>{Q=!0},void 0,()=>{if(Q)try{for(we--;he.length&&we<Ne;){const ae=he.shift();K?(0,le.f)(X,K,()=>Ke(ae)):Ke(ae)}Ce()}catch(ae){X.error(ae)}}))};return H.subscribe(new ie.Q(X,rt,()=>{Ue=!0,Ce()})),()=>{null==re||re()}}(Ne,Fe,H,Ge)))}var ye=L(4671);function $(H=1/0){return de(ye.y,H)}},5363:(it,be,L)=>{"use strict";L.d(be,{Q:()=>le});var _=L(9672),J=L(4482),k=L(5403);function le(ie,ge=0){return(0,J.e)((oe,de)=>{oe.subscribe(new k.Q(de,ye=>(0,_.f)(de,ie,()=>de.next(ye),ge),()=>(0,_.f)(de,ie,()=>de.complete(),ge),ye=>(0,_.f)(de,ie,()=>de.error(ye),ge)))})}},3099:(it,be,L)=>{"use strict";L.d(be,{B:()=>ge});var _=L(8996),J=L(5698),k=L(7579),le=L(930),ie=L(4482);function ge(de={}){const{connector:ye=(()=>new k.x),resetOnError:$=!0,resetOnComplete:H=!0,resetOnRefCountZero:X=!0}=de;return Ge=>{let Ne=null,Fe=null,Be=null,K=0,re=!1,he=!1;const we=()=>{null==Fe||Fe.unsubscribe(),Fe=null},me=()=>{we(),Ne=Be=null,re=he=!1},Ue=()=>{const Ce=Ne;me(),null==Ce||Ce.unsubscribe()};return(0,ie.e)((Ce,rt)=>{K++,!he&&!re&&we();const Ke=Be=null!=Be?Be:ye();rt.add(()=>{K--,0===K&&!he&&!re&&(Fe=oe(Ue,X))}),Ke.subscribe(rt),Ne||(Ne=new le.Hp({next:pt=>Ke.next(pt),error:pt=>{he=!0,we(),Fe=oe(me,$,pt),Ke.error(pt)},complete:()=>{re=!0,we(),Fe=oe(me,H),Ke.complete()}}),(0,_.D)(Ce).subscribe(Ne))})(Ge)}}function oe(de,ye,...$){return!0===ye?(de(),null):!1===ye?null:ye(...$).pipe((0,J.q)(1)).subscribe(()=>de())}},9468:(it,be,L)=>{"use strict";L.d(be,{R:()=>J});var _=L(4482);function J(k,le=0){return(0,_.e)((ie,ge)=>{ge.add(k.schedule(()=>ie.subscribe(ge),le))})}},5698:(it,be,L)=>{"use strict";L.d(be,{q:()=>le});var _=L(515),J=L(4482),k=L(5403);function le(ie){return ie<=0?()=>_.E:(0,J.e)((ge,oe)=>{let de=0;ge.subscribe(new k.Q(oe,ye=>{++de<=ie&&(oe.next(ye),ie<=de&&oe.complete())}))})}},4408:(it,be,L)=>{"use strict";L.d(be,{o:()=>ie});var _=L(727);class J extends _.w0{constructor(oe,de){super()}schedule(oe,de=0){return this}}const k={setInterval(...ge){const{delegate:oe}=k;return((null==oe?void 0:oe.setInterval)||setInterval)(...ge)},clearInterval(ge){const{delegate:oe}=k;return((null==oe?void 0:oe.clearInterval)||clearInterval)(ge)},delegate:void 0};var le=L(8737);class ie extends J{constructor(oe,de){super(oe,de),this.scheduler=oe,this.work=de,this.pending=!1}schedule(oe,de=0){if(this.closed)return this;this.state=oe;const ye=this.id,$=this.scheduler;return null!=ye&&(this.id=this.recycleAsyncId($,ye,de)),this.pending=!0,this.delay=de,this.id=this.id||this.requestAsyncId($,this.id,de),this}requestAsyncId(oe,de,ye=0){return k.setInterval(oe.flush.bind(oe,this),ye)}recycleAsyncId(oe,de,ye=0){if(null!=ye&&this.delay===ye&&!1===this.pending)return de;k.clearInterval(de)}execute(oe,de){if(this.closed)return new Error("executing a cancelled action");this.pending=!1;const ye=this._execute(oe,de);if(ye)return ye;!1===this.pending&&null!=this.id&&(this.id=this.recycleAsyncId(this.scheduler,this.id,null))}_execute(oe,de){let $,ye=!1;try{this.work(oe)}catch(H){ye=!0,$=H||new Error("Scheduled action threw falsy error")}if(ye)return this.unsubscribe(),$}unsubscribe(){if(!this.closed){const{id:oe,scheduler:de}=this,{actions:ye}=de;this.work=this.state=this.scheduler=null,this.pending=!1,(0,le.P)(ye,this),null!=oe&&(this.id=this.recycleAsyncId(de,oe,null)),this.delay=null,super.unsubscribe()}}}},7565:(it,be,L)=>{"use strict";L.d(be,{v:()=>k});var _=L(6063);class J{constructor(ie,ge=J.now){this.schedulerActionCtor=ie,this.now=ge}schedule(ie,ge=0,oe){return new this.schedulerActionCtor(this,ie).schedule(oe,ge)}}J.now=_.l.now;class k extends J{constructor(ie,ge=J.now){super(ie,ge),this.actions=[],this._active=!1,this._scheduled=void 0}flush(ie){const{actions:ge}=this;if(this._active)return void ge.push(ie);let oe;this._active=!0;do{if(oe=ie.execute(ie.state,ie.delay))break}while(ie=ge.shift());if(this._active=!1,oe){for(;ie=ge.shift();)ie.unsubscribe();throw oe}}}},4986:(it,be,L)=>{"use strict";L.d(be,{z:()=>k});var _=L(4408);const k=new(L(7565).v)(_.o)},6063:(it,be,L)=>{"use strict";L.d(be,{l:()=>_});const _={now:()=>(_.delegate||Date).now(),delegate:void 0}},3410:(it,be,L)=>{"use strict";L.d(be,{z:()=>_});const _={setTimeout(...J){const{delegate:k}=_;return((null==k?void 0:k.setTimeout)||setTimeout)(...J)},clearTimeout(J){const{delegate:k}=_;return((null==k?void 0:k.clearTimeout)||clearTimeout)(J)},delegate:void 0}},2202:(it,be,L)=>{"use strict";L.d(be,{h:()=>J});const J=function _(){return"function"==typeof Symbol&&Symbol.iterator?Symbol.iterator:"@@iterator"}()},8822:(it,be,L)=>{"use strict";L.d(be,{L:()=>_});const _="function"==typeof Symbol&&Symbol.observable||"@@observable"},7669:(it,be,L)=>{"use strict";L.d(be,{_6:()=>ge,jO:()=>le,yG:()=>ie});var _=L(576);function k(oe){return oe[oe.length-1]}function le(oe){return(0,_.m)(k(oe))?oe.pop():void 0}function ie(oe){return function J(oe){return oe&&(0,_.m)(oe.schedule)}(k(oe))?oe.pop():void 0}function ge(oe,de){return"number"==typeof k(oe)?oe.pop():de}},8737:(it,be,L)=>{"use strict";function _(J,k){if(J){const le=J.indexOf(k);0<=le&&J.splice(le,1)}}L.d(be,{P:()=>_})},3888:(it,be,L)=>{"use strict";function _(J){const le=J(ie=>{Error.call(ie),ie.stack=(new Error).stack});return le.prototype=Object.create(Error.prototype),le.prototype.constructor=le,le}L.d(be,{d:()=>_})},2806:(it,be,L)=>{"use strict";L.d(be,{x:()=>k,O:()=>le});var _=L(2416);let J=null;function k(ie){if(_.v.useDeprecatedSynchronousErrorHandling){const ge=!J;if(ge&&(J={errorThrown:!1,error:null}),ie(),ge){const{errorThrown:oe,error:de}=J;if(J=null,oe)throw de}}else ie()}function le(ie){_.v.useDeprecatedSynchronousErrorHandling&&J&&(J.errorThrown=!0,J.error=ie)}},9672:(it,be,L)=>{"use strict";function _(J,k,le,ie=0,ge=!1){const oe=k.schedule(function(){le(),ge?J.add(this.schedule(null,ie)):this.unsubscribe()},ie);if(J.add(oe),!ge)return oe}L.d(be,{f:()=>_})},4671:(it,be,L)=>{"use strict";function _(J){return J}L.d(be,{y:()=>_})},1144:(it,be,L)=>{"use strict";L.d(be,{z:()=>_});const _=J=>J&&"number"==typeof J.length&&"function"!=typeof J},2206:(it,be,L)=>{"use strict";L.d(be,{D:()=>J});var _=L(576);function J(k){return Symbol.asyncIterator&&(0,_.m)(null==k?void 0:k[Symbol.asyncIterator])}},576:(it,be,L)=>{"use strict";function _(J){return"function"==typeof J}L.d(be,{m:()=>_})},3670:(it,be,L)=>{"use strict";L.d(be,{c:()=>k});var _=L(8822),J=L(576);function k(le){return(0,J.m)(le[_.L])}},6495:(it,be,L)=>{"use strict";L.d(be,{T:()=>k});var _=L(2202),J=L(576);function k(le){return(0,J.m)(null==le?void 0:le[_.h])}},8239:(it,be,L)=>{"use strict";L.d(be,{t:()=>J});var _=L(576);function J(k){return(0,_.m)(null==k?void 0:k.then)}},3260:(it,be,L)=>{"use strict";L.d(be,{Q:()=>k,L:()=>le});var _=L(5987),J=L(576);function k(ie){return(0,_.FC)(this,arguments,function*(){const oe=ie.getReader();try{for(;;){const{value:de,done:ye}=yield(0,_.qq)(oe.read());if(ye)return yield(0,_.qq)(void 0);yield yield(0,_.qq)(de)}}finally{oe.releaseLock()}})}function le(ie){return(0,J.m)(null==ie?void 0:ie.getReader)}},4482:(it,be,L)=>{"use strict";L.d(be,{e:()=>k});var _=L(576);function k(le){return ie=>{if(function J(le){return(0,_.m)(null==le?void 0:le.lift)}(ie))return ie.lift(function(ge){try{return le(ge,this)}catch(oe){this.error(oe)}});throw new TypeError("Unable to lift unknown Observable type")}}},5032:(it,be,L)=>{"use strict";function _(){}L.d(be,{Z:()=>_})},7849:(it,be,L)=>{"use strict";L.d(be,{h:()=>k});var _=L(2416),J=L(3410);function k(le){J.z.setTimeout(()=>{const{onUnhandledError:ie}=_.v;if(!ie)throw le;ie(le)})}},4532:(it,be,L)=>{"use strict";function _(J){return new TypeError(`You provided ${null!==J&&"object"==typeof J?"an invalid object":`'${J}'`} where a stream was expected. You can provide an Observable, Promise, ReadableStream, Array, AsyncIterable, or Iterable.`)}L.d(be,{z:()=>_})},5987:(it,be,L)=>{"use strict";function de(Q,ae,_e,Ee){return new(_e||(_e=Promise))(function(ce,Ct){function Ot(nt){try{st(Ee.next(nt))}catch(wr){Ct(wr)}}function Ln(nt){try{st(Ee.throw(nt))}catch(wr){Ct(wr)}}function st(nt){nt.done?ce(nt.value):function Re(ce){return ce instanceof _e?ce:new _e(function(Ct){Ct(ce)})}(nt.value).then(Ot,Ln)}st((Ee=Ee.apply(Q,ae||[])).next())})}function K(Q){return this instanceof K?(this.v=Q,this):new K(Q)}function re(Q,ae,_e){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var Re,Ee=_e.apply(Q,ae||[]),ce=[];return Re={},Ct("next"),Ct("throw"),Ct("return"),Re[Symbol.asyncIterator]=function(){return this},Re;function Ct(Jt){Ee[Jt]&&(Re[Jt]=function(mr){return new Promise(function($t,yi){ce.push([Jt,mr,$t,yi])>1||Ot(Jt,mr)})})}function Ot(Jt,mr){try{!function Ln(Jt){Jt.value instanceof K?Promise.resolve(Jt.value.v).then(st,nt):wr(ce[0][2],Jt)}(Ee[Jt](mr))}catch($t){wr(ce[0][3],$t)}}function st(Jt){Ot("next",Jt)}function nt(Jt){Ot("throw",Jt)}function wr(Jt,mr){Jt(mr),ce.shift(),ce.length&&Ot(ce[0][0],ce[0][1])}}function we(Q){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var _e,ae=Q[Symbol.asyncIterator];return ae?ae.call(Q):(Q=function X(Q){var ae="function"==typeof Symbol&&Symbol.iterator,_e=ae&&Q[ae],Ee=0;if(_e)return _e.call(Q);if(Q&&"number"==typeof Q.length)return{next:function(){return Q&&Ee>=Q.length&&(Q=void 0),{value:Q&&Q[Ee++],done:!Q}}};throw new TypeError(ae?"Object is not iterable.":"Symbol.iterator is not defined.")}(Q),_e={},Ee("next"),Ee("throw"),Ee("return"),_e[Symbol.asyncIterator]=function(){return this},_e);function Ee(ce){_e[ce]=Q[ce]&&function(Ct){return new Promise(function(Ot,Ln){!function Re(ce,Ct,Ot,Ln){Promise.resolve(Ln).then(function(st){ce({value:st,done:Ot})},Ct)}(Ot,Ln,(Ct=Q[ce](Ct)).done,Ct.value)})}}}L.d(be,{mG:()=>de,qq:()=>K,FC:()=>re,KL:()=>we})},5e3:(it,be,L)=>{"use strict";L.d(be,{AFp:()=>CC,ip1:()=>Jm,CZH:()=>dh,hGG:()=>WC,sBO:()=>LC,_Vd:()=>ap,EJc:()=>e_,SBq:()=>oh,qLn:()=>Lu,vpe:()=>du,OlP:()=>Yt,zs3:()=>Kr,ZZ4:()=>vp,aQg:()=>y_,soG:()=>fh,h0i:()=>bc,R0b:()=>Oi,FiY:()=>at,Lbi:()=>DC,g9A:()=>hh,Qsj:()=>UT,FYo:()=>GI,JOm:()=>ws,Rgc:()=>Ac,dDg:()=>RE,q4F:()=>eE,GfV:()=>km,s_b:()=>uh,ifc:()=>bt,eFA:()=>FE,G48:()=>FC,Gpc:()=>H,X6Q:()=>o_,_c5:()=>kA,VLi:()=>PE,zSh:()=>Ky,wAp:()=>mt,vHH:()=>Fe,cg1:()=>Cm,kL8:()=>_I,dqk:()=>ct,sIi:()=>Vf,CqO:()=>eh,QGY:()=>cm,F4k:()=>dm,RDi:()=>Zc,AaK:()=>de,qOj:()=>sv,TTD:()=>Ta,_Bn:()=>zv,xp6:()=>Ng,uIk:()=>rm,ekj:()=>mm,Xpm:()=>Bn,lG2:()=>mu,Yz7:()=>$t,cJS:()=>Vi,oAB:()=>Ps,Yjl:()=>to,Y36:()=>qf,_UZ:()=>Yf,qZA:()=>Zf,TgZ:()=>Iv,EpF:()=>Nw,n5z:()=>En,LFG:()=>D,$8M:()=>Xo,NdJ:()=>Ec,oxw:()=>hm,Q6J:()=>Kf,CHM:()=>Eu,YNc:()=>hv,_uU:()=>Xb,Oqu:()=>Ov});var _=L(7579),J=L(727),k=L(8306),le=L(6451),ie=L(3099);function ge(i){for(let s in i)if(i[s]===ge)return s;throw Error("Could not find renamed property on target object.")}function oe(i,s){for(const a in s)s.hasOwnProperty(a)&&!i.hasOwnProperty(a)&&(i[a]=s[a])}function de(i){if("string"==typeof i)return i;if(Array.isArray(i))return"["+i.map(de).join(", ")+"]";if(null==i)return""+i;if(i.overriddenName)return`${i.overriddenName}`;if(i.name)return`${i.name}`;const s=i.toString();if(null==s)return""+s;const a=s.indexOf("\n");return-1===a?s:s.substring(0,a)}function ye(i,s){return null==i||""===i?null===s?"":s:null==s||""===s?i:i+" "+s}const $=ge({__forward_ref__:ge});function H(i){return i.__forward_ref__=H,i.toString=function(){return de(this())},i}function X(i){return Ge(i)?i():i}function Ge(i){return"function"==typeof i&&i.hasOwnProperty($)&&i.__forward_ref__===H}class Fe extends Error{constructor(s,a){super(function Be(i,s){return`NG0${Math.abs(i)}${s?": "+s:""}`}(s,a)),this.code=s}}function K(i){return"string"==typeof i?i:null==i?"":String(i)}function re(i){return"function"==typeof i?i.name||i.toString():"object"==typeof i&&null!=i&&"function"==typeof i.type?i.type.name||i.type.toString():K(i)}function Ue(i,s){const a=s?` in ${s}`:"";throw new Fe(-201,`No provider for ${re(i)} found${a}`)}function st(i,s){null==i&&function nt(i,s,a,l){throw new Error(`ASSERTION ERROR: ${i}`+(null==l?"":` [Expected=> ${a} ${l} ${s} <=Actual]`))}(s,i,null,"!=")}function $t(i){return{token:i.token,providedIn:i.providedIn||null,factory:i.factory,value:void 0}}function Vi(i){return{providers:i.providers||[],imports:i.imports||[]}}function Dn(i){return vi(i,Ur)||vi(i,Ae)}function vi(i,s){return i.hasOwnProperty(s)?i[s]:null}function Xs(i){return i&&(i.hasOwnProperty(os)||i.hasOwnProperty(ur))?i[os]:null}const Ur=ge({\u0275prov:ge}),os=ge({\u0275inj:ge}),Ae=ge({ngInjectableDef:ge}),ur=ge({ngInjectorDef:ge});var et=(()=>((et=et||{})[et.Default=0]="Default",et[et.Host=1]="Host",et[et.Self=2]="Self",et[et.SkipSelf=4]="SkipSelf",et[et.Optional=8]="Optional",et))();let Xr;function Vn(i){const s=Xr;return Xr=i,s}function Rs(i,s,a){const l=Dn(i);return l&&"root"==l.providedIn?void 0===l.value?l.value=l.factory():l.value:a&et.Optional?null:void 0!==s?s:void Ue(de(i),"Injector")}function tt(i){return{toString:i}.toString()}var Dt=(()=>((Dt=Dt||{})[Dt.OnPush=0]="OnPush",Dt[Dt.Default=1]="Default",Dt))(),bt=(()=>{return(i=bt||(bt={}))[i.Emulated=0]="Emulated",i[i.None=2]="None",i[i.ShadowDom=3]="ShadowDom",bt;var i})();const Xe="undefined"!=typeof globalThis&&globalThis,ot="undefined"!=typeof window&&window,_l="undefined"!=typeof self&&"undefined"!=typeof WorkerGlobalScope&&self instanceof WorkerGlobalScope&&self,ct=Xe||"undefined"!=typeof global&&global||ot||_l,as={},B=[],G=ge({\u0275cmp:ge}),q=ge({\u0275dir:ge}),ve=ge({\u0275pipe:ge}),ee=ge({\u0275mod:ge}),je=ge({\u0275fac:ge}),gt=ge({__NG_ELEMENT_ID__:ge});let on=0;function Bn(i){return tt(()=>{const a={},l={type:i.type,providersResolver:null,decls:i.decls,vars:i.vars,factory:null,template:i.template||null,consts:i.consts||null,ngContentSelectors:i.ngContentSelectors,hostBindings:i.hostBindings||null,hostVars:i.hostVars||0,hostAttrs:i.hostAttrs||null,contentQueries:i.contentQueries||null,declaredInputs:a,inputs:null,outputs:null,exportAs:i.exportAs||null,onPush:i.changeDetection===Dt.OnPush,directiveDefs:null,pipeDefs:null,selectors:i.selectors||B,viewQuery:i.viewQuery||null,features:i.features||null,data:i.data||{},encapsulation:i.encapsulation||bt.Emulated,id:"c",styles:i.styles||B,_:null,setInput:null,schemas:i.schemas||null,tView:null},d=i.directives,p=i.features,y=i.pipes;return l.id+=on++,l.inputs=ko(i.inputs,a),l.outputs=ko(i.outputs),p&&p.forEach(w=>w(l)),l.directiveDefs=d?()=>("function"==typeof d?d():d).map(Dr):null,l.pipeDefs=y?()=>("function"==typeof y?y():y).map(xt):null,l})}function Dr(i){return Qn(i)||function Un(i){return i[q]||null}(i)}function xt(i){return function Bi(i){return i[ve]||null}(i)}const lr={};function Ps(i){return tt(()=>{const s={type:i.type,bootstrap:i.bootstrap||B,declarations:i.declarations||B,imports:i.imports||B,exports:i.exports||B,transitiveCompileScopes:null,schemas:i.schemas||null,id:i.id||null};return null!=i.id&&(lr[i.id]=i.type),s})}function ko(i,s){if(null==i)return as;const a={};for(const l in i)if(i.hasOwnProperty(l)){let d=i[l],p=d;Array.isArray(d)&&(p=d[1],d=d[0]),a[d]=l,s&&(s[d]=p)}return a}const mu=Bn;function to(i){return{type:i.type,name:i.name,factory:null,pure:!1!==i.pure,onDestroy:i.type.prototype.ngOnDestroy||null}}function Qn(i){return i[G]||null}function Jn(i,s){const a=i[ee]||null;if(!a&&!0===s)throw new Error(`Type ${de(i)} does not have '\u0275mod' property.`);return a}function Ii(i){return Array.isArray(i)&&"object"==typeof i[1]}function Ci(i){return Array.isArray(i)&&!0===i[1]}function Vc(i){return 0!=(8&i.flags)}function xn(i){return 2==(2&i.flags)}function us(i){return 1==(1&i.flags)}function Hi(i){return null!==i.template}function Bc(i){return 0!=(512&i[2])}function so(i,s){return i.hasOwnProperty(je)?i[je]:null}class _u{constructor(s,a,l){this.previousValue=s,this.currentValue=a,this.firstChange=l}isFirstChange(){return this.firstChange}}function Ta(){return oo}function oo(i){return i.type.prototype.ngOnChanges&&(i.setInput=ks),Aa}function Aa(){const i=zc(this),s=null==i?void 0:i.current;if(s){const a=i.previous;if(a===as)i.previous=s;else for(let l in s)a[l]=s[l];i.current=null,this.ngOnChanges(s)}}function ks(i,s,a,l){const d=zc(i)||function yr(i,s){return i[Sa]=s}(i,{previous:as,current:null}),p=d.current||(d.current={}),y=d.previous,w=this.declaredInputs[a],C=y[w];p[w]=new _u(C&&C.currentValue,s,y===as),i[l]=s}Ta.ngInherit=!0;const Sa="__ngSimpleChanges__";function zc(i){return i[Sa]||null}let yu;function Zc(i){yu=i}function Wt(i){return!!i.listen}const Fs={createRenderer:(i,s)=>function Yc(){return void 0!==yu?yu:"undefined"!=typeof document?document:void 0}()};function en(i){for(;Array.isArray(i);)i=i[0];return i}function $n(i,s){return en(s[i])}function Mn(i,s){return en(s[i.index])}function jo(i,s){return i.data[s]}function Tr(i,s){const a=s[i];return Ii(a)?a:a[0]}function $i(i){return 128==(128&i[2])}function Ar(i,s){return null==s?null:i[s]}function Ls(i){i[18]=0}function Ho(i,s){i[5]+=s;let a=i,l=i[3];for(;null!==l&&(1===s&&1===a[5]||-1===s&&0===a[5]);)l[5]+=s,a=l,l=l[3]}const dt={lFrame:La(null),bindingsEnabled:!0,isInCheckNoChangesMode:!1};function $o(){return dt.bindingsEnabled}function Te(){return dt.lFrame.lView}function At(){return dt.lFrame.tView}function Eu(i){return dt.lFrame.contextLView=i,i[8]}function tn(){let i=ao();for(;null!==i&&64===i.type;)i=i.parent;return i}function ao(){return dt.lFrame.currentTNode}function $r(i,s){const a=dt.lFrame;a.currentTNode=i,a.isParent=s}function cs(){return dt.lFrame.isParent}function Wo(){return dt.isInCheckNoChangesMode}function Ra(i){dt.isInCheckNoChangesMode=i}function ds(){return dt.lFrame.bindingIndex++}function bu(i,s){const a=dt.lFrame;a.bindingIndex=a.bindingRootIndex=i,zo(s)}function zo(i){dt.lFrame.currentDirectiveIndex=i}function Fa(i){dt.lFrame.currentQueryIndex=i}function Tl(i){const s=i[1];return 2===s.type?s.declTNode:1===s.type?i[6]:null}function Al(i,s,a){if(a&et.SkipSelf){let d=s,p=i;for(;!(d=d.parent,null!==d||a&et.Host||(d=Tl(p),null===d||(p=p[15],10&d.type))););if(null===d)return!1;s=d,i=p}const l=dt.lFrame=Xc();return l.currentTNode=s,l.lView=i,!0}function Ko(i){const s=Xc(),a=i[1];dt.lFrame=s,s.currentTNode=a.firstChild,s.lView=i,s.tView=a,s.contextLView=i,s.bindingIndex=a.bindingStartIndex,s.inI18n=!1}function Xc(){const i=dt.lFrame,s=null===i?null:i.child;return null===s?La(i):s}function La(i){const s={currentTNode:null,isParent:!0,lView:null,tView:null,selectedIndex:-1,contextLView:null,elementDepthCount:0,currentNamespace:null,currentDirectiveIndex:-1,bindingRootIndex:-1,bindingIndex:-1,currentQueryIndex:0,parent:i,child:null,inI18n:!1};return null!==i&&(i.child=s),s}function Sl(){const i=dt.lFrame;return dt.lFrame=i.parent,i.currentTNode=null,i.lView=null,i}const Va=Sl;function Tu(){const i=Sl();i.isParent=!0,i.tView=null,i.selectedIndex=-1,i.contextLView=null,i.elementDepthCount=0,i.currentDirectiveIndex=-1,i.currentNamespace=null,i.bindingRootIndex=-1,i.bindingIndex=-1,i.currentQueryIndex=0}function er(){return dt.lFrame.selectedIndex}function Nn(i){dt.lFrame.selectedIndex=i}function _n(){const i=dt.lFrame;return jo(i.tView,i.selectedIndex)}function Ml(i,s){for(let a=s.directiveStart,l=s.directiveEnd;a<l;a++){const p=i.data[a].type.prototype,{ngAfterContentInit:y,ngAfterContentChecked:w,ngAfterViewInit:C,ngAfterViewChecked:A,ngOnDestroy:N}=p;y&&(i.contentHooks||(i.contentHooks=[])).push(-a,y),w&&((i.contentHooks||(i.contentHooks=[])).push(a,w),(i.contentCheckHooks||(i.contentCheckHooks=[])).push(a,w)),C&&(i.viewHooks||(i.viewHooks=[])).push(-a,C),A&&((i.viewHooks||(i.viewHooks=[])).push(a,A),(i.viewCheckHooks||(i.viewCheckHooks=[])).push(a,A)),null!=N&&(i.destroyHooks||(i.destroyHooks=[])).push(a,N)}}function Bs(i,s,a){jh(i,s,3,a)}function Au(i,s,a,l){(3&i[2])===a&&jh(i,s,a,l)}function Su(i,s){let a=i[2];(3&a)===s&&(a&=2047,a+=1,i[2]=a)}function jh(i,s,a,l){const p=null!=l?l:-1,y=s.length-1;let w=0;for(let C=void 0!==l?65535&i[18]:0;C<y;C++)if("number"==typeof s[C+1]){if(w=s[C],null!=l&&w>=l)break}else s[C]<0&&(i[18]+=65536),(w<p||-1==p)&&(nd(i,a,s,C),i[18]=(4294901760&i[18])+C+2),C++}function nd(i,s,a,l){const d=a[l]<0,p=a[l+1],w=i[d?-a[l]:a[l]];if(d){if(i[2]>>11<i[18]>>16&&(3&i[2])===s){i[2]+=2048;try{p.call(w)}finally{}}}else try{p.call(w)}finally{}}class yn{constructor(s,a,l){this.factory=s,this.resolving=!1,this.canSeeViewProviders=a,this.injectImpl=l}}function Nl(i,s,a){const l=Wt(i);let d=0;for(;d<a.length;){const p=a[d];if("number"==typeof p){if(0!==p)break;d++;const y=a[d++],w=a[d++],C=a[d++];l?i.setAttribute(s,w,C,y):s.setAttributeNS(y,w,C)}else{const y=p,w=a[++d];uo(y)?l&&i.setProperty(s,y,w):l?i.setAttribute(s,y,w):s.setAttribute(y,w),d++}}return d}function Wi(i){return 3===i||4===i||6===i}function uo(i){return 64===i.charCodeAt(0)}function cr(i,s){if(null!==s&&0!==s.length)if(null===i||0===i.length)i=s.slice();else{let a=-1;for(let l=0;l<s.length;l++){const d=s[l];"number"==typeof d?a=d:0===a||Gh(i,a,d,null,-1===a||2===a?s[++l]:null)}}return i}function Gh(i,s,a,l,d){let p=0,y=i.length;if(-1===s)y=-1;else for(;p<i.length;){const w=i[p++];if("number"==typeof w){if(w===s){y=-1;break}if(w>s){y=p-1;break}}}for(;p<i.length;){const w=i[p];if("number"==typeof w)break;if(w===a){if(null===l)return void(null!==d&&(i[p+1]=d));if(l===i[p+1])return void(i[p+2]=d)}p++,null!==l&&p++,null!==d&&p++}-1!==y&&(i.splice(y,0,s),p=y+1),i.splice(p++,0,a),null!==l&&i.splice(p++,0,l),null!==d&&i.splice(p++,0,d)}function $h(i){return-1!==i}function Ha(i){return 32767&i}function Ga(i,s){let a=function Wh(i){return i>>16}(i),l=s;for(;a>0;)l=l[15],a--;return l}let Mu=!0;function fs(i){const s=Mu;return Mu=i,s}let Rl=0;function Wa(i,s){const a=Zo(i,s);if(-1!==a)return a;const l=s[1];l.firstCreatePass&&(i.injectorIndex=s.length,Pl(l.data,i),Pl(s,null),Pl(l.blueprint,null));const d=Sr(i,s),p=i.injectorIndex;if($h(d)){const y=Ha(d),w=Ga(d,s),C=w[1].data;for(let A=0;A<8;A++)s[p+A]=w[y+A]|C[y+A]}return s[p+8]=d,p}function Pl(i,s){i.push(0,0,0,0,0,0,0,0,s)}function Zo(i,s){return-1===i.injectorIndex||i.parent&&i.parent.injectorIndex===i.injectorIndex||null===s[i.injectorIndex+8]?-1:i.injectorIndex}function Sr(i,s){if(i.parent&&-1!==i.parent.injectorIndex)return i.parent.injectorIndex;let a=0,l=null,d=s;for(;null!==d;){const p=d[1],y=p.type;if(l=2===y?p.declTNode:1===y?d[6]:null,null===l)return-1;if(a++,d=d[15],-1!==l.injectorIndex)return l.injectorIndex|a<<16}return-1}function qr(i,s,a){!function qh(i,s,a){let l;"string"==typeof a?l=a.charCodeAt(0)||0:a.hasOwnProperty(gt)&&(l=a[gt]),null==l&&(l=a[gt]=Rl++);const d=255&l;s.data[i+(d>>5)]|=1<<d}(i,s,a)}function Nu(i,s,a){if(a&et.Optional)return i;Ue(s,"NodeInjector")}function qi(i,s,a,l){if(a&et.Optional&&void 0===l&&(l=null),0==(a&(et.Self|et.Host))){const d=i[9],p=Vn(void 0);try{return d?d.get(s,l,a&et.Optional):Rs(s,l,a&et.Optional)}finally{Vn(p)}}return Nu(l,s,a)}function Ol(i,s,a,l=et.Default,d){if(null!==i){const p=function zi(i){if("string"==typeof i)return i.charCodeAt(0)||0;const s=i.hasOwnProperty(gt)?i[gt]:void 0;return"number"==typeof s?s>=0?255&s:Qo:s}(a);if("function"==typeof p){if(!Al(s,i,l))return l&et.Host?Nu(d,a,l):qi(s,a,l,d);try{const y=p(l);if(null!=y||l&et.Optional)return y;Ue(a)}finally{Va()}}else if("number"==typeof p){let y=null,w=Zo(i,s),C=-1,A=l&et.Host?s[16][6]:null;for((-1===w||l&et.SkipSelf)&&(C=-1===w?Sr(i,s):s[w+8],-1!==C&&za(l,!1)?(y=s[1],w=Ha(C),s=Ga(C,s)):w=-1);-1!==w;){const N=s[1];if(zh(p,w,N.data)){const O=ei(w,s,a,y,l,A);if(O!==kl)return O}C=s[w+8],-1!==C&&za(l,s[1].data[w+8]===A)&&zh(p,w,s)?(y=N,w=Ha(C),s=Ga(C,s)):w=-1}}}return qi(s,a,l,d)}const kl={};function Qo(){return new lo(tn(),Te())}function ei(i,s,a,l,d,p){const y=s[1],w=y.data[i+8],N=function qa(i,s,a,l,d){const p=i.providerIndexes,y=s.data,w=1048575&p,C=i.directiveStart,N=p>>20,j=d?w+N:i.directiveEnd;for(let Z=l?w:w+N;Z<j;Z++){const se=y[Z];if(Z<C&&a===se||Z>=C&&se.type===a)return Z}if(d){const Z=y[C];if(Z&&Hi(Z)&&Z.type===a)return C}return null}(w,y,a,null==l?xn(w)&&Mu:l!=y&&0!=(3&w.type),d&et.Host&&p===w);return null!==N?Vt(s,y,N,w):kl}function Vt(i,s,a,l){let d=i[a];const p=s.data;if(function Hh(i){return i instanceof yn}(d)){const y=d;y.resolving&&function he(i,s){const a=s?`. Dependency path: ${s.join(" > ")} > ${i}`:"";throw new Fe(-200,`Circular dependency in DI detected for ${i}${a}`)}(re(p[a]));const w=fs(y.canSeeViewProviders);y.resolving=!0;const C=y.injectImpl?Vn(y.injectImpl):null;Al(i,l,et.Default);try{d=i[a]=y.factory(void 0,p,i,l),s.firstCreatePass&&a>=l.directiveStart&&function Uh(i,s,a){const{ngOnChanges:l,ngOnInit:d,ngDoCheck:p}=s.type.prototype;if(l){const y=oo(s);(a.preOrderHooks||(a.preOrderHooks=[])).push(i,y),(a.preOrderCheckHooks||(a.preOrderCheckHooks=[])).push(i,y)}d&&(a.preOrderHooks||(a.preOrderHooks=[])).push(0-i,d),p&&((a.preOrderHooks||(a.preOrderHooks=[])).push(i,p),(a.preOrderCheckHooks||(a.preOrderCheckHooks=[])).push(i,p))}(a,p[a],s)}finally{null!==C&&Vn(C),fs(w),y.resolving=!1,Va()}}return d}function zh(i,s,a){return!!(a[s+(i>>5)]&1<<i)}function za(i,s){return!(i&et.Self||i&et.Host&&s)}class lo{constructor(s,a){this._tNode=s,this._lView=a}get(s,a,l){return Ol(this._tNode,this._lView,s,l,a)}}function En(i){return tt(()=>{const s=i.prototype.constructor,a=s[je]||Jo(s),l=Object.prototype;let d=Object.getPrototypeOf(i.prototype).constructor;for(;d&&d!==l;){const p=d[je]||Jo(d);if(p&&p!==a)return p;d=Object.getPrototypeOf(d)}return p=>new p})}function Jo(i){return Ge(i)?()=>{const s=Jo(X(i));return s&&s()}:so(i)}function Xo(i){return function Yo(i,s){if("class"===s)return i.classes;if("style"===s)return i.styles;const a=i.attrs;if(a){const l=a.length;let d=0;for(;d<l;){const p=a[d];if(Wi(p))break;if(0===p)d+=2;else if("number"==typeof p)for(d++;d<l&&"string"==typeof a[d];)d++;else{if(p===s)return a[d+1];d+=2}}}return null}(tn(),i)}const gs="__parameters__";function co(i,s,a){return tt(()=>{const l=function Ki(i){return function(...a){if(i){const l=i(...a);for(const d in l)this[d]=l[d]}}}(s);function d(...p){if(this instanceof d)return l.apply(this,p),this;const y=new d(...p);return w.annotation=y,w;function w(C,A,N){const O=C.hasOwnProperty(gs)?C[gs]:Object.defineProperty(C,gs,{value:[]})[gs];for(;O.length<=N;)O.push(null);return(O[N]=O[N]||[]).push(y),C}}return a&&(d.prototype=Object.create(a.prototype)),d.prototype.ngMetadataName=i,d.annotationCls=d,d})}class Yt{constructor(s,a){this._desc=s,this.ngMetadataName="InjectionToken",this.\u0275prov=void 0,"number"==typeof a?this.__NG_ELEMENT_ID__=a:void 0!==a&&(this.\u0275prov=$t({token:this,providedIn:a.providedIn||"root",factory:a.factory}))}toString(){return`InjectionToken ${this._desc}`}}function an(i,s){i.forEach(a=>Array.isArray(a)?an(a,s):s(a))}function Ul(i,s,a){s>=i.length?i.push(a):i.splice(s,0,a)}function Ru(i,s){return s>=i.length-1?i.pop():i.splice(s,1)[0]}function tr(i,s,a){let l=ho(i,s);return l>=0?i[1|l]=a:(l=~l,function ta(i,s,a,l){let d=i.length;if(d==s)i.push(a,l);else if(1===d)i.push(l,i[0]),i[0]=a;else{for(d--,i.push(i[d-1],i[d]);d>s;)i[d]=i[d-2],d--;i[s]=a,i[s+1]=l}}(i,l,s,a)),l}function Ou(i,s){const a=ho(i,s);if(a>=0)return i[1|a]}function ho(i,s){return function Gl(i,s,a){let l=0,d=i.length>>a;for(;d!==l;){const p=l+(d-l>>1),y=i[p<<a];if(s===y)return p<<a;y>s?d=p:l=p+1}return~(d<<a)}(i,s,1)}const Zi={},na="__NG_DI_FLAG__",ti="ngTempTokenPath",ni=/\n/gm,ql="__source",fo=ge({provide:String,useValue:ge});let xi;function Qa(i){const s=xi;return xi=i,s}function ug(i,s=et.Default){if(void 0===xi)throw new Fe(203,"");return null===xi?Rs(i,void 0,s):xi.get(i,s&et.Optional?null:void 0,s)}function D(i,s=et.Default){return(function Ut(){return Xr}()||ug)(X(i),s)}function V(i){const s=[];for(let a=0;a<i.length;a++){const l=X(i[a]);if(Array.isArray(l)){if(0===l.length)throw new Fe(900,"");let d,p=et.Default;for(let y=0;y<l.length;y++){const w=l[y],C=ne(w);"number"==typeof C?-1===C?d=w.token:p|=C:d=w}s.push(D(d,p))}else s.push(D(l))}return s}function z(i,s){return i[na]=s,i.prototype[na]=s,i}function ne(i){return i[na]}const ke=z(co("Inject",i=>({token:i})),-1),at=z(co("Optional"),8),ln=z(co("SkipSelf"),4);const yy="__ngContext__";function hr(i,s){i[yy]=s}function bd(i){const s=function Pn(i){return i[yy]||null}(i);return s?Array.isArray(s)?s:s.lView:null}function pf(i){return i.ngOriginalError}function gf(i,...s){i.error(...s)}class Lu{constructor(){this._console=console}handleError(s){const a=this._findOriginalError(s),l=function vn(i){return i&&i.ngErrorLogger||gf}(s);l(this._console,"ERROR",s),a&&l(this._console,"ORIGINAL ERROR",a)}_findOriginalError(s){let a=s&&pf(s);for(;a&&pf(a);)a=pf(a);return a||null}}const Md=(()=>("undefined"!=typeof requestAnimationFrame&&requestAnimationFrame||setTimeout).bind(ct))();function Es(i){return i instanceof Function?i():i}var ws=(()=>((ws=ws||{})[ws.Important=1]="Important",ws[ws.DashCase=2]="DashCase",ws))();function ua(i,s){return undefined(i,s)}function rr(i){const s=i[3];return Ci(s)?s[3]:s}function ic(i){return Cs(i[13])}function Mi(i){return Cs(i[4])}function Cs(i){for(;null!==i&&!Ci(i);)i=i[4];return i}function qs(i,s,a,l,d){if(null!=l){let p,y=!1;Ci(l)?p=l:Ii(l)&&(y=!0,l=l[0]);const w=en(l);0===i&&null!==a?null==d?Ye(s,a,w):ze(s,a,w,d||null,!0):1===i&&null!==a?ze(s,a,w,d||null,!0):2===i?function ju(i,s,a){const l=es(i,s);l&&function ir(i,s,a,l){Wt(i)?i.removeChild(s,a,l):s.removeChild(a)}(i,l,s,a)}(s,w,y):3===i&&s.destroyNode(w),null!=p&&function k0(i,s,a,l,d){const p=a[7];p!==en(a)&&qs(s,i,l,p,d);for(let w=10;w<a.length;w++){const C=a[w];cc(C[1],C,i,s,l,p)}}(s,i,p,a,d)}}function Sn(i,s,a){return Wt(i)?i.createElement(s,a):null===a?i.createElement(s):i.createElementNS(a,s)}function f(i,s){const a=i[9],l=a.indexOf(s),d=s[3];1024&s[2]&&(s[2]&=-1025,Ho(d,-1)),a.splice(l,1)}function v(i,s){if(i.length<=10)return;const a=10+s,l=i[a];if(l){const d=l[17];null!==d&&d!==i&&f(d,l),s>0&&(i[a-1][4]=l[4]);const p=Ru(i,10+s);!function xg(i,s){cc(i,s,s[11],2,null,null),s[0]=null,s[6]=null}(l[1],l);const y=p[19];null!==y&&y.detachView(p[1]),l[3]=null,l[4]=null,l[2]&=-129}return l}function b(i,s){if(!(256&s[2])){const a=s[11];Wt(a)&&a.destroyNode&&cc(i,s,a,3,null,null),function Dy(i){let s=i[13];if(!s)return x(i[1],i);for(;s;){let a=null;if(Ii(s))a=s[13];else{const l=s[10];l&&(a=l)}if(!a){for(;s&&!s[4]&&s!==i;)Ii(s)&&x(s[1],s),s=s[3];null===s&&(s=i),Ii(s)&&x(s[1],s),a=s&&s[4]}s=a}}(s)}}function x(i,s){if(!(256&s[2])){s[2]&=-129,s[2]|=256,function te(i,s){let a;if(null!=i&&null!=(a=i.destroyHooks))for(let l=0;l<a.length;l+=2){const d=s[a[l]];if(!(d instanceof yn)){const p=a[l+1];if(Array.isArray(p))for(let y=0;y<p.length;y+=2){const w=d[p[y]],C=p[y+1];try{C.call(w)}finally{}}else try{p.call(d)}finally{}}}}(i,s),function U(i,s){const a=i.cleanup,l=s[7];let d=-1;if(null!==a)for(let p=0;p<a.length-1;p+=2)if("string"==typeof a[p]){const y=a[p+1],w="function"==typeof y?y(s):en(s[y]),C=l[d=a[p+2]],A=a[p+3];"boolean"==typeof A?w.removeEventListener(a[p],C,A):A>=0?l[d=A]():l[d=-A].unsubscribe(),p+=2}else{const y=l[d=a[p+1]];a[p].call(y)}if(null!==l){for(let p=d+1;p<l.length;p++)l[p]();s[7]=null}}(i,s),1===s[1].type&&Wt(s[11])&&s[11].destroy();const a=s[17];if(null!==a&&Ci(s[3])){a!==s[3]&&f(a,s);const l=s[19];null!==l&&l.detachView(i)}}}function Pe(i,s,a){return function Se(i,s,a){let l=s;for(;null!==l&&40&l.type;)l=(s=l).parent;if(null===l)return a[0];if(2&l.flags){const d=i.data[l.directiveStart].encapsulation;if(d===bt.None||d===bt.Emulated)return null}return Mn(l,a)}(i,s.parent,a)}function ze(i,s,a,l,d){Wt(i)?i.insertBefore(s,a,l,d):s.insertBefore(a,l,d)}function Ye(i,s,a){Wt(i)?i.appendChild(s,a):s.appendChild(a)}function St(i,s,a,l,d){null!==l?ze(i,s,a,l,d):Ye(i,s,a)}function es(i,s){return Wt(i)?i.parentNode(s):s.parentNode}let uc=function Ef(i,s,a){return 40&i.type?Mn(i,a):null};function nu(i,s,a,l){const d=Pe(i,l,s),p=s[11],w=function ac(i,s,a){return uc(i,s,a)}(l.parent||s[6],l,s);if(null!=d)if(Array.isArray(a))for(let C=0;C<a.length;C++)St(p,d,a[C],w,!1);else St(p,d,a,w,!1)}function Uu(i,s){if(null!==s){const a=s.type;if(3&a)return Mn(s,i);if(4&a)return wf(-1,i[s.index]);if(8&a){const l=s.child;if(null!==l)return Uu(i,l);{const d=i[s.index];return Ci(d)?wf(-1,d):en(d)}}if(32&a)return ua(s,i)()||en(i[s.index]);{const l=Rd(i,s);return null!==l?Array.isArray(l)?l[0]:Uu(rr(i[16]),l):Uu(i,s.next)}}return null}function Rd(i,s){return null!==s?i[16][6].projection[s.projection]:null}function wf(i,s){const a=10+i+1;if(a<s.length){const l=s[a],d=l[1].firstChild;if(null!==d)return Uu(l,d)}return s[7]}function lc(i,s,a,l,d,p,y){for(;null!=a;){const w=l[a.index],C=a.type;if(y&&0===s&&(w&&hr(en(w),l),a.flags|=4),64!=(64&a.flags))if(8&C)lc(i,s,a.child,l,d,p,!1),qs(s,i,d,w,p);else if(32&C){const A=ua(a,l);let N;for(;N=A();)qs(s,i,d,N,p);qs(s,i,d,w,p)}else 16&C?O0(i,s,l,a,d,p):qs(s,i,d,w,p);a=y?a.projectionNext:a.next}}function cc(i,s,a,l,d,p){lc(a,l,i.firstChild,s,d,p,!1)}function O0(i,s,a,l,d,p){const y=a[16],C=y[6].projection[l.projection];if(Array.isArray(C))for(let A=0;A<C.length;A++)qs(s,i,d,C[A],p);else lc(i,s,C,y[3],d,p,!0)}function F0(i,s,a){Wt(i)?i.setAttribute(s,"style",a):s.style.cssText=a}function by(i,s,a){Wt(i)?""===a?i.removeAttribute(s,"class"):i.setAttribute(s,"class",a):s.className=a}function Ty(i,s,a){let l=i.length;for(;;){const d=i.indexOf(s,a);if(-1===d)return d;if(0===d||i.charCodeAt(d-1)<=32){const p=s.length;if(d+p===l||i.charCodeAt(d+p)<=32)return d}a=d+1}}const Ay="ng-template";function qD(i,s,a){let l=0;for(;l<i.length;){let d=i[l++];if(a&&"class"===d){if(d=i[l],-1!==Ty(d.toLowerCase(),s,0))return!0}else if(1===d){for(;l<i.length&&"string"==typeof(d=i[l++]);)if(d.toLowerCase()===s)return!0;return!1}}return!1}function L0(i){return 4===i.type&&i.value!==Ay}function zD(i,s,a){return s===(4!==i.type||a?i.value:Ay)}function KD(i,s,a){let l=4;const d=i.attrs||[],p=function YD(i){for(let s=0;s<i.length;s++)if(Wi(i[s]))return s;return i.length}(d);let y=!1;for(let w=0;w<s.length;w++){const C=s[w];if("number"!=typeof C){if(!y)if(4&l){if(l=2|1&l,""!==C&&!zD(i,C,a)||""===C&&1===s.length){if(mo(l))return!1;y=!0}}else{const A=8&l?C:s[++w];if(8&l&&null!==i.attrs){if(!qD(i.attrs,A,a)){if(mo(l))return!1;y=!0}continue}const O=V0(8&l?"class":C,d,L0(i),a);if(-1===O){if(mo(l))return!1;y=!0;continue}if(""!==A){let j;j=O>p?"":d[O+1].toLowerCase();const Z=8&l?j:null;if(Z&&-1!==Ty(Z,A,0)||2&l&&A!==j){if(mo(l))return!1;y=!0}}}}else{if(!y&&!mo(l)&&!mo(C))return!1;if(y&&mo(C))continue;y=!1,l=C|1&l}}return mo(l)||y}function mo(i){return 0==(1&i)}function V0(i,s,a,l){if(null===s)return-1;let d=0;if(l||!a){let p=!1;for(;d<s.length;){const y=s[d];if(y===i)return d;if(3===y||6===y)p=!0;else{if(1===y||2===y){let w=s[++d];for(;"string"==typeof w;)w=s[++d];continue}if(4===y)break;if(0===y){d+=4;continue}}d+=p?1:2}return-1}return function QD(i,s){let a=i.indexOf(4);if(a>-1)for(a++;a<i.length;){const l=i[a];if("number"==typeof l)return-1;if(l===s)return a;a++}return-1}(s,i)}function Sy(i,s,a=!1){for(let l=0;l<s.length;l++)if(KD(i,s[l],a))return!0;return!1}function Mg(i,s){return i?":not("+s.trim()+")":s}function JD(i){let s=i[0],a=1,l=2,d="",p=!1;for(;a<i.length;){let y=i[a];if("string"==typeof y)if(2&l){const w=i[++a];d+="["+y+(w.length>0?'="'+w+'"':"")+"]"}else 8&l?d+="."+y:4&l&&(d+=" "+y);else""!==d&&!mo(y)&&(s+=Mg(p,d),d=""),l=y,p=p||!mo(l);a++}return""!==d&&(s+=Mg(p,d)),s}const _t={};function Ng(i){B0(At(),Te(),er()+i,Wo())}function B0(i,s,a,l){if(!l)if(3==(3&s[2])){const p=i.preOrderCheckHooks;null!==p&&Bs(s,p,a)}else{const p=i.preOrderHooks;null!==p&&Au(s,p,0,a)}Nn(a)}function Rg(i,s){return i<<17|s<<2}function _o(i){return i>>17&32767}function xy(i){return 2|i}function ca(i){return(131068&i)>>2}function My(i,s){return-131069&i|s<<2}function Og(i){return 1|i}function Tf(i,s){const a=i.contentQueries;if(null!==a)for(let l=0;l<a.length;l+=2){const d=a[l],p=a[l+1];if(-1!==p){const y=i.data[p];Fa(d),y.contentQueries(2,s[p],p)}}}function Mr(i,s,a,l,d,p,y,w,C,A){const N=s.blueprint.slice();return N[0]=d,N[2]=140|l,Ls(N),N[3]=N[15]=i,N[8]=a,N[10]=y||i&&i[10],N[11]=w||i&&i[11],N[12]=C||i&&i[12]||null,N[9]=A||i&&i[9]||null,N[6]=p,N[16]=2==s.type?i[16]:N,N}function Fd(i,s,a,l,d){let p=i.data[s];if(null===p)p=function Af(i,s,a,l,d){const p=ao(),y=cs(),C=i.data[s]=function Ly(i,s,a,l,d,p){return{type:a,index:l,insertBeforeIndex:null,injectorIndex:s?s.injectorIndex:-1,directiveStart:-1,directiveEnd:-1,directiveStylingLast:-1,propertyBindings:null,flags:0,providerIndexes:0,value:d,attrs:p,mergedAttrs:null,localNames:null,initialInputs:void 0,inputs:null,outputs:null,tViews:null,next:null,projectionNext:null,child:null,parent:s,projection:null,styles:null,stylesWithoutHost:null,residualStyles:void 0,classes:null,classesWithoutHost:null,residualClasses:void 0,classBindings:0,styleBindings:0}}(0,y?p:p&&p.parent,a,s,l,d);return null===i.firstChild&&(i.firstChild=C),null!==p&&(y?null==p.child&&null!==C.parent&&(p.child=C):null===p.next&&(p.next=C)),C}(i,s,a,l,d),function Jc(){return dt.lFrame.inI18n}()&&(p.flags|=64);else if(64&p.type){p.type=a,p.value=l,p.attrs=d;const y=function Vs(){const i=dt.lFrame,s=i.currentTNode;return i.isParent?s:s.parent}();p.injectorIndex=null===y?-1:y.injectorIndex}return $r(p,!0),p}function $u(i,s,a,l){if(0===a)return-1;const d=s.length;for(let p=0;p<a;p++)s.push(l),i.blueprint.push(l),i.data.push(null);return d}function Sf(i,s,a){Ko(s);try{const l=i.viewQuery;null!==l&&zy(1,l,a);const d=i.template;null!==d&&Fy(i,s,d,1,a),i.firstCreatePass&&(i.firstCreatePass=!1),i.staticContentQueries&&Tf(i,s),i.staticViewQueries&&zy(2,i.viewQuery,a);const p=i.components;null!==p&&function ib(i,s){for(let a=0;a<s.length;a++)Kg(i,s[a])}(s,p)}catch(l){throw i.firstCreatePass&&(i.incompleteFirstPass=!0,i.firstCreatePass=!1),l}finally{s[2]&=-5,Tu()}}function hc(i,s,a,l){const d=s[2];if(256==(256&d))return;Ko(s);const p=Wo();try{Ls(s),function Du(i){return dt.lFrame.bindingIndex=i}(i.bindingStartIndex),null!==a&&Fy(i,s,a,2,l);const y=3==(3&d);if(!p)if(y){const A=i.preOrderCheckHooks;null!==A&&Bs(s,A,null)}else{const A=i.preOrderHooks;null!==A&&Au(s,A,0,null),Su(s,0)}if(function lb(i){for(let s=ic(i);null!==s;s=Mi(s)){if(!s[2])continue;const a=s[9];for(let l=0;l<a.length;l++){const d=a[l],p=d[3];0==(1024&d[2])&&Ho(p,1),d[2]|=1024}}}(s),function Gy(i){for(let s=ic(i);null!==s;s=Mi(s))for(let a=10;a<s.length;a++){const l=s[a],d=l[1];$i(l)&&hc(d,l,d.template,l[8])}}(s),null!==i.contentQueries&&Tf(i,s),!p)if(y){const A=i.contentCheckHooks;null!==A&&Bs(s,A)}else{const A=i.contentHooks;null!==A&&Au(s,A,1),Su(s,1)}!function da(i,s){const a=i.hostBindingOpCodes;if(null!==a)try{for(let l=0;l<a.length;l++){const d=a[l];if(d<0)Nn(~d);else{const p=d,y=a[++l],w=a[++l];bu(y,p),w(2,s[p])}}}finally{Nn(-1)}}(i,s);const w=i.components;null!==w&&function vo(i,s){for(let a=0;a<s.length;a++)$y(i,s[a])}(s,w);const C=i.viewQuery;if(null!==C&&zy(2,C,l),!p)if(y){const A=i.viewCheckHooks;null!==A&&Bs(s,A)}else{const A=i.viewHooks;null!==A&&Au(s,A,2),Su(s,2)}!0===i.firstUpdatePass&&(i.firstUpdatePass=!1),p||(s[2]&=-73),1024&s[2]&&(s[2]&=-1025,Ho(s[3],-1))}finally{Tu()}}function K0(i,s,a,l){const d=s[10],p=!Wo(),y=function Wn(i){return 4==(4&i[2])}(s);try{p&&!y&&d.begin&&d.begin(),y&&Sf(i,s,l),hc(i,s,a,l)}finally{p&&!y&&d.end&&d.end()}}function Fy(i,s,a,l,d){const p=er(),y=2&l;try{Nn(-1),y&&s.length>20&&B0(i,s,20,Wo()),a(l,d)}finally{Nn(p)}}function Hg(i,s,a){!$o()||(function J0(i,s,a,l){const d=a.directiveStart,p=a.directiveEnd;i.firstCreatePass||Wa(a,s),hr(l,s);const y=a.initialInputs;for(let w=d;w<p;w++){const C=i.data[w],A=Hi(C);A&&jy(s,a,C);const N=Vt(s,i,w,a);hr(N,s),null!==y&&zg(0,w-d,N,C,0,y),A&&(Tr(a.index,s)[8]=N)}}(i,s,a,Mn(a,s)),128==(128&a.flags)&&function ab(i,s,a){const l=a.directiveStart,d=a.directiveEnd,y=a.index,w=function Pa(){return dt.lFrame.currentDirectiveIndex}();try{Nn(y);for(let C=l;C<d;C++){const A=i.data[C],N=s[C];zo(C),(null!==A.hostBindings||0!==A.hostVars||null!==A.hostAttrs)&&By(A,N)}}finally{Nn(-1),zo(w)}}(i,s,a))}function Gg(i,s,a=Mn){const l=s.localNames;if(null!==l){let d=s.index+1;for(let p=0;p<l.length;p+=2){const y=l[p+1],w=-1===y?a(s,i):i[y];i[d++]=w}}}function Z0(i){const s=i.tView;return null===s||s.incompleteFirstPass?i.tView=$g(1,null,i.template,i.decls,i.vars,i.directiveDefs,i.pipeDefs,i.viewQuery,i.schemas,i.consts):s}function $g(i,s,a,l,d,p,y,w,C,A){const N=20+l,O=N+d,j=function sb(i,s){const a=[];for(let l=0;l<s;l++)a.push(l<i?null:_t);return a}(N,O),Z="function"==typeof A?A():A;return j[1]={type:i,blueprint:j,template:a,queries:null,viewQuery:w,declTNode:s,data:j.slice().fill(null,N),bindingStartIndex:N,expandoStartIndex:O,hostBindingOpCodes:null,firstCreatePass:!0,firstUpdatePass:!0,staticViewQueries:!1,staticContentQueries:!1,preOrderHooks:null,preOrderCheckHooks:null,contentHooks:null,contentCheckHooks:null,viewHooks:null,viewCheckHooks:null,destroyHooks:null,cleanup:null,contentQueries:null,components:null,directiveRegistry:"function"==typeof p?p():p,pipeRegistry:"function"==typeof y?y():y,firstChild:null,schemas:C,consts:Z,incompleteFirstPass:!1}}function pc(i,s,a){for(let l in i)if(i.hasOwnProperty(l)){const d=i[l];(a=null===a?{}:a).hasOwnProperty(l)?a[l].push(s,d):a[l]=[s,d]}return a}function Wu(i,s,a,l){let d=!1;if($o()){const p=function X0(i,s,a){const l=i.directiveRegistry;let d=null;if(l)for(let p=0;p<l.length;p++){const y=l[p];Sy(a,y.selectors,!1)&&(d||(d=[]),qr(Wa(a,s),i,y.type),Hi(y)?(Uy(i,a),d.unshift(y)):d.push(y))}return d}(i,s,a),y=null===l?null:{"":-1};if(null!==p){d=!0,Vd(a,i.data.length,p.length);for(let N=0;N<p.length;N++){const O=p[N];O.providersResolver&&O.providersResolver(O)}let w=!1,C=!1,A=$u(i,s,p.length,null);for(let N=0;N<p.length;N++){const O=p[N];a.mergedAttrs=cr(a.mergedAttrs,O.hostAttrs),ew(i,a,s,A,O),Rf(A,O,y),null!==O.contentQueries&&(a.flags|=8),(null!==O.hostBindings||null!==O.hostAttrs||0!==O.hostVars)&&(a.flags|=128);const j=O.type.prototype;!w&&(j.ngOnChanges||j.ngOnInit||j.ngDoCheck)&&((i.preOrderHooks||(i.preOrderHooks=[])).push(a.index),w=!0),!C&&(j.ngOnChanges||j.ngDoCheck)&&((i.preOrderCheckHooks||(i.preOrderCheckHooks=[])).push(a.index),C=!0),A++}!function ru(i,s){const l=s.directiveEnd,d=i.data,p=s.attrs,y=[];let w=null,C=null;for(let A=s.directiveStart;A<l;A++){const N=d[A],O=N.inputs,j=null===p||L0(s)?null:ub(O,p);y.push(j),w=pc(O,A,w),C=pc(N.outputs,A,C)}null!==w&&(w.hasOwnProperty("class")&&(s.flags|=16),w.hasOwnProperty("style")&&(s.flags|=32)),s.initialInputs=y,s.inputs=w,s.outputs=C}(i,a)}y&&function Ld(i,s,a){if(s){const l=i.localNames=[];for(let d=0;d<s.length;d+=2){const p=a[s[d+1]];if(null==p)throw new Fe(-301,`Export of name '${s[d+1]}' not found!`);l.push(s[d],p)}}}(a,l,y)}return a.mergedAttrs=cr(a.mergedAttrs,a.attrs),d}function qg(i,s,a,l,d,p){const y=p.hostBindings;if(y){let w=i.hostBindingOpCodes;null===w&&(w=i.hostBindingOpCodes=[]);const C=~s.index;(function Q0(i){let s=i.length;for(;s>0;){const a=i[--s];if("number"==typeof a&&a<0)return a}return 0})(w)!=C&&w.push(C),w.push(l,d,y)}}function By(i,s){null!==i.hostBindings&&i.hostBindings(1,s)}function Uy(i,s){s.flags|=2,(i.components||(i.components=[])).push(s.index)}function Rf(i,s,a){if(a){if(s.exportAs)for(let l=0;l<s.exportAs.length;l++)a[s.exportAs[l]]=i;Hi(s)&&(a[""]=i)}}function Vd(i,s,a){i.flags|=1,i.directiveStart=s,i.directiveEnd=s+a,i.providerIndexes=s}function ew(i,s,a,l,d){i.data[l]=d;const p=d.factory||(d.factory=so(d.type)),y=new yn(p,Hi(d),null);i.blueprint[l]=y,a[l]=y,qg(i,s,0,l,$u(i,a,d.hostVars,_t),d)}function jy(i,s,a){const l=Mn(s,i),d=Z0(a),p=i[10],y=Pf(i,Mr(i,d,null,a.onPush?64:16,l,s,p,p.createRenderer(l,a),null,null));i[s.index]=y}function ts(i,s,a,l,d,p){const y=Mn(i,s);!function Hy(i,s,a,l,d,p,y){if(null==p)Wt(i)?i.removeAttribute(s,d,a):s.removeAttribute(d);else{const w=null==y?K(p):y(p,l||"",d);Wt(i)?i.setAttribute(s,d,w,a):a?s.setAttributeNS(a,d,w):s.setAttribute(d,w)}}(s[11],y,p,i.value,a,l,d)}function zg(i,s,a,l,d,p){const y=p[s];if(null!==y){const w=l.setInput;for(let C=0;C<y.length;){const A=y[C++],N=y[C++],O=y[C++];null!==w?l.setInput(a,O,A,N):a[N]=O}}}function ub(i,s){let a=null,l=0;for(;l<s.length;){const d=s[l];if(0!==d)if(5!==d){if("number"==typeof d)break;i.hasOwnProperty(d)&&(null===a&&(a=[]),a.push(d,i[d],s[l+1])),l+=2}else l+=2;else l+=4}return a}function tw(i,s,a,l){return new Array(i,!0,!1,s,null,0,l,a,null,null)}function $y(i,s){const a=Tr(s,i);if($i(a)){const l=a[1];80&a[2]?hc(l,a,l.template,a[8]):a[5]>0&&Wy(a)}}function Wy(i){for(let l=ic(i);null!==l;l=Mi(l))for(let d=10;d<l.length;d++){const p=l[d];if(1024&p[2]){const y=p[1];hc(y,p,y.template,p[8])}else p[5]>0&&Wy(p)}const a=i[1].components;if(null!==a)for(let l=0;l<a.length;l++){const d=Tr(a[l],i);$i(d)&&d[5]>0&&Wy(d)}}function Kg(i,s){const a=Tr(s,i),l=a[1];(function nw(i,s){for(let a=s.length;a<i.blueprint.length;a++)s.push(i.blueprint[a])})(l,a),Sf(l,a,a[8])}function Pf(i,s){return i[13]?i[14][4]=s:i[13]=s,i[14]=s,s}function Bd(i){for(;i;){i[2]|=64;const s=rr(i);if(Bc(i)&&!s)return i;i=s}return null}function qu(i,s,a){const l=s[10];l.begin&&l.begin();try{hc(i,s,i.template,a)}catch(d){throw Yg(s,d),d}finally{l.end&&l.end()}}function Zg(i){!function Ud(i){for(let s=0;s<i.components.length;s++){const a=i.components[s],l=bd(a),d=l[1];K0(d,l,d.template,a)}}(i[8])}function zy(i,s,a){Fa(0),s(i,a)}const fb=(()=>Promise.resolve(null))();function rw(i){return i[7]||(i[7]=[])}function iw(i){return i.cleanup||(i.cleanup=[])}function Yg(i,s){const a=i[9],l=a?a.get(Lu,null):null;l&&l.handleError(s)}function Qg(i,s,a,l,d){for(let p=0;p<a.length;){const y=a[p++],w=a[p++],C=s[y],A=i.data[y];null!==A.setInput?A.setInput(C,d,l,w):C[w]=d}}function Eo(i,s,a){const l=$n(s,i);!function sc(i,s,a){Wt(i)?i.setValue(s,a):s.textContent=a}(i[11],l,a)}function gc(i,s,a){let l=a?i.styles:null,d=a?i.classes:null,p=0;if(null!==s)for(let y=0;y<s.length;y++){const w=s[y];"number"==typeof w?p=w:1==p?d=ye(d,w):2==p&&(l=ye(l,w+": "+s[++y]+";"))}a?i.styles=l:i.stylesWithoutHost=l,a?i.classes=d:i.classesWithoutHost=d}const ha=new Yt("INJECTOR",-1);class sw{get(s,a=Zi){if(a===Zi){const l=new Error(`NullInjectorError: No provider for ${de(s)}!`);throw l.name="NullInjectorError",l}return a}}const Ky=new Yt("Set Injector scope."),iu={},pb={};let Zy;function Ff(){return void 0===Zy&&(Zy=new sw),Zy}function jd(i,s=null,a=null,l){const d=Yy(i,s,a,l);return d._resolveInjectorDefTypes(),d}function Yy(i,s=null,a=null,l){return new Jg(i,a,s||Ff(),l)}class Jg{constructor(s,a,l,d=null){this.parent=l,this.records=new Map,this.injectorDefTypes=new Set,this.onDestroy=new Set,this._destroyed=!1;const p=[];a&&an(a,w=>this.processProvider(w,s,a)),an([s],w=>this.processInjectorType(w,[],p)),this.records.set(ha,si(void 0,this));const y=this.records.get(Ky);this.scope=null!=y?y.value:null,this.source=d||("object"==typeof s?null:de(s))}get destroyed(){return this._destroyed}destroy(){this.assertNotDestroyed(),this._destroyed=!0;try{this.onDestroy.forEach(s=>s.ngOnDestroy())}finally{this.records.clear(),this.onDestroy.clear(),this.injectorDefTypes.clear()}}get(s,a=Zi,l=et.Default){this.assertNotDestroyed();const d=Qa(this),p=Vn(void 0);try{if(!(l&et.SkipSelf)){let w=this.records.get(s);if(void 0===w){const C=function Xy(i){return"function"==typeof i||"object"==typeof i&&i instanceof Yt}(s)&&Dn(s);w=C&&this.injectableDefInScope(C)?si(su(s),iu):null,this.records.set(s,w)}if(null!=w)return this.hydrate(s,w)}return(l&et.Self?Ff():this.parent).get(s,a=l&et.Optional&&a===Zi?null:a)}catch(y){if("NullInjectorError"===y.name){if((y[ti]=y[ti]||[]).unshift(de(s)),d)throw y;return function De(i,s,a,l){const d=i[ti];throw s[ql]&&d.unshift(s[ql]),i.message=function $e(i,s,a,l=null){i=i&&"\n"===i.charAt(0)&&"\u0275"==i.charAt(1)?i.substr(2):i;let d=de(s);if(Array.isArray(s))d=s.map(de).join(" -> ");else if("object"==typeof s){let p=[];for(let y in s)if(s.hasOwnProperty(y)){let w=s[y];p.push(y+":"+("string"==typeof w?JSON.stringify(w):de(w)))}d=`{${p.join(", ")}}`}return`${a}${l?"("+l+")":""}[${d}]: ${i.replace(ni,"\n  ")}`}("\n"+i.message,d,a,l),i.ngTokenPath=d,i[ti]=null,i}(y,s,"R3InjectorError",this.source)}throw y}finally{Vn(p),Qa(d)}}_resolveInjectorDefTypes(){this.injectorDefTypes.forEach(s=>this.get(s))}toString(){const s=[];return this.records.forEach((l,d)=>s.push(de(d))),`R3Injector[${s.join(", ")}]`}assertNotDestroyed(){if(this._destroyed)throw new Fe(205,"")}processInjectorType(s,a,l){if(!(s=X(s)))return!1;let d=Xs(s);const p=null==d&&s.ngModule||void 0,y=void 0===p?s:p,w=-1!==l.indexOf(y);if(void 0!==p&&(d=Xs(p)),null==d)return!1;if(null!=d.imports&&!w){let N;l.push(y);try{an(d.imports,O=>{this.processInjectorType(O,a,l)&&(void 0===N&&(N=[]),N.push(O))})}finally{}if(void 0!==N)for(let O=0;O<N.length;O++){const{ngModule:j,providers:Z}=N[O];an(Z,se=>this.processProvider(se,j,Z||B))}}this.injectorDefTypes.add(y);const C=so(y)||(()=>new y);this.records.set(y,si(C,iu));const A=d.providers;if(null!=A&&!w){const N=s;an(A,O=>this.processProvider(O,N,A))}return void 0!==p&&void 0!==s.providers}processProvider(s,a,l){let d=zu(s=X(s))?s:X(s&&s.provide);const p=function gb(i,s,a){return Hd(i)?si(void 0,i.useValue):si(pn(i),iu)}(s);if(zu(s)||!0!==s.multi)this.records.get(d);else{let y=this.records.get(d);y||(y=si(void 0,iu,!0),y.factory=()=>V(y.multi),this.records.set(d,y)),d=s,y.multi.push(s)}this.records.set(d,p)}hydrate(s,a){return a.value===iu&&(a.value=pb,a.value=a.factory()),"object"==typeof a.value&&a.value&&function Ku(i){return null!==i&&"object"==typeof i&&"function"==typeof i.ngOnDestroy}(a.value)&&this.onDestroy.add(a.value),a.value}injectableDefInScope(s){if(!s.providedIn)return!1;const a=X(s.providedIn);return"string"==typeof a?"any"===a||a===this.scope:this.injectorDefTypes.has(a)}}function su(i){const s=Dn(i),a=null!==s?s.factory:so(i);if(null!==a)return a;if(i instanceof Yt)throw new Fe(204,"");if(i instanceof Function)return function Qy(i){const s=i.length;if(s>0)throw function Za(i,s){const a=[];for(let l=0;l<i;l++)a.push(s);return a}(s,"?"),new Fe(204,"");const a=function kt(i){const s=i&&(i[Ur]||i[Ae]);if(s){const a=function gn(i){if(i.hasOwnProperty("name"))return i.name;const s=(""+i).match(/^function\s*([^\s(]+)/);return null===s?"":s[1]}(i);return console.warn(`DEPRECATED: DI is instantiating a token "${a}" that inherits its @Injectable decorator but does not provide one itself.\nThis will become an error in a future version of Angular. Please add @Injectable() to the "${a}" class.`),s}return null}(i);return null!==a?()=>a.factory(i):()=>new i}(i);throw new Fe(204,"")}function pn(i,s,a){let l;if(zu(i)){const d=X(i);return so(d)||su(d)}if(Hd(i))l=()=>X(i.useValue);else if(function ow(i){return!(!i||!i.useFactory)}(i))l=()=>i.useFactory(...V(i.deps||[]));else if(function Jy(i){return!(!i||!i.useExisting)}(i))l=()=>D(X(i.useExisting));else{const d=X(i&&(i.useClass||i.provide));if(!function aw(i){return!!i.deps}(i))return so(d)||su(d);l=()=>new d(...V(i.deps))}return l}function si(i,s,a=!1){return{factory:i,value:s,multi:a?[]:void 0}}function Hd(i){return null!==i&&"object"==typeof i&&fo in i}function zu(i){return"function"==typeof i}let Kr=(()=>{class i{static create(a,l){var d;if(Array.isArray(a))return jd({name:""},l,a,"");{const p=null!==(d=a.name)&&void 0!==d?d:"";return jd({name:p},a.parent,a.providers,p)}}}return i.THROW_IF_NOT_FOUND=Zi,i.NULL=new sw,i.\u0275prov=$t({token:i,providedIn:"any",factory:()=>D(ha)}),i.__NG_ELEMENT_ID__=-1,i})();function gw(i,s){Ml(bd(i)[1],tn())}function sv(i){let s=function _w(i){return Object.getPrototypeOf(i.prototype).constructor}(i.type),a=!0;const l=[i];for(;s;){let d;if(Hi(i))d=s.\u0275cmp||s.\u0275dir;else{if(s.\u0275cmp)throw new Fe(903,"");d=s.\u0275dir}if(d){if(a){l.push(d);const y=i;y.inputs=ov(i.inputs),y.declaredInputs=ov(i.declaredInputs),y.outputs=ov(i.outputs);const w=d.hostBindings;w&&av(i,w);const C=d.viewQuery,A=d.contentQueries;if(C&&yw(i,C),A&&nm(i,A),oe(i.inputs,d.inputs),oe(i.declaredInputs,d.declaredInputs),oe(i.outputs,d.outputs),Hi(d)&&d.data.animation){const N=i.data;N.animation=(N.animation||[]).concat(d.data.animation)}}const p=d.features;if(p)for(let y=0;y<p.length;y++){const w=p[y];w&&w.ngInherit&&w(i),w===sv&&(a=!1)}}s=Object.getPrototypeOf(s)}!function Db(i){let s=0,a=null;for(let l=i.length-1;l>=0;l--){const d=i[l];d.hostVars=s+=d.hostVars,d.hostAttrs=cr(d.hostAttrs,a=cr(a,d.hostAttrs))}}(l)}function ov(i){return i===as?{}:i===B?[]:i}function yw(i,s){const a=i.viewQuery;i.viewQuery=a?(l,d)=>{s(l,d),a(l,d)}:s}function nm(i,s){const a=i.contentQueries;i.contentQueries=a?(l,d,p)=>{s(l,d,p),a(l,d,p)}:s}function av(i,s){const a=i.hostBindings;i.hostBindings=a?(l,d)=>{s(l,d),a(l,d)}:s}let Gd=null;function $d(){if(!Gd){const i=ct.Symbol;if(i&&i.iterator)Gd=i.iterator;else{const s=Object.getOwnPropertyNames(Map.prototype);for(let a=0;a<s.length;++a){const l=s[a];"entries"!==l&&"size"!==l&&Map.prototype[l]===Map.prototype.entries&&(Gd=l)}}}return Gd}function Vf(i){return!!uv(i)&&(Array.isArray(i)||!(i instanceof Map)&&$d()in i)}function uv(i){return null!==i&&("function"==typeof i||"object"==typeof i)}function oi(i,s,a){return!Object.is(i[s],a)&&(i[s]=a,!0)}function rm(i,s,a,l){const d=Te();return oi(d,ds(),s)&&(At(),ts(_n(),d,i,s,a,l)),rm}function hv(i,s,a,l,d,p,y,w){const C=Te(),A=At(),N=i+20,O=A.firstCreatePass?function xb(i,s,a,l,d,p,y,w,C){const A=s.consts,N=Fd(s,i,4,y||null,Ar(A,w));Wu(s,a,N,Ar(A,C)),Ml(s,N);const O=N.tViews=$g(2,N,l,d,p,s.directiveRegistry,s.pipeRegistry,null,s.schemas,A);return null!==s.queries&&(s.queries.template(s,N),O.queries=s.queries.embeddedTView(N)),N}(N,A,C,s,a,l,d,p,y):A.data[N];$r(O,!1);const j=C[11].createComment("");nu(A,C,j,O),hr(j,C),Pf(C,C[N]=tw(j,C,j,O)),us(O)&&Hg(A,C,O),null!=y&&Gg(C,O,w)}function qf(i,s=et.Default){const a=Te();return null===a?D(i,s):Ol(tn(),a,X(i),s)}function Kf(i,s,a){const l=Te();return oi(l,ds(),s)&&function ht(i,s,a,l,d,p,y,w){const C=Mn(s,a);let N,A=s.inputs;!w&&null!=A&&(N=A[l])?(Qg(i,a,N,l,d),xn(s)&&function ob(i,s){const a=Tr(s,i);16&a[2]||(a[2]|=64)}(a,s.index)):3&s.type&&(l=function Mf(i){return"class"===i?"className":"for"===i?"htmlFor":"formaction"===i?"formAction":"innerHtml"===i?"innerHTML":"readonly"===i?"readOnly":"tabindex"===i?"tabIndex":i}(l),d=null!=y?y(d,s.value||"",l):d,Wt(p)?p.setProperty(C,l,d):uo(l)||(C.setProperty?C.setProperty(l,d):C[l]=d))}(At(),_n(),l,i,s,l[11],a,!1),Kf}function wv(i,s,a,l,d){const y=d?"class":"style";Qg(i,a,s.inputs[y],y,l)}function Iv(i,s,a,l){const d=Te(),p=At(),y=20+i,w=d[11],C=d[y]=Sn(w,s,function td(){return dt.lFrame.currentNamespace}()),A=p.firstCreatePass?function Gb(i,s,a,l,d,p,y){const w=s.consts,A=Fd(s,i,2,d,Ar(w,p));return Wu(s,a,A,Ar(w,y)),null!==A.attrs&&gc(A,A.attrs,!1),null!==A.mergedAttrs&&gc(A,A.mergedAttrs,!0),null!==s.queries&&s.queries.elementStart(s,A),A}(y,p,d,0,s,a,l):p.data[y];$r(A,!0);const N=A.mergedAttrs;null!==N&&Nl(w,C,N);const O=A.classes;null!==O&&by(w,C,O);const j=A.styles;null!==j&&F0(w,C,j),64!=(64&A.flags)&&nu(p,d,C,A),0===function Ma(){return dt.lFrame.elementDepthCount}()&&hr(C,d),function Na(){dt.lFrame.elementDepthCount++}(),us(A)&&(Hg(p,d,A),function fc(i,s,a){if(Vc(s)){const d=s.directiveEnd;for(let p=s.directiveStart;p<d;p++){const y=i.data[p];y.contentQueries&&y.contentQueries(1,a[p],p)}}}(p,A,d)),null!==l&&Gg(d,A)}function Zf(){let i=tn();cs()?function wu(){dt.lFrame.isParent=!1}():(i=i.parent,$r(i,!1));const s=i;!function Go(){dt.lFrame.elementDepthCount--}();const a=At();a.firstCreatePass&&(Ml(a,i),Vc(i)&&a.queries.elementEnd(i)),null!=s.classesWithoutHost&&function rd(i){return 0!=(16&i.flags)}(s)&&wv(a,s,Te(),s.classesWithoutHost,!0),null!=s.stylesWithoutHost&&function ja(i){return 0!=(32&i.flags)}(s)&&wv(a,s,Te(),s.stylesWithoutHost,!1)}function Yf(i,s,a,l){Iv(i,s,a,l),Zf()}function Nw(){return Te()}function cm(i){return!!i&&"function"==typeof i.then}function dm(i){return!!i&&"function"==typeof i.subscribe}const eh=dm;function Ec(i,s,a,l){const d=Te(),p=At(),y=tn();return function Cv(i,s,a,l,d,p,y,w){const C=us(l),N=i.firstCreatePass&&iw(i),O=s[8],j=rw(s);let Z=!0;if(3&l.type||w){const Ve=Mn(l,s),Qe=w?w(Ve):Ve,Ie=j.length,ft=w?Rt=>w(en(Rt[l.index])):l.index;if(Wt(a)){let Rt=null;if(!w&&C&&(Rt=function Ks(i,s,a,l){const d=i.cleanup;if(null!=d)for(let p=0;p<d.length-1;p+=2){const y=d[p];if(y===a&&d[p+1]===l){const w=s[7],C=d[p+2];return w.length>C?w[C]:null}"string"==typeof y&&(p+=2)}return null}(i,s,d,l.index)),null!==Rt)(Rt.__ngLastListenerFn__||Rt).__ngNextListenerFn__=p,Rt.__ngLastListenerFn__=p,Z=!1;else{p=th(l,s,O,p,!1);const Qt=a.listen(Qe,d,p);j.push(p,Qt),N&&N.push(d,ft,Ie,Ie+1)}}else p=th(l,s,O,p,!0),Qe.addEventListener(d,p,y),j.push(p),N&&N.push(d,ft,Ie,y)}else p=th(l,s,O,p,!1);const se=l.outputs;let Oe;if(Z&&null!==se&&(Oe=se[d])){const Ve=Oe.length;if(Ve)for(let Qe=0;Qe<Ve;Qe+=2){const ns=s[Oe[Qe]][Oe[Qe+1]].subscribe(p),ga=j.length;j.push(p,ns),N&&N.push(d,l.index,ga,-(ga+1))}}}(p,d,d[11],y,i,s,!!a,l),Ec}function Pw(i,s,a,l){try{return!1!==a(l)}catch(d){return Yg(i,d),!1}}function th(i,s,a,l,d){return function p(y){if(y===Function)return l;const w=2&i.flags?Tr(i.index,s):s;0==(32&s[2])&&Bd(w);let C=Pw(s,0,l,y),A=p.__ngNextListenerFn__;for(;A;)C=Pw(s,0,A,y)&&C,A=A.__ngNextListenerFn__;return d&&!1===C&&(y.preventDefault(),y.returnValue=!1),C}}function hm(i=1){return function ed(i){return(dt.lFrame.contextLView=function tg(i,s){for(;i>0;)s=s[15],i--;return s}(i,dt.lFrame.contextLView))[8]}(i)}function Vw(i,s,a,l,d){const p=i[a+1],y=null===s;let w=l?_o(p):ca(p),C=!1;for(;0!==w&&(!1===C||y);){const N=i[w+1];Kb(i[w],s)&&(C=!0,i[w+1]=l?Og(N):xy(N)),w=l?_o(N):ca(N)}C&&(i[a+1]=l?xy(p):Og(p))}function Kb(i,s){return null===i||null==s||(Array.isArray(i)?i[1]:i)===s||!(!Array.isArray(i)||"string"!=typeof s)&&ho(i,s)>=0}function mm(i,s){return function bs(i,s,a,l){const d=Te(),p=At(),y=function Ai(i){const s=dt.lFrame,a=s.bindingIndex;return s.bindingIndex=s.bindingIndex+i,a}(2);p.firstUpdatePass&&function ym(i,s,a,l){const d=i.data;if(null===d[a+1]){const p=d[er()],y=function $w(i,s){return s>=i.expandoStartIndex}(i,a);(function tl(i,s){return 0!=(i.flags&(s?16:32))})(p,l)&&null===s&&!y&&(s=!1),s=function Jb(i,s,a,l){const d=function Oa(i){const s=dt.lFrame.currentDirectiveIndex;return-1===s?null:i[s]}(i);let p=l?s.residualClasses:s.residualStyles;if(null===d)0===(l?s.classBindings:s.styleBindings)&&(a=Nr(a=vm(null,i,s,a,l),s.attrs,l),p=null);else{const y=s.directiveStylingLast;if(-1===y||i[y]!==d)if(a=vm(d,i,s,a,l),null===p){let C=function Ww(i,s,a){const l=a?s.classBindings:s.styleBindings;if(0!==ca(l))return i[_o(l)]}(i,s,l);void 0!==C&&Array.isArray(C)&&(C=vm(null,i,s,C[1],l),C=Nr(C,s.attrs,l),function qw(i,s,a,l){i[_o(a?s.classBindings:s.styleBindings)]=l}(i,s,l,C))}else p=function zw(i,s,a){let l;const d=s.directiveEnd;for(let p=1+s.directiveStylingLast;p<d;p++)l=Nr(l,i[p].hostAttrs,a);return Nr(l,s.attrs,a)}(i,s,l)}return void 0!==p&&(l?s.residualClasses=p:s.residualStyles=p),a}(d,p,s,l),function zb(i,s,a,l,d,p){let y=p?s.classBindings:s.styleBindings,w=_o(y),C=ca(y);i[l]=a;let N,A=!1;if(Array.isArray(a)){const O=a;N=O[1],(null===N||ho(O,N)>0)&&(A=!0)}else N=a;if(d)if(0!==C){const j=_o(i[w+1]);i[l+1]=Rg(j,w),0!==j&&(i[j+1]=My(i[j+1],l)),i[w+1]=function j0(i,s){return 131071&i|s<<17}(i[w+1],l)}else i[l+1]=Rg(w,0),0!==w&&(i[w+1]=My(i[w+1],l)),w=l;else i[l+1]=Rg(C,0),0===w?w=l:i[C+1]=My(i[C+1],l),C=l;A&&(i[l+1]=xy(i[l+1])),Vw(i,N,l,!0),Vw(i,N,l,!1),function Mv(i,s,a,l,d){const p=d?i.residualClasses:i.residualStyles;null!=p&&"string"==typeof s&&ho(p,s)>=0&&(a[l+1]=Og(a[l+1]))}(s,N,i,l,p),y=Rg(w,C),p?s.classBindings=y:s.styleBindings=y}(d,p,s,a,y,l)}}(p,i,y,l),s!==_t&&oi(d,y,s)&&function Ts(i,s,a,l,d,p,y,w){if(!(3&s.type))return;const C=i.data,A=C[w+1];Xf(function Ny(i){return 1==(1&i)}(A)?el(C,s,a,d,ca(A),y):void 0)||(Xf(p)||function Pg(i){return 2==(2&i)}(A)&&(p=el(C,null,a,d,w,y)),function $D(i,s,a,l,d){const p=Wt(i);if(s)d?p?i.addClass(a,l):a.classList.add(l):p?i.removeClass(a,l):a.classList.remove(l);else{let y=-1===l.indexOf("-")?void 0:ws.DashCase;if(null==d)p?i.removeStyle(a,l,y):a.style.removeProperty(l);else{const w="string"==typeof d&&d.endsWith("!important");w&&(d=d.slice(0,-10),y|=ws.Important),p?i.setStyle(a,l,d,y):a.style.setProperty(l,d,w?"important":"")}}}(l,y,$n(er(),a),d,p))}(p,p.data[er()],d,d[11],i,d[y+1]=function Kw(i,s){return null==i||("string"==typeof s?i+=s:"object"==typeof i&&(i=de(function Ja(i){return i instanceof class yd{constructor(s){this.changingThisBreaksApplicationSecurity=s}toString(){return`SafeValue must use [property]=binding: ${this.changingThisBreaksApplicationSecurity} (see https://g.co/ng/security#xss)`}}?i.changingThisBreaksApplicationSecurity:i}(i)))),i}(s,a),l,y)}(i,s,null,!0),mm}function vm(i,s,a,l,d){let p=null;const y=a.directiveEnd;let w=a.directiveStylingLast;for(-1===w?w=a.directiveStart:w++;w<y&&(p=s[w],l=Nr(l,p.hostAttrs,d),p!==i);)w++;return null!==i&&(a.directiveStylingLast=w),l}function Nr(i,s,a){const l=a?1:2;let d=-1;if(null!==s)for(let p=0;p<s.length;p++){const y=s[p];"number"==typeof y?d=y:d===l&&(Array.isArray(i)||(i=void 0===i?[]:["",i]),tr(i,y,!!a||s[++p]))}return void 0===i?null:i}function el(i,s,a,l,d,p){const y=null===s;let w;for(;d>0;){const C=i[d],A=Array.isArray(C),N=A?C[1]:C,O=null===N;let j=a[d+1];j===_t&&(j=O?B:void 0);let Z=O?Ou(j,l):N===l?j:void 0;if(A&&!Xf(Z)&&(Z=Ou(C,l)),Xf(Z)&&(w=Z,y))return w;const se=i[d+1];d=y?_o(se):ca(se)}if(null!==s){let C=p?s.residualClasses:s.residualStyles;null!=C&&(w=Ou(C,l))}return w}function Xf(i){return void 0!==i}function Xb(i,s=""){const a=Te(),l=At(),d=i+20,p=l.firstCreatePass?Fd(l,d,1,s,null):l.data[d],y=a[d]=function la(i,s){return Wt(i)?i.createText(s):i.createTextNode(s)}(a[11],s);nu(l,a,y,p),$r(p,!1)}function Ov(i){return kv("",i,""),Ov}function kv(i,s,a){const l=Te(),d=function yc(i,s,a,l){return oi(i,ds(),a)?s+K(a)+l:_t}(l,i,s,a);return d!==_t&&Eo(l,er(),d),kv}const Zr=void 0;var Lv=["en",[["a","p"],["AM","PM"],Zr],[["AM","PM"],Zr,Zr],[["S","M","T","W","T","F","S"],["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],["Su","Mo","Tu","We","Th","Fr","Sa"]],Zr,[["J","F","M","A","M","J","J","A","S","O","N","D"],["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],["January","February","March","April","May","June","July","August","September","October","November","December"]],Zr,[["B","A"],["BC","AD"],["Before Christ","Anno Domini"]],0,[6,0],["M/d/yy","MMM d, y","MMMM d, y","EEEE, MMMM d, y"],["h:mm a","h:mm:ss a","h:mm:ss a z","h:mm:ss a zzzz"],["{1}, {0}",Zr,"{1} 'at' {0}",Zr],[".",",",";","%","+","-","E","\xd7","\u2030","\u221e","NaN",":"],["#,##0.###","#,##0%","\xa4#,##0.00","#E0"],"USD","$","US Dollar",{},"ltr",function lT(i){const a=Math.floor(Math.abs(i)),l=i.toString().replace(/^[^.]*\.?/,"").length;return 1===a&&0===l?1:5}];let wc={};function Cm(i){const s=function cT(i){return i.toLowerCase().replace(/_/g,"-")}(i);let a=yI(s);if(a)return a;const l=s.split("-")[0];if(a=yI(l),a)return a;if("en"===l)return Lv;throw new Error(`Missing locale data for the locale "${i}".`)}function _I(i){return Cm(i)[mt.PluralCase]}function yI(i){return i in wc||(wc[i]=ct.ng&&ct.ng.common&&ct.ng.common.locales&&ct.ng.common.locales[i]),wc[i]}var mt=(()=>((mt=mt||{})[mt.LocaleId=0]="LocaleId",mt[mt.DayPeriodsFormat=1]="DayPeriodsFormat",mt[mt.DayPeriodsStandalone=2]="DayPeriodsStandalone",mt[mt.DaysFormat=3]="DaysFormat",mt[mt.DaysStandalone=4]="DaysStandalone",mt[mt.MonthsFormat=5]="MonthsFormat",mt[mt.MonthsStandalone=6]="MonthsStandalone",mt[mt.Eras=7]="Eras",mt[mt.FirstDayOfWeek=8]="FirstDayOfWeek",mt[mt.WeekendRange=9]="WeekendRange",mt[mt.DateFormat=10]="DateFormat",mt[mt.TimeFormat=11]="TimeFormat",mt[mt.DateTimeFormat=12]="DateTimeFormat",mt[mt.NumberSymbols=13]="NumberSymbols",mt[mt.NumberFormats=14]="NumberFormats",mt[mt.CurrencyCode=15]="CurrencyCode",mt[mt.CurrencySymbol=16]="CurrencySymbol",mt[mt.CurrencyName=17]="CurrencyName",mt[mt.Currencies=18]="Currencies",mt[mt.Directionality=19]="Directionality",mt[mt.PluralCase=20]="PluralCase",mt[mt.ExtraData=21]="ExtraData",mt))();const Dm="en-US";let vI=Dm;function sh(i,s,a,l,d){if(i=X(i),Array.isArray(i))for(let p=0;p<i.length;p++)sh(i[p],s,a,l,d);else{const p=At(),y=Te();let w=zu(i)?i:X(i.provide),C=pn(i);const A=tn(),N=1048575&A.providerIndexes,O=A.directiveStart,j=A.providerIndexes>>20;if(zu(i)||!i.multi){const Z=new yn(C,d,qf),se=Wv(w,s,d?N:N+j,O);-1===se?(qr(Wa(A,y),p,w),Rm(p,i,s.length),s.push(w),A.directiveStart++,A.directiveEnd++,d&&(A.providerIndexes+=1048576),a.push(Z),y.push(Z)):(a[se]=Z,y[se]=Z)}else{const Z=Wv(w,s,N+j,O),se=Wv(w,s,N,N+j),Oe=Z>=0&&a[Z],Ve=se>=0&&a[se];if(d&&!Ve||!d&&!Oe){qr(Wa(A,y),p,w);const Qe=function qv(i,s,a,l,d){const p=new yn(i,a,qf);return p.multi=[],p.index=s,p.componentProviders=0,BI(p,d,l&&!a),p}(d?BT:VT,a.length,d,l,C);!d&&Ve&&(a[se].providerFactory=Qe),Rm(p,i,s.length,0),s.push(w),A.directiveStart++,A.directiveEnd++,d&&(A.providerIndexes+=1048576),a.push(Qe),y.push(Qe)}else Rm(p,i,Z>-1?Z:se,BI(a[d?se:Z],C,!d&&l));!d&&l&&Ve&&a[se].componentProviders++}}}function Rm(i,s,a,l){const d=zu(s),p=function _c(i){return!!i.useClass}(s);if(d||p){const C=(p?X(s.useClass):s).prototype.ngOnDestroy;if(C){const A=i.destroyHooks||(i.destroyHooks=[]);if(!d&&s.multi){const N=A.indexOf(a);-1===N?A.push(a,[l,C]):A[N+1].push(l,C)}else A.push(a,C)}}}function BI(i,s,a){return a&&i.componentProviders++,i.multi.push(s)-1}function Wv(i,s,a,l){for(let d=a;d<l;d++)if(s[d]===i)return d;return-1}function VT(i,s,a,l){return Pm(this.multi,[])}function BT(i,s,a,l){const d=this.multi;let p;if(this.providerFactory){const y=this.providerFactory.componentProviders,w=Vt(a,a[1],this.providerFactory.index,l);p=w.slice(0,y),Pm(d,p);for(let C=y;C<w.length;C++)p.push(w[C])}else p=[],Pm(d,p);return p}function Pm(i,s){for(let a=0;a<i.length;a++)s.push((0,i[a])());return s}function zv(i,s=[]){return a=>{a.providersResolver=(l,d)=>function VI(i,s,a){const l=At();if(l.firstCreatePass){const d=Hi(i);sh(a,l.data,l.blueprint,d,!0),sh(s,l.data,l.blueprint,d,!1)}}(l,d?d(i):i,s)}}class Zv{}class HI{resolveComponentFactory(s){throw function op(i){const s=Error(`No component factory found for ${de(i)}. Did you add it to @NgModule.entryComponents?`);return s.ngComponent=i,s}(s)}}let ap=(()=>{class i{}return i.NULL=new HI,i})();function Yv(){return Dc(tn(),Te())}function Dc(i,s){return new oh(Mn(i,s))}let oh=(()=>{class i{constructor(a){this.nativeElement=a}}return i.__NG_ELEMENT_ID__=Yv,i})();class GI{}let UT=(()=>{class i{}return i.__NG_ELEMENT_ID__=()=>function Jv(){const i=Te(),a=Tr(tn().index,i);return function Om(i){return i[11]}(Ii(a)?a:i)}(),i})(),Xv=(()=>{class i{}return i.\u0275prov=$t({token:i,providedIn:"root",factory:()=>null}),i})();class km{constructor(s){this.full=s,this.major=s.split(".")[0],this.minor=s.split(".")[1],this.patch=s.split(".").slice(2).join(".")}}const eE=new km("13.1.3"),tE={};function up(i,s,a,l,d=!1){for(;null!==a;){const p=s[a.index];if(null!==p&&l.push(en(p)),Ci(p))for(let w=10;w<p.length;w++){const C=p[w],A=C[1].firstChild;null!==A&&up(C[1],C,A,l)}const y=a.type;if(8&y)up(i,s,a.child,l);else if(32&y){const w=ua(a,s);let C;for(;C=w();)l.push(C)}else if(16&y){const w=Rd(s,a);if(Array.isArray(w))l.push(...w);else{const C=rr(s[16]);up(C[1],C,w,l,!0)}}a=d?a.projectionNext:a.next}return l}class sl{constructor(s,a){this._lView=s,this._cdRefInjectingView=a,this._appRef=null,this._attachedToViewContainer=!1}get rootNodes(){const s=this._lView,a=s[1];return up(a,s,a.firstChild,[])}get context(){return this._lView[8]}set context(s){this._lView[8]=s}get destroyed(){return 256==(256&this._lView[2])}destroy(){if(this._appRef)this._appRef.detachView(this);else if(this._attachedToViewContainer){const s=this._lView[3];if(Ci(s)){const a=s[8],l=a?a.indexOf(this):-1;l>-1&&(v(s,l),Ru(a,l))}this._attachedToViewContainer=!1}b(this._lView[1],this._lView)}onDestroy(s){!function xf(i,s,a,l){const d=rw(s);null===a?d.push(l):(d.push(a),i.firstCreatePass&&iw(i).push(l,d.length-1))}(this._lView[1],this._lView,null,s)}markForCheck(){Bd(this._cdRefInjectingView||this._lView)}detach(){this._lView[2]&=-129}reattach(){this._lView[2]|=128}detectChanges(){qu(this._lView[1],this._lView,this.context)}checkNoChanges(){!function qy(i,s,a){Ra(!0);try{qu(i,s,a)}finally{Ra(!1)}}(this._lView[1],this._lView,this.context)}attachToViewContainerRef(){if(this._appRef)throw new Fe(902,"");this._attachedToViewContainer=!0}detachFromAppRef(){this._appRef=null,function Cy(i,s){cc(i,s,s[11],2,null,null)}(this._lView[1],this._lView)}attachToAppRef(s){if(this._attachedToViewContainer)throw new Fe(902,"");this._appRef=s}}class jT extends sl{constructor(s){super(s),this._view=s}detectChanges(){Zg(this._view)}checkNoChanges(){!function db(i){Ra(!0);try{Zg(i)}finally{Ra(!1)}}(this._view)}get context(){return null}}class $I extends ap{constructor(s){super(),this.ngModule=s}resolveComponentFactory(s){const a=Qn(s);return new nE(a,this.ngModule)}}function WI(i){const s=[];for(let a in i)i.hasOwnProperty(a)&&s.push({propName:i[a],templateName:a});return s}const GT=new Yt("SCHEDULER_TOKEN",{providedIn:"root",factory:()=>Md});class nE extends Zv{constructor(s,a){super(),this.componentDef=s,this.ngModule=a,this.componentType=s.type,this.selector=function XD(i){return i.map(JD).join(",")}(s.selectors),this.ngContentSelectors=s.ngContentSelectors?s.ngContentSelectors:[],this.isBoundToModule=!!a}get inputs(){return WI(this.componentDef.inputs)}get outputs(){return WI(this.componentDef.outputs)}create(s,a,l,d){const p=(d=d||this.ngModule)?function $T(i,s){return{get:(a,l,d)=>{const p=i.get(a,tE,d);return p!==tE||l===tE?p:s.get(a,l,d)}}}(s,d.injector):s,y=p.get(GI,Fs),w=p.get(Xv,null),C=y.createRenderer(null,this.componentDef),A=this.componentDef.selectors[0][0]||"div",N=l?function Y0(i,s,a){if(Wt(i))return i.selectRootElement(s,a===bt.ShadowDom);let l="string"==typeof s?i.querySelector(s):s;return l.textContent="",l}(C,l,this.componentDef.encapsulation):Sn(y.createRenderer(null,this.componentDef),A,function HT(i){const s=i.toLowerCase();return"svg"===s?"http://www.w3.org/2000/svg":"math"===s?"http://www.w3.org/1998/MathML/":null}(A)),O=this.componentDef.onPush?576:528,j=function pw(i,s){return{components:[],scheduler:i||Md,clean:fb,playerHandler:s||null,flags:0}}(),Z=$g(0,null,null,1,0,null,null,null,null,null),se=Mr(null,Z,j,O,null,null,y,C,w,p);let Oe,Ve;Ko(se);try{const Qe=function iv(i,s,a,l,d,p){const y=a[1];a[20]=i;const C=Fd(y,20,2,"#host",null),A=C.mergedAttrs=s.hostAttrs;null!==A&&(gc(C,A,!0),null!==i&&(Nl(d,i,A),null!==C.classes&&by(d,i,C.classes),null!==C.styles&&F0(d,i,C.styles)));const N=l.createRenderer(i,s),O=Mr(a,Z0(s),null,s.onPush?64:16,a[20],C,l,N,p||null,null);return y.firstCreatePass&&(qr(Wa(C,a),y,s.type),Uy(y,C),Vd(C,a.length,1)),Pf(a,O),a[20]=O}(N,this.componentDef,se,y,C);if(N)if(l)Nl(C,N,["ng-version",eE.full]);else{const{attrs:Ie,classes:ft}=function If(i){const s=[],a=[];let l=1,d=2;for(;l<i.length;){let p=i[l];if("string"==typeof p)2===d?""!==p&&s.push(p,i[++l]):8===d&&a.push(p);else{if(!mo(d))break;d=p}l++}return{attrs:s,classes:a}}(this.componentDef.selectors[0]);Ie&&Nl(C,N,Ie),ft&&ft.length>0&&by(C,N,ft.join(" "))}if(Ve=jo(Z,20),void 0!==a){const Ie=Ve.projection=[];for(let ft=0;ft<this.ngContentSelectors.length;ft++){const Rt=a[ft];Ie.push(null!=Rt?Array.from(Rt):null)}}Oe=function fw(i,s,a,l,d){const p=a[1],y=function Vy(i,s,a){const l=tn();i.firstCreatePass&&(a.providersResolver&&a.providersResolver(a),ew(i,l,s,$u(i,s,1,null),a));const d=Vt(s,i,l.directiveStart,l);hr(d,s);const p=Mn(l,s);return p&&hr(p,s),d}(p,a,s);if(l.components.push(y),i[8]=y,d&&d.forEach(C=>C(y,s)),s.contentQueries){const C=tn();s.contentQueries(1,y,C.directiveStart)}const w=tn();return!p.firstCreatePass||null===s.hostBindings&&null===s.hostAttrs||(Nn(w.index),qg(a[1],w,0,w.directiveStart,w.directiveEnd,s),By(s,y)),y}(Qe,this.componentDef,se,j,[gw]),Sf(Z,se,null)}finally{Tu()}return new qT(this.componentType,Oe,Dc(Ve,se),se,Ve)}}class qT extends class Kv{}{constructor(s,a,l,d,p){super(),this.location=l,this._rootLView=d,this._tNode=p,this.instance=a,this.hostView=this.changeDetectorRef=new jT(d),this.componentType=s}get injector(){return new lo(this._tNode,this._rootLView)}destroy(){this.hostView.destroy()}onDestroy(s){this.hostView.onDestroy(s)}}class bc{}const ol=new Map;class iE extends bc{constructor(s,a){super(),this._parent=a,this._bootstrapComponents=[],this.injector=this,this.destroyCbs=[],this.componentFactoryResolver=new $I(this);const l=Jn(s);this._bootstrapComponents=Es(l.bootstrap),this._r3Injector=Yy(s,a,[{provide:bc,useValue:this},{provide:ap,useValue:this.componentFactoryResolver}],de(s)),this._r3Injector._resolveInjectorDefTypes(),this.instance=this.get(s)}get(s,a=Kr.THROW_IF_NOT_FOUND,l=et.Default){return s===Kr||s===bc||s===ha?this:this._r3Injector.get(s,a,l)}destroy(){const s=this._r3Injector;!s.destroyed&&s.destroy(),this.destroyCbs.forEach(a=>a()),this.destroyCbs=null}onDestroy(s){this.destroyCbs.push(s)}}class Lm extends class qI{}{constructor(s){super(),this.moduleType=s,null!==Jn(s)&&function zT(i){const s=new Set;!function a(l){const d=Jn(l,!0),p=d.id;null!==p&&(function zI(i,s,a){if(s&&s!==a)throw new Error(`Duplicate module registered for ${i} - ${de(s)} vs ${de(s.name)}`)}(p,ol.get(p),l),ol.set(p,l));const y=Es(d.imports);for(const w of y)s.has(w)||(s.add(w),a(w))}(i)}(s)}create(s){return new iE(this.moduleType,s)}}function QI(i){return s=>{setTimeout(i,void 0,s)}}const du=class $M extends _.x{constructor(s=!1){super(),this.__isAsync=s}emit(s){super.next(s)}subscribe(s,a,l){var d,p,y;let w=s,C=a||(()=>null),A=l;if(s&&"object"==typeof s){const O=s;w=null===(d=O.next)||void 0===d?void 0:d.bind(O),C=null===(p=O.error)||void 0===p?void 0:p.bind(O),A=null===(y=O.complete)||void 0===y?void 0:y.bind(O)}this.__isAsync&&(C=QI(C),w&&(w=QI(w)),A&&(A=QI(A)));const N=super.subscribe({next:w,error:C,complete:A});return s instanceof J.w0&&s.add(N),N}};Symbol;let Ac=(()=>{class i{}return i.__NG_ELEMENT_ID__=lE,i})();const aE=Ac,uE=class extends aE{constructor(s,a,l){super(),this._declarationLView=s,this._declarationTContainer=a,this.elementRef=l}createEmbeddedView(s){const a=this._declarationTContainer.tViews,l=Mr(this._declarationLView,a,s,16,null,a.declTNode,null,null,null,null);l[17]=this._declarationLView[this._declarationTContainer.index];const p=this._declarationLView[19];return null!==p&&(l[19]=p.createEmbeddedView(a)),Sf(a,l,s),new sl(l)}};function lE(){return function ah(i,s){return 4&i.type?new uE(s,i,Dc(i,s)):null}(tn(),Te())}let uh=(()=>{class i{}return i.__NG_ELEMENT_ID__=cE,i})();function cE(){return function fE(i,s){let a;const l=s[i.index];if(Ci(l))a=l;else{let d;if(8&i.type)d=en(l);else{const p=s[11];d=p.createComment("");const y=Mn(i,s);ze(p,es(p,y),d,function oc(i,s){return Wt(i)?i.nextSibling(s):s.nextSibling}(p,y),!1)}s[i.index]=a=tw(l,s,d,i),Pf(s,a)}return new sA(a,i,s)}(tn(),Te())}const dE=uh,sA=class extends dE{constructor(s,a,l){super(),this._lContainer=s,this._hostTNode=a,this._hostLView=l}get element(){return Dc(this._hostTNode,this._hostLView)}get injector(){return new lo(this._hostTNode,this._hostLView)}get parentInjector(){const s=Sr(this._hostTNode,this._hostLView);if($h(s)){const a=Ga(s,this._hostLView),l=Ha(s);return new lo(a[1].data[l+8],a)}return new lo(null,this._hostLView)}clear(){for(;this.length>0;)this.remove(this.length-1)}get(s){const a=JI(this._lContainer);return null!==a&&a[s]||null}get length(){return this._lContainer.length-10}createEmbeddedView(s,a,l){const d=s.createEmbeddedView(a||{});return this.insert(d,l),d}createComponent(s,a,l,d,p){const y=s&&!function Si(i){return"function"==typeof i}(s);let w;if(y)w=a;else{const O=a||{};w=O.index,l=O.injector,d=O.projectableNodes,p=O.ngModuleRef}const C=y?s:new nE(Qn(s)),A=l||this.parentInjector;if(!p&&null==C.ngModule&&A){const O=A.get(bc,null);O&&(p=O)}const N=C.create(A,d,void 0,p);return this.insert(N.hostView,w),N}insert(s,a){const l=s._lView,d=l[1];if(function Dl(i){return Ci(i[3])}(l)){const N=this.indexOf(s);if(-1!==N)this.detach(N);else{const O=l[3],j=new sA(O,O[6],O[3]);j.detach(j.indexOf(s))}}const p=this._adjustIndex(a),y=this._lContainer;!function m(i,s,a,l){const d=10+l,p=a.length;l>0&&(a[d-1][4]=s),l<p-10?(s[4]=a[d],Ul(a,10+l,s)):(a.push(s),s[4]=null),s[3]=a;const y=s[17];null!==y&&a!==y&&function h(i,s){const a=i[9];s[16]!==s[3][3][16]&&(i[2]=!0),null===a?i[9]=[s]:a.push(s)}(y,s);const w=s[19];null!==w&&w.insertView(i),s[2]|=128}(d,l,y,p);const w=wf(p,y),C=l[11],A=es(C,y[7]);return null!==A&&function Iy(i,s,a,l,d,p){l[0]=d,l[6]=s,cc(i,l,a,1,d,p)}(d,y[6],C,l,A,w),s.attachToViewContainerRef(),Ul(hE(y),p,s),s}move(s,a){return this.insert(s,a)}indexOf(s){const a=JI(this._lContainer);return null!==a?a.indexOf(s):-1}remove(s){const a=this._adjustIndex(s,-1),l=v(this._lContainer,a);l&&(Ru(hE(this._lContainer),a),b(l[1],l))}detach(s){const a=this._adjustIndex(s,-1),l=v(this._lContainer,a);return l&&null!=Ru(hE(this._lContainer),a)?new sl(l):null}_adjustIndex(s,a=0){return null==s?this.length+a:s}};function JI(i){return i[8]}function hE(i){return i[8]||(i[8]=[])}function Qm(...i){}const Jm=new Yt("Application Initializer");let dh=(()=>{class i{constructor(a){this.appInits=a,this.resolve=Qm,this.reject=Qm,this.initialized=!1,this.done=!1,this.donePromise=new Promise((l,d)=>{this.resolve=l,this.reject=d})}runInitializers(){if(this.initialized)return;const a=[],l=()=>{this.done=!0,this.resolve()};if(this.appInits)for(let d=0;d<this.appInits.length;d++){const p=this.appInits[d]();if(cm(p))a.push(p);else if(eh(p)){const y=new Promise((w,C)=>{p.subscribe({complete:w,error:C})});a.push(y)}}Promise.all(a).then(()=>{l()}).catch(d=>{this.reject(d)}),0===a.length&&l(),this.initialized=!0}}return i.\u0275fac=function(a){return new(a||i)(D(Jm,8))},i.\u0275prov=$t({token:i,factory:i.\u0275fac}),i})();const CC=new Yt("AppId"),hp={provide:CC,useFactory:function ui(){return`${SE()}${SE()}${SE()}`},deps:[]};function SE(){return String.fromCharCode(97+Math.floor(25*Math.random()))}const hh=new Yt("Platform Initializer"),DC=new Yt("Platform ID"),_A=new Yt("appBootstrapListener");let Xm=(()=>{class i{log(a){console.log(a)}warn(a){console.warn(a)}}return i.\u0275fac=function(a){return new(a||i)},i.\u0275prov=$t({token:i,factory:i.\u0275fac}),i})();const fh=new Yt("LocaleId"),e_=new Yt("DefaultCurrencyCode");class AC{constructor(s,a){this.ngModuleFactory=s,this.componentFactories=a}}let SC=(()=>{class i{compileModuleSync(a){return new Lm(a)}compileModuleAsync(a){return Promise.resolve(this.compileModuleSync(a))}compileModuleAndAllComponentsSync(a){const l=this.compileModuleSync(a),p=Es(Jn(a).declarations).reduce((y,w)=>{const C=Qn(w);return C&&y.push(new nE(C)),y},[]);return new AC(l,p)}compileModuleAndAllComponentsAsync(a){return Promise.resolve(this.compileModuleAndAllComponentsSync(a))}clearCache(){}clearCacheFor(a){}getModuleId(a){}}return i.\u0275fac=function(a){return new(a||i)},i.\u0275prov=$t({token:i,factory:i.\u0275fac}),i})();const ME=(()=>Promise.resolve(0))();function t_(i){"undefined"==typeof Zone?ME.then(()=>{i&&i.apply(null,null)}):Zone.current.scheduleMicroTask("scheduleMicrotask",i)}class Oi{constructor({enableLongStackTrace:s=!1,shouldCoalesceEventChangeDetection:a=!1,shouldCoalesceRunChangeDetection:l=!1}){if(this.hasPendingMacrotasks=!1,this.hasPendingMicrotasks=!1,this.isStable=!0,this.onUnstable=new du(!1),this.onMicrotaskEmpty=new du(!1),this.onStable=new du(!1),this.onError=new du(!1),"undefined"==typeof Zone)throw new Error("In this configuration Angular requires Zone.js");Zone.assertZonePatched();const d=this;d._nesting=0,d._outer=d._inner=Zone.current,Zone.TaskTrackingZoneSpec&&(d._inner=d._inner.fork(new Zone.TaskTrackingZoneSpec)),s&&Zone.longStackTraceZoneSpec&&(d._inner=d._inner.fork(Zone.longStackTraceZoneSpec)),d.shouldCoalesceEventChangeDetection=!l&&a,d.shouldCoalesceRunChangeDetection=l,d.lastRequestAnimationFrameId=-1,d.nativeRequestAnimationFrame=function EA(){let i=ct.requestAnimationFrame,s=ct.cancelAnimationFrame;if("undefined"!=typeof Zone&&i&&s){const a=i[Zone.__symbol__("OriginalDelegate")];a&&(i=a);const l=s[Zone.__symbol__("OriginalDelegate")];l&&(s=l)}return{nativeRequestAnimationFrame:i,nativeCancelAnimationFrame:s}}().nativeRequestAnimationFrame,function Qr(i){const s=()=>{!function kr(i){i.isCheckStableRunning||-1!==i.lastRequestAnimationFrameId||(i.lastRequestAnimationFrameId=i.nativeRequestAnimationFrame.call(ct,()=>{i.fakeTopEventTask||(i.fakeTopEventTask=Zone.root.scheduleEventTask("fakeTopEventTask",()=>{i.lastRequestAnimationFrameId=-1,ph(i),i.isCheckStableRunning=!0,fp(i),i.isCheckStableRunning=!1},void 0,()=>{},()=>{})),i.fakeTopEventTask.invoke()}),ph(i))}(i)};i._inner=i._inner.fork({name:"angular",properties:{isAngularZone:!0},onInvokeTask:(a,l,d,p,y,w)=>{try{return n_(i),a.invokeTask(d,p,y,w)}finally{(i.shouldCoalesceEventChangeDetection&&"eventTask"===p.type||i.shouldCoalesceRunChangeDetection)&&s(),MC(i)}},onInvoke:(a,l,d,p,y,w,C)=>{try{return n_(i),a.invoke(d,p,y,w,C)}finally{i.shouldCoalesceRunChangeDetection&&s(),MC(i)}},onHasTask:(a,l,d,p)=>{a.hasTask(d,p),l===d&&("microTask"==p.change?(i._hasPendingMicrotasks=p.microTask,ph(i),fp(i)):"macroTask"==p.change&&(i.hasPendingMacrotasks=p.macroTask))},onHandleError:(a,l,d,p)=>(a.handleError(d,p),i.runOutsideAngular(()=>i.onError.emit(p)),!1)})}(d)}static isInAngularZone(){return!0===Zone.current.get("isAngularZone")}static assertInAngularZone(){if(!Oi.isInAngularZone())throw new Error("Expected to be in Angular Zone, but it is not!")}static assertNotInAngularZone(){if(Oi.isInAngularZone())throw new Error("Expected to not be in Angular Zone, but it is!")}run(s,a,l){return this._inner.run(s,a,l)}runTask(s,a,l,d){const p=this._inner,y=p.scheduleEventTask("NgZoneEvent: "+d,s,NE,Qm,Qm);try{return p.runTask(y,a,l)}finally{p.cancelTask(y)}}runGuarded(s,a,l){return this._inner.runGuarded(s,a,l)}runOutsideAngular(s){return this._outer.run(s)}}const NE={};function fp(i){if(0==i._nesting&&!i.hasPendingMicrotasks&&!i.isStable)try{i._nesting++,i.onMicrotaskEmpty.emit(null)}finally{if(i._nesting--,!i.hasPendingMicrotasks)try{i.runOutsideAngular(()=>i.onStable.emit(null))}finally{i.isStable=!0}}}function ph(i){i.hasPendingMicrotasks=!!(i._hasPendingMicrotasks||(i.shouldCoalesceEventChangeDetection||i.shouldCoalesceRunChangeDetection)&&-1!==i.lastRequestAnimationFrameId)}function n_(i){i._nesting++,i.isStable&&(i.isStable=!1,i.onUnstable.emit(null))}function MC(i){i._nesting--,fp(i)}class wA{constructor(){this.hasPendingMicrotasks=!1,this.hasPendingMacrotasks=!1,this.isStable=!0,this.onUnstable=new du,this.onMicrotaskEmpty=new du,this.onStable=new du,this.onError=new du}run(s,a,l){return s.apply(a,l)}runGuarded(s,a,l){return s.apply(a,l)}runOutsideAngular(s){return s()}runTask(s,a,l,d){return s.apply(a,l)}}let RE=(()=>{class i{constructor(a){this._ngZone=a,this._pendingCount=0,this._isZoneStable=!0,this._didWork=!1,this._callbacks=[],this.taskTrackingZone=null,this._watchAngularEvents(),a.run(()=>{this.taskTrackingZone="undefined"==typeof Zone?null:Zone.current.get("TaskTrackingZone")})}_watchAngularEvents(){this._ngZone.onUnstable.subscribe({next:()=>{this._didWork=!0,this._isZoneStable=!1}}),this._ngZone.runOutsideAngular(()=>{this._ngZone.onStable.subscribe({next:()=>{Oi.assertNotInAngularZone(),t_(()=>{this._isZoneStable=!0,this._runCallbacksIfReady()})}})})}increasePendingRequestCount(){return this._pendingCount+=1,this._didWork=!0,this._pendingCount}decreasePendingRequestCount(){if(this._pendingCount-=1,this._pendingCount<0)throw new Error("pending async requests below zero");return this._runCallbacksIfReady(),this._pendingCount}isStable(){return this._isZoneStable&&0===this._pendingCount&&!this._ngZone.hasPendingMacrotasks}_runCallbacksIfReady(){if(this.isStable())t_(()=>{for(;0!==this._callbacks.length;){let a=this._callbacks.pop();clearTimeout(a.timeoutId),a.doneCb(this._didWork)}this._didWork=!1});else{let a=this.getPendingTasks();this._callbacks=this._callbacks.filter(l=>!l.updateCb||!l.updateCb(a)||(clearTimeout(l.timeoutId),!1)),this._didWork=!0}}getPendingTasks(){return this.taskTrackingZone?this.taskTrackingZone.macroTasks.map(a=>({source:a.source,creationLocation:a.creationLocation,data:a.data})):[]}addCallback(a,l,d){let p=-1;l&&l>0&&(p=setTimeout(()=>{this._callbacks=this._callbacks.filter(y=>y.timeoutId!==p),a(this._didWork,this.getPendingTasks())},l)),this._callbacks.push({doneCb:a,timeoutId:p,updateCb:d})}whenStable(a,l,d){if(d&&!this.taskTrackingZone)throw new Error('Task tracking zone is required when passing an update callback to whenStable(). Is "zone.js/plugins/task-tracking" loaded?');this.addCallback(a,l,d),this._runCallbacksIfReady()}getPendingRequestCount(){return this._pendingCount}findProviders(a,l,d){return[]}}return i.\u0275fac=function(a){return new(a||i)(D(Oi))},i.\u0275prov=$t({token:i,factory:i.\u0275fac}),i})(),NC=(()=>{class i{constructor(){this._applications=new Map,pp.addToWindow(this)}registerApplication(a,l){this._applications.set(a,l)}unregisterApplication(a){this._applications.delete(a)}unregisterAllApplications(){this._applications.clear()}getTestability(a){return this._applications.get(a)||null}getAllTestabilities(){return Array.from(this._applications.values())}getAllRootElements(){return Array.from(this._applications.keys())}findTestabilityInTree(a,l=!0){return pp.findTestabilityInTree(this,a,l)}}return i.\u0275fac=function(a){return new(a||i)},i.\u0275prov=$t({token:i,factory:i.\u0275fac}),i})();class IA{addToWindow(s){}findTestabilityInTree(s,a,l){return null}}function PE(i){pp=i}let So,pp=new IA;const gp=new Yt("AllowMultipleToken");function FE(i,s,a=[]){const l=`Platform: ${s}`,d=new Yt(l);return(p=[])=>{let y=LE();if(!y||y.injector.get(gp,!1))if(i)i(a.concat(p).concat({provide:d,useValue:!0}));else{const w=a.concat(p).concat({provide:d,useValue:!0},{provide:Ky,useValue:"platform"});!function kE(i){if(So&&!So.destroyed&&!So.injector.get(gp,!1))throw new Fe(400,"");So=i.get(VE);const s=i.get(hh,null);s&&s.forEach(a=>a())}(Kr.create({providers:w,name:l}))}return function bA(i){const s=LE();if(!s)throw new Fe(401,"");return s}()}}function LE(){return So&&!So.destroyed?So:null}let VE=(()=>{class i{constructor(a){this._injector=a,this._modules=[],this._destroyListeners=[],this._destroyed=!1}bootstrapModuleFactory(a,l){const w=function PC(i,s){let a;return a="noop"===i?new wA:("zone.js"===i?void 0:i)||new Oi({enableLongStackTrace:!1,shouldCoalesceEventChangeDetection:!!(null==s?void 0:s.ngZoneEventCoalescing),shouldCoalesceRunChangeDetection:!!(null==s?void 0:s.ngZoneRunCoalescing)}),a}(l?l.ngZone:void 0,{ngZoneEventCoalescing:l&&l.ngZoneEventCoalescing||!1,ngZoneRunCoalescing:l&&l.ngZoneRunCoalescing||!1}),C=[{provide:Oi,useValue:w}];return w.run(()=>{const A=Kr.create({providers:C,parent:this.injector,name:a.moduleType.name}),N=a.create(A),O=N.injector.get(Lu,null);if(!O)throw new Fe(402,"");return w.runOutsideAngular(()=>{const j=w.onError.subscribe({next:Z=>{O.handleError(Z)}});N.onDestroy(()=>{al(this._modules,N),j.unsubscribe()})}),function i_(i,s,a){try{const l=a();return cm(l)?l.catch(d=>{throw s.runOutsideAngular(()=>i.handleError(d)),d}):l}catch(l){throw s.runOutsideAngular(()=>i.handleError(l)),l}}(O,w,()=>{const j=N.injector.get(dh);return j.runInitializers(),j.donePromise.then(()=>(function wM(i){st(i,"Expected localeId to be defined"),"string"==typeof i&&(vI=i.toLowerCase().replace(/_/g,"-"))}(N.injector.get(fh,Dm)||Dm),this._moduleDoBootstrap(N),N))})})}bootstrapModule(a,l=[]){const d=OC({},l);return function OE(i,s,a){const l=new Lm(a);return Promise.resolve(l)}(0,0,a).then(p=>this.bootstrapModuleFactory(p,d))}_moduleDoBootstrap(a){const l=a.injector.get(s_);if(a._bootstrapComponents.length>0)a._bootstrapComponents.forEach(d=>l.bootstrap(d));else{if(!a.instance.ngDoBootstrap)throw new Fe(403,"");a.instance.ngDoBootstrap(l)}this._modules.push(a)}onDestroy(a){this._destroyListeners.push(a)}get injector(){return this._injector}destroy(){if(this._destroyed)throw new Fe(404,"");this._modules.slice().forEach(a=>a.destroy()),this._destroyListeners.forEach(a=>a()),this._destroyed=!0}get destroyed(){return this._destroyed}}return i.\u0275fac=function(a){return new(a||i)(D(Kr))},i.\u0275prov=$t({token:i,factory:i.\u0275fac}),i})();function OC(i,s){return Array.isArray(s)?s.reduce(OC,i):Object.assign(Object.assign({},i),s)}let s_=(()=>{class i{constructor(a,l,d,p,y){this._zone=a,this._injector=l,this._exceptionHandler=d,this._componentFactoryResolver=p,this._initStatus=y,this._bootstrapListeners=[],this._views=[],this._runningTick=!1,this._stable=!0,this.componentTypes=[],this.components=[],this._onMicrotaskEmptySubscription=this._zone.onMicrotaskEmpty.subscribe({next:()=>{this._zone.run(()=>{this.tick()})}});const w=new k.y(A=>{this._stable=this._zone.isStable&&!this._zone.hasPendingMacrotasks&&!this._zone.hasPendingMicrotasks,this._zone.runOutsideAngular(()=>{A.next(this._stable),A.complete()})}),C=new k.y(A=>{let N;this._zone.runOutsideAngular(()=>{N=this._zone.onStable.subscribe(()=>{Oi.assertNotInAngularZone(),t_(()=>{!this._stable&&!this._zone.hasPendingMacrotasks&&!this._zone.hasPendingMicrotasks&&(this._stable=!0,A.next(!0))})})});const O=this._zone.onUnstable.subscribe(()=>{Oi.assertInAngularZone(),this._stable&&(this._stable=!1,this._zone.runOutsideAngular(()=>{A.next(!1)}))});return()=>{N.unsubscribe(),O.unsubscribe()}});this.isStable=(0,le.T)(w,C.pipe((0,ie.B)()))}bootstrap(a,l){if(!this._initStatus.done)throw new Fe(405,"");let d;d=a instanceof Zv?a:this._componentFactoryResolver.resolveComponentFactory(a),this.componentTypes.push(d.componentType);const p=function DA(i){return i.isBoundToModule}(d)?void 0:this._injector.get(bc),w=d.create(Kr.NULL,[],l||d.selector,p),C=w.location.nativeElement,A=w.injector.get(RE,null),N=A&&w.injector.get(NC);return A&&N&&N.registerApplication(C,A),w.onDestroy(()=>{this.detachView(w.hostView),al(this.components,w),N&&N.unregisterApplication(C)}),this._loadComponent(w),w}tick(){if(this._runningTick)throw new Fe(101,"");try{this._runningTick=!0;for(let a of this._views)a.detectChanges()}catch(a){this._zone.runOutsideAngular(()=>this._exceptionHandler.handleError(a))}finally{this._runningTick=!1}}attachView(a){const l=a;this._views.push(l),l.attachToAppRef(this)}detachView(a){const l=a;al(this._views,l),l.detachFromAppRef()}_loadComponent(a){this.attachView(a.hostView),this.tick(),this.components.push(a),this._injector.get(_A,[]).concat(this._bootstrapListeners).forEach(d=>d(a))}ngOnDestroy(){this._views.slice().forEach(a=>a.destroy()),this._onMicrotaskEmptySubscription.unsubscribe()}get viewCount(){return this._views.length}}return i.\u0275fac=function(a){return new(a||i)(D(Oi),D(Kr),D(Lu),D(ap),D(dh))},i.\u0275prov=$t({token:i,factory:i.\u0275fac}),i})();function al(i,s){const a=i.indexOf(s);a>-1&&i.splice(a,1)}let ul=!0,BE=!1;function o_(){return BE=!0,ul}function FC(){if(BE)throw new Error("Cannot enable prod mode after platform setup.");ul=!1}let LC=(()=>{class i{}return i.__NG_ELEMENT_ID__=mp,i})();function mp(i){return function u_(i,s,a){if(xn(i)&&!a){const l=Tr(i.index,s);return new sl(l,l)}return 47&i.type?new sl(s[16],s):null}(tn(),Te(),16==(16&i))}class g_{constructor(){}supports(s){return Vf(s)}create(s){return new WE(s)}}const vh=(i,s)=>s;class WE{constructor(s){this.length=0,this._linkedRecords=null,this._unlinkedRecords=null,this._previousItHead=null,this._itHead=null,this._itTail=null,this._additionsHead=null,this._additionsTail=null,this._movesHead=null,this._movesTail=null,this._removalsHead=null,this._removalsTail=null,this._identityChangesHead=null,this._identityChangesTail=null,this._trackByFn=s||vh}forEachItem(s){let a;for(a=this._itHead;null!==a;a=a._next)s(a)}forEachOperation(s){let a=this._itHead,l=this._removalsHead,d=0,p=null;for(;a||l;){const y=!l||a&&a.currentIndex<cl(l,d,p)?a:l,w=cl(y,d,p),C=y.currentIndex;if(y===l)d--,l=l._nextRemoved;else if(a=a._next,null==y.previousIndex)d++;else{p||(p=[]);const A=w-d,N=C-d;if(A!=N){for(let j=0;j<A;j++){const Z=j<p.length?p[j]:p[j]=0,se=Z+j;N<=se&&se<A&&(p[j]=Z+1)}p[y.previousIndex]=N-A}}w!==C&&s(y,w,C)}}forEachPreviousItem(s){let a;for(a=this._previousItHead;null!==a;a=a._nextPrevious)s(a)}forEachAddedItem(s){let a;for(a=this._additionsHead;null!==a;a=a._nextAdded)s(a)}forEachMovedItem(s){let a;for(a=this._movesHead;null!==a;a=a._nextMoved)s(a)}forEachRemovedItem(s){let a;for(a=this._removalsHead;null!==a;a=a._nextRemoved)s(a)}forEachIdentityChange(s){let a;for(a=this._identityChangesHead;null!==a;a=a._nextIdentityChange)s(a)}diff(s){if(null==s&&(s=[]),!Vf(s))throw new Fe(900,"");return this.check(s)?this:null}onDestroy(){}check(s){this._reset();let d,p,y,a=this._itHead,l=!1;if(Array.isArray(s)){this.length=s.length;for(let w=0;w<this.length;w++)p=s[w],y=this._trackByFn(w,p),null!==a&&Object.is(a.trackById,y)?(l&&(a=this._verifyReinsertion(a,p,y,w)),Object.is(a.item,p)||this._addIdentityChange(a,p)):(a=this._mismatch(a,p,y,w),l=!0),a=a._next}else d=0,function Sb(i,s){if(Array.isArray(i))for(let a=0;a<i.length;a++)s(i[a]);else{const a=i[$d()]();let l;for(;!(l=a.next()).done;)s(l.value)}}(s,w=>{y=this._trackByFn(d,w),null!==a&&Object.is(a.trackById,y)?(l&&(a=this._verifyReinsertion(a,w,y,d)),Object.is(a.item,w)||this._addIdentityChange(a,w)):(a=this._mismatch(a,w,y,d),l=!0),a=a._next,d++}),this.length=d;return this._truncate(a),this.collection=s,this.isDirty}get isDirty(){return null!==this._additionsHead||null!==this._movesHead||null!==this._removalsHead||null!==this._identityChangesHead}_reset(){if(this.isDirty){let s;for(s=this._previousItHead=this._itHead;null!==s;s=s._next)s._nextPrevious=s._next;for(s=this._additionsHead;null!==s;s=s._nextAdded)s.previousIndex=s.currentIndex;for(this._additionsHead=this._additionsTail=null,s=this._movesHead;null!==s;s=s._nextMoved)s.previousIndex=s.currentIndex;this._movesHead=this._movesTail=null,this._removalsHead=this._removalsTail=null,this._identityChangesHead=this._identityChangesTail=null}}_mismatch(s,a,l,d){let p;return null===s?p=this._itTail:(p=s._prev,this._remove(s)),null!==(s=null===this._unlinkedRecords?null:this._unlinkedRecords.get(l,null))?(Object.is(s.item,a)||this._addIdentityChange(s,a),this._reinsertAfter(s,p,d)):null!==(s=null===this._linkedRecords?null:this._linkedRecords.get(l,d))?(Object.is(s.item,a)||this._addIdentityChange(s,a),this._moveAfter(s,p,d)):s=this._addAfter(new Mc(a,l),p,d),s}_verifyReinsertion(s,a,l,d){let p=null===this._unlinkedRecords?null:this._unlinkedRecords.get(l,null);return null!==p?s=this._reinsertAfter(p,s._prev,d):s.currentIndex!=d&&(s.currentIndex=d,this._addToMoves(s,d)),s}_truncate(s){for(;null!==s;){const a=s._next;this._addToRemovals(this._unlink(s)),s=a}null!==this._unlinkedRecords&&this._unlinkedRecords.clear(),null!==this._additionsTail&&(this._additionsTail._nextAdded=null),null!==this._movesTail&&(this._movesTail._nextMoved=null),null!==this._itTail&&(this._itTail._next=null),null!==this._removalsTail&&(this._removalsTail._nextRemoved=null),null!==this._identityChangesTail&&(this._identityChangesTail._nextIdentityChange=null)}_reinsertAfter(s,a,l){null!==this._unlinkedRecords&&this._unlinkedRecords.remove(s);const d=s._prevRemoved,p=s._nextRemoved;return null===d?this._removalsHead=p:d._nextRemoved=p,null===p?this._removalsTail=d:p._prevRemoved=d,this._insertAfter(s,a,l),this._addToMoves(s,l),s}_moveAfter(s,a,l){return this._unlink(s),this._insertAfter(s,a,l),this._addToMoves(s,l),s}_addAfter(s,a,l){return this._insertAfter(s,a,l),this._additionsTail=null===this._additionsTail?this._additionsHead=s:this._additionsTail._nextAdded=s,s}_insertAfter(s,a,l){const d=null===a?this._itHead:a._next;return s._next=d,s._prev=a,null===d?this._itTail=s:d._prev=s,null===a?this._itHead=s:a._next=s,null===this._linkedRecords&&(this._linkedRecords=new GC),this._linkedRecords.put(s),s.currentIndex=l,s}_remove(s){return this._addToRemovals(this._unlink(s))}_unlink(s){null!==this._linkedRecords&&this._linkedRecords.remove(s);const a=s._prev,l=s._next;return null===a?this._itHead=l:a._next=l,null===l?this._itTail=a:l._prev=a,s}_addToMoves(s,a){return s.previousIndex===a||(this._movesTail=null===this._movesTail?this._movesHead=s:this._movesTail._nextMoved=s),s}_addToRemovals(s){return null===this._unlinkedRecords&&(this._unlinkedRecords=new GC),this._unlinkedRecords.put(s),s.currentIndex=null,s._nextRemoved=null,null===this._removalsTail?(this._removalsTail=this._removalsHead=s,s._prevRemoved=null):(s._prevRemoved=this._removalsTail,this._removalsTail=this._removalsTail._nextRemoved=s),s}_addIdentityChange(s,a){return s.item=a,this._identityChangesTail=null===this._identityChangesTail?this._identityChangesHead=s:this._identityChangesTail._nextIdentityChange=s,s}}class Mc{constructor(s,a){this.item=s,this.trackById=a,this.currentIndex=null,this.previousIndex=null,this._nextPrevious=null,this._prev=null,this._next=null,this._prevDup=null,this._nextDup=null,this._prevRemoved=null,this._nextRemoved=null,this._nextAdded=null,this._nextMoved=null,this._nextIdentityChange=null}}class HC{constructor(){this._head=null,this._tail=null}add(s){null===this._head?(this._head=this._tail=s,s._nextDup=null,s._prevDup=null):(this._tail._nextDup=s,s._prevDup=this._tail,s._nextDup=null,this._tail=s)}get(s,a){let l;for(l=this._head;null!==l;l=l._nextDup)if((null===a||a<=l.currentIndex)&&Object.is(l.trackById,s))return l;return null}remove(s){const a=s._prevDup,l=s._nextDup;return null===a?this._head=l:a._nextDup=l,null===l?this._tail=a:l._prevDup=a,null===this._head}}class GC{constructor(){this.map=new Map}put(s){const a=s.trackById;let l=this.map.get(a);l||(l=new HC,this.map.set(a,l)),l.add(s)}get(s,a){const d=this.map.get(s);return d?d.get(s,a):null}remove(s){const a=s.trackById;return this.map.get(a).remove(s)&&this.map.delete(a),s}get isEmpty(){return 0===this.map.size}clear(){this.map.clear()}}function cl(i,s,a){const l=i.previousIndex;if(null===l)return l;let d=0;return a&&l<a.length&&(d=a[l]),l+s+d}class pa{constructor(){}supports(s){return s instanceof Map||uv(s)}create(){return new m_}}class m_{constructor(){this._records=new Map,this._mapHead=null,this._appendAfter=null,this._previousMapHead=null,this._changesHead=null,this._changesTail=null,this._additionsHead=null,this._additionsTail=null,this._removalsHead=null,this._removalsTail=null}get isDirty(){return null!==this._additionsHead||null!==this._changesHead||null!==this._removalsHead}forEachItem(s){let a;for(a=this._mapHead;null!==a;a=a._next)s(a)}forEachPreviousItem(s){let a;for(a=this._previousMapHead;null!==a;a=a._nextPrevious)s(a)}forEachChangedItem(s){let a;for(a=this._changesHead;null!==a;a=a._nextChanged)s(a)}forEachAddedItem(s){let a;for(a=this._additionsHead;null!==a;a=a._nextAdded)s(a)}forEachRemovedItem(s){let a;for(a=this._removalsHead;null!==a;a=a._nextRemoved)s(a)}diff(s){if(s){if(!(s instanceof Map||uv(s)))throw new Fe(900,"")}else s=new Map;return this.check(s)?this:null}onDestroy(){}check(s){this._reset();let a=this._mapHead;if(this._appendAfter=null,this._forEach(s,(l,d)=>{if(a&&a.key===d)this._maybeAddToChanges(a,l),this._appendAfter=a,a=a._next;else{const p=this._getOrCreateRecordForKey(d,l);a=this._insertBeforeOrAppend(a,p)}}),a){a._prev&&(a._prev._next=null),this._removalsHead=a;for(let l=a;null!==l;l=l._nextRemoved)l===this._mapHead&&(this._mapHead=null),this._records.delete(l.key),l._nextRemoved=l._next,l.previousValue=l.currentValue,l.currentValue=null,l._prev=null,l._next=null}return this._changesTail&&(this._changesTail._nextChanged=null),this._additionsTail&&(this._additionsTail._nextAdded=null),this.isDirty}_insertBeforeOrAppend(s,a){if(s){const l=s._prev;return a._next=s,a._prev=l,s._prev=a,l&&(l._next=a),s===this._mapHead&&(this._mapHead=a),this._appendAfter=s,s}return this._appendAfter?(this._appendAfter._next=a,a._prev=this._appendAfter):this._mapHead=a,this._appendAfter=a,null}_getOrCreateRecordForKey(s,a){if(this._records.has(s)){const d=this._records.get(s);this._maybeAddToChanges(d,a);const p=d._prev,y=d._next;return p&&(p._next=y),y&&(y._prev=p),d._next=null,d._prev=null,d}const l=new __(s);return this._records.set(s,l),l.currentValue=a,this._addToAdditions(l),l}_reset(){if(this.isDirty){let s;for(this._previousMapHead=this._mapHead,s=this._previousMapHead;null!==s;s=s._next)s._nextPrevious=s._next;for(s=this._changesHead;null!==s;s=s._nextChanged)s.previousValue=s.currentValue;for(s=this._additionsHead;null!=s;s=s._nextAdded)s.previousValue=s.currentValue;this._changesHead=this._changesTail=null,this._additionsHead=this._additionsTail=null,this._removalsHead=null}}_maybeAddToChanges(s,a){Object.is(a,s.currentValue)||(s.previousValue=s.currentValue,s.currentValue=a,this._addToChanges(s))}_addToAdditions(s){null===this._additionsHead?this._additionsHead=this._additionsTail=s:(this._additionsTail._nextAdded=s,this._additionsTail=s)}_addToChanges(s){null===this._changesHead?this._changesHead=this._changesTail=s:(this._changesTail._nextChanged=s,this._changesTail=s)}_forEach(s,a){s instanceof Map?s.forEach(a):Object.keys(s).forEach(l=>a(s[l],l))}}class __{constructor(s){this.key=s,this.previousValue=null,this.currentValue=null,this._nextPrevious=null,this._next=null,this._prev=null,this._nextAdded=null,this._nextRemoved=null,this._nextChanged=null}}function yp(){return new vp([new g_])}let vp=(()=>{class i{constructor(a){this.factories=a}static create(a,l){if(null!=l){const d=l.factories.slice();a=a.concat(d)}return new i(a)}static extend(a){return{provide:i,useFactory:l=>i.create(a,l||yp()),deps:[[i,new ln,new at]]}}find(a){const l=this.factories.find(d=>d.supports(a));if(null!=l)return l;throw new Fe(901,"")}}return i.\u0275prov=$t({token:i,providedIn:"root",factory:yp}),i})();function Ep(){return new y_([new pa])}let y_=(()=>{class i{constructor(a){this.factories=a}static create(a,l){if(l){const d=l.factories.slice();a=a.concat(d)}return new i(a)}static extend(a){return{provide:i,useFactory:l=>i.create(a,l||Ep()),deps:[[i,new ln,new at]]}}find(a){const l=this.factories.find(p=>p.supports(a));if(l)return l;throw new Fe(901,"")}}return i.\u0275prov=$t({token:i,providedIn:"root",factory:Ep}),i})();const RA=[new pa],Ip=new vp([new g_]),PA=new y_(RA),kA=FE(null,"core",[{provide:DC,useValue:"unknown"},{provide:VE,deps:[Kr]},{provide:NC,deps:[]},{provide:Xm,deps:[]}]),dl=[{provide:s_,useClass:s_,deps:[Oi,Kr,Lu,ap,dh]},{provide:GT,deps:[Oi],useFactory:function $C(i){let s=[];return i.onStable.subscribe(()=>{for(;s.length;)s.pop()()}),function(a){s.push(a)}}},{provide:dh,useClass:dh,deps:[[new at,Jm]]},{provide:SC,useClass:SC,deps:[]},hp,{provide:vp,useFactory:function FA(){return Ip},deps:[]},{provide:y_,useFactory:function LA(){return PA},deps:[]},{provide:fh,useFactory:function VA(i){return i||function Cp(){return"undefined"!=typeof $localize&&$localize.locale||Dm}()},deps:[[new ke(fh),new at,new ln]]},{provide:e_,useValue:"USD"}];let WC=(()=>{class i{constructor(a){}}return i.\u0275fac=function(a){return new(a||i)(D(s_))},i.\u0275mod=Ps({type:i}),i.\u0275inj=Vi({providers:dl}),i})()},3942:(it,be,L)=>{"use strict";L.d(be,{Z:()=>Fe});var _=L(2090),J=L(4859),k=L(9681),le=L(1877);class ie{constructor(K,re){this._delegate=K,this.firebase=re,(0,k._addComponent)(K,new J.wA("app-compat",()=>this,"PUBLIC")),this.container=K.container}get automaticDataCollectionEnabled(){return this._delegate.automaticDataCollectionEnabled}set automaticDataCollectionEnabled(K){this._delegate.automaticDataCollectionEnabled=K}get name(){return this._delegate.name}get options(){return this._delegate.options}delete(){return new Promise(K=>{this._delegate.checkDestroyed(),K()}).then(()=>(this.firebase.INTERNAL.removeApp(this.name),(0,k.deleteApp)(this._delegate)))}_getService(K,re=k._DEFAULT_ENTRY_NAME){var he;this._delegate.checkDestroyed();const we=this._delegate.container.getProvider(K);return!we.isInitialized()&&"EXPLICIT"===(null===(he=we.getComponent())||void 0===he?void 0:he.instantiationMode)&&we.initialize(),we.getImmediate({identifier:re})}_removeServiceInstance(K,re=k._DEFAULT_ENTRY_NAME){this._delegate.container.getProvider(K).clearInstance(re)}_addComponent(K){(0,k._addComponent)(this._delegate,K)}_addOrOverwriteComponent(K){(0,k._addOrOverwriteComponent)(this._delegate,K)}toJSON(){return{name:this.name,automaticDataCollectionEnabled:this.automaticDataCollectionEnabled,options:this.options}}}const oe=new _.LL("app-compat","Firebase",{"no-app":"No Firebase App '{$appName}' has been created - call Firebase App.initializeApp()","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance."}),$=function ye(){const Be=function de(Be){const K={},re={__esModule:!0,initializeApp:function me(Ke,pt={}){const Q=k.initializeApp(Ke,pt);if((0,_.r3)(K,Q.name))return K[Q.name];const ae=new Be(Q,re);return K[Q.name]=ae,ae},app:we,registerVersion:k.registerVersion,setLogLevel:k.setLogLevel,onLog:k.onLog,apps:null,SDK_VERSION:k.SDK_VERSION,INTERNAL:{registerComponent:function Ce(Ke){const pt=Ke.name,Q=pt.replace("-compat","");if(k._registerComponent(Ke)&&"PUBLIC"===Ke.type){const ae=(_e=we())=>{if("function"!=typeof _e[Q])throw oe.create("invalid-app-argument",{appName:pt});return _e[Q]()};void 0!==Ke.serviceProps&&(0,_.ZB)(ae,Ke.serviceProps),re[Q]=ae,Be.prototype[Q]=function(..._e){return this._getService.bind(this,pt).apply(this,Ke.multipleInstances?_e:[])}}return"PUBLIC"===Ke.type?re[Q]:null},removeApp:function he(Ke){delete K[Ke]},useAsService:function rt(Ke,pt){return"serverAuth"===pt?null:pt},modularAPIs:k}};function we(Ke){if(!(0,_.r3)(K,Ke=Ke||k._DEFAULT_ENTRY_NAME))throw oe.create("no-app",{appName:Ke});return K[Ke]}return re.default=re,Object.defineProperty(re,"apps",{get:function Ue(){return Object.keys(K).map(Ke=>K[Ke])}}),we.App=Be,re}(ie);return Be.INTERNAL=Object.assign(Object.assign({},Be.INTERNAL),{createFirebaseNamespace:ye,extendNamespace:function K(re){(0,_.ZB)(Be,re)},createSubscribe:_.ne,ErrorFactory:_.LL,deepExtend:_.ZB}),Be}(),H=new le.Yd("@firebase/app-compat");if((0,_.jU)()&&void 0!==self.firebase){H.warn("\n    Warning: Firebase is already defined in the global scope. Please make sure\n    Firebase library is only loaded once.\n  ");const Be=self.firebase.SDK_VERSION;Be&&Be.indexOf("LITE")>=0&&H.warn("\n    Warning: You are trying to load Firebase while using Firebase Performance standalone script.\n    You should load Firebase Performance with this instance of Firebase to avoid loading duplicate code.\n    ")}const Fe=$;!function Ne(Be){(0,k.registerVersion)("@firebase/app-compat","0.1.18",Be)}()},9681:(it,be,L)=>{"use strict";L.r(be),L.d(be,{FirebaseError:()=>le.ZR,SDK_VERSION:()=>Xs,_DEFAULT_ENTRY_NAME:()=>Ln,_addComponent:()=>Jt,_addOrOverwriteComponent:()=>mr,_apps:()=>nt,_clearComponents:()=>Dn,_components:()=>wr,_getProvider:()=>yi,_registerComponent:()=>$t,_removeServiceInstance:()=>Vi,deleteApp:()=>ur,getApp:()=>os,getApps:()=>Ae,initializeApp:()=>Ur,onLog:()=>Ut,registerVersion:()=>Xr,setLogLevel:()=>Vn});var _=L(5861),J=L(4859),k=L(1877),le=L(2090);class ie{constructor(tt){this.container=tt}getPlatformInfoString(){return this.container.getProviders().map(Dt=>{if(function ge(lt){const tt=lt.getComponent();return"VERSION"===(null==tt?void 0:tt.type)}(Dt)){const sn=Dt.getImmediate();return`${sn.library}/${sn.version}`}return null}).filter(Dt=>Dt).join(" ")}}const oe="@firebase/app",ye=new k.Yd("@firebase/app"),Ln="[DEFAULT]",st={[oe]:"fire-core","@firebase/app-compat":"fire-core-compat","@firebase/analytics":"fire-analytics","@firebase/analytics-compat":"fire-analytics-compat","@firebase/app-check":"fire-app-check","@firebase/app-check-compat":"fire-app-check-compat","@firebase/auth":"fire-auth","@firebase/auth-compat":"fire-auth-compat","@firebase/database":"fire-rtdb","@firebase/database-compat":"fire-rtdb-compat","@firebase/functions":"fire-fn","@firebase/functions-compat":"fire-fn-compat","@firebase/installations":"fire-iid","@firebase/installations-compat":"fire-iid-compat","@firebase/messaging":"fire-fcm","@firebase/messaging-compat":"fire-fcm-compat","@firebase/performance":"fire-perf","@firebase/performance-compat":"fire-perf-compat","@firebase/remote-config":"fire-rc","@firebase/remote-config-compat":"fire-rc-compat","@firebase/storage":"fire-gcs","@firebase/storage-compat":"fire-gcs-compat","@firebase/firestore":"fire-fst","@firebase/firestore-compat":"fire-fst-compat","fire-js":"fire-js",firebase:"fire-js-all"},nt=new Map,wr=new Map;function Jt(lt,tt){try{lt.container.addComponent(tt)}catch(Dt){ye.debug(`Component ${tt.name} failed to register with FirebaseApp ${lt.name}`,Dt)}}function mr(lt,tt){lt.container.addOrOverwriteComponent(tt)}function $t(lt){const tt=lt.name;if(wr.has(tt))return ye.debug(`There were multiple attempts to register component ${tt}.`),!1;wr.set(tt,lt);for(const Dt of nt.values())Jt(Dt,lt);return!0}function yi(lt,tt){return lt.container.getProvider(tt)}function Vi(lt,tt,Dt=Ln){yi(lt,tt).clearInstance(Dt)}function Dn(){wr.clear()}const kt=new le.LL("app","Firebase",{"no-app":"No Firebase App '{$appName}' has been created - call Firebase App.initializeApp()","bad-app-name":"Illegal App name: '{$appName}","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function."});class gn{constructor(tt,Dt,sn){this._isDeleted=!1,this._options=Object.assign({},tt),this._config=Object.assign({},Dt),this._name=Dt.name,this._automaticDataCollectionEnabled=Dt.automaticDataCollectionEnabled,this._container=sn,this.container.addComponent(new J.wA("app",()=>this,"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(tt){this.checkDestroyed(),this._automaticDataCollectionEnabled=tt}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(tt){this._isDeleted=tt}checkDestroyed(){if(this.isDeleted)throw kt.create("app-deleted",{appName:this._name})}}const Xs="9.6.7";function Ur(lt,tt={}){"object"!=typeof tt&&(tt={name:tt});const Dt=Object.assign({name:Ln,automaticDataCollectionEnabled:!1},tt),sn=Dt.name;if("string"!=typeof sn||!sn)throw kt.create("bad-app-name",{appName:String(sn)});const Ir=nt.get(sn);if(Ir){if((0,le.vZ)(lt,Ir.options)&&(0,le.vZ)(Dt,Ir.config))return Ir;throw kt.create("duplicate-app",{appName:sn})}const bt=new J.H0(sn);for(const ot of wr.values())bt.addComponent(ot);const Xe=new gn(lt,Dt,bt);return nt.set(sn,Xe),Xe}function os(lt=Ln){const tt=nt.get(lt);if(!tt)throw kt.create("no-app",{appName:lt});return tt}function Ae(){return Array.from(nt.values())}function ur(lt){return et.apply(this,arguments)}function et(){return(et=(0,_.Z)(function*(lt){const tt=lt.name;nt.has(tt)&&(nt.delete(tt),yield Promise.all(lt.container.getProviders().map(Dt=>Dt.delete())),lt.isDeleted=!0)})).apply(this,arguments)}function Xr(lt,tt,Dt){var sn;let Ir=null!==(sn=st[lt])&&void 0!==sn?sn:lt;Dt&&(Ir+=`-${Dt}`);const bt=Ir.match(/\s|\//),Xe=tt.match(/\s|\//);if(bt||Xe){const ot=[`Unable to register library "${Ir}" with version "${tt}":`];return bt&&ot.push(`library name "${Ir}" contains illegal characters (whitespace or "/")`),bt&&Xe&&ot.push("and"),Xe&&ot.push(`version name "${tt}" contains illegal characters (whitespace or "/")`),void ye.warn(ot.join(" "))}$t(new J.wA(`${Ir}-version`,()=>({library:Ir,version:tt}),"VERSION"))}function Ut(lt,tt){if(null!==lt&&"function"!=typeof lt)throw kt.create("invalid-log-argument");(0,k.Am)(lt,tt)}function Vn(lt){(0,k.Ub)(lt)}!function Rs(lt){$t(new J.wA("platform-logger",tt=>new ie(tt),"PRIVATE")),Xr(oe,"0.7.17",lt),Xr(oe,"0.7.17","esm2017"),Xr("fire-js","")}("")},4859:(it,be,L)=>{"use strict";L.d(be,{wA:()=>k,H0:()=>de,zt:()=>ie});var _=L(5861),J=L(2090);class k{constructor($,H,X){this.name=$,this.instanceFactory=H,this.type=X,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode($){return this.instantiationMode=$,this}setMultipleInstances($){return this.multipleInstances=$,this}setServiceProps($){return this.serviceProps=$,this}setInstanceCreatedCallback($){return this.onInstanceCreated=$,this}}const le="[DEFAULT]";class ie{constructor($,H){this.name=$,this.container=H,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get($){const H=this.normalizeInstanceIdentifier($);if(!this.instancesDeferred.has(H)){const X=new J.BH;if(this.instancesDeferred.set(H,X),this.isInitialized(H)||this.shouldAutoInitialize())try{const Ge=this.getOrInitializeService({instanceIdentifier:H});Ge&&X.resolve(Ge)}catch(Ge){}}return this.instancesDeferred.get(H).promise}getImmediate($){var H;const X=this.normalizeInstanceIdentifier(null==$?void 0:$.identifier),Ge=null!==(H=null==$?void 0:$.optional)&&void 0!==H&&H;if(!this.isInitialized(X)&&!this.shouldAutoInitialize()){if(Ge)return null;throw Error(`Service ${this.name} is not available`)}try{return this.getOrInitializeService({instanceIdentifier:X})}catch(Ne){if(Ge)return null;throw Ne}}getComponent(){return this.component}setComponent($){if($.name!==this.name)throw Error(`Mismatching Component ${$.name} for Provider ${this.name}.`);if(this.component)throw Error(`Component for ${this.name} has already been provided`);if(this.component=$,this.shouldAutoInitialize()){if(function oe(ye){return"EAGER"===ye.instantiationMode}($))try{this.getOrInitializeService({instanceIdentifier:le})}catch(H){}for(const[H,X]of this.instancesDeferred.entries()){const Ge=this.normalizeInstanceIdentifier(H);try{const Ne=this.getOrInitializeService({instanceIdentifier:Ge});X.resolve(Ne)}catch(Ne){}}}}clearInstance($=le){this.instancesDeferred.delete($),this.instancesOptions.delete($),this.instances.delete($)}delete(){var $=this;return(0,_.Z)(function*(){const H=Array.from($.instances.values());yield Promise.all([...H.filter(X=>"INTERNAL"in X).map(X=>X.INTERNAL.delete()),...H.filter(X=>"_delete"in X).map(X=>X._delete())])})()}isComponentSet(){return null!=this.component}isInitialized($=le){return this.instances.has($)}getOptions($=le){return this.instancesOptions.get($)||{}}initialize($={}){const{options:H={}}=$,X=this.normalizeInstanceIdentifier($.instanceIdentifier);if(this.isInitialized(X))throw Error(`${this.name}(${X}) has already been initialized`);if(!this.isComponentSet())throw Error(`Component ${this.name} has not been registered yet`);const Ge=this.getOrInitializeService({instanceIdentifier:X,options:H});for(const[Ne,Fe]of this.instancesDeferred.entries())X===this.normalizeInstanceIdentifier(Ne)&&Fe.resolve(Ge);return Ge}onInit($,H){var X;const Ge=this.normalizeInstanceIdentifier(H),Ne=null!==(X=this.onInitCallbacks.get(Ge))&&void 0!==X?X:new Set;Ne.add($),this.onInitCallbacks.set(Ge,Ne);const Fe=this.instances.get(Ge);return Fe&&$(Fe,Ge),()=>{Ne.delete($)}}invokeOnInitCallbacks($,H){const X=this.onInitCallbacks.get(H);if(X)for(const Ge of X)try{Ge($,H)}catch(Ne){}}getOrInitializeService({instanceIdentifier:$,options:H={}}){let X=this.instances.get($);if(!X&&this.component&&(X=this.component.instanceFactory(this.container,{instanceIdentifier:(ye=$,ye===le?void 0:ye),options:H}),this.instances.set($,X),this.instancesOptions.set($,H),this.invokeOnInitCallbacks(X,$),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,$,X)}catch(Ge){}var ye;return X||null}normalizeInstanceIdentifier($=le){return this.component?this.component.multipleInstances?$:le:$}shouldAutoInitialize(){return!!this.component&&"EXPLICIT"!==this.component.instantiationMode}}class de{constructor($){this.name=$,this.providers=new Map}addComponent($){const H=this.getProvider($.name);if(H.isComponentSet())throw new Error(`Component ${$.name} has already been registered with ${this.name}`);H.setComponent($)}addOrOverwriteComponent($){this.getProvider($.name).isComponentSet()&&this.providers.delete($.name),this.addComponent($)}getProvider($){if(this.providers.has($))return this.providers.get($);const H=new ie($,this);return this.providers.set($,H),H}getProviders(){return Array.from(this.providers.values())}}},1877:(it,be,L)=>{"use strict";L.d(be,{in:()=>J,Yd:()=>oe,Ub:()=>de,Am:()=>ye});const _=[];var J=(()=>{return($=J||(J={}))[$.DEBUG=0]="DEBUG",$[$.VERBOSE=1]="VERBOSE",$[$.INFO=2]="INFO",$[$.WARN=3]="WARN",$[$.ERROR=4]="ERROR",$[$.SILENT=5]="SILENT",J;var $})();const k={debug:J.DEBUG,verbose:J.VERBOSE,info:J.INFO,warn:J.WARN,error:J.ERROR,silent:J.SILENT},le=J.INFO,ie={[J.DEBUG]:"log",[J.VERBOSE]:"log",[J.INFO]:"info",[J.WARN]:"warn",[J.ERROR]:"error"},ge=($,H,...X)=>{if(H<$.logLevel)return;const Ge=(new Date).toISOString(),Ne=ie[H];if(!Ne)throw new Error(`Attempted to log a message with an invalid logType (value: ${H})`);console[Ne](`[${Ge}]  ${$.name}:`,...X)};class oe{constructor(H){this.name=H,this._logLevel=le,this._logHandler=ge,this._userLogHandler=null,_.push(this)}get logLevel(){return this._logLevel}set logLevel(H){if(!(H in J))throw new TypeError(`Invalid value "${H}" assigned to \`logLevel\``);this._logLevel=H}setLogLevel(H){this._logLevel="string"==typeof H?k[H]:H}get logHandler(){return this._logHandler}set logHandler(H){if("function"!=typeof H)throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=H}get userLogHandler(){return this._userLogHandler}set userLogHandler(H){this._userLogHandler=H}debug(...H){this._userLogHandler&&this._userLogHandler(this,J.DEBUG,...H),this._logHandler(this,J.DEBUG,...H)}log(...H){this._userLogHandler&&this._userLogHandler(this,J.VERBOSE,...H),this._logHandler(this,J.VERBOSE,...H)}info(...H){this._userLogHandler&&this._userLogHandler(this,J.INFO,...H),this._logHandler(this,J.INFO,...H)}warn(...H){this._userLogHandler&&this._userLogHandler(this,J.WARN,...H),this._logHandler(this,J.WARN,...H)}error(...H){this._userLogHandler&&this._userLogHandler(this,J.ERROR,...H),this._logHandler(this,J.ERROR,...H)}}function de($){_.forEach(H=>{H.setLogLevel($)})}function ye($,H){for(const X of _){let Ge=null;H&&H.level&&(Ge=k[H.level]),X.userLogHandler=null===$?null:(Ne,Fe,...Be)=>{const K=Be.map(re=>{if(null==re)return null;if("string"==typeof re)return re;if("number"==typeof re||"boolean"==typeof re)return re.toString();if(re instanceof Error)return re.message;try{return JSON.stringify(re)}catch(he){return null}}).filter(re=>re).join(" ");Fe>=(null!=Ge?Ge:Ne.logLevel)&&$({level:J[Fe].toLowerCase(),message:K,args:Be,type:Ne.name})}}}},5861:(it,be,L)=>{"use strict";function _(k,le,ie,ge,oe,de,ye){try{var $=k[de](ye),H=$.value}catch(X){return void ie(X)}$.done?le(H):Promise.resolve(H).then(ge,oe)}function J(k){return function(){var le=this,ie=arguments;return new Promise(function(ge,oe){var de=k.apply(le,ie);function ye(H){_(de,ge,oe,ye,$,"next",H)}function $(H){_(de,ge,oe,ye,$,"throw",H)}ye(void 0)})}}L.d(be,{Z:()=>J})}},it=>{it(it.s=4799)}]);